// Console-polyfill. MIT license.
// https://github.com/paulmillr/console-polyfill
// Make it safe to do console.log() always.

//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.2.min.map
*/

//     (c) 2010-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

//! moment.js
//! version : 2.11.2
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*!
 * Globalize
 *
 * http://github.com/jquery/globalize
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */

/******************************************************************************
 * jquery.i18n.properties
 * 
 * Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
 * MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses.
 * 
 * @version     1.0.x
 * @author      Nuno Fernandes
 * @url         www.codingwithcoffee.com
 * @inspiration Localisation assistance for jQuery (http://keith-wood.name/localisation.html)
 *              by Keith Wood (kbwood{at}iinet.com.au) June 2007
 * 
 *****************************************************************************/

/* Cross-Browser Split 1.0.1
(c) Steven Levithan <stevenlevithan.com>; MIT License
An ECMA-compliant, uniform cross-browser split method */

/*! sprintf.js | Copyright (c) 2007-2013 Alexandru Marasteanu <hello at alexei dot ro> | 3 clause BSD license */

/**
 * Copyright 2010 Tim Down.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * jquery.numberformatter - Formatting/Parsing Numbers in jQuery
 * 
 * Written by
 * Michael Abernethy (mike@abernethysoft.com),
 * Andrew Parry (aparry0@gmail.com)
 *
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * @author Michael Abernethy, Andrew Parry
 * @version 1.2.3-SNAPSHOT ($Id$)
 * 
 * Dependencies
 * 
 * jQuery (http://jquery.com)
 * jshashtable (http://www.timdown.co.uk/jshashtable)
 * 
 * Notes & Thanks
 * 
 * many thanks to advweb.nanasi.jp for his bug fixes
 * jsHashtable is now used also, so thanks to the author for that excellent little class.
 *
 * This plugin can be used to format numbers as text and parse text as Numbers
 * Because we live in an international world, we cannot assume that everyone
 * uses "," to divide thousands, and "." as a decimal point.
 *
 * As of 1.2 the way this plugin works has changed slightly, parsing text to a number
 * has 1 set of functions, formatting a number to text has it's own. Before things
 * were a little confusing, so I wanted to separate the 2 out more.
 *
 *
 * jQuery extension functions:
 *
 * formatNumber(options, writeBack, giveReturnValue) - Reads the value from the subject, parses to
 * a Javascript Number object, then formats back to text using the passed options and write back to
 * the subject.
 * 
 * parseNumber(options) - Parses the value in the subject to a Number object using the passed options
 * to decipher the actual number from the text, then writes the value as text back to the subject.
 * 
 * 
 * Generic functions:
 * 
 * formatNumber(numberString, options) - Takes a plain number as a string (e.g. '1002.0123') and returns
 * a string of the given format options.
 * 
 * parseNumber(numberString, options) - Takes a number as text that is formatted the same as the given
 * options then and returns it as a plain Number object.
 * 
 * To achieve the old way of combining parsing and formatting to keep say a input field always formatted
 * to a given format after it has lost focus you'd simply use a combination of the functions.
 * 
 * e.g.
 * $("#salary").blur(function(){
 * 		$(this).parseNumber({format:"#,###.00", locale:"us"});
 * 		$(this).formatNumber({format:"#,###.00", locale:"us"});
 * });
 *
 * The syntax for the formatting is:
 * 0 = Digit
 * # = Digit, zero shows as absent
 * . = Decimal separator
 * - = Negative sign
 * , = Grouping Separator
 * % = Percent (multiplies the number by 100)
 * 
 * For example, a format of "#,###.00" and text of 4500.20 will
 * display as "4.500,20" with a locale of "de", and "4,500.20" with a locale of "us"
 *
 *
 * As of now, the only acceptable locales are 
 * Arab Emirates -> "ae"
 * Australia -> "au"
 * Austria -> "at"
 * Brazil -> "br"
 * Canada -> "ca"
 * China -> "cn"
 * Czech -> "cz"
 * Denmark -> "dk"
 * Egypt -> "eg"
 * Finland -> "fi"
 * France  -> "fr"
 * Germany -> "de"
 * Greece -> "gr"
 * Great Britain -> "gb"
 * Hong Kong -> "hk"
 * India -> "in"
 * Israel -> "il"
 * Japan -> "jp"
 * Russia -> "ru"
 * South Korea -> "kr"
 * Spain -> "es"
 * Sweden -> "se"
 * Switzerland -> "ch"
 * Taiwan -> "tw"
 * Thailand -> "th"
 * United States -> "us"
 * Vietnam -> "vn"
 **/

/**
 * jQuery Cookie plugin
 *
 * Copyright (c) 2010 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

/*! garmin.host-v1.2-min.js Branch: r20131127.02 */

/**
 * @license RequireJS text 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/**
 * @file - RouteModel.js
 * @description This is the model class for a route. It contains metadata for the
 * route plus the points defining the route.
 *
 * @author Steve Mitchell
 * @email steve.mitchell@garmin.com
 *
 * Copyright(c) 2010, Garmin International
 */

/**
 *
 * @description This class provides linked list functionality for markers on a map.
 *
 * @author Steve Mitchell
 * @email steve.mitchell@garmin.com
 *
 * Copyright(c) 2010, Garmin International
 */

/**
 *
 * @description This class provides linked list functionality for lines on a map.
 *
 * @author Steve Mitchell
 * @email steve.mitchell@garmin.com
 *
 * Copyright(c) 2010, Garmin International
 */

/**
 *
 * @description This is the model class for a lat/lon point.
 *
 * @author Steve Mitchell
 * @email steve.mitchell@garmin.com
 *
 * Copyright(c) 2010, Garmin International
 * @param latitude - The latitude of the point.
 * @param longitude - The longitude of the point.
 * @param elevation - (optional) the elevation of the point.
 */

/**
 *
 * @description This class contains parameters needed for handling direction callbacks.
 *
 * @author Steve Mitchell
 * @email steve.mitchell@garmin.com
 *
 * Copyright(c) 2010, Garmin International
 * @param marker1 = The marker for the start of the directions.
 * @param marker2 = The marker for the end of the directions.
 */

/*!
 * jquery-timepicker v1.11.1 - A jQuery timepicker plugin inspired by Google Calendar. It supports both mouse and keyboard navigation.
 * Copyright (c) 2016 Jon Thornton - http://jonthornton.github.com/jquery-timepicker/
 * License: MIT
 */

/*! jQuery UI - v1.10.3 - 2013-05-03
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2012 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/

/*
 Highcharts JS v5.0.0 (2016-09-29)

 (c) 2009-2016 Torstein Honsi

 License: www.highcharts.com/license
*/

/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011â€“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */

/**
 * @filename RestClient.js
 * 
 * @description This is the base class for all client library classes. It
 *              contains methods for performing all of the different HTTP
 *              methods neccesary to make calls to the web service.
 * 
 * @author Michael Bina
 * @email michael.bina@garmin.com
 * 
 * Copyright(c) 2008, Garmin International
 */

/**
 * @filename 
 * 
 * @description 
 * 
 *
 * Copyright(c) 2008, Garmin International
 */

/*! jQuery Migrate v1.2.1 | (c) 2005, 2013 jQuery Foundation, Inc. and other contributors | jquery.org/license */

/*
 Highcharts JS v5.0.0 (2016-09-29)
 Exporting module

 (c) 2010-2016 Torstein Honsi

 License: www.highcharts.com/license
*/

/* ==========================================================
 * bootstrap-twipsy.js v2.0.0
 * http://twitter.github.com/bootstrap/javascript.html#twipsy
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ==========================================================
 * Copyright 2011 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/*
  Highcharts JS v5.0.0 (2016-09-29)
 Solid angular gauge module

 (c) 2010-2016 Torstein Honsi

 License: www.highcharts.com/license
*/

require.config({waitSeconds:14,paths:{underscore:"lib/underscore",backbone:"lib/backbone",backbonetrackit:"lib/backbone.trackit",json2:"lib/json2",jquery:"lib/jquery.min",localizer:"utils/Localizer",globalize:"lib/globalize",personalizer:"utils/Personalizer",i18n:"lib/jquery.i18n.properties-1.0.9",numberformatter:"lib/jquery.numberformatter-1.2.3",jshashtable:"lib/jshashtable-2.1",jquerycookie:"lib/jquery.cookie",jquerytools:"lib/jquery.tools.min",jqueryui:"lib/jquery-ui",jquerymigrate:"lib/jquery-migrate-1.2.1.min",jquerytimepicker:"lib/jquery.timepicker",jquerymenus:"lib/jquery.menus",jquerycrop:"lib/jquery.Jcrop.min",jqueryformatter:"lib/jquery.formatter",moment:"lib/moment.min",momentTimeZone:"lib/moment-timezone-with-data-2012-2022.min",sprintf:"lib/sprintf.min","action-menu":"/script/main/action-menu",highcharts:"lib/highcharts/highcharts",highchartsmore:"lib/highcharts/highcharts-more",highchartsexport:"lib/highcharts/exporting",highchartssolidgauge:"lib/highcharts/solid-gauge",twipsy:"lib/twipsy",twitterbootstrap:"lib/bootstrap.min",addthis:"//s7.addthis.com/js/250/addthis_widget.js#username=grmnconnect&async=1",garminhost:"lib/garmin.host-v1.2-min",garminlib:"//static.garmincdn.com/com.garmin/ui/js/garmin.lib-v1.1-min",navhelper:"//static.garmincdn.com/com.garmin.connect/ui/js/nav-helper-v1.0-min",jquerywrapper:"utils/jQueryWrapper",touchpunch:"lib/jquery.ui.touch-punch.min",gauth:"https://sso.garmin.com/sso/js/gauth-widget",sinon:"lib/sinon-1.9.1",jqueryellipsis:"lib/jquery.ellipsis",poller:"lib/map/main/poller",client:"lib/legacy/Client",settingsclient:"lib/legacy/settingsClient",googleapis:"//maps.googleapis.com/maps/api/js?sensor=true&client=gme-garmininternational&channel=connect&language=en&callback=noOp",bingapis:"//www.bing.com/api/maps/mapcontrol?",bingveapicore:"//ecn.dev.virtualearth.net/mapcontrol/v7.0/7.0.20160525132934.57/js/en-us/veapicore",garminmapmodel:"lib/map/GarminMapModel",garminmap:"lib/map/GarminMap",garminmapcontrols:"lib/map/GarminMapControls",garmingooglemaps:"lib/map/GarminGoogleMaps",garminbingmaps:"lib/map/GarminBingMaps",garminosmmaps:"lib/map/GarminOpenStreetMaps",garminbaidumaps:"lib/map/GarminBaiduMaps",tealium:"//tags.tiqcdn.com/utag/garmin/main/prod/utag",activity2:"pages/activity_details_2/",grid:"views/utils/Grid/GridView",requestHeader:"lib/request-header",dropzone:"lib/dropzone",leaflet:"lib/leaflet-1.2.0",leaflet_draw:"lib/leaflet.draw",leaflet_control_geocoder:"lib/Control.Geocoder",leaflet_google:"lib/Leaflet.GoogleMutant",leaflet_bing:"lib/leaflet-plugins/1.6.1/layer/tile/Bing",garminbing:"lib/leaflet-plugins/1.6.1/layer/tile/GarminBing",leaflet_baidu:"lib/leaflet-plugins/1.6.1/layer/tile/Baidu",garminbaidu:"lib/leaflet-plugins/1.6.1/layer/tile/GarminBaidu",leaflet_contextmenu:"lib/leaflet-plugins/leaflet.contextmenu.min",facebook:"//connect.facebook.net/en_US/sdk",googlepeople:"//apis.google.com/js/client",jqueryuisliderpips:"lib/jQueryUiSliderPips",jqueryinputmask:"lib/jquery.inputmask.bundle",leaflet_garmin_osm:"lib/leaflet-plugins/1.6.1/layer/tile/GarminOpenStreetMapLayer",leaflet_popular_areas:"lib/leaflet-plugins/1.6.1/layer/tile/GarminPopularAreaLayer",filesaver:"lib/FileSaver.min",here_map_core:"//js.api.here.com/v3/3.0/mapsjs-core",here_map_service:"//js.api.here.com/v3/3.0/mapsjs-service",geodesy_dms:"lib/geodesy/conversions/dms",geodesy_latlon_vector3d:"lib/geodesy/libs/vector3d",geodesy_latlon_ellipsodial:"lib/geodesy/latlon-ellipsoidal",geodesy_latlon_vincenty:"lib/geodesy/libs/latlon-vincenty",es6_promise:"lib/polyfill/es6-promise.auto.min",console_polyfill:"lib/polyfill/console-polyfill"},map:{"*":{underscore:"config/underscore.wrapper"},"config/underscore.wrapper":{underscore:"underscore"}},shim:{globalize:{exports:"Globalize"},backbone:{deps:["es6_promise","console_polyfill"]},jquerywrapper:{deps:["jquery"]},addthis:{deps:["config/addthisconfig"],exports:"addthis"},sinon:{exports:"sinon"},dropzone:{exports:"dropzone"},numberformatter:{deps:["jshashtable","jquery"]},highchartsexport:{deps:["highcharts"]},i18n:{deps:["jquery"]},jquery:{exports:"jQuery"},jquerymigrate:{deps:["jquery"]},jquerycookie:{deps:["jquery"]},jquerytools:{deps:["jquery","jquerymigrate"]},jqueryui:{deps:["jquery"]},jquerytimepicker:{deps:["jquery"]},jquerymenus:{deps:["jquery"]},jqueryformatter:{deps:["jquery"]},jquerycrop:{deps:["jquery"]},jqueryellipsis:{deps:["jquery"]},touchpunch:{deps:["jqueryui"]},garminlib:{deps:["jquery"]},navhelper:{deps:["garminlib","twitterbootstrap"]},masonry:{deps:["jquery"]},highchartsmore:{deps:["highcharts"]},twitterbootstrap:{deps:["jquery","jqueryui"]},garminhost:{deps:["jquery"]},gauth:{deps:["jquery"]},tealium:{deps:["jquery"]},settingsclient:{deps:["client"]},garminmap:{deps:["garminmapmodel"]},garminmapcontrols:{deps:["garminmap","settingsclient"]},garmingooglemaps:{deps:["garminmapcontrols","googleapis"]},garminbingmaps:{deps:["garminmapcontrols","bingapis"]},garminosmmaps:{deps:["garminmapcontrols"]},garminbaidumaps:{deps:["garminmapcontrols"]},momentTimeZone:{deps:["moment"]},facebook:{exports:"FB"},googlepeople:{exports:"Google"},leaflet_garmin_osm:{deps:["leaflet"]},leaflet_google:{deps:["leaflet"]},leaflet_bing:{deps:["leaflet"]},leaflet_baidu:{deps:["leaflet"]},leaflet_popular_areas:{deps:["leaflet"]},garminbing:{deps:["leaflet","leaflet_bing"]},garminbaidu:{deps:["leaflet","leaflet_baidu"]},leaflet_draw:{deps:["leaflet"]},leaflet_control_geocoder:{deps:["leaflet"]},here_map_service:{deps:["here_map_core"]},geodesy_latlon_ellipsodial:{deps:["geodesy_latlon_vector3d","geodesy_dms"]},geodesy_latlon_vincenty:{deps:["geodesy_latlon_ellipsodial"]}}}),window.noOp=function(){},define("common",function(){}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("es6_promise",t):e.ES6Promise=t()}(this,function(){function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}function n(e){V=e}function r(e){$=e}function i(){return function(){return process.nextTick(f)}}function s(){return"undefined"!=typeof X?function(){X(f)}:a()}function o(){var e=0,t=new Q(f),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function u(){var e=new MessageChannel;return e.port1.onmessage=f,function(){return e.port2.postMessage(0)}}function a(){var e=setTimeout;return function(){return e(f,1)}}function f(){for(var e=0;e<W;e+=2){var t=Z[e],n=Z[e+1];t(n),Z[e]=void 0,Z[e+1]=void 0}W=0}function l(){try{var e=require,t=e("vertx");return X=t.runOnLoop||t.runOnContext,s()}catch(n){return a()}}function c(e,t){var n=arguments,r=this,i=new this.constructor(p);void 0===i[tt]&&_(i);var s=r._state;return s?!function(){var e=n[s-1];$(function(){return A(s,i,e,r._result)})}():N(r,i,e,t),i}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(p);return E(n,e),n}function p(){}function d(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function m(e){try{return e.then}catch(t){return st.error=t,st}}function g(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function y(e,t,n){$(function(e){var r=!1,i=g(n,t,function(n){r||(r=!0,t!==n?E(e,n):x(e,n))},function(t){r||(r=!0,T(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,T(e,i))},e)}function b(e,t){t._state===rt?x(e,t._result):t._state===it?T(e,t._result):N(t,void 0,function(t){return E(e,t)},function(t){return T(e,t)})}function w(e,n,r){n.constructor===e.constructor&&r===c&&n.constructor.resolve===h?b(e,n):r===st?(T(e,st.error),st.error=null):void 0===r?x(e,n):t(r)?y(e,n,r):x(e,n)}function E(t,n){t===n?T(t,d()):e(n)?w(t,n,m(n)):x(t,n)}function S(e){e._onerror&&e._onerror(e._result),C(e)}function x(e,t){e._state===nt&&(e._result=t,e._state=rt,0!==e._subscribers.length&&$(C,e))}function T(e,t){e._state===nt&&(e._state=it,e._result=t,$(S,e))}function N(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+rt]=n,i[s+it]=r,0===s&&e._state&&$(C,e)}function C(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3)r=t[o],i=t[o+n],r?A(n,r,i,s):i(s);e._subscribers.length=0}}function k(){this.error=null}function L(e,t){try{return e(t)}catch(n){return ot.error=n,ot}}function A(e,n,r,i){var s=t(r),o=void 0,u=void 0,a=void 0,f=void 0;if(s){if(o=L(r,i),o===ot?(f=!0,u=o.error,o.error=null):a=!0,n===o)return void T(n,v())}else o=i,a=!0;n._state!==nt||(s&&a?E(n,o):f?T(n,u):e===rt?x(n,o):e===it&&T(n,o))}function O(e,t){try{t(function(t){E(e,t)},function(t){T(e,t)})}catch(n){T(e,n)}}function M(){return ut++}function _(e){e[tt]=ut++,e._state=void 0,e._result=void 0,e._subscribers=[]}function D(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[tt]||_(this.promise),z(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&x(this.promise,this._result))):T(this.promise,P())}function P(){return new Error("Array Methods must be provided an Array")}function H(e){return(new D(this,e)).promise}function B(e){var t=this;return new t(z(e)?function(n,r){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function j(e){var t=this,n=new t(p);return T(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(e){this[tt]=M(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&F(),this instanceof q?O(this,e):I())}function R(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=q}var U=void 0;U=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var z=U,W=0,X=void 0,V=void 0,$=function(e,t){Z[W]=e,Z[W+1]=t,W+=2,2===W&&(V?V(f):et())},J="undefined"!=typeof window?window:void 0,K=J||{},Q=K.MutationObserver||K.WebKitMutationObserver,G="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),et=void 0;et=G?i():Q?o():Y?u():void 0===J&&"function"==typeof require?l():a();var tt=Math.random().toString(36).substring(16),nt=void 0,rt=1,it=2,st=new k,ot=new k,ut=0;return D.prototype._enumerate=function(e){for(var t=0;this._state===nt&&t<e.length;t++)this._eachEntry(e[t],t)},D.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===h){var i=m(e);if(i===c&&e._state!==nt)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===q){var s=new n(p);w(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},D.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===nt&&(this._remaining--,e===it?T(r,n):this._result[t]=n),0===this._remaining&&x(r,this._result)},D.prototype._willSettleAt=function(e,t){var n=this;N(e,void 0,function(e){return n._settledAt(rt,t,e)},function(e){return n._settledAt(it,t,e)})},q.all=H,q.race=B,q.resolve=h,q.reject=j,q._setScheduler=n,q._setAsap=r,q._asap=$,q.prototype={constructor:q,then:c,"catch":function(e){return this.then(null,e)}},q.polyfill=R,q.Promise=q,q.polyfill(),q}),function(e){e.console||(e.console={});var t=e.console,n,r,i=function(){},s=["memory"],o="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");while(n=s.pop())t[n]||(t[n]={});while(r=o.pop())t[r]||(t[r]=i)}(typeof window=="undefined"?this:window),define("console_polyfill",function(){}),function(){function x(e){function t(t,n,r,i,s,o){for(;s>=0&&s<o;s+=e){var u=i?i[s]:s;r=n(r,t[u],u,t)}return r}return function(n,r,i,s){r=v(r,s,4);var o=!S(n)&&d.keys(n),u=(o||n).length,a=e>0?0:u-1;return arguments.length<3&&(i=n[o?o[a]:a],a+=e),t(n,r,i,o,a,u)}}function C(e){return function(t,n,r){n=m(n,r);var i=E(t),s=e>0?0:i-1;for(;s>=0&&s<i;s+=e)if(n(t[s],s,t))return s;return-1}}function k(e,t,n){return function(r,i,s){var u=0,a=E(r);if(typeof s=="number")e>0?u=s>=0?s:Math.max(s+a,u):a=s>=0?Math.min(s+1,a):s+a+1;else if(n&&s&&a)return s=n(r,i),r[s]===i?s:-1;if(i!==i)return s=t(o.call(r,u,a),d.isNaN),s>=0?s+u:-1;for(s=e>0?u:a-1;s>=0&&s<a;s+=e)if(r[s]===i)return s;return-1}}function M(e,t){var n=O.length,i=e.constructor,s=d.isFunction(i)&&i.prototype||r,o="constructor";d.has(e,o)&&!d.contains(t,o)&&t.push(o);while(n--)o=O[n],o in e&&e[o]!==s[o]&&!d.contains(t,o)&&t.push(o)}var e=this,t=e._,n=Array.prototype,r=Object.prototype,i=Function.prototype,s=n.push,o=n.slice,u=r.toString,a=r.hasOwnProperty,f=Array.isArray,l=Object.keys,c=i.bind,h=Object.create,p=function(){},d=function(e){if(e instanceof d)return e;if(!(this instanceof d))return new d(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=d),exports._=d):e._=d,d.VERSION="1.8.3";var v=function(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}},m=function(e,t,n){return e==null?d.identity:d.isFunction(e)?v(e,t,n):d.isObject(e)?d.matcher(e):d.property(e)};d.iteratee=function(e,t){return m(e,t,Infinity)};var g=function(e,t){return function(n){var r=arguments.length;if(r<2||n==null)return n;for(var i=1;i<r;i++){var s=arguments[i],o=e(s),u=o.length;for(var a=0;a<u;a++){var f=o[a];if(!t||n[f]===void 0)n[f]=s[f]}}return n}},y=function(e){if(!d.isObject(e))return{};if(h)return h(e);p.prototype=e;var t=new p;return p.prototype=null,t},b=function(e){return function(t){return t==null?void 0:t[e]}},w=Math.pow(2,53)-1,E=b("length"),S=function(e){var t=E(e);return typeof t=="number"&&t>=0&&t<=w};d.each=d.forEach=function(e,t,n){t=v(t,n);var r,i;if(S(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=d.keys(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e},d.map=d.collect=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length,s=Array(i);for(var o=0;o<i;o++){var u=r?r[o]:o;s[o]=t(e[u],u,e)}return s},d.reduce=d.foldl=d.inject=x(1),d.reduceRight=d.foldr=x(-1),d.find=d.detect=function(e,t,n){var r;S(e)?r=d.findIndex(e,t,n):r=d.findKey(e,t,n);if(r!==void 0&&r!==-1)return e[r]},d.filter=d.select=function(e,t,n){var r=[];return t=m(t,n),d.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},d.reject=function(e,t,n){return d.filter(e,d.negate(m(t)),n)},d.every=d.all=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0},d.some=d.any=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1},d.contains=d.includes=d.include=function(e,t,n,r){S(e)||(e=d.values(e));if(typeof n!="number"||r)n=0;return d.indexOf(e,t,n)>=0},d.invoke=function(e,t){var n=o.call(arguments,2),r=d.isFunction(t);return d.map(e,function(e){var i=r?t:e[t];return i==null?i:i.apply(e,n)})},d.pluck=function(e,t){return d.map(e,d.property(t))},d.where=function(e,t){return d.filter(e,d.matcher(t))},d.findWhere=function(e,t){return d.find(e,d.matcher(t))},d.max=function(e,t,n){var r=-Infinity,i=-Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s>r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o>i||o===-Infinity&&r===-Infinity)r=e,i=o});return r},d.min=function(e,t,n){var r=Infinity,i=Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s<r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o<i||o===Infinity&&r===Infinity)r=e,i=o});return r},d.shuffle=function(e){var t=S(e)?e:d.values(e),n=t.length,r=Array(n);for(var i=0,s;i<n;i++)s=d.random(0,i),s!==i&&(r[i]=r[s]),r[s]=t[i];return r},d.sample=function(e,t,n){return t==null||n?(S(e)||(e=d.values(e)),e[d.random(e.length-1)]):d.shuffle(e).slice(0,Math.max(0,t))},d.sortBy=function(e,t,n){return t=m(t,n),d.pluck(d.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,r){var i={};return n=m(n,r),d.each(t,function(r,s){var o=n(r,s,t);e(i,r,o)}),i}};d.groupBy=T(function(e,t,n){d.has(e,n)?e[n].push(t):e[n]=[t]}),d.indexBy=T(function(e,t,n){e[n]=t}),d.countBy=T(function(e,t,n){d.has(e,n)?e[n]++:e[n]=1}),d.toArray=function(e){return e?d.isArray(e)?o.call(e):S(e)?d.map(e,d.identity):d.values(e):[]},d.size=function(e){return e==null?0:S(e)?e.length:d.keys(e).length},d.partition=function(e,t,n){t=m(t,n);var r=[],i=[];return d.each(e,function(e,n,s){(t(e,n,s)?r:i).push(e)}),[r,i]},d.first=d.head=d.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:d.initial(e,e.length-t)},d.initial=function(e,t,n){return o.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))},d.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:d.rest(e,Math.max(0,e.length-t))},d.rest=d.tail=d.drop=function(e,t,n){return o.call(e,t==null||n?1:t)},d.compact=function(e){return d.filter(e,d.identity)};var N=function(e,t,n,r){var i=[],s=0;for(var o=r||0,u=E(e);o<u;o++){var a=e[o];if(S(a)&&(d.isArray(a)||d.isArguments(a))){t||(a=N(a,t,n));var f=0,l=a.length;i.length+=l;while(f<l)i[s++]=a[f++]}else n||(i[s++]=a)}return i};d.flatten=function(e,t){return N(e,t,!1)},d.without=function(e){return d.difference(e,o.call(arguments,1))},d.uniq=d.unique=function(e,t,n,r){d.isBoolean(t)||(r=n,n=t,t=!1),n!=null&&(n=m(n,r));var i=[],s=[];for(var o=0,u=E(e);o<u;o++){var a=e[o],f=n?n(a,o,e):a;t?((!o||s!==f)&&i.push(a),s=f):n?d.contains(s,f)||(s.push(f),i.push(a)):d.contains(i,a)||i.push(a)}return i},d.union=function(){return d.uniq(N(arguments,!0,!0))},d.intersection=function(e){var t=[],n=arguments.length;for(var r=0,i=E(e);r<i;r++){var s=e[r];if(d.contains(t,s))continue;for(var o=1;o<n;o++)if(!d.contains(arguments[o],s))break;o===n&&t.push(s)}return t},d.difference=function(e){var t=N(arguments,!0,!0,1);return d.filter(e,function(e){return!d.contains(t,e)})},d.zip=function(){return d.unzip(arguments)},d.unzip=function(e){var t=e&&d.max(e,E).length||0,n=Array(t);for(var r=0;r<t;r++)n[r]=d.pluck(e,r);return n},d.object=function(e,t){var n={};for(var r=0,i=E(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},d.findIndex=C(1),d.findLastIndex=C(-1),d.sortedIndex=function(e,t,n,r){n=m(n,r,1);var i=n(t),s=0,o=E(e);while(s<o){var u=Math.floor((s+o)/2);n(e[u])<i?s=u+1:o=u}return s},d.indexOf=k(1,d.findIndex,d.sortedIndex),d.lastIndexOf=k(-1,d.findLastIndex),d.range=function(e,t,n){t==null&&(t=e||0,e=0),n=n||1;var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r);for(var s=0;s<r;s++,e+=n)i[s]=e;return i};var L=function(e,t,n,r,i){if(r instanceof t){var s=y(e.prototype),o=e.apply(s,i);return d.isObject(o)?o:s}return e.apply(n,i)};d.bind=function(e,t){if(c&&e.bind===c)return c.apply(e,o.call(arguments,1));if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");var n=o.call(arguments,2),r=function(){return L(e,r,t,this,n.concat(o.call(arguments)))};return r},d.partial=function(e){var t=o.call(arguments,1),n=function(){var r=0,i=t.length,s=Array(i);for(var o=0;o<i;o++)s[o]=t[o]===d?arguments[r++]:t[o];while(r<arguments.length)s.push(arguments[r++]);return L(e,n,this,this,s)};return n},d.bindAll=function(e){var t,n=arguments.length,r;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)r=arguments[t],e[r]=d.bind(e[r],e);return e},d.memoize=function(e,t){var n=function(r){var i=n.cache,s=""+(t?t.apply(this,arguments):r);return d.has(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return n.cache={},n},d.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},d.defer=d.partial(d.delay,d,1),d.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:d.now(),o=null,s=e.apply(r,i),o||(r=i=null)};return function(){var f=d.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),u=f,s=e.apply(r,i),o||(r=i=null)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},d.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=d.now()-o;f<t&&f>=0?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),r||(s=i=null)))};return function(){s=this,i=arguments,o=d.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},d.wrap=function(e,t){return d.partial(t,e)},d.negate=function(e){return function(){return!e.apply(this,arguments)}},d.compose=function(){var e=arguments,t=e.length-1;return function(){var n=t,r=e[t].apply(this,arguments);while(n--)r=e[n].call(this,r);return r}},d.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},d.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},d.once=d.partial(d.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];d.keys=function(e){if(!d.isObject(e))return[];if(l)return l(e);var t=[];for(var n in e)d.has(e,n)&&t.push(n);return A&&M(e,t),t},d.allKeys=function(e){if(!d.isObject(e))return[];var t=[];for(var n in e)t.push(n);return A&&M(e,t),t},d.values=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},d.mapObject=function(e,t,n){t=m(t,n);var r=d.keys(e),i=r.length,s={},o;for(var u=0;u<i;u++)o=r[u],s[o]=t(e[o],o,e);return s},d.pairs=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},d.invert=function(e){var t={},n=d.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},d.functions=d.methods=function(e){var t=[];for(var n in e)d.isFunction(e[n])&&t.push(n);return t.sort()},d.extend=g(d.allKeys),d.extendOwn=d.assign=g(d.keys),d.findKey=function(e,t,n){t=m(t,n);var r=d.keys(e),i;for(var s=0,o=r.length;s<o;s++){i=r[s];if(t(e[i],i,e))return i}},d.pick=function(e,t,n){var r={},i=e,s,o;if(i==null)return r;d.isFunction(t)?(o=d.allKeys(i),s=v(t,n)):(o=N(arguments,!1,!1,1),s=function(e,t,n){return t in n},i=Object(i));for(var u=0,a=o.length;u<a;u++){var f=o[u],l=i[f];s(l,f,i)&&(r[f]=l)}return r},d.omit=function(e,t,n){if(d.isFunction(t))t=d.negate(t);else{var r=d.map(N(arguments,!1,!1,1),String);t=function(e,t){return!d.contains(r,t)}}return d.pick(e,t,n)},d.defaults=g(d.allKeys,!0),d.create=function(e,t){var n=y(e);return t&&d.extendOwn(n,t),n},d.clone=function(e){return d.isObject(e)?d.isArray(e)?e.slice():d.extend({},e):e},d.tap=function(e,t){return t(e),e},d.isMatch=function(e,t){var n=d.keys(t),r=n.length;if(e==null)return!r;var i=Object(e);for(var s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0};var _=function(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return e===t;e instanceof d&&(e=e._wrapped),t instanceof d&&(t=t._wrapped);var i=u.call(e);if(i!==u.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":if(+e!==+e)return+t!==+t;return+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var s=i==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(d.isFunction(o)&&o instanceof o&&d.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];var f=n.length;while(f--)if(n[f]===e)return r[f]===t;n.push(e),r.push(t);if(s){f=e.length;if(f!==t.length)return!1;while(f--)if(!_(e[f],t[f],n,r))return!1}else{var l=d.keys(e),c;f=l.length;if(d.keys(t).length!==f)return!1;while(f--){c=l[f];if(!d.has(t,c)||!_(e[c],t[c],n,r))return!1}}return n.pop(),r.pop(),!0};d.isEqual=function(e,t){return _(e,t)},d.isEmpty=function(e){return e==null?!0:S(e)&&(d.isArray(e)||d.isString(e)||d.isArguments(e))?e.length===0:d.keys(e).length===0},d.isElement=function(e){return!!e&&e.nodeType===1},d.isArray=f||function(e){return u.call(e)==="[object Array]"},d.isObject=function(e){var t=typeof e;return t==="function"||t==="object"&&!!e},d.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){d["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(e){return d.has(e,"callee")}),typeof /./!="function"&&typeof Int8Array!="object"&&(d.isFunction=function(e){return typeof e=="function"||!1}),d.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},d.isNaN=function(e){return d.isNumber(e)&&e!==+e},d.isBoolean=function(e){return e===!0||e===!1||u.call(e)==="[object Boolean]"},d.isNull=function(e){return e===null},d.isUndefined=function(e){return e===void 0},d.has=function(e,t){return e!=null&&a.call(e,t)},d.noConflict=function(){return e._=t,this},d.identity=function(e){return e},d.constant=function(e){return function(){return e}},d.noop=function(){},d.property=b,d.propertyOf=function(e){return e==null?function(){}:function(t){return e[t]}},d.matcher=d.matches=function(e){return e=d.extendOwn({},e),function(t){return d.isMatch(t,e)}},d.times=function(e,t,n){var r=Array(Math.max(0,e));t=v(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},d.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},d.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=d.invert(D),H=function(e){var t=function(t){return e[t]},n="(?:"+d.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=e==null?"":""+e,r.test(e)?e.replace(i,t):e}};d.escape=H(D),d.unescape=H(P),d.result=function(e,t,n){var r=e==null?void 0:e[t];return r===void 0&&(r=n),d.isFunction(r)?r.call(e):r};var B=0;d.uniqueId=function(e){var t=++B+"";return e?e+t:t},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+F[e]};d.template=function(e,t,n){!t&&n&&(t=n),t=d.defaults({},t,d.templateSettings);var r=RegExp([(t.escape||j).source,(t.interpolate||j).source,(t.evaluate||j).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(I,q),i=u+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(t.variable||"obj","_",s)}catch(u){throw u.source=s,u}var a=function(e){return o.call(this,e,d)},f=t.variable||"obj";return a.source="function("+f+"){\n"+s+"}",a},d.chain=function(e){var t=d(e);return t._chain=!0,t};var R=function(e,t){return e._chain?d(t).chain():t};d.mixin=function(e){d.each(d.functions(e),function(t){var n=d[t]=e[t];d.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),R(this,n.apply(d,e))}})},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];d.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0],R(this,n)}}),d.each(["concat","join","slice"],function(e){var t=n[e];d.prototype[e]=function(){return R(this,t.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return""+this._wrapped},typeof define=="function"&&define.amd&&define("underscore",[],function(){return d})}.call(this),define("config/underscore.wrapper",["require","underscore"],function(e){var t=e("underscore");return t.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%~([\s\S]+?)%>/g,escape:/<%=([\s\S]+?)%>/g},t}),function(e,t){function H(e){var t=e.length,n=w.type(e);return w.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function j(e){var t=B[e]={};return w.each(e.match(S)||[],function(e,n){t[n]=!0}),t}function q(e,n,r,i){if(w.acceptData(e)){var s,o,u=w.expando,a=e.nodeType,f=a?w.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||r!==t||"string"!=typeof n)return l||(l=a?e[u]=c.pop()||w.guid++:u),f[l]||(f[l]=a?{}:{toJSON:w.noop}),("object"==typeof n||"function"==typeof n)&&(i?f[l]=w.extend(f[l],n):f[l].data=w.extend(f[l].data,n)),o=f[l],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[w.camelCase(n)]=r),"string"==typeof n?(s=o[n],null==s&&(s=o[w.camelCase(n)])):s=o,s}}function R(e,t,n){if(w.acceptData(e)){var r,i,s=e.nodeType,o=s?w.cache:e,u=s?e[w.expando]:w.expando;if(o[u]){if(t&&(r=n?o[u]:o[u].data)){w.isArray(t)?t=t.concat(w.map(t,w.camelCase)):t in r?t=[t]:(t=w.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!z(r):!w.isEmptyObject(r))return}(n||(delete o[u].data,z(o[u])))&&(s?w.cleanData([e],!0):w.support.deleteExpando||o!=o.window?delete o[u]:o[u]=null)}}}function U(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(I,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:F.test(r)?w.parseJSON(r):r}catch(s){}w.data(e,n,r)}else r=t}return r}function z(e){var t;for(t in e)if(("data"!==t||!w.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function it(){return!0}function st(){return!1}function ot(){try{return o.activeElement}catch(e){}}function ct(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function ht(e,t,n){if(w.isFunction(t))return w.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return w.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ut.test(t))return w.filter(t,e,n);t=w.filter(t,e)}return w.grep(e,function(e){return w.inArray(e,t)>=0!==n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return w.nodeName(e,"table")&&w.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _t(e){return e.type=(null!==w.find.attr(e,"type"))+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)w._data(n,"globalEval",!t||w._data(t[r],"globalEval"))}function Ht(e,t){if(1===t.nodeType&&w.hasData(e)){var n,r,i,s=w._data(e),o=w._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)w.event.add(t,n,u[n][r])}o.data&&(o.data=w.extend({},o.data))}}function Bt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!w.support.noCloneEvent&&t[w.expando]){i=w._data(t);for(r in i.events)w.removeEvent(t,r,i.handle);t.removeAttribute(w.expando)}"script"===n&&t.text!==e.text?(_t(t).text=e.text,Dt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),w.support.html5Clone&&e.innerHTML&&!w.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&xt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;null!=(s=r[o]);o++)!n||w.nodeName(s,n)?u.push(s):w.merge(u,jt(s,n));return n===t||n&&w.nodeName(e,n)?w.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===w.css(e,"display")||!w.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=w._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(s[o]=w._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&"none"!==n||!i)&&w._data(r,"olddisplay",i?n:w.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=w.css(e,n+Zt[s],!0,i)),r?("content"===n&&(o-=w.css(e,"padding"+Zt[s],!0,i)),"margin"!==n&&(o-=w.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=w.css(e,"padding"+Zt[s],!0,i),"padding"!==n&&(o+=w.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Rt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Jt.test(i))return i;r=o&&(w.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=o,n=Qt[e];return n||(n=fn(e,t),"none"!==n&&n||(It=(It||w("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach()),Qt[e]=n),n}function fn(e,t){var n=w(t.createElement(e)).appendTo(t.body),r=w.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(w.isArray(t))w.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==w.type(t))r(e,t);else for(i in t)vn(e+"["+i+"]",t[i],n,r)}function _n(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(S)||[];if(w.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,n,r,i){function u(a){var f;return s[a]=!0,w.each(e[a]||[],function(e,a){var l=a(n,r,i);return"string"!=typeof l||o||s[l]?o?!(f=l):t:(n.dataTypes.unshift(l),u(l),!1)}),f}var s={},o=e===An;return u(n.dataTypes[0])||!s["*"]&&u("*")}function Pn(e,n){var r,i,s=w.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&w.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes;while("*"===f[0])f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}return o?(o!==f[0]&&f.unshift(o),r[o]):t}function Bn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=w.now()}function Zn(e,t,n){var r,i=(Gn[t]||[]).concat(Gn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function er(e,t,n){var r,i,s=0,o=Qn.length,u=w.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(tr(l,f.opts.specialEasing);o>s;s++)if(r=Qn[s].call(f,e,l,f.opts))return r;return w.map(l,Zn,f),w.isFunction(f.opts.start)&&f.opts.start.call(e,f),w.fx.timer(w.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(n in e)if(r=w.camelCase(n),i=t[r],s=e[n],w.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=w.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function nr(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&nn(e),p=w._data(e,"fxshow");n.queue||(u=w._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,w.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===w.css(e,"display")&&"none"===w.css(e,"float")&&(w.support.inlineBlockNeedsLayout&&"inline"!==an(e.nodeName)?c.zoom=1:c.display="inline-block")),n.overflow&&(c.overflow="hidden",w.support.shrinkWrapBlocks||f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],$n.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show"))continue;l[r]=p&&p[r]||w.style(e,r)}if(!w.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=w._data(e,"fxshow",{}),s&&(p.hidden=!h),h?w(e).show():f.done(function(){w(e).hide()}),f.done(function(){var t;w._removeData(e,"fxshow");for(t in l)w.style(e,t,l[t])});for(r in l)o=Zn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return w.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.location,o=e.document,u=o.documentElement,a=e.jQuery,f=e.$,l={},c=[],h="1.10.2",p=c.concat,d=c.push,v=c.slice,m=c.indexOf,g=l.toString,y=l.hasOwnProperty,b=h.trim,w=function(e,t){return new w.fn.init(e,t,r)},E=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,S=/\S+/g,x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,N=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,C=/^[\],:{}\s]*$/,k=/(?:^|:|,)(?:\s*\[)+/g,L=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,O=/^-ms-/,M=/-([\da-z])/gi,_=function(e,t){return t.toUpperCase()},D=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(P(),w.ready())},P=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",D,!1),e.removeEventListener("load",D,!1)):(o.detachEvent("onreadystatechange",D),e.detachEvent("onload",D))};w.fn=w.prototype={jquery:h,constructor:w,init:function(e,n,r){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof w?n[0]:n,w.merge(this,w.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),N.test(i[1])&&w.isPlainObject(n))for(i in n)w.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(s=o.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this))},selector:"",length:0,toArray:function(){return v.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return w.each(this,e,t)},ready:function(e){return w.ready.promise().done(e),this},slice:function(){return this.pushStack(v.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},w.fn.init.prototype=w.fn,w.extend=w.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||w.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(w.isPlainObject(r)||(n=w.isArray(r)))?(n?(n=!1,o=e&&w.isArray(e)?e:[]):o=e&&w.isPlainObject(e)?e:{},u[i]=w.extend(l,o,r)):r!==t&&(u[i]=r));return u},w.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===w&&(e.$=f),t&&e.jQuery===w&&(e.jQuery=a),w},isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){if(e===!0?!--w.readyWait:!w.isReady){if(!o.body)return setTimeout(w.ready);w.isReady=!0,e!==!0&&--w.readyWait>0||(n.resolveWith(o,[w]),w.fn.trigger&&w(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===w.type(e)},isArray:Array.isArray||function(e){return"array"===w.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[g.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==w.type(e)||e.nodeType||w.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(w.support.ownLast)for(n in e)return y.call(e,n);for(n in e);return n===t||y.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=N.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=w.buildFragment([e],t,i),i&&w(i).remove(),w.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=w.trim(n),n&&C.test(n.replace(L,"@").replace(A,"]").replace(k,"")))?Function("return "+n)():(w.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&w.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(O,"ms-").replace(M,_)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=H(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("ï»¿Â ")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(x,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(H(Object(e))?w.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=H(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return p.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(s=e[n],n=e,e=s),w.isFunction(e)?(r=v.call(arguments,2),i=function(){return e.apply(n||this,r.concat(v.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===w.type(r)){s=!0;for(a in r)w.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,w.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),w.ready.promise=function(t){if(!n)if(n=w.Deferred(),"complete"===o.readyState)setTimeout(w.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",D,!1),e.addEventListener("load",D,!1);else{o.attachEvent("onreadystatechange",D),e.attachEvent("onload",D);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function s(){if(!w.isReady){try{r.doScroll("left")}catch(e){return setTimeout(s,50)}P(),w.ready()}}()}return n.promise(t)},w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),r=w(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,w;if((t?t.ownerDocument||t:E)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,w=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,w=l.join(",")}if(w)try{return H.apply(n,g.querySelectorAll(w)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=x++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=S+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=S+=null==x?1:Math.random()||.1;for(E&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}E&&(S=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),E&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return E&&(S=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(E.childNodes),E.childNodes),_[E.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:E,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(E,e)?-1:t===n||y(E,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===E?-1:a[i]===E?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[S,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),w.find=ot,w.expr=ot.selectors,w.expr[":"]=w.expr.pseudos,w.unique=ot.uniqueSort,w.text=ot.getText,w.isXMLDoc=ot.isXML,w.contains=ot.contains}(e);var B={};w.Callbacks=function(e){e="string"==typeof e?B[e]||j(e):w.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){for(r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;a&&s>o;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){w.each(t,function(t,n){var r=w.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&w.each(arguments,function(e,t){var r;while((r=w.inArray(t,a,r))>-1)a.splice(r,1),n&&(s>=r&&s--,o>=r&&o--)}),this},has:function(e){return e?w.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],s=0,this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return!a||i&&!f||(t=t||[],t=[e,t.slice?t.slice():t],n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},w.extend({Deferred:function(e){var t=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return w.Deferred(function(n){w.each(t,function(t,s){var o=s[0],u=w.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?w.extend(e,r):r}},i={};return r.pipe=r.then,w.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=v.call(arguments),r=n.length,i=1!==r||e&&w.isFunction(e.promise)?r:0,s=1===i?e:w.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?v.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&w.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),w.support=function(t){var n,r,s,u,a,f,l,c,h,p=o.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*")||[],r=p.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;u=o.createElement("select"),f=u.appendChild(o.createElement("option")),s=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==p.className,t.leadingWhitespace=3===p.firstChild.nodeType,t.tbody=!p.getElementsByTagName("tbody").length,t.htmlSerialize=!!p.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!s.value,t.optSelected=f.selected,t.enctype=!!o.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}s=o.createElement("input"),s.setAttribute("value",""),t.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),a=o.createDocumentFragment(),a.appendChild(s),t.appendChecked=s.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===p.style.backgroundClip;for(h in w(t))break;return t.ownLast="0"!==h,w(function(){var n,r,s,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=p.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&0===s[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",w.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===p.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(p,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(p,null)||{width:"4px"}).width,r=p.appendChild(o.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==p.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=s=r=null)}),n=u=a=f=r=s=null,t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;w.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?w.cache[e[w.expando]]:e[w.expando],!!e&&!z(e)},data:function(e,t,n){return q(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return q(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&w.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),w.fn.extend({data:function(e,n){var r,i,s=null,o=0,u=this[0];if(e===t){if(this.length&&(s=w.data(u),1===u.nodeType&&!w._data(u,"parsedAttrs"))){for(r=u.attributes;r.length>o;o++)i=r[o].name,0===i.indexOf("data-")&&(i=w.camelCase(i.slice(5)),U(u,i,s[i]));w._data(u,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){w.data(this,e)}):arguments.length>1?this.each(function(){w.data(this,e,n)}):u?U(u,e,w.data(u,e)):null},removeData:function(e){return this.each(function(){w.removeData(this,e)})}}),w.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=w._data(e,n),r&&(!i||w.isArray(r)?i=w._data(e,n,w.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),s=w._queueHooks(e,t),o=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return w._data(e,n)||w._data(e,n,{empty:w.Callbacks("once memory").add(function(){w._removeData(e,t+"queue"),w._removeData(e,n)})})}}),w.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?w.queue(this[0],e):n===t?this:this.each(function(){var t=w.queue(this,e,n);w._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},delay:function(e,t){return e=w.fx?w.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=w.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(u--)r=w._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var W,X,V=/[\t\r\n\f]/g,$=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,K=/^(?:a|area)$/i,Q=/^(?:checked|selected)$/i,G=w.support.getSetAttribute,Y=w.support.input;w.fn.extend({attr:function(e,t){return w.access(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})},prop:function(e,t){return w.access(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return e=w.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=w.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?w.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):w.isFunction(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,r=0,s=w(this),o=e.match(S)||[];while(t=o[r++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===i||"boolean"===n)&&(this.className&&w._data(this,"__className__",this.className),this.className=this.className||e===!1?"":w._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(V," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=w.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,w(this).val()):e,null==s?s="":"number"==typeof s?s+="":w.isArray(s)&&(s=w.map(s,function(e){return null==e?"":e+""})),r=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,s,"value")!==t||(this.value=s))});if(s)return r=w.valHooks[s.type]||w.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(w.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&w.nodeName(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=w.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=w.inArray(w(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,n,r){var s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?w.prop(e,n,r):(1===u&&w.isXMLDoc(e)||(n=n.toLowerCase(),s=w.attrHooks[n]||(w.expr.match.bool.test(n)?X:W)),r===t?s&&"get"in s&&null!==(o=s.get(e,n))?o:(o=w.find.attr(e,n),null==o?t:o):null!==r?s&&"set"in s&&(o=s.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):(w.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(S);if(s&&1===e.nodeType)while(n=s[i++])r=w.propFix[n]||n,w.expr.match.bool.test(n)?Y&&G||!Q.test(n)?e[r]=!1:e[w.camelCase("default-"+n)]=e[r]=!1:w.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!w.support.radioValue&&"radio"===t&&w.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!w.isXMLDoc(e),o&&(n=w.propFix[n]||n,s=w.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||K.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?w.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&w.propFix[n]||n,n):e[w.camelCase("default-"+n)]=e[n]=!0,n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,n){var r=w.expr.attrHandle[n]||w.find.attr;w.expr.attrHandle[n]=Y&&G||!Q.test(n)?function(e,n,i){var s=w.expr.attrHandle[n],o=i?t:(w.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return w.expr.attrHandle[n]=s,o}:function(e,n,r){return r?t:e[w.camelCase("default-"+n)]?n.toLowerCase():null}}),Y&&G||(w.attrHooks.value={set:function(e,n,r){return w.nodeName(e,"input")?(e.defaultValue=n,t):W&&W.set(e,n,r)}}),G||(W={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},w.expr.attrHandle.id=w.expr.attrHandle.name=w.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},w.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:W.set},w.attrHooks.contenteditable={set:function(e,t,n){W.set(e,""===t?!1:t,n)}},w.each(["width","height"],function(e,n){w.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),w.support.hrefNormalized||w.each(["href","src"],function(e,t){w.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),w.support.style||(w.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),w.support.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.support.enctype||(w.propFix.enctype="encoding"),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,n){return w.isArray(n)?e.checked=w.inArray(w(e).val(),n)>=0:t}},w.support.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;w.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=w._data(e);if(y){r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=w.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof w===i||e&&w.event.triggered===e.type?t:w.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(S)||[""],f=n.length;while(f--)u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort(),v&&(c=w.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=w.event.special[v]||{},p=w.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:m.join(".")},l),(d=a[v])||(d=a[v]=[],d.delegateCount=0,c.setup&&c.setup.call(e,s,m,h)!==!1||(e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h))),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),w.event.global[v]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=w.hasData(e)&&w._data(e);if(m&&(l=m.events)){t=(t||"").match(S)||[""],f=t.length;while(f--)if(u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=w.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],!i&&v!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||w.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[f],n,r,!0);w.isEmptyObject(l)&&(delete m.handle,w._removeData(e,"events"))}},trigger:function(n,r,i,s){var u,a,f,l,c,h,p,d=[i||o],v=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(f=h=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(v+w.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=0>v.indexOf(":")&&"on"+v,n=n[w.expando]?n:new w.Event(v,"object"==typeof n&&n),n.isTrigger=s?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:w.makeArray(r,[n]),c=w.event.special[v]||{},s||!c.trigger||c.trigger.apply(i,r)!==!1)){if(!s&&!c.noBubble&&!w.isWindow(i)){for(l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||o)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(w._data(f,"events")||{})[n.type]&&w._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&w.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();if(n.type=v,!s&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),r)===!1)&&w.acceptData(i)&&a&&i[v]&&!w.isWindow(i)){h=i[a],h&&(i[a]=null),w.event.triggered=v;try{i[v]()}catch(g){}w.event.triggered=t,h&&(i[a]=h)}return n.result}},dispatch:function(e){e=w.event.fix(e);var n,r,i,s,o,u=[],a=v.call(arguments),f=(w._data(this,"events")||{})[e.type]||[],l=w.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=w.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((w.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(f.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?w(r,this).index(f)>=0:w.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return n.length>a&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[w.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new w.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,u=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,s=i.documentElement,r=i.body,e.pageX=n.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||u===t||(e.which=1&u?1:2&u?3:4&u?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ot()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===ot()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return w.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?w.event.trigger(i,null,t):w.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},w.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},w.Event=function(e,n){return this instanceof w.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,n&&w.extend(this,n),this.timeStamp=e&&e.timeStamp||w.now(),this[w.expando]=!0,t):new w.Event(e,n)},w.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!w.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),w.support.submitBubbles||(w.event.special.submit={setup:function(){return w.nodeName(this,"form")?!1:(w.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=w.nodeName(n,"input")||w.nodeName(n,"button")?n.form:t;r&&!w._data(r,"submitBubbles")&&(w.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),w._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&w.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return w.nodeName(this,"form")?!1:(w.event.remove(this,"._submit"),t)}}),w.support.changeBubbles||(w.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(w.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),w.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),w.event.simulate("change",this,e,!0)})),!1):(w.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!w._data(t,"changeBubbles")&&(w.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||w.event.simulate("change",this.parentNode,e,!0)}),w._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return w.event.remove(this,"._change"),!Z.test(this.nodeName)}}),w.support.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){w.event.simulate(t,e.target,w.event.fix(e),!0)};w.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),w.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=st;else if(!i)return this;return 1===s&&(u=i,i=function(e){return w().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=w.guid++)),this.each(function(){w.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=st),this.each(function(){w.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?w.event.trigger(e,n,r,!0):t}});var ut=/^.[^:#\[\.,]*$/,at=/^(?:parents|prev(?:Until|All))/,ft=w.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;i>t;t++)if(w.contains(r[t],this))return!0}));for(t=0;i>t;t++)w.find(e,r[t],n);return n=this.pushStack(i>1?w.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=w(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(w.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e||[],!0))},filter:function(e){return this.pushStack(ht(this,e||[],!1))},is:function(e){return!!ht(this,"string"==typeof e&&ft.test(e)?w(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||"string"!=typeof e?w(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?w.unique(s):s)},index:function(e){return e?"string"==typeof e?w.inArray(this[0],w(e)):w.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?w(e,t):w.makeArray(e&&e.nodeType?[e]:e),r=w.merge(this.get(),n);return this.pushStack(w.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,n){return w.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,n){return w.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return w.dir(e,"previousSibling",n)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return w.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:w.merge([],e.childNodes)}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(lt[e]||(i=w.unique(i)),at.test(e)&&(i=i.reverse())),this.pushStack(i)}}),w.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],s=e[n];while(s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!w(s).is(r)))1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:w.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(o),Ot=At.appendChild(o.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,w.fn.extend({text:function(e){return w.access(this,function(e){return e===t?w.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?w.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||w.cleanData(jt(n)),n.parentNode&&(t&&w.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&w.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&w.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return w.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(vt,""):t;if(!("string"!=typeof e||St.test(e)||!w.support.htmlSerialize&&mt.test(e)||!w.support.leadingWhitespace&&gt.test(e)||Lt[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(yt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(w.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=w.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),w(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=p.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,d=e[0],v=w.isFunction(d);if(v||!(1>=l||"string"!=typeof d||w.support.checkClone)&&Tt.test(d))return this.each(function(r){var i=c.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(l&&(a=w.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=a.firstChild,1===a.childNodes.length&&(a=r),r)){for(o=w.map(jt(a,"script"),_t),s=o.length;l>f;f++)i=a,f!==h&&(i=w.clone(i,!0,!0),s&&w.merge(o,jt(i,"script"))),t.call(this[f],i,f);if(s)for(u=o[o.length-1].ownerDocument,w.map(o,Dt),f=0;s>f;f++)i=o[f],Nt.test(i.type||"")&&!w._data(i,"globalEval")&&w.contains(u,i)&&(i.src?w._evalUrl(i.src):w.globalEval((i.text||i.textContent||i.innerHTML||"").replace(kt,"")));a=r=null}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){var n,r=0,i=[],s=w(e),o=s.length-1;for(;o>=r;r++)n=r===o?this:this.clone(!0),w(s[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}}),w.extend({clone:function(e,t,n){var r,i,s,o,u,a=w.contains(e.ownerDocument,e);if(w.support.html5Clone||w.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild)),!(w.support.noCloneEvent&&w.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(r=jt(s),u=jt(e),o=0;null!=(i=u[o]);++o)r[o]&&Bt(i,r[o]);if(t)if(n)for(u=u||jt(e),r=r||jt(s),o=0;null!=(i=u[o]);o++)Ht(i,r[o]);else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;c>d;d++)if(s=e[d],s||0===s)if("object"===w.type(s))w.merge(p,s.nodeType?[s]:s);else if(Et.test(s)){u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;if(!w.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0])),!w.support.tbody){s="table"!==a||wt.test(s)?"<table>"!==l[1]||wt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)w.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}w.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}else p.push(t.createTextNode(s));u&&h.removeChild(u),w.support.appendChecked||w.grep(jt(p,"input"),Ft),d=0;while(s=p[d++])if((!r||-1===w.inArray(s,r))&&(o=w.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u),n)){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=w.expando,f=w.cache,l=w.support.deleteExpando,h=w.event.special;for(;null!=(n=e[u]);u++)if((t||w.acceptData(n))&&(s=n[a],o=s&&f[s])){if(o.events)for(r in o.events)h[r]?w.event.remove(n,r):w.removeEvent(n,r,o.handle);f[s]&&(delete f[s],l?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,c.push(s))}},_evalUrl:function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),w.fn.extend({wrapAll:function(e){if(w.isFunction(e))return this.each(function(t){w(this).wrapAll(e.call(this,t))});if(this[0]){var t=w(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return w.isFunction(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=w.isFunction(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=RegExp("^("+E+")(.*)$","i"),Jt=RegExp("^("+E+")(?!px)[a-z%]+$","i"),Kt=RegExp("^([+-])=("+E+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];w.fn.extend({css:function(e,n){return w.access(this,function(e,n,r){var i,s,o={},u=0;if(w.isArray(n)){for(s=qt(e),i=n.length;i>u;u++)o[n[u]]=w.css(e,n[u],!1,s);return o}return r!==t?w.style(e,n,r):w.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?w(this).show():w(this).hide()})}}),w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":w.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=w.camelCase(n),f=e.style;if(n=w.cssProps[a]||(w.cssProps[a]=tn(f,a)),u=w.cssHooks[n]||w.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(w.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||w.cssNumber[a]||(r+="px"),w.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=w.camelCase(n);return n=w.cssProps[a]||(w.cssProps[a]=tn(e.style,a)),u=w.cssHooks[n]||w.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),"normal"===o&&n in Yt&&(o=Yt[n]),""===r||r?(s=parseFloat(o),r===!0||w.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||w.contains(e.ownerDocument,e)||(a=w.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):o.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),w.each(["height","width"],function(e,n){w.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(w.css(e,"display"))?w.swap(e,Gt,function(){return un(e,n,i)}):un(e,n,i):t},set:function(e,t,r){var i=r&&qt(e);return sn(e,t,r?on(e,n,r,w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,i),i):0)}}}),w.support.opacity||(w.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=w.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===w.trim(s.replace(Ut,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i)}}),w(function(){w.support.reliableMarginRight||(w.cssHooks.marginRight={get:function(e,n){return n?w.swap(e,{display:"inline-block"},Rt,[e,"marginRight"]):t}}),!w.support.pixelPosition&&w.fn.position&&w.each(["top","left"],function(e,n){w.cssHooks[n]={get:function(e,r){return r?(r=Rt(e,n),Jt.test(r)?w(e).position()[n]+"px":r):t}}})}),w.expr&&w.expr.filters&&(w.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!w.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||w.css(e,"display"))},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(w.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:w.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),w.param=function(e,n){var r,i=[],s=function(e,t){t=w.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=w.ajaxSettings&&w.ajaxSettings.traditional),w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,gn,yn=w.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=w.fn.load,Ln={},An={},On="*/".concat("*");try{gn=s.href}catch(Mn){gn=o.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],w.fn.load=function(e,n,r){if("string"!=typeof e&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),w.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),u.length>0&&w.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,w.ajaxSettings),t):Pn(w.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;2!==b&&(b=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,r&&(E=Hn(c,x,r)),E=Bn(c,E,x,l),l?(c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(w.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(w.etag[s]=S)),204===e||"HEAD"===c.type?T="nocontent":304===e?T="notmodified":(T=E.state,g=E.data,y=E.error,l=!y)):(y=T,(e||!T)&&(T="error",0>e&&(e=0))),x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--w.active||w.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=w.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?w(h):w.event,d=w.Deferred(),v=w.Callbacks("once memory"),m=c.statusCode||{},g={},y={},b=0,E="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||E;return f&&f.abort(t),N(0,t),this}};if(d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=w.trim(c.dataType||"*").toLowerCase().match(S)||[""],null==c.crossDomain&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=w.param(c.data,c.traditional)),Dn(Ln,c,n,x),2===b)return x;a=c.global,a&&0===w.active++&&w.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(w.lastModified[s]&&x.setRequestHeader("If-Modified-Since",w.lastModified[s]),w.etag[s]&&x.setRequestHeader("If-None-Match",w.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&2!==b){E="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);if(f=Dn(An,c,n,x)){x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{b=1,f.send(g,N)}catch(T){if(!(2>b))throw T;N(-1,T)}}else N(-1,"No Transport");return x}return x.abort()},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,n){return w.get(e,t,n,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,r,i,s){return w.isFunction(r)&&(s=s||i,i=r,r=t),w.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),w.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||w("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||w.expando+"_"+yn++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=w.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||w.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&w.isFunction(o)&&o(u[0]),u=o=t}),"script"):t});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};w.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=w.ajaxSettings.xhr(),w.support.cors=!!qn&&"withCredentials"in qn,qn=w.support.ajax=!!qn,qn&&w.ajaxTransport(function(n){if(!n.crossDomain||w.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=w.noop,Un&&delete In[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?4===a.readyState?setTimeout(r):(o=++Rn,Un&&(In||(In={},w(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=RegExp("^(?:([+-])=|)("+E+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Jn.exec(t),s=i&&i[3]||(w.cssNumber[e]?"":"px"),o=(w.cssNumber[e]||"px"!==s&&+r)&&Jn.exec(w.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,w.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};w.Animation=w.extend(er,{tweener:function(e,t){w.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),w.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(w.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=w.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[w.cssProps[e.prop]]||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),s=w.speed(t,n,r),o=function(){var t=er(this,w.extend({},e),s);(i||w._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=w.timers,o=w._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&w.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=w._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=w.timers,o=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||w.isFunction(e)&&e,duration:e,easing:n&&t||t&&!w.isFunction(t)&&t};return r.duration=w.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in w.fx.speeds?w.fx.speeds[r.duration]:w.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){w.isFunction(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.timers=[],w.fx=rr.prototype.init,w.fx.tick=function(){var e,n=w.timers,r=0;for(Xn=w.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||w.fx.stop(),Xn=t},w.fx.timer=function(e){e()&&w.timers.push(e)&&w.fx.start()},w.fx.interval=13,w.fx.start=function(){Vn||(Vn=setInterval(w.fx.tick,w.fx.interval))},w.fx.stop=function(){clearInterval(Vn),Vn=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fx.step={},w.expr&&w.expr.filters&&(w.expr.filters.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length}),w.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){w.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(u)return n=u.documentElement,w.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},w.offset={setOffset:function(e,t,n){var r=w.css(e,"position");"static"===r&&(e.style.position="relative");var i=w(e),s=i.offset(),o=w.css(e,"top"),u=w.css(e,"left"),a=("absolute"===r||"fixed"===r)&&w.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),w.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(f.top=t.top-s.top+c),null!=t.left&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},w.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===w.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),w.nodeName(e[0],"html")||(n=e.offset()),n.top+=w.css(e[0],"borderTopWidth",!0),n.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-w.css(r,"marginTop",!0),left:t.left-n.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u;while(e&&!w.nodeName(e,"html")&&"static"===w.css(e,"position"))e=e.offsetParent;return e||u})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);w.fn[e]=function(i){return w.access(this,function(e,i,s){var o=sr(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?w(o).scrollLeft():s,r?s:w(o).scrollTop()):e[i]=s,t)},e,i,arguments.length,null)}}),w.each({Height:"height",Width:"width"},function(e,n){w.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){w.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return w.access(this,function(n,r,i){var s;return w.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?w.css(n,r,u):w.style(n,r,i,u)},n,o?i:t,o,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=w:(e.jQuery=e.$=w,"function"==typeof define&&define.amd&&define("jquery",[],function(){return w}))}(window),function(e){var t=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore"),r;try{r=require("jquery")}catch(i){}e(t,exports,n,r)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.3.3",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,r){switch(e){case 1:return function(){return n[t](this[r])};case 2:return function(e){return n[t](this[r],e)};case 3:return function(e,i){return n[t](this[r],a(e,this),i)};case 4:return function(e,i,s){return n[t](this[r],a(e,this),i,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[r]),n[t].apply(n,e)}}},u=function(e,t,r){n.each(t,function(t,i){n[i]&&(e.prototype[i]=o(t,i,r))})},a=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?f(e):n.isString(e)?function(t){return t.get(e)}:e},f=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},l=t.Events={},c=/\s+/,h=function(e,t,r,i,s){var o=0,u;if(r&&typeof r=="object"){i!==void 0&&"context"in s&&s.context===void 0&&(s.context=i);for(u=n.keys(r);o<u.length;o++)t=h(e,t,u[o],r[u[o]],s)}else if(r&&c.test(r))for(u=r.split(c);o<u.length;o++)t=e(t,u[o],i,s);else t=e(t,r,i,s);return t};l.on=function(e,t,n){return p(this,e,t,n)};var p=function(e,t,n,r,i){e._events=h(d,e._events||{},t,n,{context:r,ctx:e,listening:i});if(i){var s=e._listeners||(e._listeners={});s[i.id]=i}return e};l.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),o=s[i];if(!o){var u=this._listenId||(this._listenId=n.uniqueId("l"));o=s[i]={obj:e,objId:i,id:u,listeningTo:s,count:0}}return p(e,t,r,this,o),this};var d=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,u=r.listening;u&&u.count++,i.push({callback:n,context:s,ctx:s||o,listening:u})}return e};l.off=function(e,t,n){return this._events?(this._events=h(v,this._events,e,t,{context:n,listeners:this._listeners}),this):this},l.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=e?[e._listenId]:n.keys(i);for(var o=0;o<s.length;o++){var u=i[s[o]];if(!u)break;u.obj.off(t,r,this)}return this};var v=function(e,t,r,i){if(!e)return;var s=0,o,u=i.context,a=i.listeners;if(!t&&!r&&!u){var f=n.keys(a);for(;s<f.length;s++)o=a[f[s]],delete a[o.id],delete o.listeningTo[o.objId];return}var l=t?[t]:n.keys(e);for(;s<l.length;s++){t=l[s];var c=e[t];if(!c)break;var h=[];for(var p=0;p<c.length;p++){var d=c[p];r&&r!==d.callback&&r!==d.callback._callback||u&&u!==d.context?h.push(d):(o=d.listening,o&&--o.count===0&&(delete a[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}return e};l.once=function(e,t,r){var i=h(m,{},e,t,n.bind(this.off,this));return typeof e=="string"&&r==null&&(t=void 0),this.on(i,t,r)},l.listenToOnce=function(e,t,r){var i=h(m,{},t,r,n.bind(this.stopListening,this,e));return this.listenTo(e,i)};var m=function(e,t,r,i){if(r){var s=e[t]=n.once(function(){i(t,s),r.apply(this,arguments)});s._callback=r}return e};l.trigger=function(e){if(!this._events)return this;var t=Math.max(0,arguments.length-1),n=Array(t);for(var r=0;r<t;r++)n[r]=arguments[r+1];return h(g,this._events,e,void 0,n),this};var g=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&y(i,r),s&&y(s,[t].concat(r))}return e},y=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}};l.bind=l.on,l.unbind=l.off,n.extend(t,l);var b=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(e==null)return this;var i;typeof e=="object"?(i=e,r=t):(i={})[e]=t,r||(r={});if(!this._validate(i,r))return!1;var s=r.unset,o=r.silent,u=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=n.clone(this.attributes),this.changed={});var f=this.attributes,l=this.changed,c=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(f[h],t)||u.push(h),n.isEqual(c[h],t)?delete l[h]:l[h]=t,s?delete f[h]:f[h]=t;this.idAttribute in i&&(this.id=this.get(this.idAttribute));if(!o){u.length&&(this._pending=r);for(var p=0;p<u.length;p++)this.trigger("change:"+u[p],this,f[u[p]],r)}if(a)return this;if(!o)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,r={};for(var i in e){var s=e[i];if(n.isEqual(t[i],s))continue;r[i]=s}return n.size(r)?r:!1},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},R(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0,parse:!0},r);var s=r.wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,u=r.success,a=this.attributes;r.success=function(e){o.attributes=a;var t=r.parse?o.parse(e,r):e;s&&(t=n.extend({},i,t));if(t&&!o.set(t,r))return!1;u&&u.call(r.context,o,e,r),o.trigger("sync",o,e,r)},R(this,r),i&&s&&(this.attributes=n.extend({},a,i));var f=this.isNew()?"create":r.patch?"patch":"update";f==="patch"&&!r.attrs&&(r.attrs=i);var l=this.sync(f,this,r);return this.attributes=a,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):(R(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};u(b,w,"attributes");var E=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},T=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r=Array(e.length-n),i=t.length,s;for(s=0;s<r.length;s++)r[s]=e[s+n];for(s=0;s<i;s++)e[s+n]=t[s];for(s=0;s<r.length;s++)e[s+i+n]=r[s]};n.extend(E.prototype,l,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,x))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),r?i[0]:i},set:function(e,t){if(e==null)return;t=n.extend({},S,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;i!=null&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var s=[],o=[],u=[],a=[],f={},l=t.add,c=t.merge,h=t.remove,p=!1,d=this.comparator&&i==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m,g;for(g=0;g<e.length;g++){m=e[g];var y=this.get(m);if(y){if(c&&m!==y){var b=this._isModel(m)?m.attributes:m;t.parse&&(b=y.parse(b,t)),y.set(b,t),u.push(y),d&&!p&&(p=y.hasChanged(v))}f[y.cid]||(f[y.cid]=!0,s.push(y)),e[g]=y}else l&&(m=e[g]=this._prepareModel(m,t),m&&(o.push(m),this._addReference(m,t),f[m.cid]=!0,s.push(m)))}if(h){for(g=0;g<this.length;g++)m=this.models[g],f[m.cid]||a.push(m);a.length&&this._removeModels(a,t)}var w=!1,E=!d&&l&&h;s.length&&E?(w=this.length!==s.length||n.some(this.models,function(e,t){return e!==s[t]}),this.models.length=0,T(this.models,s,0),this.length=this.models.length):o.length&&(d&&(p=!0),T(this.models,o,i==null?this.length:i),this.length=this.models.length),p&&this.sort({silent:!0});if(!t.silent){for(g=0;g<o.length;g++)i!=null&&(t.index=i+g),m=o[g],m.trigger("add",m,this,t);(p||w)&&this.trigger("sort",this,t);if(o.length||a.length||u.length)t.changes={added:o,removed:a,merged:u},this.trigger("update",this,t)}return r?e[0]:e},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return this.get(e)!=null},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),r===1||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},R(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var r=t.wait;e=this._prepareModel(e,t);if(!e)return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&i.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){var n=[];for(var r=0;r<e.length;r++){var i=this.get(e[r]);if(!i)continue;var s=this.indexOf(i);this.models.splice(s,1),this.length--,delete this._byId[i.cid];var o=this.modelId(i.attributes);o!=null&&delete this._byId[o],t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);n!=null&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);n!=null&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r);if(e==="change"){var i=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);i!==s&&(i!=null&&delete this._byId[i],s!=null&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}});var N={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};u(E,N,"models");var C=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,L)),this._ensureElement(),this.initialize.apply(this,arguments)},k=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){e||(e=n.result(this,"events"));if(!e)return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[r]);if(!r)continue;var i=t.match(k);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=A[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||q()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1);var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.call(i.context,e,t,n)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,D=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(O.prototype,l,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(M,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var H=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,F=/#.*$/;H.started=!1,n.extend(H.prototype,l,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return e.charAt(0)==="/"?e.slice(1):e},getFragment:function(e){return e==null&&(this._usePushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(B,"")},start:function(e){if(H.started)throw new Error("Backbone.history has already been started");H.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!this.history&&!!this.history.pushState,this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(j,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),H.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})):!1},navigate:function(e,t){if(!H.started)return!1;if(!t||t===!0)t={trigger:!!t};e=this.getFragment(e||"");var n=this.root;if(e===""||e.charAt(0)==="?")n=n.slice(0,-1)||"/";var r=n+e;e=this.decodeFragment(e.replace(F,""));if(this.fragment===e)return;this.fragment=e;if(this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new H;var I=function(e,t){var r=this,i;return e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t),i.prototype=n.create(r.prototype,e),i.prototype.constructor=i,i.__super__=r.prototype,i};b.extend=E.extend=O.extend=C.extend=H.extend=I;var q=function(){throw new Error('A "url" property or function must be specified')},R=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}),define("models/user/DefaultProfileImage",["require"],function(e){var t={small:"//static.garmincdn.com/apps/connect/image/profile-pic-default_60.gif",medium:"//static.garmincdn.com/apps/connect/image/profile-pic-default_120.gif",large:"//static.garmincdn.com/apps/connect/image/profile-pic-default.gif"};return t}),define("models/user/UserProfile",["require","underscore","backbone","models/user/DefaultProfileImage"],function(e){var t=e("underscore"),n=e("backbone"),r=e("models/user/DefaultProfileImage"),i={VALIDATION_SUCCEEDED:"VALIDATION_SUCCEEDED"},s={PUBLIC:"public",PRIVATE:"private",FOLLOWING:"following"},o={RUNNING:"running",CYCLING:"cycling",SWIMMING:"swimming",TRIATHLON:"triathlon",DUATHLON:"duathlon",CROSS_TRAINING:"cross_training",WALKING:"walking",HIKING:"hiking",WEIGHT_TRAINING:"weight_training",SNOW_SPORTS:"snow_sports",WATER_SPORTS:"water_sports",OTHER:"other"},u=0,a=VIEWER_SOCIAL_PROFILE!=null?VIEWER_SOCIAL_PROFILE.displayName:null,f=n.Model.extend({url:function(){return"/proxy/userprofile-service/socialProfile/"+this.displayName},initialize:function(e){this.validationEnabled=!1,this.displayName=this.get("displayName"),this.displayName===a&&(u++,u>1&&console.log("!!!!Detected extra instance of UserProfile.!!!!")),this.bind("change",function(){this.fetched=!0},this),this.bind("sync",this.onSync,this)},getDisplayName:function(){return this.get("displayName")},onSync:function(){this.displayName=this.get("displayName")},getUserType:function(){var e=this.get("userRoles"),n=t.contains(e,"ROLE_FITNESS_USER"),r=t.contains(e,"ROLE_WELLNESS_USER");return n&&r?"CROSSOVER_USER":n?"TRANSITIONED_USER":"NEW_USER"},hasUserExperience:function(){return t.contains(this.get("userRoles"),"ROLE_WELLNESS_USER")||t.contains(this.get("userRoles"),"ROLE_FITNESS_USER")||t.contains(this.get("userRoles"),"ROLE_OUTDOOR_USER")||t.contains(this.get("userRoles"),"ROLE_DIVE_USER")||t.contains(this.get("userRoles"),"ROLE_MARINE_USER")},hasStepsEnabled:function(){return typeof this.stepsEnabled=="undefined"&&(this.stepsEnabled=this.isWellnessUser()),this.stepsEnabled},isAdminUser:function(){return t.contains(this.get("userRoles"),"ROLE_ADMINISTRATOR")},isCustomerService:function(){return t.contains(this.get("userRoles"),"ROLE_CUSTOMERSERVICE")},isCustomerServiceAdmin:function(){return t.contains(this.get("userRoles"),"ROLE_CUSTOMER_SERVICE_ADMIN")},isDeviceAdmin:function(){return t.contains(this.get("userRoles"),"ROLE_DEVICE_ADMIN")},getProfileImageUrlSmall:function(){return this.get("profileImageUrlSmall")||r.small},getProfileImageUrlMedium:function(){return this.get("profileImageUrlMedium")||r.medium},getProfileImageUrlLarge:function(){return this.get("profileImageUrlLarge")||r.large},hasMBTesterRole:function(){return this.has("userRoles")?this.get("userRoles").indexOf("ROLE_MBTESTER")!==-1:!1},isUserLoggedIn:function(){return!!this.get("displayName")},isFitnessUser:function(){return this.hasRole("ROLE_FITNESS_USER")},isWellnessUser:function(){return this.hasRole("ROLE_WELLNESS_USER")},isOutdoorUser:function(){return this.hasRole("ROLE_OUTDOOR_USER")},isDiveUser:function(){return this.hasRole("ROLE_DIVE_USER")},isMarineUser:function(){return this.hasRole("ROLE_MARINE_USER")},isBetaUser:function(){return this.hasRole("ROLE_CONNECTBETAUSER")},hasRole:function(e){if(this.get("userRoles"))return t.contains(this.get("userRoles"),e)}});return f.ProfileVisibility=s,f.SocialActivityType=o,f.Events=i,f}),define("models/user/ViewerSocialProfile",["backbone","models/user/UserProfile"],function(e,t){return typeof this.globalSocialProfileObject=="undefined"&&(this.globalSocialProfileObject=new t(VIEWER_SOCIAL_PROFILE),delete VIEWER_SOCIAL_PROFILE),this.globalSocialProfileObject}),define("utils/personalizer/NumberSeparators",[],function(){return{DECIMAL_COMMA:"de",DECIMAL_PERIOD:"en"}}),define("utils/personalizer/NumberFormats",[],function(){return{NO_DECIMAL:"##,##0",NO_DECIMAL_NOSEP:"####0",NO_DECIMAL_PAD_2_ZEROS:"00",PRECISION1:"##,##0.0",PRECISION1_PAD_2_ZEROS:"##,#00.0",PRECISION1_NOSEP:"####0.0",PRECISION1_NOSEP_NOZERO:"####0.#",PRECISION1_NOZERO:"##,##0.#",PRECISION2:"##,##0.00",PRECISION3:"##,##0.000",PRECISION3_NOSEP_NOZERO:"####0.###",PRECISION_EXTENDED:"##,##0.00000000"}}),define("utils/personalizer/DateFormats",[],function(){return{MMDDYYYY:"mmddyyyy",DDMMYYYY:"ddmmyyyy",YYYYMMDD:"yyyymmdd"}}),define("utils/personalizer/MeasurementSystems",[],function(){return{METRIC:"metric",STATUTE_US:"statute_us",STATUTE_UK:"statute_uk",METER:"meter",YARD:"yard"}}),define("utils/personalizer/WeightUnitKeys",[],function(){return{STATUTE:"weight_unit_statute",STATUTE_UK:"weight_unit_statute_uk",METRIC:"weight_unit_metric"}}),define("utils/personalizer/ConversionFactors",[],function(){return{MetersToFeet:3.280839895,CmToFeet:.032808399,CmToMiles:621371192e-14,CmToMeters:.01,CmToKm:1e-5,CmToInches:.3937,MetersToKm:.001,MetersToMiles:.000621371192,MilesToMeters:1609.344,KmToMeters:1e3,KmToMiles:.621371,JoulesToKiloCal:.238662345,CaloriesToJoules:4.19002,MpsToKph:3.60000101,MpsToMph:2.23693692,MetersToYards:1.0936133,YardsToMeters:.9144,KphToMps:.27777778,MphToMps:.4470400035763,MilesToYards:1760,MilesToKm:1.60934,GramsToKg:.001,GramsToLbs:.00220462,GramsToSt:15747e-8,KgToGrams:1e3,LbToGrams:453.592,StToGrams:6350.293,StToLbs:14,LbsToSt:.07142857,FeetToMeters:.3048,MeterSecTo100YardHour:39.3700787402,MeterSecTo100MeterHour:36,FloorsToMeters:3.048,FloorsToFeet:10,MpsToFeetPerMinute:196.85,FeetPerMinuteToMps:.0051}}),define("utils/personalizer/SpeedTypes",[],function(){return{Pace:"Pace",Speed:"Speed",SwimPace:"SwimPace",SwimSpeed:"SwimSpeed",Flying:"Flying",RowingSpeed:"RowingSpeed",RowingPace:"RowingPace",FloorClimbingPace:"FloorClimbingPace"}}),define("utils/personalizer/CadenceSensorTypes",[],function(){return{Bike:"Bike",Ped:"Ped",Swim:"Swim",Unknown:"Unknown"}}),define("utils/Conversion",["personalizer"],function(e){var t={MilesToMeters:1609.344,MilesToYards:1760,MilesToKm:1.60934,KmToMeters:1e3,KmToMiles:.621371,KmToYards:1093.61,YardToMeters:.9144,MpsToKph:3.60000101,MpsToMph:2.23694,MetersToMiles:.000621371192,MetersToKm:.001,MetersToYards:1.09361,YardsToMiles:5681e-7,YardsToKm:9144e-7,MinutesPerMeter:.1666666667,MinutesPerYard:.1524,MinutesPerMile:2.68224,MinutesPerKilometer:1.666666667,MphToMps:.44704,KphToMps:.277778,MpsToMilesPerMinute:.0372822715,MilesPerMinuteToMps:26.822400024633694,MpsToKmPerMinute:.05999999988,KmPerMinuteToMps:16.6666667},n={convertFahrenheitToCelsius:function(e){return e=parseFloat(e),(e-32)/1.8},getPaceFactor:function(e){var n=0;switch(e){case"meter":n=t.MinutesPerMeter;break;case"yard":n=t.MinutesPerYard;break;case"mile":n=t.MinutesPerMile;break;case"kilometer":n=t.MinutesPerKilometer;break;default:n=1}return n},calculateSpeed:function(t,r,i,s){var o=n.convertToMetersPerSecond(r,i,s),u=null;return t?u=n.metresPerSec2KMH(o):u=n.metresPerSec2MPH(o),u=parseFloat(e.formatSpeed(u)),t?u*=n.ConversionFactors.KphToMps:u*=n.ConversionFactors.MphToMps,u},convertPaceToSpeed:function(e,t){var n=this.getPaceFactor(e),r=1/t,i=r*n;return i*=10,i},convertDistance:function(e,t,n){var r=this.paceConversionUnit(t,n);return e*r},paceConversionUnit:function(e,n){var r=0;return e==n?r=1:e=="mile"&&n=="kilometer"?r=t.MilesToKm:e=="mile"&&n=="yard"?r=t.MilesToYards:e=="mile"&&n=="meter"?r=t.MilesToMeters:e=="kilometer"&&n=="yard"?r=t.KmToYards:e=="kilometer"&&n=="mile"?r=t.KmToMiles:e=="kilometer"&&n=="meter"?r=t.KmToMeters:e=="meter"&&n=="mile"?r=t.MetersToMiles:e=="meter"&&n=="kilometer"?r=t.MetersToKm:e=="meter"&&n=="yard"?r=t.MetersToYards:e=="yard"&&n=="mile"?r=t.YardsToMiles:e=="yard"&&n=="kilometer"?r=t.YardsToKm:e=="yard"&&n=="meter"&&(r=t.YardToMeters),r},convertToMetersPerSecond:function(e,t,n){var r=this.convertToMeters(e,t),i=r/n;return i},convertToMeters:function(e,n){var r=0;switch(e){case"mile":r=n*t.MilesToMeters;break;case"kilometer":r=n*t.KmToMeters;break;case"meter":r=n;break;case"yard":r=n*t.YardToMeters}return r},convertSpeedToMPS:function(e,n){var r=null;switch(e){case"mile":r=t.MphToMps;break;case"kilometer":r=t.KphToMps;break;default:throw new Error("No conversion for "+e)}return r*n},metresPerSec2KMH:function(e){return e*t.MpsToKph},metresPerSec2MPH:function(e){return e*t.MpsToMph},convertToFloat:function(e,t){if(this.isNotEmpty(e)){if(typeof e=="string")try{e=t.parse(e)}catch(n){e=0}}else e=null;return e},isNotEmpty:function(e){return e!=null&&typeof e!="undefined"&&jQuery.trim(e).length>0}};return n.ConversionFactors=t,n}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){function e(){return $r.apply(null,arguments)}function t(e){$r=e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function i(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e,t){for(var n in t)s(t,n)&&(e[n]=t[n]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function u(e,t,n,r){return At(e,t,n,r,!0).utc()}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function f(e){return null==e._pf&&(e._pf=a()),e._pf}function l(e){if(null==e._isValid){var t=f(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function c(e){var t=u(NaN);return null!=e?o(f(t),e):f(t).userInvalidated=!0,t}function h(e){return void 0===e}function p(e,t){var n,r,i;if(h(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),h(t._i)||(e._i=t._i),h(t._f)||(e._f=t._f),h(t._l)||(e._l=t._l),h(t._strict)||(e._strict=t._strict),h(t._tzm)||(e._tzm=t._tzm),h(t._isUTC)||(e._isUTC=t._isUTC),h(t._offset)||(e._offset=t._offset),h(t._pf)||(e._pf=f(t)),h(t._locale)||(e._locale=t._locale),Kr.length>0)for(n in Kr)r=Kr[n],i=t[r],h(i)||(e[r]=i);return e}function d(t){p(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),Qr===!1&&(Qr=!0,e.updateOffset(this),Qr=!1)}function v(e){return e instanceof d||null!=e&&null!=e._isAMomentObject}function m(e){return 0>e?Math.ceil(e):Math.floor(e)}function g(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=m(t)),n}function y(e,t,n){var r,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(r=0;i>r;r++)(n&&e[r]!==t[r]||!n&&g(e[r])!==g(t[r]))&&o++;return o+s}function b(){}function w(e){return e?e.toLowerCase().replace("_","-"):e}function E(e){for(var t,n,r,i,s=0;s<e.length;){for(i=w(e[s]).split("-"),t=i.length,n=w(e[s+1]),n=n?n.split("-"):null;t>0;){if(r=S(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&y(i,n,!0)>=t-1)break;t--}s++}return null}function S(e){var t=null;if(!Gr[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=Jr._abbr,require("./locale/"+e),x(t)}catch(n){}return Gr[e]}function x(e,t){var n;return e&&(n=h(t)?N(e):T(e,t),n&&(Jr=n)),Jr._abbr}function T(e,t){return null!==t?(t.abbr=e,Gr[e]=Gr[e]||new b,Gr[e].set(t),x(e),Gr[e]):(delete Gr[e],null)}function N(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Jr;if(!n(e)){if(t=S(e))return t;e=[e]}return E(e)}function C(e,t){var n=e.toLowerCase();Yr[n]=Yr[n+"s"]=Yr[t]=e}function k(e){return"string"==typeof e?Yr[e]||Yr[e.toLowerCase()]:void 0}function L(e){var t,n,r={};for(n in e)s(e,n)&&(t=k(n),t&&(r[t]=e[n]));return r}function A(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function O(t,n){return function(r){return null!=r?(_(this,t,r),e.updateOffset(this,n),this):M(this,t)}}function M(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function _(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function D(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=k(e),A(this[e]))return this[e](t);return this}function P(e,t,n){var r=""+Math.abs(e),i=t-r.length,s=e>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function H(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(ni[e]=i),t&&(ni[t[0]]=function(){return P(i.apply(this,arguments),t[1],t[2])}),n&&(ni[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function B(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function j(e){var t,n,r=e.match(Zr);for(t=0,n=r.length;n>t;t++)ni[r[t]]?r[t]=ni[r[t]]:r[t]=B(r[t]);return function(i){var s="";for(t=0;n>t;t++)s+=r[t]instanceof Function?r[t].call(i,e):r[t];return s}}function F(e,t){return e.isValid()?(t=I(t,e.localeData()),ti[t]=ti[t]||j(t),ti[t](e)):e.localeData().invalidDate()}function I(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(ei.lastIndex=0;r>=0&&ei.test(e);)e=e.replace(ei,n),ei.lastIndex=0,r-=1;return e}function q(e,t,n){wi[e]=A(t)?t:function(e,r){return e&&n?n:t}}function R(e,t){return s(wi,e)?wi[e](t._strict,t._locale):new RegExp(U(e))}function U(e){return z(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function z(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function W(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(r=function(e,n){n[t]=g(e)}),n=0;n<e.length;n++)Ei[e[n]]=r}function X(e,t){W(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function V(e,t,n){null!=t&&s(Ei,e)&&Ei[e](t,n._a,n,e)}function $(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function J(e,t){return n(this._months)?this._months[e.month()]:this._months[Mi.test(t)?"format":"standalone"][e.month()]}function K(e,t){return n(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Mi.test(t)?"format":"standalone"][e.month()]}function Q(e,t,n){var r,i,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;12>r;r++){if(i=u([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function G(e,t){var n;return e.isValid()?"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),$(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e):e}function Y(t){return null!=t?(G(this,t),e.updateOffset(this,!0),this):M(this,"Month")}function Z(){return $(this.year(),this.month())}function et(e){return this._monthsParseExact?(s(this,"_monthsRegex")||nt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}function tt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||nt.call(this),e?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}function nt(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],s=[];for(t=0;12>t;t++)n=u([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),s.push(this.months(n,"")),s.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),s.sort(e),t=0;12>t;t++)r[t]=z(r[t]),i[t]=z(i[t]),s[t]=z(s[t]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")$","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")$","i")}function rt(e){var t,n=e._a;return n&&-2===f(e).overflow&&(t=n[xi]<0||n[xi]>11?xi:n[Ti]<1||n[Ti]>$(n[Si],n[xi])?Ti:n[Ni]<0||n[Ni]>24||24===n[Ni]&&(0!==n[Ci]||0!==n[ki]||0!==n[Li])?Ni:n[Ci]<0||n[Ci]>59?Ci:n[ki]<0||n[ki]>59?ki:n[Li]<0||n[Li]>999?Li:-1,f(e)._overflowDayOfYear&&(Si>t||t>Ti)&&(t=Ti),f(e)._overflowWeeks&&-1===t&&(t=Ai),f(e)._overflowWeekday&&-1===t&&(t=Oi),f(e).overflow=t),e}function it(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function st(e,t){var n=!0;return o(function(){return n&&(it(e+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function ot(e,t){Bi[e]||(it(t),Bi[e]=!0)}function ut(e){var t,n,r,i,s,o,u=e._i,a=ji.exec(u)||Fi.exec(u);if(a){for(f(e).iso=!0,t=0,n=qi.length;n>t;t++)if(qi[t][1].exec(a[1])){i=qi[t][0],r=qi[t][2]!==!1;break}if(null==i)return void (e._isValid=!1);if(a[3]){for(t=0,n=Ri.length;n>t;t++)if(Ri[t][1].exec(a[3])){s=(a[2]||" ")+Ri[t][0];break}if(null==s)return void (e._isValid=!1)}if(!r&&null!=s)return void (e._isValid=!1);if(a[4]){if(!Ii.exec(a[4]))return void (e._isValid=!1);o="Z"}e._f=i+(s||"")+(o||""),St(e)}else e._isValid=!1}function at(t){var n=Ui.exec(t._i);return null!==n?void (t._d=new Date(+n[1])):(ut(t),void (t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function ft(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return 100>e&&e>=0&&isFinite(u.getFullYear())&&u.setFullYear(e),u}function lt(e){var t=new Date(Date.UTC.apply(null,arguments));return 100>e&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ct(e){return ht(e)?366:365}function ht(e){return e%4===0&&e%100!==0||e%400===0}function pt(){return ht(this.year())}function dt(e,t,n){var r=7+t-n,i=(7+lt(e,0,r).getUTCDay()-t)%7;return-i+r-1}function vt(e,t,n,r,i){var s,o,u=(7+n-r)%7,a=dt(e,r,i),f=1+7*(t-1)+u+a;return 0>=f?(s=e-1,o=ct(s)+f):f>ct(e)?(s=e+1,o=f-ct(e)):(s=e,o=f),{year:s,dayOfYear:o}}function mt(e,t,n){var r,i,s=dt(e.year(),t,n),o=Math.floor((e.dayOfYear()-s-1)/7)+1;return 1>o?(i=e.year()-1,r=o+gt(i,t,n)):o>gt(e.year(),t,n)?(r=o-gt(e.year(),t,n),i=e.year()+1):(i=e.year(),r=o),{week:r,year:i}}function gt(e,t,n){var r=dt(e,t,n),i=dt(e+1,t,n);return(ct(e)-r+i)/7}function yt(e,t,n){return null!=e?e:null!=t?t:n}function bt(t){var n=new Date(e.now());return t._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function wt(e){var t,n,r,i,s=[];if(!e._d){for(r=bt(e),e._w&&null==e._a[Ti]&&null==e._a[xi]&&Et(e),e._dayOfYear&&(i=yt(e._a[Si],r[Si]),e._dayOfYear>ct(i)&&(f(e)._overflowDayOfYear=!0),n=lt(i,0,e._dayOfYear),e._a[xi]=n.getUTCMonth(),e._a[Ti]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;7>t;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ni]&&0===e._a[Ci]&&0===e._a[ki]&&0===e._a[Li]&&(e._nextDay=!0,e._a[Ni]=0),e._d=(e._useUTC?lt:ft).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ni]=24)}}function Et(e){var t,n,r,i,s,o,u,a;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,o=4,n=yt(t.GG,e._a[Si],mt(Ot(),1,4).year),r=yt(t.W,1),i=yt(t.E,1),(1>i||i>7)&&(a=!0)):(s=e._locale._week.dow,o=e._locale._week.doy,n=yt(t.gg,e._a[Si],mt(Ot(),s,o).year),r=yt(t.w,1),null!=t.d?(i=t.d,(0>i||i>6)&&(a=!0)):null!=t.e?(i=t.e+s,(t.e<0||t.e>6)&&(a=!0)):i=s),1>r||r>gt(n,s,o)?f(e)._overflowWeeks=!0:null!=a?f(e)._overflowWeekday=!0:(u=vt(n,r,i,s,o),e._a[Si]=u.year,e._dayOfYear=u.dayOfYear)}function St(t){if(t._f===e.ISO_8601)return void ut(t);t._a=[],f(t).empty=!0;var n,r,i,s,o,u=""+t._i,a=u.length,l=0;for(i=I(t._f,t._locale).match(Zr)||[],n=0;n<i.length;n++)s=i[n],r=(u.match(R(s,t))||[])[0],r&&(o=u.substr(0,u.indexOf(r)),o.length>0&&f(t).unusedInput.push(o),u=u.slice(u.indexOf(r)+r.length),l+=r.length),ni[s]?(r?f(t).empty=!1:f(t).unusedTokens.push(s),V(s,r,t)):t._strict&&!r&&f(t).unusedTokens.push(s);f(t).charsLeftOver=a-l,u.length>0&&f(t).unusedInput.push(u),f(t).bigHour===!0&&t._a[Ni]<=12&&t._a[Ni]>0&&(f(t).bigHour=void 0),t._a[Ni]=xt(t._locale,t._a[Ni],t._meridiem),wt(t),rt(t)}function xt(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&12>t&&(t+=12),r||12!==t||(t=0),t):t}function Tt(e){var t,n,r,i,s;if(0===e._f.length)return f(e).invalidFormat=!0,void (e._d=new Date(NaN));for(i=0;i<e._f.length;i++)s=0,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],St(t),l(t)&&(s+=f(t).charsLeftOver,s+=10*f(t).unusedTokens.length,f(t).score=s,(null==r||r>s)&&(r=s,n=t));o(e,n||t)}function Nt(e){if(!e._d){var t=L(e._i);e._a=i([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),wt(e)}}function Ct(e){var t=new d(rt(kt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function kt(e){var t=e._i,i=e._f;return e._locale=e._locale||N(e._l),null===t||void 0===i&&""===t?c({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),v(t)?new d(rt(t)):(n(i)?Tt(e):i?St(e):r(t)?e._d=t:Lt(e),l(e)||(e._d=null),e))}function Lt(t){var s=t._i;void 0===s?t._d=new Date(e.now()):r(s)?t._d=new Date(+s):"string"==typeof s?at(t):n(s)?(t._a=i(s.slice(0),function(e){return parseInt(e,10)}),wt(t)):"object"==typeof s?Nt(t):"number"==typeof s?t._d=new Date(s):e.createFromInputFallback(t)}function At(e,t,n,r,i){var s={};return"boolean"==typeof n&&(r=n,n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=r,Ct(s)}function Ot(e,t,n,r){return At(e,t,n,r,!1)}function Mt(e,t){var r,i;if(1===t.length&&n(t[0])&&(t=t[0]),!t.length)return Ot();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][e](r))&&(r=t[i]);return r}function _t(){var e=[].slice.call(arguments,0);return Mt("isBefore",e)}function Dt(){var e=[].slice.call(arguments,0);return Mt("isAfter",e)}function Pt(e){var t=L(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,u=t.hour||0,a=t.minute||0,f=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*f+6e4*a+36e5*u,this._days=+o+7*s,this._months=+i+3*r+12*n,this._data={},this._locale=N(),this._bubble()}function Ht(e){return e instanceof Pt}function Bt(e,t){H(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+P(~~(e/60),2)+t+P(~~e%60,2)})}function jt(e,t){var n=(t||"").match(e)||[],r=n[n.length-1]||[],i=(r+"").match($i)||["-",0,0],s=+(60*i[1])+g(i[2]);return"+"===i[0]?s:-s}function Ft(t,n){var i,s;return n._isUTC?(i=n.clone(),s=(v(t)||r(t)?+t:+Ot(t))- +i,i._d.setTime(+i._d+s),e.updateOffset(i,!1),i):Ot(t).local()}function It(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function qt(t,n){var r,i=this._offset||0;return this.isValid()?null!=t?("string"==typeof t?t=jt(gi,t):Math.abs(t)<16&&(t=60*t),!this._isUTC&&n&&(r=It(this)),this._offset=t,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==t&&(!n||this._changeInProgress?nn(this,Gt(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:It(this):null!=t?this:NaN}function Rt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Ut(e){return this.utcOffset(0,e)}function zt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(It(this),"m")),this}function Wt(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(jt(mi,this._i)),this}function Xt(e){return this.isValid()?(e=e?Ot(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Vt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function $t(){if(!h(this._isDSTShifted))return this._isDSTShifted;var e={};if(p(e,this),e=kt(e),e._a){var t=e._isUTC?u(e._a):Ot(e._a);this._isDSTShifted=this.isValid()&&y(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Jt(){return this.isValid()?!this._isUTC:!1}function Kt(){return this.isValid()?this._isUTC:!1}function Qt(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Gt(e,t){var n,r,i,o=e,u=null;return Ht(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(u=Ji.exec(e))?(n="-"===u[1]?-1:1,o={y:0,d:g(u[Ti])*n,h:g(u[Ni])*n,m:g(u[Ci])*n,s:g(u[ki])*n,ms:g(u[Li])*n}):(u=Ki.exec(e))?(n="-"===u[1]?-1:1,o={y:Yt(u[2],n),M:Yt(u[3],n),d:Yt(u[4],n),h:Yt(u[5],n),m:Yt(u[6],n),s:Yt(u[7],n),w:Yt(u[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=en(Ot(o.from),Ot(o.to)),o={},o.ms=i.milliseconds,o.M=i.months),r=new Pt(o),Ht(e)&&s(e,"_locale")&&(r._locale=e._locale),r}function Yt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function en(e,t){var n;return e.isValid()&&t.isValid()?(t=Ft(t,e),e.isBefore(t)?n=Zt(e,t):(n=Zt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function tn(e,t){return function(n,r){var i,s;return null===r||isNaN(+r)||(ot(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=r,r=s),n="string"==typeof n?+n:n,i=Gt(n,r),nn(this,i,e),this}}function nn(t,n,r,i){var s=n._milliseconds,o=n._days,u=n._months;t.isValid()&&(i=null==i?!0:i,s&&t._d.setTime(+t._d+s*r),o&&_(t,"Date",M(t,"Date")+o*r),u&&G(t,M(t,"Month")+u*r),i&&e.updateOffset(t,o||u))}function rn(e,t){var n=e||Ot(),r=Ft(n,this).startOf("day"),i=this.diff(r,"days",!0),s=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse",o=t&&(A(t[s])?t[s]():t[s]);return this.format(o||this.localeData().calendar(s,this,Ot(n)))}function sn(){return new d(this)}function on(e,t){var n=v(e)?e:Ot(e);return this.isValid()&&n.isValid()?(t=k(h(t)?"millisecond":t),"millisecond"===t?+this>+n:+n<+this.clone().startOf(t)):!1}function un(e,t){var n=v(e)?e:Ot(e);return this.isValid()&&n.isValid()?(t=k(h(t)?"millisecond":t),"millisecond"===t?+n>+this:+this.clone().endOf(t)<+n):!1}function an(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function fn(e,t){var n,r=v(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=k(t||"millisecond"),"millisecond"===t?+this===+r:(n=+r,+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))):!1}function ln(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function cn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function hn(e,t,n){var r,i,s,o;return this.isValid()?(r=Ft(e,this),r.isValid()?(i=6e4*(r.utcOffset()-this.utcOffset()),t=k(t),"year"===t||"month"===t||"quarter"===t?(o=pn(this,r),"quarter"===t?o/=3:"year"===t&&(o/=12)):(s=this-r,o="second"===t?s/1e3:"minute"===t?s/6e4:"hour"===t?s/36e5:"day"===t?(s-i)/864e5:"week"===t?(s-i)/6048e5:s),n?o:m(o)):NaN):NaN}function pn(e,t){var n,r,i=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(i,"months");return 0>t-s?(n=e.clone().add(i-1,"months"),r=(t-s)/(s-n)):(n=e.clone().add(i+1,"months"),r=(t-s)/(n-s)),-(i+r)}function dn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function vn(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?A(Date.prototype.toISOString)?this.toDate().toISOString():F(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function mn(t){var n=F(this,t||e.defaultFormat);return this.localeData().postformat(n)}function gn(e,t){return this.isValid()&&(v(e)&&e.isValid()||Ot(e).isValid())?Gt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yn(e){return this.from(Ot(),e)}function bn(e,t){return this.isValid()&&(v(e)&&e.isValid()||Ot(e).isValid())?Gt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function wn(e){return this.to(Ot(),e)}function En(e){var t;return void 0===e?this._locale._abbr:(t=N(e),null!=t&&(this._locale=t),this)}function Sn(){return this._locale}function xn(e){switch(e=k(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function Tn(e){return e=k(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function Nn(){return+this._d-6e4*(this._offset||0)}function Cn(){return Math.floor(+this/1e3)}function kn(){return this._offset?new Date(+this):this._d}function Ln(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function An(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function On(){return this.isValid()?this.toISOString():"null"}function Mn(){return l(this)}function _n(){return o({},f(this))}function Dn(){return f(this).overflow}function Pn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Hn(e,t){H(0,[e,e.length],0,t)}function Bn(e){return qn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function jn(e){return qn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Fn(){return gt(this.year(),1,4)}function In(){var e=this.localeData()._week;return gt(this.year(),e.dow,e.doy)}function qn(e,t,n,r,i){var s;return null==e?mt(this,r,i).year:(s=gt(e,r,i),t>s&&(t=s),Rn.call(this,e,t,n,r,i))}function Rn(e,t,n,r,i){var s=vt(e,t,n,r,i),o=lt(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function Un(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function zn(e){return mt(e,this._week.dow,this._week.doy).week}function Wn(){return this._week.dow}function Xn(){return this._week.doy}function Vn(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function $n(e){var t=mt(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Jn(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Kn(e,t){return n(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function Qn(e){return this._weekdaysShort[e.day()]}function Gn(e){return this._weekdaysMin[e.day()]}function Yn(e,t,n){var r,i,s;for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;7>r;r++){if(i=Ot([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Zn(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Jn(e,this.localeData()),this.add(e-t,"d")):t}function er(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function tr(e){return this.isValid()?null==e?this.day()||7:this.day(this.day()%7?e:e-7):null!=e?this:NaN}function nr(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function rr(){return this.hours()%12||12}function ir(e,t){H(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function sr(e,t){return t._meridiemParse}function or(e){return"p"===(e+"").toLowerCase().charAt(0)}function ur(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function ar(e,t){t[Li]=g(1e3*("0."+e))}function fr(){return this._isUTC?"UTC":""}function lr(){return this._isUTC?"Coordinated Universal Time":""}function cr(e){return Ot(1e3*e)}function hr(){return Ot.apply(null,arguments).parseZone()}function pr(e,t,n){var r=this._calendar[e];return A(r)?r.call(t,n):r}function dr(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function vr(){return this._invalidDate}function mr(e){return this._ordinal.replace("%d",e)}function gr(e){return e}function yr(e,t,n,r){var i=this._relativeTime[n];return A(i)?i(e,t,n,r):i.replace(/%d/i,e)}function br(e,t){var n=this._relativeTime[e>0?"future":"past"];return A(n)?n(t):n.replace(/%s/i,t)}function wr(e){var t,n;for(n in e)t=e[n],A(t)?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function Er(e,t,n,r){var i=N(),s=u().set(r,t);return i[n](s,e)}function Sr(e,t,n,r,i){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Er(e,t,n,i);var s,o=[];for(s=0;r>s;s++)o[s]=Er(e,s,n,i);return o}function xr(e,t){return Sr(e,t,"months",12,"month")}function Tr(e,t){return Sr(e,t,"monthsShort",12,"month")}function Nr(e,t){return Sr(e,t,"weekdays",7,"day")}function Cr(e,t){return Sr(e,t,"weekdaysShort",7,"day")}function kr(e,t){return Sr(e,t,"weekdaysMin",7,"day")}function Lr(){var e=this._data;return this._milliseconds=bs(this._milliseconds),this._days=bs(this._days),this._months=bs(this._months),e.milliseconds=bs(e.milliseconds),e.seconds=bs(e.seconds),e.minutes=bs(e.minutes),e.hours=bs(e.hours),e.months=bs(e.months),e.years=bs(e.years),this}function Ar(e,t,n,r){var i=Gt(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Or(e,t){return Ar(this,e,t,1)}function Mr(e,t){return Ar(this,e,t,-1)}function _r(e){return 0>e?Math.floor(e):Math.ceil(e)}function Dr(){var e,t,n,r,i,s=this._milliseconds,o=this._days,u=this._months,a=this._data;return s>=0&&o>=0&&u>=0||0>=s&&0>=o&&0>=u||(s+=864e5*_r(Hr(u)+o),o=0,u=0),a.milliseconds=s%1e3,e=m(s/1e3),a.seconds=e%60,t=m(e/60),a.minutes=t%60,n=m(t/60),a.hours=n%24,o+=m(n/24),i=m(Pr(o)),u+=i,o-=_r(Hr(i)),r=m(u/12),u%=12,a.days=o,a.months=u,a.years=r,this}function Pr(e){return 4800*e/146097}function Hr(e){return 146097*e/4800}function Br(e){var t,n,r=this._milliseconds;if(e=k(e),"month"===e||"year"===e)return t=this._days+r/864e5,n=this._months+Pr(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Hr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function jr(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)}function Fr(e){return function(){return this.as(e)}}function Ir(e){return e=k(e),this[e+"s"]()}function qr(e){return function(){return this._data[e]}}function Rr(){return m(this.days()/7)}function Ur(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function zr(e,t,n){var r=Gt(e).abs(),i=Hs(r.as("s")),s=Hs(r.as("m")),o=Hs(r.as("h")),u=Hs(r.as("d")),a=Hs(r.as("M")),f=Hs(r.as("y")),l=i<Bs.s&&["s",i]||1>=s&&["m"]||s<Bs.m&&["mm",s]||1>=o&&["h"]||o<Bs.h&&["hh",o]||1>=u&&["d"]||u<Bs.d&&["dd",u]||1>=a&&["M"]||a<Bs.M&&["MM",a]||1>=f&&["y"]||["yy",f];return l[2]=t,l[3]=+e>0,l[4]=n,Ur.apply(null,l)}function Wr(e,t){return void 0===Bs[e]?!1:void 0===t?Bs[e]:(Bs[e]=t,!0)}function Xr(e){var t=this.localeData(),n=zr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Vr(){var e,t,n,r=js(this._milliseconds)/1e3,i=js(this._days),s=js(this._months);e=m(r/60),t=m(e/60),r%=60,e%=60,n=m(s/12),s%=12;var o=n,u=s,a=i,f=t,l=e,c=r,h=this.asSeconds();return h?(0>h?"-":"")+"P"+(o?o+"Y":"")+(u?u+"M":"")+(a?a+"D":"")+(f||l||c?"T":"")+(f?f+"H":"")+(l?l+"M":"")+(c?c+"S":""):"P0D"}var $r,Jr,Kr=e.momentProperties=[],Qr=!1,Gr={},Yr={},Zr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ei=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ti={},ni={},ri=/\d/,ii=/\d\d/,si=/\d{3}/,oi=/\d{4}/,ui=/[+-]?\d{6}/,ai=/\d\d?/,fi=/\d\d\d\d?/,li=/\d\d\d\d\d\d?/,ci=/\d{1,3}/,hi=/\d{1,4}/,pi=/[+-]?\d{1,6}/,di=/\d+/,vi=/[+-]?\d+/,mi=/Z|[+-]\d\d:?\d\d/gi,gi=/Z|[+-]\d\d(?::?\d\d)?/gi,yi=/[+-]?\d+(\.\d{1,3})?/,bi=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,wi={},Ei={},Si=0,xi=1,Ti=2,Ni=3,Ci=4,ki=5,Li=6,Ai=7,Oi=8;H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),H("MMMM",0,0,function(e){return this.localeData().months(this,e)}),C("month","M"),q("M",ai),q("MM",ai,ii),q("MMM",function(e,t){return t.monthsShortRegex(e)}),q("MMMM",function(e,t){return t.monthsRegex(e)}),W(["M","MM"],function(e,t){t[xi]=g(e)-1}),W(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[xi]=i:f(n).invalidMonth=e});var Mi=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,_i="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Di="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Pi=bi,Hi=bi,Bi={};e.suppressDeprecationWarnings=!1;var ji=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Fi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Ii=/Z|[+-]\d\d(?::?\d\d)?/,qi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Ri=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ui=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=st("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),H("Y",0,0,function(){var e=this.year();return 9999>=e?""+e:"+"+e}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),C("year","y"),q("Y",vi),q("YY",ai,ii),q("YYYY",hi,oi),q("YYYYY",pi,ui),q("YYYYYY",pi,ui),W(["YYYYY","YYYYYY"],Si),W("YYYY",function(t,n){n[Si]=2===t.length?e.parseTwoDigitYear(t):g(t)}),W("YY",function(t,n){n[Si]=e.parseTwoDigitYear(t)}),W("Y",function(e,t){t[Si]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return g(e)+(g(e)>68?1900:2e3)};var zi=O("FullYear",!1);e.ISO_8601=function(){};var Wi=st("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?this>e?this:e:c()}),Xi=st("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:c()}),Vi=function(){return Date.now?Date.now():+(new Date)};Bt("Z",":"),Bt("ZZ",""),q("Z",gi),q("ZZ",gi),W(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=jt(gi,e)});var $i=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Ji=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,Ki=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Gt.fn=Pt.prototype;var Qi=tn(1,"add"),Gi=tn(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Yi=st("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Hn("gggg","weekYear"),Hn("ggggg","weekYear"),Hn("GGGG","isoWeekYear"),Hn("GGGGG","isoWeekYear"),C("weekYear","gg"),C("isoWeekYear","GG"),q("G",vi),q("g",vi),q("GG",ai,ii),q("gg",ai,ii),q("GGGG",hi,oi),q("gggg",hi,oi),q("GGGGG",pi,ui),q("ggggg",pi,ui),X(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=g(e)}),X(["gg","GG"],function(t,n,r,i){n[i]=e.parseTwoDigitYear(t)}),H("Q",0,"Qo","quarter"),C("quarter","Q"),q("Q",ri),W("Q",function(e,t){t[xi]=3*(g(e)-1)}),H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),C("week","w"),C("isoWeek","W"),q("w",ai),q("ww",ai,ii),q("W",ai),q("WW",ai,ii),X(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=g(e)});var Zi={dow:0,doy:6};H("D",["DD",2],"Do","date"),C("date","D"),q("D",ai),q("DD",ai,ii),q("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),W(["D","DD"],Ti),W("Do",function(e,t){t[Ti]=g(e.match(ai)[0],10)});var es=O("Date",!0);H("d",0,"do","day"),H("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),H("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),H("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),C("day","d"),C("weekday","e"),C("isoWeekday","E"),q("d",ai),q("e",ai),q("E",ai),q("dd",bi),q("ddd",bi),q("dddd",bi),X(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:f(n).invalidWeekday=e}),X(["d","e","E"],function(e,t,n,r){t[r]=g(e)});var ts="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ns="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),rs="Su_Mo_Tu_We_Th_Fr_Sa".split("_");H("DDD",["DDDD",3],"DDDo","dayOfYear"),C("dayOfYear","DDD"),q("DDD",ci),q("DDDD",si),W(["DDD","DDDD"],function(e,t,n){n._dayOfYear=g(e)}),H("H",["HH",2],0,"hour"),H("h",["hh",2],0,rr),H("hmm",0,0,function(){return""+rr.apply(this)+P(this.minutes(),2)}),H("hmmss",0,0,function(){return""+rr.apply(this)+P(this.minutes(),2)+P(this.seconds(),2)}),H("Hmm",0,0,function(){return""+this.hours()+P(this.minutes(),2)}),H("Hmmss",0,0,function(){return""+this.hours()+P(this.minutes(),2)+P(this.seconds(),2)}),ir("a",!0),ir("A",!1),C("hour","h"),q("a",sr),q("A",sr),q("H",ai),q("h",ai),q("HH",ai,ii),q("hh",ai,ii),q("hmm",fi),q("hmmss",li),q("Hmm",fi),q("Hmmss",li),W(["H","HH"],Ni),W(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),W(["h","hh"],function(e,t,n){t[Ni]=g(e),f(n).bigHour=!0}),W("hmm",function(e,t,n){var r=e.length-2;t[Ni]=g(e.substr(0,r)),t[Ci]=g(e.substr(r)),f(n).bigHour=!0}),W("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Ni]=g(e.substr(0,r)),t[Ci]=g(e.substr(r,2)),t[ki]=g(e.substr(i)),f(n).bigHour=!0}),W("Hmm",function(e,t,n){var r=e.length-2;t[Ni]=g(e.substr(0,r)),t[Ci]=g(e.substr(r))}),W("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Ni]=g(e.substr(0,r)),t[Ci]=g(e.substr(r,2)),t[ki]=g(e.substr(i))});var is=/[ap]\.?m?\.?/i,ss=O("Hours",!0);H("m",["mm",2],0,"minute"),C("minute","m"),q("m",ai),q("mm",ai,ii),W(["m","mm"],Ci);var os=O("Minutes",!1);H("s",["ss",2],0,"second"),C("second","s"),q("s",ai),q("ss",ai,ii),W(["s","ss"],ki);var us=O("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),C("millisecond","ms"),q("S",ci,ri),q("SS",ci,ii),q("SSS",ci,si);var as;for(as="SSSS";as.length<=9;as+="S")q(as,di);for(as="S";as.length<=9;as+="S")W(as,ar);var fs=O("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var ls=d.prototype;ls.add=Qi,ls.calendar=rn,ls.clone=sn,ls.diff=hn,ls.endOf=Tn,ls.format=mn,ls.from=gn,ls.fromNow=yn,ls.to=bn,ls.toNow=wn,ls.get=D,ls.invalidAt=Dn,ls.isAfter=on,ls.isBefore=un,ls.isBetween=an,ls.isSame=fn,ls.isSameOrAfter=ln,ls.isSameOrBefore=cn,ls.isValid=Mn,ls.lang=Yi,ls.locale=En,ls.localeData=Sn,ls.max=Xi,ls.min=Wi,ls.parsingFlags=_n,ls.set=D,ls.startOf=xn,ls.subtract=Gi,ls.toArray=Ln,ls.toObject=An,ls.toDate=kn,ls.toISOString=vn,ls.toJSON=On,ls.toString=dn,ls.unix=Cn,ls.valueOf=Nn,ls.creationData=Pn,ls.year=zi,ls.isLeapYear=pt,ls.weekYear=Bn,ls.isoWeekYear=jn,ls.quarter=ls.quarters=Un,ls.month=Y,ls.daysInMonth=Z,ls.week=ls.weeks=Vn,ls.isoWeek=ls.isoWeeks=$n,ls.weeksInYear=In,ls.isoWeeksInYear=Fn,ls.date=es,ls.day=ls.days=Zn,ls.weekday=er,ls.isoWeekday=tr,ls.dayOfYear=nr,ls.hour=ls.hours=ss,ls.minute=ls.minutes=os,ls.second=ls.seconds=us,ls.millisecond=ls.milliseconds=fs,ls.utcOffset=qt,ls.utc=Ut,ls.local=zt,ls.parseZone=Wt,ls.hasAlignedHourOffset=Xt,ls.isDST=Vt,ls.isDSTShifted=$t,ls.isLocal=Jt,ls.isUtcOffset=Kt,ls.isUtc=Qt,ls.isUTC=Qt,ls.zoneAbbr=fr,ls.zoneName=lr,ls.dates=st("dates accessor is deprecated. Use date instead.",es),ls.months=st("months accessor is deprecated. Use month instead",Y),ls.years=st("years accessor is deprecated. Use year instead",zi),ls.zone=st("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Rt);var cs=ls,hs={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},ps={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},ds="Invalid date",vs="%d",ms=/\d{1,2}/,gs={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ys=b.prototype;ys._calendar=hs,ys.calendar=pr,ys._longDateFormat=ps,ys.longDateFormat=dr,ys._invalidDate=ds,ys.invalidDate=vr,ys._ordinal=vs,ys.ordinal=mr,ys._ordinalParse=ms,ys.preparse=gr,ys.postformat=gr,ys._relativeTime=gs,ys.relativeTime=yr,ys.pastFuture=br,ys.set=wr,ys.months=J,ys._months=_i,ys.monthsShort=K,ys._monthsShort=Di,ys.monthsParse=Q,ys._monthsRegex=Hi,ys.monthsRegex=tt,ys._monthsShortRegex=Pi,ys.monthsShortRegex=et,ys.week=zn,ys._week=Zi,ys.firstDayOfYear=Xn,ys.firstDayOfWeek=Wn,ys.weekdays=Kn,ys._weekdays=ts,ys.weekdaysMin=Gn,ys._weekdaysMin=rs,ys.weekdaysShort=Qn,ys._weekdaysShort=ns,ys.weekdaysParse=Yn,ys.isPM=or,ys._meridiemParse=is,ys.meridiem=ur,x("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),e.lang=st("moment.lang is deprecated. Use moment.locale instead.",x),e.langData=st("moment.langData is deprecated. Use moment.localeData instead.",N);var bs=Math.abs,ws=Fr("ms"),Es=Fr("s"),Ss=Fr("m"),xs=Fr("h"),Ts=Fr("d"),Ns=Fr("w"),Cs=Fr("M"),ks=Fr("y"),Ls=qr("milliseconds"),As=qr("seconds"),Os=qr("minutes"),Ms=qr("hours"),_s=qr("days"),Ds=qr("months"),Ps=qr("years"),Hs=Math.round,Bs={s:45,m:45,h:22,d:26,M:11},js=Math.abs,Fs=Pt.prototype;Fs.abs=Lr,Fs.add=Or,Fs.subtract=Mr,Fs.as=Br,Fs.asMilliseconds=ws,Fs.asSeconds=Es,Fs.asMinutes=Ss,Fs.asHours=xs,Fs.asDays=Ts,Fs.asWeeks=Ns,Fs.asMonths=Cs,Fs.asYears=ks,Fs.valueOf=jr,Fs._bubble=Dr,Fs.get=Ir,Fs.milliseconds=Ls,Fs.seconds=As,Fs.minutes=Os,Fs.hours=Ms,Fs.days=_s,Fs.weeks=Rr,Fs.months=Ds,Fs.years=Ps,Fs.humanize=Xr,Fs.toISOString=Vr,Fs.toString=Vr,Fs.toJSON=Vr,Fs.locale=En,Fs.localeData=Sn,Fs.toIsoString=st("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Vr),Fs.lang=Yi,H("X",0,0,"unix"),H("x",0,0,"valueOf"),q("x",vi),q("X",yi),W("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),W("x",function(e,t,n){n._d=new Date(g(e))}),e.version="2.11.2",t(Ot),e.fn=cs,e.min=_t,e.max=Dt,e.now=Vi,e.utc=u,e.unix=cr,e.months=xr,e.isDate=r,e.locale=x,e.invalid=c,e.duration=Gt,e.isMoment=v,e.weekdays=Nr,e.parseZone=hr,e.localeData=N,e.isDuration=Ht,e.monthsShort=Tr,e.weekdaysMin=kr,e.defineLocale=T,e.weekdaysShort=Cr,e.normalizeUnits=k,e.relativeTimeThreshold=Wr,e.prototype=cs;var Is=e;return Is}),define("personalizer",["require","underscore","jquery","utils/personalizer/NumberSeparators","utils/personalizer/NumberFormats","utils/personalizer/DateFormats","utils/personalizer/MeasurementSystems","utils/personalizer/WeightUnitKeys","utils/personalizer/ConversionFactors","utils/personalizer/SpeedTypes","utils/personalizer/CadenceSensorTypes","utils/Conversion","moment"],function(e){var t=e("underscore"),n=e("jquery"),r=e("utils/personalizer/NumberSeparators"),i=e("utils/personalizer/NumberFormats"),s=e("utils/personalizer/DateFormats"),o=e("utils/personalizer/MeasurementSystems"),u=e("utils/personalizer/WeightUnitKeys"),a=e("utils/personalizer/ConversionFactors"),f=e("utils/personalizer/SpeedTypes"),l=e("utils/personalizer/CadenceSensorTypes"),c=e("utils/Conversion"),h=e("moment"),p={MeasurementSystems:o,DateFormats:s,measurementSystem:o.STATUTE_US,golfMeasurementSystem:o.YARD,dateFormat:s.MMDDYYYY,speedType:f.Speed,cadenceSensorType:"Unknown",numberSeparator:r.DECIMAL_PERIOD,setMeasurementSystem:function(e){this.measurementSystem=e},setGolfMeasurementSystem:function(e){this.golfMeasurementSystem=e},setDateFormat:function(e){this.dateFormat=e},setTimeFormat:function(e){this.timeFormat=e},setNumberSeparator:function(e){this.numberSeparator=r[e]},getNumberSeparator:function(){return this.numberSeparator},getMeasurementSystem:function(){return this.measurementSystem},getGolfMeasurementSystem:function(){return this.golfMeasurementSystem},setSpeedType:function(e){this.speedType=e},personalizeHeight:function(e,t){var r=t||i.PRECISION1_NOZERO;return n.formatNumber(e,{format:r,locale:this.numberSeparator})},convertHeight:function(e){if(isNaN(e))throw"value must be in centimeter";var t={};t.type=this.measurementSystem,t.cm=e;var n=e*this.ConversionFactors.CmToFeet;t.feet=Math.floor(n),t.inches=Math.round((n-t.feet)*12);var r=t.inches===12?1:0;return t.inches=t.inches===12?0:t.inches,t.feet+=r,t},convertHeightToCm:function(e){return this.measurementSystem===this.MeasurementSystems.METRIC?e:e/this.ConversionFactors.CmToFeet},convertFeetToMeter:function(e){return e?this.measurementSystem===this.MeasurementSystems.STATUTE_US?(e*this.ConversionFactors.FeetToMeters).toFixed(2):e:0},convertElevationToMeter:function(e){return this.convertFeetToMeter(e)},convertElevation:function(e){return this.convertMetersFt(e)},formatElevation:function(e){return this.formatMetersFt(e)},personalizeElevation:function(e){return t.isNull(e)||t.isUndefined(e)?"--":this.personalizeMetersFt(e)},personalizeDistanceValue:function(e,t){return n.formatNumber(e,{format:t||i.PRECISION2,locale:this.numberSeparator})},personalizeDistancePrecision1:function(e,t){var r=this.convertDistance(e,t);return this.isLapSwimmingActivity(t)?this.formatWholeNumber(r):n.formatNumber(r,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeDistancePrecision2:function(e,t){var r=this.convertDistance(e,t);return this.isLapSwimmingActivity(t)?this.formatWholeNumber(r):n.formatNumber(r,{format:i.PRECISION2,locale:this.numberSeparator})},personalizeDistance:function(e,t,n){var r=this.convertDistance(e,t,n?n.unitKey:null);return this.formatDistance(r,t)},formatDistance:function(e,t){if(this.displayDistanceAsWholeNumber(t))return this.formatWholeNumber(e);var r=i.PRECISION2;return n.formatNumber(e,{format:r,locale:this.numberSeparator})},personalizeSwimDistance:function(e,t){var n=t||this.measurementSystem;return n===this.MeasurementSystems.METRIC?this.formatWholeNumber(e):this.formatWholeNumber(e*this.ConversionFactors.MetersToYards)},personalizePoolLength:function(e){return this.formatWholeNumber(e)},personalizeSteps:function(e){return this.formatWholeNumber(e)},personalizePercentComplete:function(e,t,n){var r,i;return t?r=Math.floor(e/t*100):r=100,i=n?r:+Math.min(r,100),isNaN(i)&&(i=0),i},convertDistance:function(e,t,n){var r=this.isLapSwimmingActivity(t),i=this.isOpenWaterSwimmingActivity(t);if(r||n){var s=this.poolUnitToMeasurementSystem(n)||this.inferPoolMeasurementSystemFromDistance(e);return s==this.MeasurementSystems.METRIC?e:e*this.ConversionFactors.MetersToYards}return i?this.measurementSystem==this.MeasurementSystems.METRIC?e:e*this.ConversionFactors.MetersToYards:this.isDisplayInMeter(t)?e:this.measurementSystem==this.MeasurementSystems.METRIC?e*this.ConversionFactors.MetersToKm:e*this.ConversionFactors.MetersToMiles},convertDistanceToCm:function(e,t){switch(t){case"meter":return e/this.ConversionFactors.CmToMeters;case"kilometer":return e/this.ConversionFactors.CmToKm;case"yard":return e/this.ConversionFactors.MetersToYards*100;case"mile":return e/this.ConversionFactors.CmToMiles;case"inch":return e/this.ConversionFactors.CmToInches;default:throw"Unknown unit key: "+t}},revertDistanceToCm:function(e,t){switch(t){case"inch":return e*this.ConversionFactors.CmToInches;case"meter":return e*this.ConversionFactors.CmToMeters;default:throw"Unknown unit key: "+t}},revertDistance:function(e,t,n){var r=this.isLapSwimmingActivity(t),i=this.isOpenWaterSwimmingActivity(t);if(r||n){var s=this.poolUnitToMeasurementSystem(n);return s==this.MeasurementSystems.METRIC?e:e*this.ConversionFactors.YardsToMeters}return i?this.measurementSystem==this.MeasurementSystems.METRIC?e:e*this.ConversionFactors.YardsToMeters:this.measurementSystem==this.MeasurementSystems.METRIC?e*this.ConversionFactors.KmToMeters:e*this.ConversionFactors.MilesToMeters},formatFractionalPace:function(e){},personalizeLactateThresholdPace:function(e){var t=this.convertSpeed(e);if(t==0)return 0;var r=Math.ceil(3600/t),s=Math.floor(r/3600),o=Math.floor((r-s*3600)/60);r=Math.floor(r-s*3600-o*60);var u=o+s*60+":"+n.formatNumber(r,{format:i.NO_DECIMAL_PAD_2_ZEROS});return u},personalizePace:function(e,t,r){var s=this.isRowingActivity(r),o=s?e:this.convertSpeed(e);if(o==0)return 0;if(s)return this.personalizeRowingPace(o);var u=Math.round(3600/o),a=Math.floor(u/3600),f=Math.floor((u-a*3600)/60);u=Math.floor(u-a*3600-f*60);if(a>0||a===0&&f===60||a===0&&f===59&&u===60)return 0;var l="";return t?l=f+a*60+":"+n.formatNumber(u,{format:i.NO_DECIMAL_PAD_2_ZEROS}):(l=f+":"+n.formatNumber(u,{format:i.NO_DECIMAL_PAD_2_ZEROS}),a>0&&(l=a+":"+l)),l},poolUnitKeyToMeasurementSystem:function(e){var t=p.MeasurementSystems.STATUTE_US;return e=="meter"&&(t=p.MeasurementSystems.METRIC),t},convertFractionalSwimPace:function(e,t){t=t||this.measurementSystem;var n=this.convertSpeed(e,t);if(!n)return 60;var r=this.ConversionFactors.MilesToYards;return t==this.MeasurementSystems.METRIC&&(r=this.ConversionFactors.KmToMeters),1/(n/60*r)*100},convertSwimSpeed:function(e,t){var n;return t==this.MeasurementSystems.METRIC?n=e*this.ConversionFactors.MeterSecTo100MeterHour:n=e*this.ConversionFactors.MeterSecTo100YardHour,n},formatPace:function(e){if(!e)return"0:00";var t=Math.round(e*60),r=Math.floor(t/3600),s=Math.floor((t-r*3600)/60);t=Math.floor(t-r*3600-s*60);var o=r>=1?r+":":"";return o?o+n.formatNumber(s,{format:i.NO_DECIMAL_PAD_2_ZEROS})+":"+n.formatNumber(t,{format:i.NO_DECIMAL_PAD_2_ZEROS}):o+s+":"+n.formatNumber(t,{format:i.NO_DECIMAL_PAD_2_ZEROS})},personalizeSwimPace:function(e,t){var n=this.convertFractionalSwimPace(e,t);return this.formatPace(n)},convertFractionalPace:function(e){if(e>0){var t=60/this.convertSpeed(e);return Math.min(60,t)}return 60},convertRowingPace:function(e){return e?500/(e*60):0},convertSpeed:function(e,t,n){if(!e)return 0;var r=0;t=t||this.measurementSystem;if(this.shouldUseMeasurementSystem(n))t==this.MeasurementSystems.METRIC?r=e*this.ConversionFactors.MetersToKm*3600:r=e*this.ConversionFactors.MetersToMiles*3600;else switch(n){case"rowing":return this.convertRowingSpeed(e)}return r},convertFloorClimbingPace:function(e){return e*a.MpsToFeetPerMinute/a.FloorsToFeet},convertFloorsPerMinToMetersPerSecond:function(e){return e*a.FloorsToFeet*a.FeetPerMinuteToMps},convertRowingSpeed:function(e){return e*a.MpsToKph},formatSpeed:function(e){return n.formatNumber(e,{format:i.PRECISION1_NOSEP,locale:this.numberSeparator})},poolUnitToMeasurementSystem:function(e){return e=="yard"?o.STATUTE_US:e=="meter"?o.METRIC:null},personalizeSpeed:function(e,t,n){if(!e)return 0;var r=this.getWorkingSpeedType(t);switch(r){case f.Speed:case f.Flying:case f.RowingSpeed:var i=this.convertSpeed(e,this.measurementSystem,t);return this.formatSpeed(i);case f.SwimPace:var s=this.measurementSystem;return this.isLapSwimmingActivity(t)&&n&&(s=this.poolUnitToMeasurementSystem(n)||this.inferPoolMeasurementSystemFromDistance(n)),this.personalizeSwimPace(e,s);case f.FloorClimbingPace:return this.formatSpeed(e);default:return this.personalizePace(e,null,t)}},zeroDash:function(e,t){return e&&e!=="0"&&e!==0?parseFloat(e).toFixed(t):"--"},personalizeGolfSwingSpeed:function(e,t,n){return t?t==="metric_mps"?this.zeroDash(e,n):this.zeroDash(this.convertSpeed(e,t),n):this.zeroDash(this.convertSpeed(e),n)},personalizeSwimSpeed:function(e,t){var t=t||this.measurementSystem,n=this.convertSwimSpeed(e,t);return this.formatSpeed(n)},inferPoolMeasurementSystemFromDistance:function(e){return e?Math.round(e)==e?o.METRIC:o.STATUTE_US:this.measurementSystem},getSpeedTypeFromActivityType:function(e){e=e||"";if(this.isLapSwimmingActivity(e))return f.SwimPace;if(this.isOpenWaterSwimmingActivity(e))return f.SwimPace;switch(e.toLowerCase()){case"flying":return f.Flying;case"rowing":case"indoor_rowing":return f.RowingPace;case"running":case"walking":case"hiking":case"trail_running":case"street_running":case"track_running":case"treadmill_running":case"speed_walking":case"casual_walking":case"stand_up_paddleboarding":case"virtual_run":case"obstacle_run":return f.Pace;case"floor_climbing":return f.FloorClimbingPace;default:return f.Speed}},getCadenceSensorTypeFromActivityType:function(e){if(this.isLapSwimmingActivity(e)||e==="open_water_swimming"||e==="swimming")return l.Swim;switch(e){case"running":case"walking":case"hiking":case"trail_running":case"street_running":case"track_running":case"treadmill_running":case"speed_walking":case"casual_walking":return l.Ped;default:return l.Bike}},personalizeDuration:function(e,t,r){typeof t=="undefined"&&(t=!0);var s=Math.floor(e/3600),o=Math.floor(e/60-s*60),u=e-s*3600-o*60,a=Math.floor(u),f=Math.round((u-a)*1e4)/1e4,l=f>0,c=t&&l&&e<599.95;if(c&&f>=.95||!c&&f>=.5)a++,f=0;a>59&&(a=0,o++,o>59&&(o=0,s++));var h=s>0?s+":"+n.formatNumber(o,{format:i.NO_DECIMAL_PAD_2_ZEROS}):n.formatNumber(o,{format:i.NO_DECIMAL});return r?h:(c?(a+=f,h=h+":"+n.formatNumber(a,{format:i.PRECISION1_PAD_2_ZEROS,locale:this.numberSeparator})):h=h+":"+n.formatNumber(a,{format:i.NO_DECIMAL_PAD_2_ZEROS}),h)},personalizeCalories:function(e){return n.formatNumber(e*a.JoulesToKiloCal,{format:i.NO_DECIMAL,locale:this.numberSeparator})},personalizeCaloriesNotConvert:function(e){return n.formatNumber(e,{format:i.NO_DECIMAL,locale:this.numberSeparator})},convertCalories:function(e){return e*a.JoulesToKiloCal},convertCaloriesToJoules:function(e){return e/a.JoulesToKiloCal},personalizeHeartRate:function(e){return this.formatWholeNumber(e)},personalizePower:function(e){return this.formatWholeNumber(e)},personalizePowerKg:function(e){return $.formatNumber(e,{format:i.PRECISION2,locale:this.numberSeparator})},personalizeLeftRightBalance:function(e){return this.formatWholeNumber(e)},personalizeTorqueEffectiveness:function(e){return this.formatWholeNumber(e)},personalizePedalSmoothness:function(e){return this.formatWholeNumber(e)},personalizeIntensityFactor:function(e){return n.formatNumber(e,{format:i.PRECISION3,locale:this.numberSeparator})},personalizeTSS:function(e){return n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeWork:function(e){return this.formatWholeNumber(e*a.CaloriesToJoules)},personalizeStandingCount:function(e){return this.formatWholeNumber(e)},personalizeStandingTime:function(e){return e?this.personalizeDuration(e,!1):"--"},personalizePowerPhaseAngle:function(e){return e>=360?e-=360:e<0&&(e+=360),this.formatWholeNumber(e)},personalizePowerPhaseArcLength:function(e){return this.formatWholeNumber(e)},personalizePowerPhaseArcCenter:function(e){return this.formatWholeNumber(e)},personalizePlatformCenterOffset:function(e){return e<-30||e>30?"":this.formatWholeNumber(e)},personalizeCadence:function(e){return this.formatWholeNumber(e)},convertCadence:function(e,t){if(typeof e=="undefined"||e==null)return null;var n=this.getCadenceSensorTypeFromActivityType(t);return n==l.Ped?e/2:e},personalizeStrokes:function(e){return this.formatWholeNumber(e)},personalizeSwolf:function(e){return this.formatWholeNumber(e)},personalizeStrokeRate:function(e){return e},personalizeStrokeDistance:function(e){return e},personalizeVO2Max:function(e){return n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeVerticalOscillation:function(e){return n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeVerticalRatio:function(e){return $.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeGroundContactTime:function(e){return this.formatWholeNumber(e)},personalizeTrainingEffect:function(e){return n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeAvgStrideLength:function(e){return n.formatNumber(e*a.CmToMeters,{format:i.PRECISION2,locale:this.numberSeparator})},convertStrideLength:function(e){return e*a.CmToMeters},convertDistancePerStroke:function(e){return this.measurementSystem!==this.MeasurementSystems.METRIC?e*a.MetersToFeet:e},formatStrideLength:function(e){return n.formatNumber(e,{format:i.PRECISION2,locale:this.numberSeparator})},formatDistancePerStroke:function(e){return $.formatNumber(e,{format:i.PRECISION2,locale:this.numberSeparator})},convertTemperature:function(e){return e!=null?this.measurementSystem==this.MeasurementSystems.STATUTE_US?e*9/5+32:e:e},formatTemperature:function(e){return n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeTemperature:function(e){var t=this.convertTemperature(e);return t==0&&this.measurementSystem==this.MeasurementSystems.STATUTE_US&&(t=32),this.formatTemperature(t)},personalizeWindSpeed:function(e){var t=null;return this.measurementSystem==this.MeasurementSystems.METRIC?t=e:t=a.KmToMiles*e,this.formatWholeNumber(t)},getWindSpeedUnitKey:function(){return this.measurementSystem==this.MeasurementSystems.METRIC?"wind_speed_unit_metric":"wind_speed_unit_statute"},supportedMeasurementSystems:function(){var e=[];for(var t in this.MeasurementSystems)this.MeasurementSystems.hasOwnProperty(t)&&e.push(t);return e},supportedDateFormats:function(){var e=[];for(var t in this.DateFormats)this.DateFormats.hasOwnProperty(t)&&supportedSystems.push(t);return e},getDistanceUnitKey:function(e,t,n){if(this.isSwimmingActivity(e)){var r=this.measurementSystem;return n?r=this.poolUnitToMeasurementSystem(n.unitKey||n.key):this.isLapSwimmingActivity(e)&&(r=this.inferPoolMeasurementSystemFromDistance(t)),r==this.MeasurementSystems.METRIC?"distance_unit_lap_swim_metric":"distance_unit_lap_swim_statute"}return this.isDisplayInMeter(e)?"distance.meter":this.measurementSystem==this.MeasurementSystems.METRIC?"distance_unit_metric":"distance_unit_statute"},isDisplayInMeter:function(e){return this.isRowingActivity(e)},getSwimDistanceUnitKey:function(){return this.measurementSystem==this.MeasurementSystems.METRIC?"distance_unit_lap_swim_metric":"distance_unit_lap_swim_statute"},getRowingSpeedUnitKey:function(){return"speed_unit_metric"},getPoolLengthUnitKey:function(e){return e=="yard"?"pool_length_unit_statute":"pool_length_unit_metric"},getElevationUnitKey:function(){return this.getMetersFtUnitKey()},getPowerUnitKey:function(){return"max_avg_power_unit"},getPowerZoneUnitKey:function(){return"zone_unit"},getPowerBalanceUnitKey:function(){return"power_balance_unit"},getWorkUnitKey:function(){return"work_unit"},getDateFormatKey:function(){switch(this.dateFormat){case this.DateFormats.MMDDYYYY:return"MM/DD/YYYY";case this.DateFormats.DDMMYYYY:return"DD/MM/YYYY";case this.DateFormats.YYYYMMDD:return"YYYY/MM/DD";default:return"MM/DD/YYYY"}},getShortDateFormatKey:function(){switch(this.dateFormat){case this.DateFormats.MMDDYYYY:return"MM/DD";case this.DateFormats.DDMMYYYY:return"DD/MM";case this.DateFormats.YYYYMMDD:return"MM/DD";default:return"MM/DD"}},getDurationUnitKey:function(){return"activity_timer_unit"},getWeightUnitKey:function(){return this.measurementSystem==this.MeasurementSystems.METRIC?"weight_unit_metric":"weight_unit_statute"},getSpeedUnitKey:function(e){if(this.shouldUseMeasurementSystem(e))return this.measurementSystem==this.MeasurementSystems.METRIC?"speed_unit_metric":"speed_unit_statute";if(e)switch(e){case"rowing":case"indoor_rowing":return this.getRowingSpeedUnitKey()}return"speed_unit_statute"},getSwingSpeedUnitKey:function(e){if(!e)return this.measurementSystem===this.MeasurementSystems.METRIC?"speed_unit_metric":"speed_unit_statute";switch(e){case"metric_mps":return"speed_unit_metric_mps";case this.MeasurementSystems.METRIC:return"speed_unit_metric";default:return"speed_unit_statute"}},golfSpeed:function(e,t){if(t!==null){if(t==="metric_mps")return p.convertSpeedToMetersPerSecond(e);if(t===p.measurementSystem)return e;if(t===p.MeasurementSystems.METRIC&&p.measurementSystem!==p.MeasurementSystems.METRIC)return e*p.ConversionFactors.MilesToKm;if(t!==p.MeasurementSystems.METRIC&&p.measurementSystem===p.MeasurementSystems.METRIC)return e*p.ConversionFactors.KmToMiles}return e},getPaceUnitKey:function(e){if(this.shouldUseMeasurementSystem(e))return this.measurementSystem==this.MeasurementSystems.METRIC?"pace_unit_metric":"pace_unit_statute";if(e)switch(e){case"rowing":return this.getRowingPaceUnitKey();case"floor_climbing":return this.getFloorClimbingPaceUnitKey()}return"pace_unit_statute"},getSwimPaceUnitKey:function(e){var t=this.measurementSystem;return e==this.MeasurementSystems.METRIC||e==this.MeasurementSystems.STATUTE_UK||e==this.MeasurementSystems.STATUTE_UK?t=e:e&&(t=this.inferPoolMeasurementSystemFromDistance(e)),t==this.MeasurementSystems.METRIC?"swim_pace_unit_metric":"swim_pace_unit_statute"},getSwimSpeedUnitKey:function(e){var t=this.measurementSystem;return e==this.MeasurementSystems.METRIC||e==this.MeasurementSystems.STATUTE_UK||e==this.MeasurementSystems.STATUTE_UK?t=e:e&&(t=this.inferPoolMeasurementSystemFromDistance(e)),t==this.MeasurementSystems.METRIC?"swim_speed_unit_metric":"swim_speed_unit_statute"},getSpeedTypeKey:function(e,t,n){var r=this.getWorkingSpeedType(e);switch(r){case f.Pace:return this.getPaceUnitKey();case f.SwimPace:return this.isLapSwimmingActivity(e)?(n&&(t=this.poolUnitToMeasurementSystem(n.unitKey||n)),this.getSwimPaceUnitKey(t)):this.getSwimPaceUnitKey(this.measurementSystem);case f.SwimSpeed:return this.getSwimSpeedUnitKey(t);case f.RowingPace:return this.getRowingPaceUnitKey();case f.RowingSpeed:return this.getRowingSpeedUnitKey();case f.FloorClimbingPace:return this.getFloorClimbingPaceUnitKey();default:return this.getSpeedUnitKey()}},getCadenceUnitKey:function(e){var t=this.getCadenceSensorTypeFromActivityType(e);return t==l.Bike?"bike_cadence_unit":t==l.Ped?"run_cadence_unit":t==l.Swim?"cadence_unit_swim":""},getStrokesUnitKey:function(){return"strokes_unit"},getStrokeRateUnitKey:function(){return"stroke_rate_unit"},getVerticalOscillationUnitKey:function(){return"vert_oscillation_unit"},getVerticalRatioUnitKey:function(){return"percentage_unit"},getGroundContactTimeUnitKey:function(){return"ground_contact_time_unit"},getAvgStrideLengthUnitKey:function(){return"avg_stride_length_unit"},getRowingPaceUnitKey:function(){return"pace_unit_metric_rowing"},getFloorClimbingPaceUnitKey:function(){return"floors_climbing_pace_unit"},getDistancePerStrokeUnitKey:function(){return this.measurementSystem!==this.MeasurementSystems.METRIC?"height_unit_ft":"distance.meter"},getCalorieUnitKey:function(){return"calories_unit"},getTemperatureUnitKey:function(){return this.measurementSystem==this.MeasurementSystems.STATUTE_US?"temp_unit_statute":"temp_unit_metric"},getHeartRateUnitKey:function(){return"heart_rate_unit"},getPercentMaxHeartRateUnitKey:function(){return"heart_rate_percent_max_unit"},getHeartRateZoneUnitKey:function(){return"zone_unit"},getPaceLabelKey:function(){return"label_pace"},getPaceAbbrLabelKey:function(){return"label_pace_abbr"},getSwimPaceLabelKey:function(){return"label_swim_pace"},getSwimPaceAbbrLabelKey:function(){return"label_swim_pace_abbr"},getSpeedLabelKey:function(){return"label_speed"},getSpeedAbbrLabelKey:function(){return"label_speed_abbr"},getAvgSpeedLabelKey:function(){return"label_avg_speed"},getAvgMovingSpeedLabelKey:function(){return"label_avg_moving_speed"},getMaxSpeedLabelKey:function(){return"label_max_speed"},getAvgPaceLabelKey:function(){return"label_avg_pace"},getAvgSwimPaceLabelKey:function(e){return e?"label_avg_swim_pace":"label_avg_pace"},getAvgMovingPaceLabelKey:function(){return"label_avg_moving_pace"},getMaxPaceLabelKey:function(){return"label_max_pace"},getMaxSwimPaceLabelKey:function(e){return e?"label_max_swim_pace":"label_max_pace"},getFlyingSpeedLabelKey:function(){return"label_flying_speed"},getFlyingSpeedAbbrLabelKey:function(){return"label_flying_speed_abbr"},getAvgFlyingSpeedLabelKey:function(){return"label_avg_flying_speed"},getMaxFlyingSpeedLabelKey:function(){return"label_max_flying_speed"},getMovingFlyingSpeedLabelKey:function(){return"label_moving_flying_speed"},getSpeedTypeLabelKey:function(e,t,n){var r=this.getWorkingSpeedType(e);switch(r){case f.RowingSpeed:case f.Speed:if(n)return this.getSpeedAbbrLabelKey();return this.getSpeedLabelKey();case f.Flying:if(n)return this.getFlyingSpeedAbbrLabelKey();return this.getFlyingSpeedLabelKey();case f.SwimPace:if(n)return this.getSwimPaceAbbrLabelKey();return this.getSwimPaceLabelKey();default:if(n)return this.getPaceAbbrLabelKey();return this.getPaceLabelKey()}},getAvgSpeedTypeLabelKey:function(e,t){var n=this.getWorkingSpeedType(e);switch(n){case f.Speed:return this.getAvgSpeedLabelKey();case f.Flying:return this.getAvgFlyingSpeedLabelKey();default:return this.getAvgPaceLabelKey()}},getAvgMovingSpeedTypeLabelKey:function(e,t){var n=this.getWorkingSpeedType(e);switch(n){case f.Speed:return this.getAvgMovingSpeedLabelKey();case f.Flying:return this.getMovingFlyingSpeedLabelKey();default:return this.getAvgMovingPaceLabelKey()}},getMaxSpeedTypeLabelKey:function(e,t){var n=this.getWorkingSpeedType(e);switch(n){case f.Speed:return this.getMaxSpeedLabelKey();case f.Flying:return this.getMaxFlyingSpeedLabelKey();default:return this.getMaxPaceLabelKey()}},getAvgCadenceTypeLabelKey:function(e){var t=this.getCadenceSensorTypeFromActivityType(e);return t==l.Bike?"label_avg_cadence":t==l.Ped?"label_avg_cadence":t==l.Swim?"label_avg_swim_strokes":""},getMaxCadenceTypeLabelKey:function(e){var t=this.getCadenceSensorTypeFromActivityType(e);return t==l.Bike?"label_max_cadence":t==l.Ped?"label_max_cadence":""},getElevationLabelKey:function(e){var t=this.getWorkingSpeedType(e);return t===f.Flying?"label_altitude":"label_elevation"},getElevGainLabelKey:function(e,t){var n=this.getWorkingSpeedType(e);return n===f.Flying?t?"label_altitude_gain_abbr":"label_altitude_gain":t?"label_elevation_gain_abbr":"label_elevation_gain"},getElevLossLabelKey:function(e){var t=this.getWorkingSpeedType(e);return t===f.Flying?"label_altitude_loss":"label_elevation_loss"},getElevMinLabelKey:function(e){var t=this.getWorkingSpeedType(e);return t===f.Flying?"label_altitude_min":"label_min_elevation"},getElevMaxLabelKey:function(e){var t=this.getWorkingSpeedType(e);return t===f.Flying?"label_altitude_max":"label_max_elevation"},fromMillisecondsToDuration:function(e){var t=e/36e5,n=Math.floor(t),r=(t-n)*60,i=Math.floor(r),s=Math.round((r-i)*60);return s==60&&(s=0,++i==60&&(i=0,n++)),this.formatDuration(n,i,s)},formatDuration:function(e,t,r){return n.formatNumber(e,{format:"#0"})+":"+n.formatNumber(t,{format:"00"})+":"+n.formatNumber(r,{format:"00"})},formatHoursMinsSecondsPace:function(e,t,r){var i="";return e>0&&(i=n.formatNumber(e,{format:"##"})+":"),i+n.formatNumber(t,{format:"00"})+":"+n.formatNumber(r,{format:"00"})},formatWholeNumber:function(e){return e==0?0:n.formatNumber(Math.round(e),{format:"##,###",locale:this.numberSeparator})},formatDecimalNumber:function(e,t,r){if(e==0)return 0;var i="##,##0.";for(var s=0;s<t;s++)i+="0";if(r){var o=e.toString();if(o.indexOf(".")>-1){var u=o.substring(o.indexOf("."));if(u===".0"||u===".00")i="##,##0"}else i="##,##0"}return n.formatNumber(e,{format:i,locale:this.numberSeparator})},convertSpeedToMetersPerSecond:function(e){return this.measurementSystem==this.MeasurementSystems.METRIC?e*this.ConversionFactors.KphToMps:e*this.ConversionFactors.MphToMps},convertPaceToMetersPerSecond:function(e){var t=this.calculateSpeed(1,e/3600);return this.convertSpeedToMetersPerSecond(t)},convertSwimPaceToMetersPerSecond:function(e,t){return this.measurementSystem==this.MeasurementSystems.METRIC?this.convertPaceToMetersPerSecond(e*this.ConversionFactors.KmToMeters/t):this.convertPaceToMetersPerSecond(e*this.ConversionFactors.MilesToYards/t)},calculateSpeed:function(e,t){return e==0||t==0?0:e/t},isNumeric:function(e){return isNaN(parseFloat(e))?!1:!0},parseTime:function(e){var t=0,n=0;if(typeof e!="undefined"&&e!=null&&e.length>0){var r=e.split(":");r.length>2?(this.isNumeric(r[0])&&(n=parseFloat(r[0]),t+=n*3600),this.isNumeric(r[1])&&(n=parseFloat(r[1]),t+=n*60),this.isNumeric(r[2])&&(t+=parseFloat(r[2]))):r.length>1?(this.isNumeric(r[0])&&(n=parseFloat(r[0]),t+=n*60),this.isNumeric(r[1])&&(t+=parseFloat(r[1]))):this.isNumeric(r[0])&&(t+=parseFloat(r[0]))}return t},personalizeWeightWithoutConvert:function(e,t){var r=t||i.PRECISION1_NOZERO;return n.formatNumber(+e,{format:r,locale:this.numberSeparator})},personalizeWeight:function(e,t){var r=t||i.PRECISION1_NOZERO;return n.formatNumber(this.convertWeight(e),{format:r,locale:this.numberSeparator})},convertWeight:function(e){return this.measurementSystem==this.MeasurementSystems.METRIC?e*=this.ConversionFactors.GramsToKg:e*=this.ConversionFactors.GramsToLbs,+n.formatNumber(e,{format:i.PRECISION1_NOSEP_NOZERO})},convertWeightToGivenUnit:function(e,t,r){var i=r||p.NumberFormats.PRECISION1_NOZERO;return t===p.WeightUnitKeys.STATUTE?e*=p.ConversionFactors.GramsToLbs:t===p.WeightUnitKeys.STATUTE_UK?e*=p.ConversionFactors.GramsToSt:e*=p.ConversionFactors.GramsToKg,+n.formatNumber(e,{format:i})},convertWeightToGrams:function(e){return this.measurementSystem==this.MeasurementSystems.METRIC?e*this.ConversionFactors.KgToGrams:e*this.ConversionFactors.LbToGrams},convertWeightGramsToKg:function(e){return e*this.ConversionFactors.GramsToKg},convertWeightToKg:function(e){return this.measurementSystem===this.MeasurementSystems.STATUTE_US?e*this.ConversionFactors.LbToGrams*this.ConversionFactors.GramsToKg:e},convertWeightToGramsByUnit:function(e,t){return t==p.WeightUnitKeys.METRIC?e*p.ConversionFactors.KgToGrams:t==p.WeightUnitKeys.STATUTE?e*p.ConversionFactors.LbToGrams:e*p.ConversionFactors.StToGrams},convertStoneToStLbs:function(e){var t;return-(e-parseInt(e)-1)<.001?(t=0,e=Math.round(e)):(t=(e-parseInt(e))*p.ConversionFactors.StToLbs,t=p.personalizeWeightWithoutConvert(t),e=parseInt(e)),{stone:e,pounds:t}},isSwimmingActivity:function(e){return e==="swimming"||e==="lap_swimming"||e==="open_water_swimming"},isLapSwimmingActivity:function(e){return e==="lap_swimming"},isOpenWaterSwimmingActivity:function(e){return e=="swimming"||e=="open_water_swimming"},isPaddleBoardingActivity:function(e){return e&&e==="stand_up_paddleboarding"},isRowingActivity:function(e){return e&&(e==="rowing"||e==="indoor_rowing")},isFloorClimbingActivity:function(e){return e&&e==="floor_climbing"},shouldUseMeasurementSystem:function(e){return e&&(this.isRowingActivity(e)||this.isFloorClimbingActivity(e))?!1:!0},personalizeDate:function(e,t){var n=new Date(e),r=n.getFullYear().toString(),i=(n.getMonth()+1).toString(),s=n.getDate().toString();switch(t?t:this.dateFormat){case this.DateFormats.MMDDYYYY:return(i.length>1?i:"0"+i)+"/"+(s.length>1?s:"0"+s)+"/"+r;case this.DateFormats.DDMMYYYY:return(s.length>1?s:"0"+s)+"/"+(i.length>1?i:"0"+i)+"/"+r;case this.DateFormats.YYYYMMDD:return r+"/"+(i.length>1?i:"0"+i)+"/"+(s.length>1?s:"0"+s);default:return(i.length>1?i:"0"+i)+"/"+(s.length>1?s:"0"+s)+"/"+r}},personalizeDateWithShortMonth:function(e,t){var n;e instanceof Date?n=e:n=h(e).utc().toDate();var r=n.getFullYear().toString(),i=(n.getMonth()+1).toString(),s=n.getDate().toString();mm2=i.length>1?i:"0"+i,month=t.localize("month.abbr."+mm2);switch(this.dateFormat){case this.DateFormats.MMDDYYYY:return month+" "+s+", "+r;case this.DateFormats.DDMMYYYY:return s+" "+month+", "+r;case this.DateFormats.YYYYMMDD:return r+" "+month+" "+s;default:return month+" "+s+", "+r}},personalizeShortMonthDateRange:function(e,t,n,r){var i;e instanceof Date?i=e:i=new Date(e);var s;t instanceof Date?s=t:s=t;var o=i.getFullYear().toString(),u=(i.getMonth()+1).toString(),a=i.getDate().toString();u=u.length>1?u:"0"+u,u=r.localize("month.abbr."+u);var f=s.getFullYear().toString(),l=(s.getMonth()+1).toString(),c=s.getDate().toString();l=l.length>1?l:"0"+l,l=r.localize("month.abbr."+l);switch(this.dateFormat){case this.DateFormats.MMDDYYYY:return u==l&&o==f?l+" "+a+" - "+c+", "+f:!n||o==f?u+" "+a+" - "+l+" "+c+", "+f:u+" "+a+", "+o+" - "+l+" "+c+", "+f;case this.DateFormats.DDMMYYYY:return u==l&&o==f?a+" - "+c+" "+l+" "+f:!n||o==f?a+" "+u+" - "+c+" "+l+" "+f:a+" "+u+" "+o+" - "+c+" "+l+" "+f;case this.DateFormats.YYYYMMDD:return u==l&&o==f?f+" "+l+"  "+a+" - "+c:!n||o==f?f+" "+u+" "+a+" - "+l+" "+c:o+" "+u+" "+a+" - "+f+" "+l+" "+c;default:return u==l&&o==f?l+" "+a+" - "+c+", "+f:!n||o==f?u+" "+a+" - "+l+" "+c+", "+f:u+" "+a+", "+o+" - "+l+" "+c+", "+f}},personalizeDateAndTime:function(e,t){var n=new Date(e),r=n.getFullYear().toString(),i=(n.getMonth()+1).toString(),s=n.getDate().toString(),o=n.getHours().toString(),u=n.getMinutes().toString(),a=o,f="";if(!this.timeFormat||this.timeFormat!="time_twenty_four_hr"){var f=t.localize("AM");a>=12&&(a=o-12,f=t.localize("PM")),a==0&&(a=12)}var l=new Date,c=l.getFullYear().toString(),h=(l.getMonth()+1).toString(),p=l.getDate().toString(),d=r+i+s,v=c+h+p;if(d==v)return t.localize("today")+" @ "+a+":"+(u.length>1?u:"0"+u)+" "+f;mm2=i.length>1?i:"0"+i,month=t.localize("month.abbr."+mm2);var m=" @ "+a+":"+(u.length>1?u:"0"+u)+" "+f;switch(this.dateFormat){case this.DateFormats.MMDDYYYY:return month+" "+s+", "+r+m;case this.DateFormats.DDMMYYYY:return s+" "+month+", "+r+m;case this.DateFormats.YYYYMMDD:return r+" "+month+" "+s+m;default:return month+" "+s+", "+r+m}},convertDateToMBDateString:function(e){var t=e.getFullYear(),r=e.getMonth()+1,i=e.getDate(),s=e.getHours(),o=e.getMinutes(),u=e.getSeconds();return n.formatNumber(t,{format:"0000"})+"-"+n.formatNumber(r,{format:"00"})+"-"+n.formatNumber(i,{format:"00"})+" "+n.formatNumber(s,{format:"00"})+":"+n.formatNumber(o,{format:"00"})+":"+n.formatNumber(u,{format:"00"})},getWorkingSpeedType:function(e){var t=this.speedType;return e&&(t=this.getSpeedTypeFromActivityType(e)),t},convertMetersToFloors:function(e){return e/this.ConversionFactors.MetersToFloors},personalizeMonth:function(e,t){var n;e instanceof Date?n=e:n=h(e).utc().toDate();var r=(n.getMonth()+1).toString(),i=r.length>1?r:"0"+r,s=t.localize("month.abbr."+i);return s},getGroundContactBalance:function(e){e=+e.toFixed(1);var t=100-e;return{left:this.formatDecimalNumber(e,1),right:this.formatDecimalNumber(t,1)}},getStrokeDistanceUnitKey:function(){return this.getMeasurementSystem()===p.MeasurementSystems.METRIC?"distance.meter":"elevation_unit_statute"},getAverageStrokeDistance:function(e){var t;return this.measurementSystem===this.MeasurementSystems.STATUTE_US?t=e*this.ConversionFactors.MetersToFeet:t=e,t},personalizeRowingPace:function(e){var t=this.convertRowingPace(e);return this.formatPace(t)},personalizeFloorClimbingPace:function(e){if(!e)return 0;var t=this.convertFloorClimbingPace(e);return this.formatFloorClimbingPace(t)},formatFloorClimbingPace:function(e){return+n.formatNumber(e,{format:i.PRECISION1_NOSEP,locale:this.numberSeparator})},displayDistanceAsWholeNumber:function(e){return e?this.isSwimmingActivity(e)||this.isRowingActivity(e):!1},formatValueByPrecision:function(e,r,i){if(t.isUndefined(e)||t.isNull(e))return e;var s=r>0,o=(""+e).indexOf(".")>-1,u="##,##0"+(s?".":""),a=0;if(t.isUndefined(i)||t.isNull(i))i=!0;!o&&s&&(e=e.toFixed(r));for(;s&&a<r;a++)u+="0";return n.formatNumber(+e,{format:u,locale:this.numberSeparator,round:i})},convertThousandsToKiloUnits:function(e,t){var r=t||i.NO_DECIMAL;return e=Number(e)||0,e/=1e3,e=n.formatNumber(e,{format:r,locale:this.numberSeparator}),e+"k"},convertDistanceToMeters:function(e){if(isNaN(e))return 0;var t="mile";return this.getMeasurementSystem()==o.METRIC&&(t="kilometer"),c.convertToMeters(t,e)},calculateAge:function(e){return h().diff(e,"years")},formatAvgGradient:function(e){return $.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator})},personalizeFloors:function(e){if(!e)return 0;var t=this.convertFloors(e);return this.formatElevation(t)},personalizeGoalDurationPercentage:function(e){return e%1===0?""+e:p.formatDecimalNumber(e,2)},convertFloors:function(e){return this.measurementSystem===this.MeasurementSystems.STATUTE_US?e*this.ConversionFactors.FloorsToFeet:e*this.ConversionFactors.FloorsToMeters},personalizeDepth:function(e){var t=this.personalizeMetersFt(e);return t||t===0?t:"--"},getDepthUnitKey:function(){return this.getMetersFtUnitKey()},personalizeMetersFt:function(e){if(!e)return 0;var t=this.convertMetersFt(e);return this.formatMetersFt(t)},convertMetersFt:function(e){var t=0;return this.measurementSystem===this.MeasurementSystems.STATUTE_US?t=e*this.ConversionFactors.MetersToFeet:t=e,t},formatMetersFt:function(e){return this.formatWholeNumber(e)},getMetersFtUnitKey:function(){return this.measurementSystem===this.MeasurementSystems.STATUTE_US?"elevation_unit_statute":"elevation_unit_metric"},personalizeDiveWaterType:function(e,t,n){switch(e){case 0:return n.localize("water_type_fresh");case 1:return n.localize("water_type_salt");case 2:case 3:return this.personalizeWaterDensity(t)+" "+n.localize("water_density_unit");case 255:default:return"--"}},personalizeWaterDensity:function(e){return e?n.formatNumber(e,{format:i.PRECISION2,locale:this.numberSeparator}):1},personalizeDiveGas:function(e,t,n){return t===100?n.localize("gas_type_oxygen"):t===21&&e===0?n.localize("gas_type_air"):t!==21&&t!==0&&e===0?n.localize("gas_type_eanx"):e>0?n.localize("gas_type_trimix"):"--"},personalizeTankStatus:function(e,t,n){return e===0?n.localize("bottom_gas"):t===1?n.localize("deco_enabled"):t===2?n.localize("backup_only"):"--"},personalizeDiveWeight:function(e){return e?n.formatNumber(e,{format:i.PRECISION1,locale:this.numberSeparator}):"--"},personalizeSuitThickness:function(e){return e?n.formatNumber(e,{format:i.NO_DECIMAL_NOSEP,locale:this.numberSeparator}):"--"},personalizeWaterCurrentType:function(e){return e?e:"--"},personalizeWaterSurfaceCondition:function(e){return e?e:"--"},personalizePressure:function(e){return e?n.formatNumber(e,{format:i.NO_DECIMAL,locale:this.numberSeparator}):"--"},personalizePressureUnit:function(e,t){return e&&e.unitKey&&e.unitKey==="bar"?t.localize("pressure_unit_metric"):e&&e.unitKey?t.localize("pressure_unit_statute"):""},personalizeSacRate:function(e){return e?n.formatNumber(e,{format:i.PRECISION3_NOSEP_NOZERO,local:this.numberSeparator}):"--"},personalizeSacRateUnit:function(e,t,n){return typeof e=="undefined"||e===null?"":t&&t.unitKey&&t.unitKey==="bar"?n.localize("sac_rate_unit_metric"):t&&t.unitKey?n.localize("sac_rate_unit_statute"):""},personalizeVolume:function(e){return e?n.formatNumber(e,{format:i.NO_DECIMAL,locale:this.numberSeparator}):"--"},personalizeVolumeUnit:function(e,t){return e&&e.unitKey&&e.unitKey==="liter"?t.localize("volume_unit_metric"):e&&e.unitKey?t.localize("volume_unit_statute"):""},personalizeDiveWeightUnit:function(e,t){return e&&e.unitKey==="kilogram"?t.localize("weight_unit_metric"):e?t.localize("weight_unit_statute"):""},personalizerNumberOfDives:function(e){return e?n.formatNumber(e,{format:i.NO_DECIMAL_NOSEP,locale:this.numberSeparator}):"--"},personalizeDiveConservatism:function(e,n,r){return t.isUndefined(e)||t.isNull(e)||t.isUndefined(n)||t.isNull(n)?null:e===35&&n===75?r.localize("dive_conservatism_high"):e===40&&n===85?r.localize("dive_conservatism_medium"):e===45&&n===95?r.localize("dive_conservatism_low"):r.localize("dive_conservatism_custom")},personalizeVisibility:function(e){return e?n.formatNumber(e,{format:i.NO_DECIMAL_NOSEP,locale:this.numberSeparator}):"--"},personalizeVisibilityUnit:function(e,t){return e&&e.unitKey==="meter"?t.localize("distance.meter"):e?t.localize("height_unit_ft"):""}};return p.MeasurementSystems=o,p.SpeedTypes=f,p.ConversionFactors=a,p.NumberFormats=i,p.NumberSeparator=r,p.DateFormats=s,p.WeightUnitKeys=u,p.CadenceSensorTypes=l,p}),function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;n=function(e){return new n.prototype.init(e)},typeof require!="undefined"&&typeof exports!="undefined"&&typeof module!="undefined"?module.exports=n:e.Globalize=n,n.cultures={},n.prototype={constructor:n,init:function(e){return this.cultures=n.cultures,this.cultureSelector=e,this}},n.prototype.init.prototype=n.prototype,n.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},n.cultures["default"].calendar=n.cultures["default"].calendars.standard,n.cultures.en=n.cultures["default"],n.cultureSelector="en",r=/^0x[a-f0-9]+$/i,i=/^[+\-]?infinity$/i,s=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,o=/^\s+|\s+$/g,u=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},a=function(e,t){return e.substr(e.length-t.length)===t},f=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,p=arguments.length,d=!1;typeof u=="boolean"&&(d=u,u=arguments[1]||{},a=2),typeof u!="object"&&!c(u)&&(u={});for(;a<p;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;d&&i&&(h(i)||(s=l(i)))?(s?(s=!1,o=r&&l(r)?r:[]):o=r&&h(r)?r:{},u[n]=f(d,o,i)):i!==t&&(u[n]=i)}return u},l=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},c=function(e){return Object.prototype.toString.call(e)==="[object Function]"},h=function(e){return Object.prototype.toString.call(e)==="[object Object]"},p=function(e,t){return e.indexOf(t)===0},d=function(e){return(e+"").replace(o,"")},v=function(e){return isNaN(e)?NaN:Math[e<0?"ceil":"floor"](e)},m=function(e,t,n){var r;for(r=e.length;r<t;r+=1)e=n?"0"+e:e+"0";return e},g=function(e,t){var n=0,r=!1;for(var i=0,s=e.length;i<s;i++){var o=e.charAt(i);switch(o){case"'":r?t.push("'"):n++,r=!1;break;case"\\":r&&t.push("\\"),r=!r;break;default:t.push(o),r=!1}}return n},y=function(e,t){t=t||"F";var n,r=e.patterns,i=t.length;if(i===1){n=r[t];if(!n)throw"Invalid date format string '"+t+"'.";t=n}else i===2&&t.charAt(0)==="%"&&(t=t.charAt(1));return t},b=function(e,t,n){function T(e,t){var n,r=e+"";return t>1&&r.length<t?(n=c[t-2]+r,n.substr(n.length-t,t)):(n=r,n)}function N(){return h||p?h:(h=d.test(t),p=!0,h)}function C(e,t){if(w)return w[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+t}}var r=n.calendar,i=r.convert,s;if(!t||!t.length||t==="i"){if(n&&n.name.length)if(i)s=b(e,r.patterns.F,n);else{var o=new Date(e.getTime()),u=S(e,r.eras);o.setFullYear(x(e,r,u)),s=o.toLocaleString()}else s=e.toString();return s}var a=r.eras,f=t==="s";t=y(r,t),s=[];var l,c=["0","00","000"],h,p,d=/([^d]|^)(d|dd)([^d]|$)/g,v=0,m=E(),w;!f&&i&&(w=i.fromGregorian(e));for(;;){var k=m.lastIndex,L=m.exec(t),A=t.slice(k,L?L.index:t.length);v+=g(A,s);if(!L)break;if(v%2){s.push(L[0]);continue}var O=L[0],M=O.length;switch(O){case"ddd":case"dddd":var _=M===3?r.days.namesAbbr:r.days.names;s.push(_[e.getDay()]);break;case"d":case"dd":h=!0,s.push(T(C(e,2),M));break;case"MMM":case"MMMM":var D=C(e,1);s.push(r.monthsGenitive&&N()?r.monthsGenitive[M===3?"namesAbbr":"names"][D]:r.months[M===3?"namesAbbr":"names"][D]);break;case"M":case"MM":s.push(T(C(e,1)+1,M));break;case"y":case"yy":case"yyyy":D=w?w[0]:x(e,r,S(e,a),f),M<4&&(D%=100),s.push(T(D,M));break;case"h":case"hh":l=e.getHours()%12,l===0&&(l=12),s.push(T(l,M));break;case"H":case"HH":s.push(T(e.getHours(),M));break;case"m":case"mm":s.push(T(e.getMinutes(),M));break;case"s":case"ss":s.push(T(e.getSeconds(),M));break;case"t":case"tt":D=e.getHours()<12?r.AM?r.AM[0]:" ":r.PM?r.PM[0]:" ",s.push(M===1?D.charAt(0):D);break;case"f":case"ff":case"fff":s.push(T(e.getMilliseconds(),3).substr(0,M));break;case"z":case"zz":l=e.getTimezoneOffset()/60,s.push((l<=0?"+":"-")+T(Math.floor(Math.abs(l)),M));break;case"zzz":l=e.getTimezoneOffset()/60,s.push((l<=0?"+":"-")+T(Math.floor(Math.abs(l)),2)+":"+T(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":r.eras&&s.push(r.eras[S(e,a)].name);break;case"/":s.push(r["/"]);break;default:throw"Invalid date format pattern '"+O+"'."}}return s.join("")},function(){var e;e=function(e,t,n){var r=n.groupSizes,i=r[0],s=1,o=Math.pow(10,t),u=Math.round(e*o)/o;isFinite(u)||(u=e),e=u;var a=e+"",f="",l=a.split(/e/i),c=l.length>1?parseInt(l[1],10):0;a=l[0],l=a.split("."),a=l[0],f=l.length>1?l[1]:"";var h;c>0?(f=m(f,c,!1),a+=f.slice(0,c),f=f.substr(c)):c<0&&(c=-c,a=m(a,c+1,!0),f=a.slice(-c,a.length)+f,a=a.slice(0,-c)),t>0?f=n["."]+(f.length>t?f.slice(0,t):m(f,t)):f="";var p=a.length-1,d=n[","],v="";while(p>=0){if(i===0||i>p)return a.slice(0,p+1)+(v.length?d+v+f:f);v=a.slice(p-i+1,p+1)+(v.length?d+v:""),p-=i,s<r.length&&(i=r[s],s++)}return a.slice(0,p+1)+d+v+f},w=function(t,n,r){if(!isFinite(t))return t===Infinity?r.numberFormat.positiveInfinity:t===-Infinity?r.numberFormat.negativeInfinity:r.numberFormat.NaN;if(!n||n==="i")return r.name.length?t.toLocaleString():t.toString();n=n||"D";var i=r.numberFormat,s=Math.abs(t),o=-1,u;n.length>1&&(o=parseInt(n.slice(1),10));var a=n.charAt(0).toUpperCase(),f;switch(a){case"D":u="n",s=v(s),o!==-1&&(s=m(""+s,o,!0)),t<0&&(s="-"+s);break;case"N":f=i;case"C":f=f||i.currency;case"P":f=f||i.percent,u=t<0?f.pattern[0]:f.pattern[1]||"n",o===-1&&(o=f.decimals),s=e(s*(a==="P"?100:1),o,f);break;default:throw"Bad number format specifier: "+a}var l=/n|\$|-|%/g,c="";for(;;){var h=l.lastIndex,p=l.exec(u);c+=u.slice(h,p?p.index:u.length);if(!p)break;switch(p[0]){case"n":c+=s;break;case"$":c+=i.currency.symbol;break;case"-":/[1-9]/.test(s)&&(c+=i["-"]);break;case"%":c+=i.percent.symbol}}return c}}(),E=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},S=function(e,t){if(!t)return 0;var n,r=e.getTime();for(var i=0,s=t.length;i<s;i++){n=t[i].start;if(n===null||r>=n)return i}return 0},x=function(e,t,n,r){var i=e.getFullYear();return!r&&t.eras&&(i-=t.eras[n].offset),i},function(){var e,t,n,r,i,s,o;e=function(e,t){if(t<100){var n=new Date,r=S(n),i=x(n,e,r),s=e.twoDigitYearMax;s=typeof s=="string"?(new Date).getFullYear()%100+parseInt(s,10):s,t+=i-i%100,t>s&&(t-=100)}return t},t=function(e,t,n){var r,i=e.days,a=e._upperDays;return a||(e._upperDays=a=[o(i.names),o(i.namesAbbr),o(i.namesShort)]),t=s(t),n?(r=u(a[1],t),r===-1&&(r=u(a[2],t))):r=u(a[0],t),r},n=function(e,t,n){var r=e.months,i=e.monthsGenitive||e.months,a=e._upperMonths,f=e._upperMonthsGen;a||(e._upperMonths=a=[o(r.names),o(r.namesAbbr)],e._upperMonthsGen=f=[o(i.names),o(i.namesAbbr)]),t=s(t);var l=u(n?a[1]:a[0],t);return l<0&&(l=u(n?f[1]:f[0],t)),l},r=function(e,t){var n=e._parseRegExp;if(!n)e._parseRegExp=n={};else{var r=n[t];if(r)return r}var i=y(e,t).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),s=["^"],o=[],u=0,a=0,f=E(),l;while((l=f.exec(i))!==null){var c=i.slice(u,l.index);u=f.lastIndex,a+=g(c,s);if(a%2){s.push(l[0]);continue}var h=l[0],p=h.length,d;switch(h){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":d="(\\D+)";break;case"tt":case"t":d="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":d="(\\d{"+p+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":d="(\\d\\d?)";break;case"zzz":d="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":d="([+-]?\\d\\d?)";break;case"/":d="(\\/)";break;default:throw"Invalid date format pattern '"+h+"'."}d&&s.push(d),o.push(l[0])}g(i.slice(u),s),s.push("$");var v=s.join("").replace(/\s+/g,"\\s+"),m={regExp:v,groups:o};return n[t]=m},i=function(e,t,n){return e<t||e>n},s=function(e){return e.split("Â ").join(" ").toUpperCase()},o=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)t[n]=s(e[n]);return t},T=function(s,o,u){s=d(s);var a=u.calendar,f=r(a,o),l=(new RegExp(f.regExp)).exec(s);if(l===null)return null;var c=f.groups,h=null,v=null,m=null,g=null,y=null,b=0,w,E=0,S=0,x=0,T=null,N=!1;for(var C=0,k=c.length;C<k;C++){var L=l[C+1];if(L){var A=c[C],O=A.length,M=parseInt(L,10);switch(A){case"dd":case"d":g=M;if(i(g,1,31))return null;break;case"MMM":case"MMMM":m=n(a,L,O===3);if(i(m,0,11))return null;break;case"M":case"MM":m=M-1;if(i(m,0,11))return null;break;case"y":case"yy":case"yyyy":v=O<4?e(a,M):M;if(i(v,0,9999))return null;break;case"h":case"hh":b=M,b===12&&(b=0);if(i(b,0,11))return null;break;case"H":case"HH":b=M;if(i(b,0,23))return null;break;case"m":case"mm":E=M;if(i(E,0,59))return null;break;case"s":case"ss":S=M;if(i(S,0,59))return null;break;case"tt":case"t":N=a.PM&&(L===a.PM[0]||L===a.PM[1]||L===a.PM[2]);if(!N&&(!a.AM||L!==a.AM[0]&&L!==a.AM[1]&&L!==a.AM[2]))return null;break;case"f":case"ff":case"fff":x=M*Math.pow(10,3-O);if(i(x,0,999))return null;break;case"ddd":case"dddd":y=t(a,L,O===3);if(i(y,0,6))return null;break;case"zzz":var _=L.split(/:/);if(_.length!==2)return null;w=parseInt(_[0],10);if(i(w,-12,13))return null;var D=parseInt(_[1],10);if(i(D,0,59))return null;T=w*60+(p(L,"-")?-D:D);break;case"z":case"zz":w=M;if(i(w,-12,13))return null;T=w*60;break;case"g":case"gg":var P=L;if(!P||!a.eras)return null;P=d(P.toLowerCase());for(var H=0,B=a.eras.length;H<B;H++)if(P===a.eras[H].name.toLowerCase()){h=H;break}if(h===null)return null}}}var j=new Date,F,I=a.convert;F=I?I.fromGregorian(j)[0]:j.getFullYear(),v===null?v=F:a.eras&&(v+=a.eras[h||0].offset),m===null&&(m=0),g===null&&(g=1);if(I){j=I.toGregorian(v,m,g);if(j===null)return null}else{j.setFullYear(v,m,g);if(j.getDate()!==g)return null;if(y!==null&&j.getDay()!==y)return null}N&&b<12&&(b+=12),j.setHours(b,E,S,x);if(T!==null){var q=j.getMinutes()-(T+j.getTimezoneOffset());j.setHours(j.getHours()+parseInt(q/60,10),q%60)}return j}}(),N=function(e,t,n){var r=t["-"],i=t["+"],s;switch(n){case"n -":r=" "+r,i=" "+i;case"n-":a(e,r)?s=["-",e.substr(0,e.length-r.length)]:a(e,i)&&(s=["+",e.substr(0,e.length-i.length)]);break;case"- n":r+=" ",i+=" ";case"-n":p(e,r)?s=["-",e.substr(r.length)]:p(e,i)&&(s=["+",e.substr(i.length)]);break;case"(n)":p(e,"(")&&a(e,")")&&(s=["-",e.substr(1,e.length-2)])}return s||["",e]},n.prototype.findClosestCulture=function(e){return n.findClosestCulture.call(this,e)},n.prototype.format=function(e,t,r){return n.format.call(this,e,t,r)},n.prototype.localize=function(e,t){return n.localize.call(this,e,t)},n.prototype.parseInt=function(e,t,r){return n.parseInt.call(this,e,t,r)},n.prototype.parseFloat=function(e,t,r){return n.parseFloat.call(this,e,t,r)},n.prototype.culture=function(e){return n.culture.call(this,e)},n.addCultureInfo=function(e,t,n){var r={},i=!1;typeof e!="string"?(n=e,e=this.culture().name,r=this.cultures[e]):typeof t!="string"?(n=t,i=this.cultures[e]==null,r=this.cultures[e]||this.cultures["default"]):(i=!0,r=this.cultures[t]),this.cultures[e]=f(!0,{},r,n),i&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},n.findClosestCulture=function(e){var t;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];typeof e=="string"&&(e=e.split(","));if(l(e)){var n,r=this.cultures,i=e,s,o=i.length,u=[];for(s=0;s<o;s++){e=d(i[s]);var a,f=e.split(";");n=d(f[0]),f.length===1?a=1:(e=d(f[1]),e.indexOf("q=")===0?(e=e.substr(2),a=parseFloat(e),a=isNaN(a)?0:a):a=1),u.push({lang:n,pri:a})}u.sort(function(e,t){return e.pri<t.pri?1:e.pri>t.pri?-1:0});for(s=0;s<o;s++){n=u[s].lang,t=r[n];if(t)return t}for(s=0;s<o;s++){n=u[s].lang;do{var c=n.lastIndexOf("-");if(c===-1)break;n=n.substr(0,c),t=r[n];if(t)return t}while(1)}for(s=0;s<o;s++){n=u[s].lang;for(var h in r){var p=r[h];if(p.language==n)return p}}}else if(typeof e=="object")return e;return t||null},n.format=function(e,t,n){var r=this.findClosestCulture(n);return e instanceof Date?e=b(e,t,r):typeof e=="number"&&(e=w(e,t,r)),e},n.localize=function(e,t){return this.findClosestCulture(t).messages[e]||this.cultures["default"].messages[e]},n.parseDate=function(e,t,n){n=this.findClosestCulture(n);var r,i,s;if(t){typeof t=="string"&&(t=[t]);if(t.length)for(var o=0,u=t.length;o<u;o++){var a=t[o];if(a){r=T(e,a,n);if(r)break}}}else{s=n.calendar.patterns;for(i in s){r=T(e,s[i],n);if(r)break}}return r||null},n.parseInt=function(e,t,r){return v(n.parseFloat(e,t,r))},n.parseFloat=function(e,t,n){typeof t!="number"&&(n=t,t=10);var o=this.findClosestCulture(n),u=NaN,a=o.numberFormat;e.indexOf(o.numberFormat.currency.symbol)>-1&&(e=e.replace(o.numberFormat.currency.symbol,""),e=e.replace(o.numberFormat.currency["."],o.numberFormat["."])),e=d(e);if(i.test(e))u=parseFloat(e);else if(!t&&r.test(e))u=parseInt(e,16);else{var f=N(e,a,a.pattern[0]),l=f[0],c=f[1];l===""&&a.pattern[0]!=="(n)"&&(f=N(e,a,"(n)"),l=f[0],c=f[1]),l===""&&a.pattern[0]!=="-n"&&(f=N(e,a,"-n"),l=f[0],c=f[1]),l=l||"+";var h,p,v=c.indexOf("e");v<0&&(v=c.indexOf("E")),v<0?(p=c,h=null):(p=c.substr(0,v),h=c.substr(v+1));var m,g,y=a["."],b=p.indexOf(y);b<0?(m=p,g=null):(m=p.substr(0,b),g=p.substr(b+y.length));var w=a[","];m=m.split(w).join("");var E=w.replace(/\u00A0/g," ");w!==E&&(m=m.split(E).join(""));var S=l+m;g!==null&&(S+="."+g);if(h!==null){var x=N(h,a,"-n");S+="e"+(x[0]||"+")+x[1]}s.test(S)&&(u=parseFloat(S))}return u},n.culture=function(e){return typeof e!="undefined"&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures["default"]}}(this),define("globalize",function(e){return function(){var t,n;return t||e.Globalize}}(this)),function($){function decrementQueue(e){var t=$.i18n.asyncQueue[e.propertyFile];if(t){t.count--;if(t.count==0){t.loaded=!0;for(var n=0;n<t.callbacks.length;n++){var r=t.callbacks[n];r()}}}}function loadAndParseFile(e,t,n){var r=t.async==1&&typeof t.success!="undefined",i=e,s=t.cache;typeof t.cache=="string"&&(i+="?bust="+t.cache,s=!0),$.ajax({url:i,async:r,cache:s,contentType:"text/plain;charset="+t.encoding,dataType:"text",success:function(e,r){parseData(e,t.mode,n),decrementQueue(t)},error:function(e,n,r){decrementQueue(t)}})}function parseData(data,mode,priority){var parsed="",parameters=data.split(/\n/),regPlaceHolder=/(\{\d+\})/g,regRepPlaceHolder=/\{(\d+)\}/g,unicodeRE=/(\\u.{4})/ig;for(var i=0;i<parameters.length;i++){parameters[i]=parameters[i].replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(parameters[i].length>0&&parameters[i].match("^#")!="#"){var pair=parameters[i].split("=");if(pair.length>0){var name=unescape(pair[0]).replace(/^\s\s*/,"").replace(/\s\s*$/,""),value=pair.length==1?"":pair[1];while(value.match(/\\$/)=="\\")value=value.substring(0,value.length-1),value+=parameters[++i].replace(/\s\s*$/,"");for(var s=2;s<pair.length;s++)value+="="+pair[s];value=value.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(mode=="map"||mode=="both"){var unicodeMatches=value.match(unicodeRE);if(unicodeMatches)for(var u=0;u<unicodeMatches.length;u++)value=value.replace(unicodeMatches[u],unescapeUnicode(unicodeMatches[u]));var property=$.i18n.map[name];property?property.priority<priority&&(property.value=value,property.priority=priority):$.i18n.map[name]={priority:priority,value:value}}if(mode=="vars"||mode=="both"){value=value.replace(/"/g,'\\"'),checkKeyNamespace(name);if(regPlaceHolder.test(value)){var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[];for(var p=0;p<parts.length;p++)regPlaceHolder.test(parts[p])&&(usedArgs.length==0||usedArgs.indexOf(parts[p])==-1)&&(first||(fnArgs+=","),fnArgs+=parts[p].replace(regRepPlaceHolder,"v$1"),usedArgs.push(parts[p]),first=!1);parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";"+"};"}else parsed+=name+'="'+value+'";'}}}}eval(parsed)}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key)){var fullname="",names=key.split(/\./);for(var i=0;i<names.length;i++)i>0&&(fullname+="."),fullname+=names[i],eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")}}function getFiles(e){return e&&e.constructor==Array?e:[e]}function normaliseLanguageCode(e){return e=e.toLowerCase(),e.length>3&&(e=e.substring(0,3)+e.substring(3).toUpperCase()),e}function unescapeUnicode(e){var t=[],n=parseInt(e.substr(2),16);n>=0&&n<Math.pow(2,16)&&t.push(n);var r="";for(var i=0;i<t.length;++i)r+=String.fromCharCode(t[i]);return r}$.i18n={},$.i18n.map={},$.i18n.asyncQueue={},$.i18n.settings=null,$.i18n.defaults={name:"Messages",language:"",path:"",mode:"vars",cache:!1,encoding:"UTF-8",callback:null},$.i18n.properties=function(e){e=$.extend($.i18n.defaults,e);if(e.language===null||e.language=="")e.language=$.i18n.browserLang();e.language===null&&(e.language="");var t=getFiles(e.name);for(i=0;i<t.length;i++)this.loadPropertyFiles(t[i]);e.callback&&e.callback(),$.i18n.settings=e},$.i18n.loadPropertyFiles=function(e,t){var n=$.i18n.asyncQueue[e];if(n){t.success&&(n.loaded?t.success():n.callbacks.push(t.success));return}var r=$.extend({},$.i18n.settings);r=$.extend(r,t);var i=1;r.language.length>=2&&i++,r.language.length>=5&&i++,$.i18n.asyncQueue[e]={count:i,loaded:!1,callbacks:[]},t.success&&$.i18n.asyncQueue[e].callbacks.push(t.success),r.propertyFile=e,loadAndParseFile(r.path+e+".properties",r,0),this.settings.language.length>=2&&loadAndParseFile(r.path+e+"_"+r.language.substring(0,2)+".properties",r,1),this.settings.language.length>=5&&loadAndParseFile(r.path+e+"_"+r.language.substring(0,5)+".properties",r,2)},$.i18n.prop=function(e){var t=$.i18n.map[e];if(t==null)return"["+e+"]";var n=t.value,r;if(typeof n=="string"){r=0;while((r=n.indexOf("\\",r))!=-1)n[r+1]=="t"?n=n.substring(0,r)+"	"+n.substring(r++ +2):n[r+1]=="r"?n=n.substring(0,r)+"\r"+n.substring(r++ +2):n[r+1]=="n"?n=n.substring(0,r)+"\n"+n.substring(r++ +2):n[r+1]=="f"?n=n.substring(0,r)+"\f"+n.substring(r++ +2):n[r+1]=="\\"?n=n.substring(0,r)+"\\"+n.substring(r++ +2):n=n.substring(0,r)+n.substring(r+1);var i=[],s,o;r=0;while(r<n.length)if(n[r]=="{"){s=n.indexOf("}",r+1);if(s==-1)r++;else{o=parseInt(n.substring(r+1,s));if(!isNaN(o)&&o>=0){var u=n.substring(0,r);u!=""&&i.push(u),i.push(o),r=0,n=n.substring(s+1)}else r=s+1}}else r++;n!=""&&i.push(n),n=i,$.i18n.map[e].value=i}if(n.length==0)return"";if(n.lengh==1&&typeof n[0]=="string")return n[0];var u="";for(r=0;r<n.length;r++)typeof n[r]=="string"?u+=n[r]:n[r]+1<arguments.length?u+=arguments[n[r]+1]:u+="{"+n[r]+"}";return u},$.i18n.browserLang=function(){return normaliseLanguageCode(navigator.language||navigator.userLanguage)},$.i18n.containsKey=function(e){var t=$.i18n.map[e];return t!=null},$.i18n.loadAdditionalData=function(e){var t,n=0;e&&Object.keys(e).forEach(function(r,i){e[r]&&(t=$.i18n.map[r],t||($.i18n.map[r]={priority:n,value:e[r]}))})};var cbSplit;cbSplit||(cbSplit=function(e,t,n){if(Object.prototype.toString.call(t)!=="[object RegExp]")return typeof cbSplit._nativeSplit=="undefined"?e.split(t,n):cbSplit._nativeSplit.call(e,t,n);var r=[],i=0,s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":""),t=RegExp(t.source,s+"g"),o,u,a,f;e+="",cbSplit._compliantExecNpcg||(o=RegExp("^"+t.source+"$(?!\\s)",s));if(n===undefined||+n<0)n=Infinity;else{n=Math.floor(+n);if(!n)return[]}while(u=t.exec(e)){a=u.index+u[0].length;if(a>i){r.push(e.slice(i,u.index)),!cbSplit._compliantExecNpcg&&u.length>1&&u[0].replace(o,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===undefined&&(u[e]=undefined)}),u.length>1&&u.index<e.length&&Array.prototype.push.apply(r,u.slice(1)),f=u[0].length,i=a;if(r.length>=n)break}t.lastIndex===u.index&&t.lastIndex++}return i===e.length?(f||!t.test(""))&&r.push(""):r.push(e.slice(i)),r.length>n?r.slice(0,n):r},cbSplit._compliantExecNpcg=/()??/.exec("")[1]===undefined,cbSplit._nativeSplit=String.prototype.split),String.prototype.split=function(e,t){return cbSplit(this,e,t)}}(jQuery),define("i18n",["jquery"],function(){}),function(e){function t(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function n(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};r.format=function(e,i){var s=1,o=e.length,u="",a,f=[],l,c,h,p,d,v;for(l=0;l<o;l++){u=t(e[l]);if(u==="string")f.push(e[l]);else if(u==="array"){h=e[l];if(h[2]){a=i[s];for(c=0;c<h[2].length;c++){if(!a.hasOwnProperty(h[2][c]))throw r('[sprintf] property "%s" does not exist',h[2][c]);a=a[h[2][c]]}}else h[1]?a=i[h[1]]:a=i[s++];if(/[^s]/.test(h[8])&&t(a)!="number")throw r("[sprintf] expecting number but found %s",t(a));switch(h[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=h[7]?a.toExponential(h[7]):a.toExponential();break;case"f":a=h[7]?parseFloat(a).toFixed(h[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&h[7]?a.substring(0,h[7]):a;break;case"u":a>>>=0;break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(h[8])&&h[3]&&a>=0?"+"+a:a,d=h[4]?h[4]=="0"?"0":h[4].charAt(1):" ",v=h[6]-String(a).length,p=h[6]?n(d,v):"",f.push(h[5]?a+p:p+a)}}return f.join("")},r.cache={},r.parse=function(e){var t=e,n=[],r=[],i=0;while(t){if((n=/^[^\x25]+/.exec(t))!==null)r.push(n[0]);else if((n=/^\x25{2}/.exec(t))!==null)r.push("%");else{if((n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))===null)throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],u=[];if((u=/^([a-z_][a-z_\d]*)/i.exec(o))===null)throw"[sprintf] huh?";s.push(u[1]);while((o=o.substring(u[0].length))!=="")if((u=/^\.([a-z_][a-z_\d]*)/i.exec(o))!==null)s.push(u[1]);else{if((u=/^\[(\d+)\]/.exec(o))===null)throw"[sprintf] huh?";s.push(u[1])}n[2]=s}else i|=2;if(i===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r};var i=function(e,t,n){return n=t.slice(0),n.splice(0,0,e),r.apply(null,n)};e.sprintf=r,e.vsprintf=i}(typeof exports!="undefined"?exports:window),define("sprintf",function(){}),define("localizer",["require","underscore","backbone","globalize","i18n","sprintf"],function(e){var t=e("underscore"),n=e("backbone"),r=e("globalize"),i=e("i18n"),s=e("sprintf"),o={ON_LOCAL_LOADED:"LOCAL_LOADED",ON_PROPERTY_FILE_LOADED:"PROPERTY_FILE_LOADED"},u={};u.mmddyyyy="ddd, MMM d, yyyy",u.ddmmyyyy="ddd, d MMM yyyy",u.yyyymmdd="ddd, yyyy MMM d";var a={};a.mmddyyyy="MMM d, yyyy",a.ddmmyyyy="d MMM yyyy",a.yyyymmdd="yyyy MMM d";var f={};f.mmddyyyy="MMM d",f.ddmmyyyy="d MMM",f.yyyymmdd="MMM d";var l={};l.mmddyyyy="MMM yyyy",l.ddmmyyyy="MMM yyyy",l.yyyymmdd="yyyy MMM";var c={};c.mmddyyyy="MMMM d, yyyy",c.ddmmyyyy="d MMMM yyyy",c.yyyymmdd="yyyy MMMM d";var h=n.Model.extend({currentDateFormatKey:"mmddyyyy",supportedLocales:{ar:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",cs:"ÄŒeÅ¡tina",da:"Dansk",de:"Deutsch",en:"English",es:"EspaÃ±ol",fr:"FranÃ§ais",hr:"Hrvatski",it:"Italiano",iw:"×¢×‘×¨×™×ª",hu:"Magyar",nl:"Nederlands",no:"Norsk",pl:"Polski",pt_BR:"PortuguÃªs (Brasil)",pt:"PortuguÃªs",ru:"Ð ÑƒÑÑÐºÐ¸Ð¹",sk:"SlovenÄina",sl:"SlovenÅ¡Äina",fi:"Suomi",sv:"Svenska",vi:"TiÃªÌng Viá»‡t",tr:"TÃ¼rkÃ§e",el:"Î•Î»Î»Î·Î½Î¹ÎºÎ¬",ja:"æ—¥æœ¬èªž",ko:"í•œêµ­ì–´",th:"à¹„à¸—à¸¢","in":"Bahasa Indonesia",ms:"Bahasa Melayu",zh_TW:"ä¸­æ–‡ (å°ç£)",zh_CN:"ä¸­æ–‡ (ä¸­å›½)"},alternateLocales:{zh:"zh_CN"},setLocale:function(t){t=this.alternateLocales[t]||t,t=t.replace("-","_"),jQuery.i18n.properties({name:[],cache:this.urlBustValue,path:"",mode:"map",language:t});var n=!1;if(t=="en"||t=="en_US")Globalize.culture("en"),n=!0;else if(this.isLocaleSupported(t)){var r=this.getPartialSupportedLocale(t);r=this.convertLocaleToGlobalizeFormat(t);var i=this;e([this.getCultureFilePath(r)],function(){Globalize.culture(r),i.trigger(o.ON_LOCAL_LOADED)})}else Globalize.culture("en"),n=!0;n&&this.trigger(o.ON_LOCAL_LOADED)},getLocale:function(){return Globalize.culture().name||"en"},setUrlBustingParam:function(e){this.urlBustValue=e},setContextPath:function(e){this.contextPath=e},loadAdditionalData:function(e){jQuery.i18n.loadAdditionalData(e)},loadPropertyFile:function(e,t,n){var r=e;this.contextPath&&(e.charAt(0)!=="/"&&this.contextPath.charAt(this.contextPath.length-1)!=="/"?r=this.contextPath+"/"+e:e.charAt(0)==="/"&&this.contextPath.charAt(this.contextPath.length-1)==="/"?r=this.contextPath+e.slice(1):r=this.contextPath+e);var i={async:!0,success:function(){t&&t.call(n,e)}};jQuery.i18n.loadPropertyFiles(r,i)},localize:function(e){return jQuery.i18n.prop.apply(jQuery.i18n.prop,arguments)},containsKey:function(e){return jQuery.i18n.containsKey(e)},isLocaleSupported:function(e){var t=this.getPartialSupportedLocale(e);return t!=null},getPartialSupportedLocale:function(e){var n=e.split("_")[0];return n.length&&t.has(this.supportedLocales,n)?n:null},parseDateString:function(e){var t=Globalize.parseDate(e,"yyyy-MM-dd");return t==null&&(t=Globalize.parseDate(e,"yyyy-MM-dd HH:mm:ss")),t},formatDate:function(e,t){var n=e;return typeof n=="string"&&(n=this.parseDateString(e)),t||(t=u[this.currentDateFormatKey]),Globalize.format(n,t)},formatShortDate:function(e,t){var n=e;return typeof n=="string"&&(n=this.parseDateString(e)),t||(t=a[this.currentDateFormatKey]),Globalize.format(n,t)},formatShortDateNoYear:function(e,t){var n=e;return typeof n=="string"&&(n=this.parseDateString(e)),t||(t=f[this.currentDateFormatKey]),Globalize.format(n,t)},formatShortDateMonthAndYear:function(e,t){var n=e;return typeof n=="string"&&(n=this.parseDateString(e)),t||(t=l[this.currentDateFormatKey]),Globalize.format(n,t)},formatMediumDate:function(e,t){var n=e;return typeof n=="string"&&(n=this.parseDateString(e)),t||(t=c[this.currentDateFormatKey]),Globalize.format(n,t)},getCultureFilePath:function(e){return"lib/cultures/globalize.culture."+e},convertLocaleToGlobalizeFormat:function(e){return e.replace("_","-")},setCurrentDateFormatKey:function(e){this.currentDateFormatKey=e},format:function(){return s.apply(this,arguments)}});return h=new h,h.Events=o,h});var Hashtable=function(){function n(t){var r;if(typeof t=="string")return t;if(typeof t.hashCode==e)return r=t.hashCode(),typeof r=="string"?r:n(r);if(typeof t.toString==e)return t.toString();try{return String(t)}catch(i){return Object.prototype.toString.call(t)}}function r(e,t){return e.equals(t)}function i(t,n){return typeof n.equals==e?n.equals(t):t===n}function s(e){return function(t){if(t===null)throw new Error("null is not a valid "+e);if(typeof t=="undefined")throw new Error(e+" must not be undefined")}}function a(e,t,n,r){this[0]=e,this.entries=[],this.addEntry(t,n),r!==null&&(this.getEqualityFunction=function(){return r})}function h(e){return function(t){var n=this.entries.length,r,i=this.getEqualityFunction(t);while(n--){r=this.entries[n];if(i(t,r[0]))switch(e){case f:return!0;case l:return r;case c:return[n,r[1]]}}return!1}}function p(e){return function(t){var n=t.length;for(var r=0,i=this.entries.length;r<i;++r)t[n+r]=this.entries[r][e]}}function d(e,t){var n=e.length,r;while(n--){r=e[n];if(t===r[0])return n}return null}function v(e,t){var n=e[t];return n&&n instanceof a?n:null}function m(r,i){var s=this,f=[],l={},c=typeof r==e?r:n,h=typeof i==e?i:null;this.put=function(e,t){o(e),u(t);var n=c(e),r,i,s=null;return r=v(l,n),r?(i=r.getEntryForKey(e),i?(s=i[1],i[1]=t):r.addEntry(e,t)):(r=new a(n,e,t,h),f[f.length]=r,l[n]=r),s},this.get=function(e){o(e);var t=c(e),n=v(l,t);if(n){var r=n.getEntryForKey(e);if(r)return r[1]}return null},this.containsKey=function(e){o(e);var t=c(e),n=v(l,t);return n?n.containsKey(e):!1},this.containsValue=function(e){u(e);var t=f.length;while(t--)if(f[t].containsValue(e))return!0;return!1},this.clear=function(){f.length=0,l={}},this.isEmpty=function(){return!f.length};var p=function(e){return function(){var t=[],n=f.length;while(n--)f[n][e](t);return t}};this.keys=p("keys"),this.values=p("values"),this.entries=p("getEntries"),this.remove=function(e){o(e);var n=c(e),r,i=null,s=v(l,n);return s&&(i=s.removeEntryForKey(e),i!==null&&(s.entries.length||(r=d(f,n),t(f,r),delete l[n]))),i},this.size=function(){var e=0,t=f.length;while(t--)e+=f[t].entries.length;return e},this.each=function(e){var t=s.entries(),n=t.length,r;while(n--)r=t[n],e(r[0],r[1])},this.putAll=function(t,n){var r=t.entries(),i,o,u,a,f=r.length,l=typeof n==e;while(f--)i=r[f],o=i[0],u=i[1],l&&(a=s.get(o))&&(u=n(o,a,u)),s.put(o,u)},this.clone=function(){var e=new m(r,i);return e.putAll(s),e}}var e="function",t=typeof Array.prototype.splice==e?function(e,t){e.splice(t,1)}:function(e,t){var n,r,i;if(t===e.length-1)e.length=t;else{n=e.slice(t+1),e.length=t;for(r=0,i=n.length;r<i;++r)e[t+r]=n[r]}},o=s("key"),u=s("value"),f=0,l=1,c=2;return a.prototype={getEqualityFunction:function(t){return typeof t.equals==e?r:i},getEntryForKey:h(l),getEntryAndIndexForKey:h(c),removeEntryForKey:function(e){var n=this.getEntryAndIndexForKey(e);return n?(t(this.entries,n[0]),n[1]):null},addEntry:function(e,t){this.entries[this.entries.length]=[e,t]},keys:p(0),values:p(1),getEntries:function(e){var t=e.length;for(var n=0,r=this.entries.length;n<r;++n)e[t+n]=this.entries[n].slice(0)},containsKey:h(f),containsValue:function(e){var t=this.entries.length;while(t--)if(e===this.entries[t][1])return!0;return!1}},m}();define("jshashtable",function(){}),function(e){function a(e,t,n){this.dec=e,this.group=t,this.neg=n}function f(){for(var e=0;e<u.length;e++){localeGroup=u[e];for(var n=0;n<localeGroup.length;n++)t.put(localeGroup[n],e)}}function l(e,n){t.size()==0&&f();var r=".",i=",",s="-";n==0&&(e.indexOf("_")!=-1?e=e.split("_")[1].toLowerCase():e.indexOf("-")!=-1&&(e=e.split("-")[1].toLowerCase()));var u=t.get(e);if(u){var l=o[u];l&&(r=l[0],i=l[1])}return new a(r,i,s)}var t=new Hashtable,n=["ae","au","ca","cn","eg","gb","hk","il","in","jp","sk","th","tw","us"],r=["at","br","de","dk","es","gr","it","nl","pt","tr","vn"],i=["cz","fi","fr","ru","se","pl"],s=["ch"],o=[[".",","],[",","."],[","," "],[".","'"]],u=[n,r,i,s];e.fn.formatNumber=function(t,n,r){return this.each(function(){n==null&&(n=!0),r==null&&(r=!0);var i;e(this).is(":input")?i=new String(e(this).val()):i=new String(e(this).text());var s=e.formatNumber(i,t);n&&(e(this).is(":input")?e(this).val(s):e(this).text(s));if(r)return s})},e.formatNumber=function(t,n){var n=e.extend({},e.fn.formatNumber.defaults,n),r=l(n.locale.toLowerCase(),n.isFullLocale),i=r.dec,s=r.group,o=r.neg,u="0#-,.",a="",f=!1;for(var c=0;c<n.format.length;c++){if(u.indexOf(n.format.charAt(c))!=-1){if(c==0&&n.format.charAt(c)=="-"){f=!0;continue}break}a+=n.format.charAt(c)}var h="";for(var c=n.format.length-1;c>=0;c--){if(u.indexOf(n.format.charAt(c))!=-1)break;h=n.format.charAt(c)+h}n.format=n.format.substring(a.length),n.format=n.format.substring(0,n.format.length-h.length);var p=new Number(t);return e._formatNumber(p,n,h,a,f)},e._formatNumber=function(t,n,r,i,s){var n=e.extend({},e.fn.formatNumber.defaults,n),o=l(n.locale.toLowerCase(),n.isFullLocale),u=o.dec,a=o.group,f=o.neg,c=!1;if(isNaN(t)){if(n.nanForceZero!=1)return null;t=0,c=!0}r=="%"&&(t*=100);var h="";if(n.format.indexOf(".")>-1){var p=u,d=n.format.substring(n.format.lastIndexOf(".")+1);if(n.round==1)t=new Number(t.toFixed(d.length));else{var v=t.toString();v=v.substring(0,v.lastIndexOf(".")+d.length+1),t=new Number(v)}var m=t%1,g=new String(m.toFixed(d.length));g=g.substring(g.lastIndexOf(".")+1);for(var y=0;y<d.length;y++){if(d.charAt(y)=="#"&&g.charAt(y)!="0"){p+=g.charAt(y);continue}if(d.charAt(y)=="#"&&g.charAt(y)=="0"){var b=g.substring(y);if(b.match("[1-9]")){p+=g.charAt(y);continue}break}d.charAt(y)=="0"&&(p+=g.charAt(y))}h+=p}else t=Math.round(t);var w=Math.floor(t);t<0&&(w=Math.ceil(t));var E="";n.format.indexOf(".")==-1?E=n.format:E=n.format.substring(0,n.format.indexOf("."));var S="";if(w!=0||E.substr(E.length-1)!="#"||c){var x=new String(Math.abs(w)),T=9999;E.lastIndexOf(",")!=-1&&(T=E.length-E.lastIndexOf(",")-1);var N=0;for(var y=x.length-1;y>-1;y--)S=x.charAt(y)+S,N++,N==T&&y!=0&&(S=a+S,N=0);if(E.length>S.length){var C=E.indexOf("0");if(C!=-1){var k=E.length-C,L=E.length-S.length-1;while(S.length<k){var A=E.charAt(L);A==","&&(A=a),S=A+S,L--}}}}return!S&&E.indexOf("0",E.length-1)!==-1&&(S="0"),h=S+h,t<0&&s&&i.length>0?i=f+i:t<0&&(h=f+h),n.decimalSeparatorAlwaysShown||h.lastIndexOf(u)==h.length-1&&(h=h.substring(0,h.length-1)),h=i+h+r,h},e.fn.parseNumber=function(t,n,r){n==null&&(n=!0),r==null&&(r=!0);var i;e(this).is(":input")?i=new String(e(this).val()):i=new String(e(this).text());var s=e.parseNumber(i,t);if(s){n&&(e(this).is(":input")?e(this).val(s.toString()):e(this).text(s.toString()));if(r)return s}},e.parseNumber=function(t,n){var n=e.extend({},e.fn.parseNumber.defaults,n),r=l(n.locale.toLowerCase(),n.isFullLocale),i=r.dec,s=r.group,o=r.neg,u="1234567890.-";while(t.indexOf(s)>-1)t=t.replace(s,"");t=t.replace(i,".").replace(o,"-");var a="",f=!1;if(t.charAt(t.length-1)=="%"||n.isPercentage==1)f=!0;for(var c=0;c<t.length;c++)u.indexOf(t.charAt(c))>-1&&(a+=t.charAt(c));var h=new Number(a);if(f){h/=100;var p=a.indexOf(".");if(p!=-1){var d=a.length-p-1;h=h.toFixed(d+2)}else h=h.toFixed(a.length-1)}return h},e.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,isFullLocale:!1},e.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1},Number.prototype.toFixed=function(t){return e._roundNumber(this,t)},e._roundNumber=function(e,t){var n=Math.pow(10,t||0),r=String(Math.round(e*n)/n);if(t>0){var i=r.indexOf(".");i==-1?(r+=".",i=0):i=r.length-(i+1);while(i<t)r+="0",i++}return r}}(jQuery),define("numberformatter",["jshashtable","jquery"],function(){}),define("utils/date/DateFormatter",["moment","numberformatter","globalize"],function(e){function t(){}var n=null;t.DateFormats={MMDDYYYY:"mmddyyyy",DDMMYYYY:"ddmmyyyy",YYYYMMDD:"yyyymmdd"},t.TimeFormats={HOUR12:"time_twelve_hr",HOUR24:"time_twenty_four_hr"};var r=t.DateFormats.MMDDYYYY,i=null,s={};return s[t.DateFormats.MMDDYYYY]="MMMM d, yyyy",s[t.DateFormats.DDMMYYYY]="d MMMM yyyy",s[t.DateFormats.YYYYMMDD]="yyyy MMMM d",t.setDateFormat=function(e){r=e},t.setTimeFormat=function(e){i=e},t.setLocalizer=function(e){n=e},t.formatDate=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),i=e.getDate().toString();switch(r){case this.DateFormats.MMDDYYYY:return(n.length>1?n:"0"+n)+"/"+(i.length>1?i:"0"+i)+"/"+t;case this.DateFormats.DDMMYYYY:return(i.length>1?i:"0"+i)+"/"+(n.length>1?n:"0"+n)+"/"+t;case this.DateFormats.YYYYMMDD:return t+"/"+(n.length>1?n:"0"+n)+"/"+(i.length>1?i:"0"+i);default:return(n.length>1?n:"0"+n)+"/"+(i.length>1?i:"0"+i)+"/"+t}},t.formatMonthDayYear=function(e){var t=e.getFullYear().toString(),i=(e.getMonth()+1).toString(),s=e.getDate().toString(),o=i.length>1?i:"0"+i,u=n.localize("month.abbr."+o);switch(r){case this.DateFormats.MMDDYYYY:return u+" "+s+", "+t;case this.DateFormats.DDMMYYYY:return s+" "+u+" "+t;case this.DateFormats.YYYYMMDD:return t+" "+u+" "+s;default:return u+" "+s+", "+t}},t.formatMonthDay=function(e){var t=(e.getMonth()+1).toString(),i=e.getDate().toString(),s=t.length>1?t:"0"+t,o=n.localize("month.abbr."+s);switch(r){case this.DateFormats.MMDDYYYY:case this.DateFormats.YYYYMMDD:return o+" "+i;case this.DateFormats.DDMMYYYY:return i+" "+o;default:return o+" "+i}},t.formatMonthDayOptionalYear=function(n){return e(n).isBefore(e().subtract(1,"year"),"day")?t.formatMonthDayYear(n):t.formatMonthDay(n)},t.formatLongMonthDayYear=function(e){return Globalize.format(e,s[r])},t.formatDateAndTime=function(e){var t=e.getFullYear().toString(),s=(e.getMonth()+1).toString(),o=e.getDate().toString(),u=e.getHours().toString(),a=e.getMinutes().toString(),f=u,l="";i!="time_twenty_four_hr"&&(l=n.localize("AM"),f>=12&&(f=u-12,l=n.localize("PM")),f==0&&(f=12));var c=new Date,h=c.getFullYear().toString(),p=(c.getMonth()+1).toString(),d=c.getDate().toString(),v=t+s+o,m=h+p+d;if(v==m){var g=n.localize("today")+" @ "+f+":"+(a.length>1?a:"0"+a);return l&&(g+=" "+l),g}var y=s.length>1?s:"0"+s,b=n.localize("month.abbr."+y),w=" @ "+f+":"+(a.length>1?a:"0"+a);l&&(w+=" "+l);switch(r){case this.DateFormats.MMDDYYYY:return b+" "+o+", "+t+w;case this.DateFormats.DDMMYYYY:return o+" "+b+" "+t+w;case this.DateFormats.YYYYMMDD:return t+" "+b+" "+o+w;default:return b+" "+o+", "+t+w}},t.formatTimeAgo=function(t){var r=(new Date).getTime()-t.getTime(),i="",s="";if(r<36e5)i=Math.floor(r/6e4),i>1?s="minutes_ago":i<=0?(i="",s="now"):s="minute_ago";else if(r<864e5)i=Math.floor(r/36e5),i>1?s="hours_ago":s="hour_ago";else{var o=new e,u=new e(t);i=o.diff(u,"days"),i>1?s="days_ago":(i="",s="yesterday")}return n.localize(s,i)},t.formatFriendlyDate=function(r,i){function f(e){return e<7?(a="day."+r.getDay(),n.localize(a)):i?t.formatMonthDayYear(r):t.formatLongMonthDayYear(r)}var s=(new e).startOf("day"),o=(new e(r)).startOf("day"),u,a="";u=s.diff(o,"days");if(u<0){var l=o.diff(s,"days");if(l!==1)return f(l);a="tomorrow"}else if(u===0)a="today";else{if(u!==1)return f(u);a="yesterday"}return n.localize(a)},t.formatFriendlyDateAndTime=function(e,n){var r=t.formatFriendlyDate(e,n),i=t.formatLocalizeTime(e);return r+" @ "+i},t.formatTime=function(e){var r,s,o;if(i==t.TimeFormats.HOUR24)s=jQuery.formatNumber(e.getHours(),{format:"00"}),o=jQuery.formatNumber(e.getMinutes(),{format:"00"}),r=s+":"+o;else{var u=e.getHours(),a;u==0||u==12?(s=12,a=u==0?n.localize("AM"):n.localize("PM")):(s=u%12,a=u>12?n.localize("PM"):n.localize("AM")),o=jQuery.formatNumber(e.getMinutes(),{format:"00"}),r=s+":"+o+" "+a}return r},t.formatLocalizeTime=function(e){var r,s,o;if(i==t.TimeFormats.HOUR24)s=jQuery.formatNumber(e.getHours(),{format:"00"}),o=jQuery.formatNumber(e.getMinutes(),{format:"00"}),r=s+":"+o;else{var u=e.getHours(),a;u==0||u==12?(s=12,a=u==0?n.localize("AM"):n.localize("PM")):(s=u%12,a=u>12?n.localize("PM"):n.localize("AM")),o=jQuery.formatNumber(e.getMinutes(),{format:"00"}),r=s+":"+o+" "+a}return r},t.formatISODate=function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return jQuery.formatNumber(t,{format:"0000"})+"-"+jQuery.formatNumber(n,{format:"00"})+"-"+jQuery.formatNumber(r,{format:"00"})},t.formatISODateLong=function(t){return(new e(t)).toISOString()},t.formatMBTimestamp=function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return jQuery.formatNumber(t,{format:"0000"})+"-"+jQuery.formatNumber(n,{format:"00"})+"-"+jQuery.formatNumber(r,{format:"00"})+" "+jQuery.formatNumber(i,{format:"00"})+":"+jQuery.formatNumber(s,{format:"00"})+":"+jQuery.formatNumber(o,{format:"00"})},t.formatMBTimestampUTC=function(e){var t=e.getUTCFullYear(),n=e.getUTCMonth()+1,r=e.getUTCDate(),i=e.getUTCHours(),s=e.getUTCMinutes(),o=e.getUTCSeconds();return jQuery.formatNumber(t,{format:"0000"})+"-"+jQuery.formatNumber(n,{format:"00"})+"-"+jQuery.formatNumber(r,{format:"00"})+" "+jQuery.formatNumber(i,{format:"00"})+":"+jQuery.formatNumber(s,{format:"00"})+":"+jQuery.formatNumber(o,{format:"00"})},t.formatConnectTimestamp=function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds(),u=e.getMilliseconds();return jQuery.formatNumber(t,{format:"0000"})+"-"+jQuery.formatNumber(n,{format:"00"})+"-"+jQuery.formatNumber(r,{format:"00"})+"T"+jQuery.formatNumber(i,{format:"00"})+":"+jQuery.formatNumber(s,{format:"00"})+":"+jQuery.formatNumber(o,{format:"00"})+"."+jQuery.formatNumber(u,{format:"00"})},t.formatConnectTimestampUTC=function(e){var t=e.getUTCFullYear(),n=e.getUTCMonth()+1,r=e.getUTCDate(),i=e.getUTCHours(),s=e.getUTCMinutes(),o=e.getUTCSeconds(),u=e.getUTCMilliseconds();return jQuery.formatNumber(t,{format:"0000"})+"-"+jQuery.formatNumber(n,{format:"00"})+"-"+jQuery.formatNumber(r,{format:"00"})+"T"+jQuery.formatNumber(i,{format:"00"})+":"+jQuery.formatNumber(s,{format:"00"})+":"+jQuery.formatNumber(o,{format:"00"})+"."+jQuery.formatNumber(u,{format:"00"})},t}),define("utils/LocaleMapper",[],function(){var e={defaultLocales:{ar:"ar-AR",pt:"pt-PT",pt_BR:"pt-BR",pl:"pl-PL",no:"nb-NO",cs:"cs-CZ",da:"da-DK",de:"de-DE",es:"es-ES",fr:"fr-FR",hr:"hr-HR",it:"it-IT",iw:"iw-IL",hu:"hu-HU",nl:"nl-NL",nb:"nb-NO",sl:"sl-SI",sk:"sk-SK",fi:"fi-FI",sv:"sv-SE",en:"en-US",el:"el-GR",ru:"ru-RU",ja:"ja-JP",ko:"ko-KR",th:"th-TH",vi:"vi-VN",tr:"tr-TR","in":"in-ID",ms:"ms-MY",zh_CN:"zh-CN",zh_TW:"zh-TW"},formatHelpStartForExpressionEngine:function(e){var t=this;jQuery("a[href='/help/start']").each(function(){jQuery(this).attr("href","/"+t.defaultLocales[e]+"/start")})},getFullLocale:function(e){var t=this.defaultLocales[e];return typeof t=="undefined"&&(t="en-US"),t},getShortLocale:function(e){var t=this.defaultLocales[e];return typeof t=="undefined"&&(t="en"),t=t.substr(0,2),t}};return e}),jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined)n.expires=-1;if(typeof n.expires=="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return e}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null},define("jquerycookie",["jquery"],function(){}),define("models/user/UserPreferences",["backbone","personalizer","localizer","utils/date/DateFormatter","utils/LocaleMapper","jquerycookie"],function(e,t,n,r,i){var s={ON_CULTURE_READY:"ON_CULTURE_READY"},o="PrimaryGarminUserLocalePref",u="GarminLocalePref",a="LAST_DASHBOARD",f="VIEWER_SEEN_TUTORIAL",l=e.Model.extend({url:function(){var e=this.get("displayName")||"";return"/proxy/userprofile-service/userprofile/settings/"+e},initialize:function(e){this.getLocaleFromCookie=e.getLocaleFromCookie,this.bind("change",this.onFetchSuccess,this),this.migrateToNewPreferenceKey()},getDisplayName:function(){return this.get("displayName")},onFetchSuccess:function(){this.updateLocalizerAndPersonalizer()},updateLocalizerAndPersonalizer:function(){t.setMeasurementSystem(this.getMeasurementSystem()),t.setNumberSeparator(this.getNumberFormat().toUpperCase()),t.setDateFormat(this.getDateFormatKey()),t.setTimeFormat(this.getTimeFormatKey()),n.setCurrentDateFormatKey(this.getDateFormatKey()),r.setDateFormat(this.getDateFormatKey()),r.setTimeFormat(this.getTimeFormatKey()),r.setLocalizer(n)},getMeasurementSystem:function(){return this.get("measurementSystem")},getHeartRateFormatKey:function(){return this.get("heartRateFormat").formatKey},getPowerDisplayFormatKey:function(){return this.get("powerFormat").formatKey},getFirstDayOfWeek:function(){return this.get("firstDayOfWeek").dayName},getLocale:function(){var e=this.get("preferredLocale");if(this.getLocaleFromCookie){var t=jQuery.cookie(u)||e||"en";return t.substr(0,2)!="zh"&&t.substr(0,2)!="pt"&&(t=t.substr(0,2)),t}return e},getLocaleCountry:function(){var e=this.getFullLocale();if(e){var t=e.substring(e.indexOf("_")+1);return t.toLowerCase()}return"us"},getFullLocale:function(){var e=this.getLocale();return i.getFullLocale(e)},getDateFormatKey:function(){return this.get("dateFormat").formatKey},getTimeFormatKey:function(){return this.get("timeFormat").formatKey},getNumberFormat:function(){return this.get("numberFormat")},onLocaleCultureReady:function(){this.trigger(s.ON_CULTURE_READY)},getLastDashboard:function(){var e=this.getLocalStoragePreference(a);return e?e:null},setLastDashboard:function(e){this.setLocalStoragePreference(a,e)},migrateToNewPreferenceKey:function(){var e=this.getOldLocalStoragePreferenceKey(),t=localStorage[e];if(typeof t=="undefined"||t==null)return;var n=this.getLocalStoragePreferenceKey(),r=localStorage[n];if(typeof r=="undefined"||r==null)localStorage[n]=t},getOldLocalStoragePreferenceKey:function(){var e=this.get("displayName");return e?"pref-"+e:null},setPreferenceKey:function(e){this.preferenceKey=e,this.migrateToNewPreferenceKey()},getLocalStoragePreferenceKey:function(){return this.preferenceKey?"pref-"+this.preferenceKey:null},setLocalStoragePreference:function(e,t){if(typeof localStorage=="undefined")throw"No Local Storage";if(!this.getLocalStoragePreferenceKey())throw"Preference set for unauthenticated user";var n=localStorage[this.getLocalStoragePreferenceKey()];n?n=JSON.parse(n):n={},n[e]=t,n=JSON.stringify(n),localStorage[this.getLocalStoragePreferenceKey()]=n},getLocalStoragePreference:function(e){if(typeof localStorage=="undefined")throw"No Local Storage";if(!this.getLocalStoragePreferenceKey())throw"Preference retrievel for unauthenticated user";var t=localStorage[this.getLocalStoragePreferenceKey()];return typeof t=="undefined"||t==null?null:(t=JSON.parse(t),t[e])},is24HourFormat:function(){return this.get("timeFormat").formatKey==="time_twenty_four_hr"}});return l.writeLegacyLocaleCookie=function(e){function t(){var e=window.location.hostname.split(".");return e.length===3&&e.shift(),e.join(".")}e.substr(0,2)=="zh"?e=e.replace("-","_"):e=e.substr(0,2);var n=t();jQuery.cookie(o,e,{path:"/",domain:n})},l.updateLegacySessionLocale=function(e){jQuery.ajax({url:"/user/locale/"+e,type:"POST"})},l.getGroupSettingsUrl=function(e){return"/proxy/group-service/group/"+e+"/settings"},l.Events=s,l}),define("models/user/ViewerUserPreferences",["backbone","models/user/UserPreferences"],function(e,t){return typeof this.globalUserPreferencesObject=="undefined"&&(this.globalUserPreferencesObject=new t(VIEWER_USERPREFERENCES),this.globalUserPreferencesObject.updateLocalizerAndPersonalizer(),delete VIEWER_USERPREFERENCES),this.globalUserPreferencesObject}),define("models/dashboard/Dashboard",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/dashboard-service/dashboard",idAttribute:"dashboardId",initialize:function(){this.on("change:dashboardOrder",this.onOrderChanged,this)},onOrderChanged:function(){this.isNew()||this.save()},getId:function(){return this.get(this.idAttribute)}});return t}),define("collections/dashboard/Dashboards",["backbone","models/dashboard/Dashboard"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/dashboard-service/dashboards/"+this.displayName},initialize:function(e,t){this.displayName=t.displayName;if(!this.displayName)throw"displayName required for Dashboards.js"},comparator:"dashboardOrder"});return n}),define("utils/date/DateUtil",["localizer","globalize","moment"],function(e,t,n){var r=0,i={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},s=["Su","M","Tu","W","Th","F","Sa"],o={toISODateString:function(e){var t=1+e.getMonth(),n=e.getDate(),r=e.getFullYear();return r+"-"+this.pad2(t)+"-"+this.pad2(n)},toUTCDate:function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())},pad2:function(e){var t=""+e;return t.length>=2?t:t.length==1?"0"+t:"00"},getDateFromISODateString:function(e){var t=e.substring(0,4),n=+e.substring(5,7)-1,r=e.substring(8,10);return new Date(t,n,r)},getDateFromISOTimestampString:function(e){var t=e.substring(0,4),n=+e.substring(5,7)-1,r=+e.substring(8,10),i=+e.substring(11,13),s=+e.substring(14,16),o=+e.substring(17,19),u=+e.substring(20);return new Date(Date.UTC(t,n,r,i,s,o,u))},parseDateFromISOTimestampString:function(e){var t=e.substring(0,4),n=+e.substring(5,7)-1,r=+e.substring(8,10),i=+e.substring(11,13),s=+e.substring(14,16),o=+e.substring(17,19),u=+e.substring(20);return new Date(t,n,r,i,s,o,u)},addMonth:function(e){var t=e.getMonth();return t++,e.setMonth(t),e.getMonth()>t&&e.setDate(0),e},subtractMonth:function(e){var t=e.getMonth();return t--,e.setMonth(t),e.getMonth>t&&e.setDate(0),e},formatTime:function(e,t){var n;if(t){var r=this.pad2(e.getHours()),i=this.pad2(e.getMinutes());n=r+":"+i}else{var s=e.getHours(),r,o;s==0||s==12?(r=12,o=s==0?"AM":"PM"):(r=s%12,o=s>12?"PM":"AM");var i=this.pad2(e.getMinutes());n=r+":"+i+" "+o}return n},howLongAgo:function(n){var r=n;typeof r=="String"&&(r=t.parseDate(r,"yyyy-MM-dd HH:mm:ss"));var i=(new Date).getTime()-r,s="",o="";return i<36e5?(s=Math.floor(i/6e4),s>1?o="minutes_ago":s<=0?(s="",o="now"):o="minute_ago"):i<864e5?(s=Math.floor(i/36e5),s>1?o="hours_ago":o="hour_ago"):(s=Math.floor(i/864e5),s>1?o="days_ago":(s="",o="yesterday")),e.localize(o,s)},daysAgo:function(t,n){var r=864e5,i=t;typeof i=="string"&&(i=e.parseDateString(i,"yyyy-MM-dd")),typeof n!="undefined"&&n=="short"?n=".short":n="";var s=(new Date).getTime()-i,o="",u="";o=Math.floor(s/r);if(o<1)u="today";else if(o==1)u="yesterday";else{if(!(o<7))return n==".short"?e.formatShortDate(t):e.formatMediumDate(t);u="day."+i.getDay()}return e.localize(u)},getStartOfWeek:function(){return n().day(0).toDate()},getEndOfWeek:function(){var e=n().day(0).toDate();return e.setDate(e.getDate()+7),e},isToday:function(e){var t=o.getCurrentTime();return t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()},setSystemTime:function(e){r=(new Date).getTime()-e},getCurrentTime:function(){var e=new Date((new Date).getTime()-r);return e},getTimeUsingTimeZoneOffSet:function(e,t){var n=e.getTime()+e.getTimezoneOffset()*6e4,r=new Date(n+36e5*t);return r},createDateUsingTimeZoneOffSet:function(e,t,n,r,i,s,o,u){var a=new Date(e,t,n,r,i,s,o),f=-a.getTimezoneOffset(),l=u*60,c=f-l,h=new Date(a.getTime()+c*6e4);return h},getHighChartsDateFormat:function(t){var n=e.currentDateFormatKey,r=t?"%y":"%Y";switch(n){case"mmddyyyy":return"%m/%d/"+r;case"ddmmyyyy":return"%d/%m/"+r;case"yyyymmdd":return r+"/%m/%d"}return"%m/%d/"+r},findClosest:function(e,t){var n=e.length,r=e.length,i=Math.abs((new Date(0,0,0)).valueOf()),s=i,o=-i,u=0,a;for(a=0;a<e.length;++a)u=t-e[a],u<0&&u>o&&(r=a,o=u),u>=0&&u<s&&(n=a,s=u);return{bestPrevious:{index:n,date:e[n]},bestAfter:{index:r,date:e[r]}}},getDayNameOrDate:function(t,r){var i=new Date,s=n(i).diff(n(t),"days");return s<7?r?e.localize("day."+t.getDay()+"."+r):e.localize("day."+t.getDay()):t.getMonth()+1+"/"+t.getDate()},addDays:function(e,t){return n(e).add(t,"days").toDate()},isFirstDayOfMonth:function(e){return e?n(e).get("date")===1:!1}};return o.DaysOfWeek=i,o.MinWeekdayKeys=s,o}),define("models/device/MyLastUsedDevice",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/device-service/deviceservice/mylastused"});return t}),define("models/dashboard/WidgetState",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/dashboard-service/widgetInstance",defaults:{id:null,dashboardId:0,order:null,stateName:null,viewName:null,widgetDefinitionId:null,args:null},initialize:function(){this.get("args")||this.set("args",{})},setPosition:function(e,t){var n=this.get("args")||{},r=n.positions,i={};r&&(i=JSON.parse(r)),i[e]=t,i=JSON.stringify(i),i!=r&&(n.positions=i,this.set("args",n),this.isNew()||this.save())},getPosition:function(e){var t=this.get("args");if(t&&t.positions){var n=JSON.parse(t.positions)||{};return n[e]}}});return t}),define("collections/dashboard/WidgetStates",["backbone","models/dashboard/WidgetState"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/dashboard-service/dashboard/widgetInstances/"+this.dashboardId},initialize:function(e,t){if(typeof t.dashboardId=="undefined")throw"Dashboard requires dashboard Id";this.dashboardId=t.dashboardId},comparator:"order"});return n}),define("models/dashboard/WidgetDefinition",["backbone","underscore"],function(e,t){var n=e.Model.extend({defaults:{order:0,title_key:"",desc_key:"",url:null,states:[],args:[]},findState:function(e){return t.find(this.get("states"),function(t){return t.name==e},this)},findView:function(e,n){var r=null;return typeof e=="string"?r=this.findState(e):r=e,r?t.find(r.views,function(e){return e.name==n},this):null},getDefaultState:function(){var e=this.get("states");if(!e||e.length==0)return null;var t=this.findState("large-state");return t&&t.views.length>0?t:e[0]},getDefaultView:function(){var e=this.getDefaultState();if(!e)return null;if(e.views.length==0)return null;if(this.get("title_key")==="title_calendar_widget"){var t=this.findView(e,"calendarWeekView");if(t)return t}if(this.get("title_key")==="title_groups_widget"){var n=this.findView(e,"activityFeed");if(n)return n}if(this.get("title_key")==="title_sleep_widget"){var r=this.findView(e,"sleepSummary");if(r)return r}return e.views[0]}});return n}),define("collections/dashboard/WidgetDefinitions",["backbone","models/dashboard/WidgetDefinition"],function(e,t){var n=e.Collection.extend({model:t,url:function(){var e="/proxy/dashboard-service/widgetDefinitions";return this.displayName&&(e+="/"+this.displayName),e},initialize:function(e,t){this.displayName=t.displayName}});return n}),define("models/connections/UserConnection",["backbone"],function(e){var t=e.Model.extend({initialize:function(e){}});return t}),define("collections/utils/PagedCollection",["require","underscore","backbone"],function(e){var t=e("underscore"),n=e("backbone"),r={ON_MORE_MEMBERS_FETCHED:"ON_MORE_MEMBERS_FETCHED"},i=n.Collection.extend({baseUrl:null,url:function(){var e=null;return this.verb=="POST"?e=this.getBaseUrl():(e=this.getBaseUrl()+"?",this.keyword&&(e+="keyword="+this.keyword),typeof this.startIndex!="undefined"&&(e+="&start="+this.startIndex),typeof this.limit!="undefined"&&(e+="&limit="+this.limit)),e},getBaseUrl:function(){return t.isFunction(this.baseUrl)?this.baseUrl():this.baseUrl},initializePagedCollection:function(e){this.varHasMoreMembers=!0,this.sizeBeforeLastFetch=0,this.totalLength=0,this.appendMode=!0,e&&(this.keyword=e.keyword,this.startIndex=e.startIndex,this.limit=e.limit,this.shouldSort=e.sort),e.hasOwnProperty("appendMode")&&(this.appendMode=e.appendMode),typeof this.startIndex=="undefined"&&(this.startIndex=1),this.initialStartIndex=this.startIndex,this.verb=e.verb,this.verb||(this.verb="POST"),t.isBoolean(this.shouldSort)||(this.shouldSort=!0)},fetchNext:function(e){e=e||{};var t=null;e.success&&(t=e.success),this.appendMode&&(e.add=!0,e.remove=!1),e.type=this.verb,e.sort=this.shouldSort;if(this.verb==="POST"){var r={};r.start=this.startIndex,r.limit=this.limit,r.keyword=this.keyword,e.data=r,e.contentType="application/x-www-form-urlencoded; charset=UTF-8"}var i=this;e.success=function(e,n,r){i.onFetchSuccess(e,n,r),t&&t.call(i,e,n,r)},this.hasMoreMembers()&&n.Collection.prototype.fetch.call(this,e)},fetch:function(e){this.fetchNext(e)},onFetchSuccess:function(e,n,i){this.appendMode?(this.startIndex=this.length+this.initialStartIndex,this.totalLength=this.length):(this.startIndex+=this.length,this.totalLength+=this.length);if(t.isUndefined(this.limit))this.varHasMoreMembers=!1;else if(this.totalLength%this.limit!==0||this.totalLength===this.sizeBeforeLastFetch)this.varHasMoreMembers=!1;this.sizeBeforeLastFetch=this.totalLength,this.trigger(r.ON_MORE_MEMBERS_FETCHED)},hasMoreMembers:function(){return this.varHasMoreMembers}});return i.Events=r,i}),define("collections/connections/UserConnections",["require","models/connections/UserConnection","collections/utils/PagedCollection"],function(e){var t=e("models/connections/UserConnection"),n=e("collections/utils/PagedCollection"),r=1e3,i="GET";return n.extend({model:t,baseUrl:function(){return this.displayName===""?"/proxy/userprofile-service/socialProfile/connections/pagination":"/proxy/userprofile-service/socialProfile/connections/pagination/"+this.displayName},initialize:function(e,t){if(typeof t.displayName=="undefined")throw"Invalid profile display name in UserConnection.";this.limit=t.limit||r,this.verb=t.verb||i,this.displayName=t.displayName,this.initializePagedCollection({verb:this.verb,limit:this.limit,appendMode:!1})},findConnection:function(e){return this.find(function(t){return t.get("displayName")===e})},parse:function(e){return this.fullName=e.fullName,e.userConnections}})}),define("collections/connections/ViewerUserConnections",["collections/connections/UserConnections","models/user/ViewerSocialProfile"],function(e,t){var n;return typeof n=="undefined"&&t.get("displayName")&&(n=new e([],{displayName:t.get("displayName")})),n}),define("models/activity/TimeZone",["backbone"],function(e){var t=e.Model.extend({idAttribute:"key"});return t}),define("collections/activity/TimeZones",["backbone","models/activity/TimeZone"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/measurement-service-1.0/json/timezone_units/"},parse:function(e){return e.dictionary},initialize:function(){},getByKey:function(e){return this.find(function(t){return t.get("key")==e})},getOffsetByKey:function(e){var t=0;for(var n=0;n<=this.models.length;n++)if(this.models[n].get("key")==e){t=parseInt(this.models[n].get("offset"));break}return t}});return new n([])}),define("models/user/UserPreference",["backbone"],function(e){var t=e.Model.extend({urlRoot:function(){return"/proxy/userpreference-service/"},idAttribute:"key",initialize:function(e){}});return t}),define("models/system/ServiceHost",["backbone"],function(e){var t=e.Model.extend({idAttribute:"value",urlRoot:function(){return"/modern/system-service/preference/Host.connectApiHost"},parse:function(e){return e}});return t}),define("models/user/UserBiometrics",["backbone"],function(e){var t=e.Model.extend({url:function(){return"/proxy/userprofile-service/userprofile/personal-information/"+this.getDisplayName()},initialize:function(e){this.displayName=e.displayName},getDisplayName:function(){return this.displayName},getWeightInKg:function(){var e=this.get("biometricProfile");if(e&&e.weight)return Math.round(e.weight/1e3*10)/10},updateWeightInKg:function(e){var t=this.get("biometricProfile")||{};t.weight=e*1e3,this.set("biometricProfile",t)},updateWeightInLbs:function(e){var t=this.get("biometricProfile")||{};t.weight=e*453.592,this.set("biometricProfile",t)},updateWeightInSt:function(e){var t=this.get("biometricProfile")||{};t.weight=e*6350.293,this.set("biometricProfile",t)}});return t}),define("models/user/ViewerUserBiometrics",["models/user/UserBiometrics","models/user/ViewerSocialProfile"],function(e,t){return typeof this.globalUserBiometricsObject=="undefined"&&t&&(this.globalUserBiometricsObject=new e({displayName:t.getDisplayName()})),this.globalUserBiometricsObject}),define("utils/TrackedModel",["backbone"],function(e){var t=e.Model.extend({defaults:{required:!1,model:null,success:null,error:null,countError:!1},initialize:function(e){this.options=e}});return t}),define("utils/ModelSynchronizer",["backbone","utils/TrackedModel"],function(e,t){var n={SYNCHRONIZED:"SYNCHRONIZED",SYNCHRONIZE_FAILED:"SYNCHRONIZE_FAILED",ON_DOCUMENT_READY:"ON_DOCUMENT_READY"},r=e.Model.extend({initialize:function(){this.models=new e.Collection,this.eventModels=[],this.requiredModelCount=0,this.successfulFetches=0,this.isSynchronized=!1},addModel:function(e){if(!e.model)throw"Model is required.";var n=new t(e);this.models.add(n),e.required&&this.requiredModelCount++},addEvent:function(e){if(!e.model)throw"Model is required.";if(!e.event)throw"Event is required.";this.eventModels.push(e.model),this.requiredModelCount++,this.listenToOnce(e.model,e.event,this.onTrackedEvent)},fetchModels:function(){if(this.models.length==0){this.fireIfComplete();return}var e=this;jQuery(function(){e.trigger(n.ON_DOCUMENT_READY)}),this.models.each(function(t){var n=_.clone(t.options);n.success=function(n,r){return e.successFunction(t,r)},n.error=function(n,r){return e.errorFunction(t,r)},t.get("model").fetch(n)},this)},successFunction:function(e,t){e.get("required")&&(this.successfulFetches++,this.fireIfComplete());var n=e.get("success");n&&n.call(this,e,t)},errorFunction:function(e,t){e.get("required")&&(e.get("countError")?(this.successfulFetches++,this.fireIfComplete()):e.get("required")&&this.trigger(n.SYNCHRONIZE_FAILED,t));var r=e.get("error");r&&r.call(this,e,t)},onTrackedEvent:function(){this.successfulFetches++,this.fireIfComplete()},fireIfComplete:function(){if(this.successfulFetches==this.requiredModelCount)this.isSynchronized=!0,this.trigger(n.SYNCHRONIZED);else if(this.successfulFetches>this.requiredModelCount)throw"Something is wrong."},"synchronized":function(){return this.isSynchronized}});return r.Events=n,r}),define("models/system/SystemPreferences",[],function(){return this.systemPreferences||(this.systemPreferences={}),this.systemPreferences}),define("utils/extensions/OptionalDependency",["backbone","underscore"],function(e,t){function n(e,t){this.context=e,this.options=t,this.module=null}return n.Events={Fetched:"FETCHED"},n.prototype.load=function(){var e=this;this.shouldLoad()&&require([this.options.url],function(t){e.options.module=t,e.trigger(n.Events.Fetched,t)},function(t){e.trigger(n.Events.Fetched)})},n.prototype.shouldLoad=function(){return this.options.truthTest.call(this.context,this.context)},t.extend(n.prototype,e.Events),n}),define("utils/extensions/Loadable",["backbone","localizer","utils/ModelSynchronizer","utils/extensions/OptionalDependency"],function(e,t,n,r){var i={ON_DEPENDENCIES_LOADED:"ON_DEPENDENCIES_LOADED",ON_DEPENDENCIES_LOAD_FAILED:"ON_DEPENDENCIES_LOAD_FAILED"},s={provideDependencies:function(e,t){},provideCommonDependencies:function(e){},loadDependencies:function(e){},onDependenciesLoaded:function(e){},onDependenciesLoadFailed:function(e){},propertyFiles:[],optionalDependencies:[],tripCount:0,getOptionalDependency:function(e){var t=_.find(this.optionalDependencyInstances,function(t){return t.options.key==e});return t.options.module?t.options:null},getOptionalDependencies:function(e){return _.map(this.optionalDependencyInstances,function(e){return e.options})},load:function(){var e=new n;_.each(this.propertyFiles,function(t){e.addEvent({model:this,event:t,required:!0})},this),this.optionalDependencies&&this.optionalDependencies.length&&(this.optionalDependencyInstances=[],_.each(this.optionalDependencies,function(t){var n=new r(this,t);this.optionalDependencyInstances.push(n),n.shouldLoad()&&e.addEvent({model:n,event:r.Events.Fetched,required:!0})},this)),this.tripCount=0,typeof this.provideDependencies!="undefined"&&this.provideDependencies.call(this,e,this.tripCount),typeof this.provideCommonDependencies!="undefined"&&this.provideCommonDependencies.call(this,e,this.tripCount),e.bind(n.Events.SYNCHRONIZED,this.onLoadableDependenciesLoaded,this),e.bind(n.Events.SYNCHRONIZE_FAILED,this.onLoadableDependenciesFailed,this),this.loadStartTime=(new Date).getTime(),typeof this.loadDependencies!="undefined"&&this.loadDependencies.call(this,this.tripCount),e.fetchModels(),_.each(this.propertyFiles,function(e){t.loadPropertyFile(e,this.onPropertyFileLoaded,this)},this),this.optionalDependencyInstances&&this.optionalDependencyInstances.length&&_.each(this.optionalDependencyInstances,function(e){e.load()},this)},onLoadableDependenciesLoaded:function(){var e=this.onDependenciesLoaded(this.tripCount);e!=0?(this.elapsedLoadTime=(new Date).getTime()-this.loadStartTime,this.loaded=!0,this.trigger(i.ON_DEPENDENCIES_LOADED,this)):this.scheduleAdditionalFetch()},onLoadableDependenciesFailed:function(e){this.onDependenciesLoadFailed(e),this.trigger(i.ON_DEPENDENCIES_LOAD_FAILED,e)},scheduleAdditionalFetch:function(){this.tripCount++;var e=new n;typeof this.loadDependencies!="undefined"&&this.provideDependencies.call(this,e,this.tripCount),e.bind(n.Events.SYNCHRONIZED,this.onLoadableDependenciesLoaded,this),e.bind(n.Events.SYNCHRONIZE_FAILED,this.onLoadableDependenciesFailed,this),typeof this.loadDependencies!="undefined"&&this.loadDependencies.call(this,this.tripCount),e.fetchModels()},onPropertyFileLoaded:function(e){this.trigger(e)},isLoaded:function(){return typeof this.elapsedLoadTime!="undefined"&&this.elapsedLoadTime!=null}};return s.Loadable={},s.Loadable.Events=i,s}),define("utils/sync/CachePolicies",[],function(){var e={OneSecond:1e3,TwoSeconds:2e3,FiveSeconds:5e3,TenSeconds:1e4,ThirtySeconds:3e4,OneMinute:6e4,FiveMinutes:3e5,TenMinutes:6e5,OneHour:36e5,OneDay:864e5,OneWeek:6048e5,OneMonth:262974e4,OneYear:315569e5},t={};return t["/proxy/activity-service-1.0/gpolyline/activity/\\d+\\?full=true"]={cacheTimeoutMs:e.OneWeek,persistToDisk:!1},t["/proxy/activity-service-1.2/json/activityDetails/\\d+\\?maxSize=\\d+"]={cacheTimeoutMs:e.OneWeek,persistToDisk:!1},t["/proxy/activitylist-service/activities/comments/\\S*\\?start=\\d+&limit=\\d+"]={cacheTimeoutMs:e.TenSeconds},t["/proxy/activity-service/activity/eventTypes"]={cacheTimeoutMs:e.OneDay,persistToDisk:!1},t["/proxy/activity-service/activity/activityTypes"]={cacheTimeoutMs:e.OneDay,persistToDisk:!1},t["/proxy/userstats-service/statistics/availability/\\S*"]={cacheTimeoutMs:e.FiveMinutes,persistToDisk:!1},t["/proxy/userstats-service/wellness/averageMovingSteps/\\S*\\?calendarDate=\\S*"]={cacheTimeoutMs:e.FiveMinutes,persistToDisk:!1},t["/proxy/activitylist-service/activities/comments/subscriptionFeed?&start=\\d+&limit=\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/course-service/segment/findSegmentsMatchedByActivity?activityId=\\d+"]={cacheTimeoutMs:e.FiveMinutes,persistToDisk:!1},t["/proxy/userstats-service/leaderboard/activity/connection\\?&start=\\d+&limit=\\d+&metricId=\\d+&startDate=\\S*&endDate=\\S*&actTypeId=\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/user/[^/]+$"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/club-type\\S*"]={cacheTimeoutMs:e.OneMonth,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/flex-type"]={cacheTimeoutMs:e.OneMonth,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/user/\\S*/swing-session/stats"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/swing-session/\\d+/stats"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/user/\\S*/club"]={cacheTimeoutMs:e.TenSeconds,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/user/\\S*/shot/stats"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/scorecard/\\d+/shot/stats"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/user/\\S*/course/\\d+/shot/stats"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t["/proxy/usersummary-service/usersummary/list/\\S*\\?start=\\d+&limit=\\d+&maxDate=\\d+"]={cacheTimeoutMs:e.TenSeconds,persistToDisk:!1},t["/proxy/usersummary-service/usersummary/weekAverageRestingHR/\\S*\\?calendarDate=\\d+"]={cacheTimeoutMs:e.TenSeconds,persistToDisk:!1},t["/proxy/device-service/deviceregistration/devices"]={cacheTimeoutMs:e.TenSeconds,persistToDisk:!1},t["/proxy/activitylist-service/activities/fordailysummary/\\S*\\?calendarDate=\\d+"]={cacheTimeoutMs:e.ThirtySeconds,persistToDisk:!1},t["/proxy/wellness-service/wellness/dailyHeartRate/\\S*\\?date=\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/userstats-service/wellness/weekly/\\S*\\?fromWeekStartDate=\\d+&untilWeekStartDate=\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/calendar-service/group/\\d+/year/\\d+/month/\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/calendar-service/group/\\d+/year/\\d+/month/\\d+/day/\\d+/start/\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/calendar-service/year/\\d+/month/\\d+/day/\\d+/start/\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/personalrecord-service/personalrecordtype/prtypes/\\S*"]={cacheTimeoutMs:e.OneDay,persistToDisk:!1},t["/proxy/device-service/deviceservice/device-info/active/\\S*"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/gear-service/gear/types"]={cacheTimeoutMs:e.OneDay,persistToDisk:!1},t["/proxy/metrics-service/metrics/maxmet/latest/\\d+"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/wellness-service/wellness/dailyStress/\\d+"]={cacheTimeoutMs:e.OneMinute,persistToDisk:!1},t["/proxy/wellness-service/wellness/dailySleepData/\\S*\\?date=\\d+"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/activity-service/activity/\\d+/exerciseSets"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/v2/leaderboard/player/latest"]={cacheTimeoutMs:e.TenSeconds,persistToDisk:!1},t["/proxy/gcs-golfcommunity/api/v2/leaderboard/player/played"]={cacheTimeoutMs:e.FiveSeconds,persistToDisk:!1},t["/proxy/omt/CourseViewData"]={cacheTimeoutMs:e.TenMinutes,persistToDisk:!1},t}),define("lib/request-header",["require","jquery"],function(e){var t=e("jquery");t.ajaxSetup({headers:{NK:"NT"}})}),define("utils/sync/ConnectSync",["underscore","backbone","lib/request-header"],function(e,t){function n(e){return e.substr(0,7)=="/proxy/"?"/modern"+e:e}var r={create:"POST",update:"PUT",patch:"PUT","delete":"DELETE",read:"GET"};return t.sync=function(i,s,o){var u=r[i],a=t.emulateHTTP;typeof s.emulateHTTP!="undefined"&&(a=s.emulateHTTP),e.defaults(o||(o={}),{emulateHTTP:a,emulateJSON:t.emulateJSON});var f={type:u,dataType:"json"};o.url?(f.url=n(o.url)||urlError(),o.url=f.url):f.url=n(e.result(s,"url"))||urlError(),o.data==null&&s&&(i==="create"||i==="update"||i==="patch")&&(f.contentType="application/json",f.data=JSON.stringify(o.attrs||s.toJSON(o))),o.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{});if(o.emulateHTTP&&(u==="PUT"||u==="DELETE"||u==="PATCH")){f.type="POST",o.emulateJSON&&(f.data._method=u);var l=o.beforeSend;o.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",u);if(l)return l.apply(this,arguments)}}f.type!=="GET"&&!o.emulateJSON&&(f.processData=!1),f.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(f.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var c=o.xhr=t.ajax(e.extend(f,o));return s.trigger("request",s,c,o),c},t.sync}),define("utils/sync/LocalCache",["underscore","backbone","utils/sync/CachePolicies","utils/sync/ConnectSync"],function(e,t,n){function o(e){if(!r)return;typeof console!="undefined"&&typeof console.log!="undefined"&&console.log((new Date).toString()+" - "+e)}function u(e){o("Cache hit: "+e.url)}function a(e){o("Cache expired: "+e.url)}function f(e){for(var t in n)if(n.hasOwnProperty(t)&&e.match(t))return n[t];return null}function l(e,t){return{url:e,resp:t,timestamp:(new Date).getTime(),pendingUpdate:!1,waitList:[]}}function c(e,t){if(e.persistToDisk)try{localStorage[t.url]=JSON.stringify(t)}catch(n){localStorage.clear()}else{var r=s.indexOf(t);r>-1?s[r]=t:s.push(t)}}function h(t,n){if(!t.persistToDisk)return e.find(s,function(e){return e.url===n});var r=localStorage[n];return r?JSON.parse(r):null}function p(t,n){n.pendingUpdate&&e.each(n.waitList,function(e){e.error("Timeout exceeded.")}),a(n),t.persistToDisk?localStorage.removeItem(n.url):s=e.reject(s,function(e){return e===n})}function d(e,t){var n=(new Date).getTime()-t.timestamp;return t.pendingUpdate&&n>12e4?!0:n>e.cacheTimeoutMs}var r=!0,i=t.sync,s=[];return t.sync=function(t,n,r){if(t=="read"){var s=r.url||e.result(n,"url");if(s){var o=f(s);if(o){var a=h(o,s);if(a){if(!d(o,a)){a.pendingUpdate?a.waitList.push({success:r.success,error:r.error}):(u(a),r.success(a.resp));return}p(o,a)}a=l(s,null),a.pendingUpdate=!0,c(o,a);var v=r.success;r.success=function(t){v(t),e.each(a.waitList,function(e){u(a),e.success(t)},this),a.resp=t,a.pendingUpdate=!1,a.waitList=[],c(o,a)};var m=r.error;r.error=function(t){m(t),e.each(a.waitList,function(e){e.error(t)},this),a.pendingUpdate=!1,a.waitList=[],p(o,a)}}}}return i(t,n,r)},t.sync}),define("models/system/SystemPreference",["backbone"],function(e){var t=e.Model.extend({idAttribute:"value",urlRoot:function(){return"/modern/system-service/preference/"+this.preferenceKey},initialize:function(e){if(!e.preferenceKey)throw new Error("preferenceKey is required");this.preferenceKey=e.preferenceKey},parse:function(e){return e}});return t});if(Garmin==undefined)var Garmin={};var detectableWithVB=!1,PluginDetect={init:function(){navigator.userAgent.indexOf("MSIE")!=-1&&navigator.userAgent.indexOf("Win")!=-1&&(document.writeln('<script language="VBscript">'),document.writeln("'do a one-time test for a version of VBScript that can handle this code"),document.writeln("detectableWithVB = False"),document.writeln("If ScriptEngineMajorVersion >= 2 then"),document.writeln("  detectableWithVB = True"),document.writeln("End If"),document.writeln("'this next function will detect most plugins"),document.writeln("Function detectActiveXControl(activeXControlName)"),document.writeln("  on error resume next"),document.writeln("  detectActiveXControl = False"),document.writeln("  If detectableWithVB Then"),document.writeln("     detectActiveXControl = IsObject(CreateObject(activeXControlName))"),document.writeln("  End If"),document.writeln("End Function"),document.writeln("</script>"))},canDetectPlugins:function(){return detectableWithVB||navigator.plugins&&navigator.plugins.length>0?!0:!1},detectFlash:function(){var e=PluginDetect.detectPlugin("Shockwave","Flash");return!e&&detectableWithVB&&(e=detectActiveXControl("ShockwaveFlash.ShockwaveFlash.1")),e},detectGarminCommunicatorPlugin:function(){var e=PluginDetect.detectPlugin("Garmin Communicator");return!e&&detectableWithVB&&(e=detectActiveXControl("GARMINAXCONTROL.GarminAxControl_t.1")),e},detectPlugin:function(){var e=PluginDetect.detectPlugin.arguments,t=!1;if(navigator.plugins&&navigator.plugins.length>0){var n=navigator.plugins.length;for(pluginsArrayCounter=0;pluginsArrayCounter<n;pluginsArrayCounter++){var r=0;for(namesCounter=0;namesCounter<e.length;namesCounter++)(navigator.plugins[pluginsArrayCounter].name.indexOf(e[namesCounter])>=0||navigator.plugins[pluginsArrayCounter].description.indexOf(e[namesCounter])>=0)&&r++;if(r==e.length){t=!0;break}}}return t}};PluginDetect.init(),function(e){function t(){return this.events=[],this.init()}t.prototype.init=function(){return this},t.prototype.on=function(e,t,n){this.events.hasOwnProperty(e)||(this.events[e]=[]);var r=typeof n=="object"?n:arguments.callee.caller;this.getEvents(e,t,r).length||this.events[e].push({name:e,func:t,context:r})},t.prototype.off=function(e,t,n){var r=this.getEvents(e,t,n);if(r.length)for(var i=0,s=r.length;i<s;i++)for(var o in this.events[e])this.events[e].hasOwnProperty(o)&&r[i]===this.events[e][o]&&delete this.events[e][o]},t.prototype.getEvents=function(e,t,n){var r=[];if(this.events.hasOwnProperty(e))for(var i in this.events[e])if(this.events[e].hasOwnProperty(i)){var s=this.events[e][i],o=!0,u=!0;n&&typeof n=="object"&&(o=n===s.context?!0:!1),t&&typeof t=="function"&&(u=t===s.func?!0:!1),u&&o&&r.push(s)}return r},t.prototype.trigger=function(e){if(e&&e.length&&this.events.hasOwnProperty(e)){var t=[];for(var n=1,r=arguments.length;n<r;n++)t[n-1]=arguments[n];for(var n in this.events[e])if(this.events[e].hasOwnProperty(n)){var i=this.events[e][n];i.func.apply(i.context,t)}}};if(!e.garminEvent){e.garminEvent=new t(this);var n=function(){e.garminEvent.trigger("document:ready")};typeof window.jQuery!="undefined"?jQuery(document).ready(n):typeof window.contentLoaded!="undefined"&&contentLoaded(window,n)}}(window),function(e,t,n){function r(){this.init()}r.prototype.init=function(){this.cookieName="GarminGlobalStorage"},r.prototype.getCookie=function(e){return e},r.prototype.getGlobal=function(e){return e=e&&e.length?"global."+e:"global",this._get(e)},r.prototype.getApplication=function(e){return e=e&&e.length?"application."+e:"application",this._get(e)},r.prototype._get=function(e){var t=this._getStore(),n=e.split(".");for(var r=0,i=n.length;r<i;r++){var s=n[r];if(!t.hasOwnProperty(s))return!1;t=t[s]}return t},r.prototype.setGlobal=function(e,t){return e=e&&e.length?"global."+e:"global",this._set(e,t)},r.prototype.setApplication=function(e,t){return e=e&&e.length?"application."+e:"application",this._set(e,t)},r.prototype._set=function(e,t){var n=this._getStore(),r=e.split(".");for(var i=0,s=r.length;i<s;i++){var o=r[i];i==s-1?n[o]=t:n.hasOwnProperty(o)?n=n[o]:n=n[o]={}}return this._setStore()},r.prototype.delGlobal=function(e){return e=e&&e.length?"global."+e:"global",this._del(e)},r.prototype.delApplication=function(e){return e=e&&e.length?"application."+e:"application",this._del(e)},r.prototype._del=function(e){var t=this._getStore(),n=e.split(".");for(var r=0,i=n.length;r<i;r++){var s=n[r];r==i-1?delete t[s]:t.hasOwnProperty(s)?t=t[s]:t=t[s]={}}return this._setStore()},r.prototype._getStore=function(){var e=this.getCookie(this.cookieName);return this.data=e?JSON.parse(e):{},this.data},r.prototype._setStore=function(){var e=this.data;return this.setCookie(this.cookieName,JSON.stringify(e),3650),e},r.prototype.getCookie=function(e){var n=t.cookie.split(";");for(var r=0,i=n.length;r<i;r++){var s=n[r].split("="),o=s[0].replace(/^\s+|\s+$/g,"");if(o==e)return unescape(s[1])}},r.prototype.setCookie=function(e,n,r){var i=new Date;i.setDate(i.getDate()+r);var s=escape(n)+(r==null?"":"; expires="+i.toUTCString()+";domain=.garmin.com;path=/");t.cookie=e+"="+s};if(!("garminGlobalStore"in e)){e.garminGlobalStore={};try{e.garminGlobalStore=new r}catch(i){}}}(window,document),function(e,t,n){function r(){this.init()}r.prototype.init=function(){var e=this.detectEnvironment();for(key in e)this[key]=e[key]},r.prototype.detectEnvironment=function(){var r=this.env={user:{},browser:{},os:{},device:{},global:{}},i=navigator.platform,s=navigator.userAgent.toLowerCase(),o=this.browser(s);r.device.touch="ontouchstart"in t?"supported":"unavailable",r.device.screen={pixelRatio:0},screen&&screen.height&&screen.width&&(r.device.screen.resolution={x:screen.width,y:screen.height}),e.devicePixelRatio&&(r.device.screen.pixelRatio=e.devicePixelRatio);if(/^Win/i.test(i)){r.os.vendor="Microsoft",r.os.family="Windows",r.os.arch=32,r.browser.arch=32,r.device.cpu="Intel",r.device.type="desktop",r.os.nameFull=r.os.vendor+" "+r.os.family,/win64|x64/i.test(s)&&(r.os.arch=64,r.browser.arch=64),/wow64/i.test(s)&&(r.os.arch=64,r.browser.arch=32),/;?\s*?arm;?/i.test(s)&&(r.device.cpu="arm");if(/windows nt \d\.\d/i.test(s)){h=s.match(/windows nt (\d+)\.(\d+)/i),r.os.version=h[1]+"."+h[2],r.os.versionFull=r.os.version,r.os.versionMajor=h[1],r.os.versionMinor=h[2];var u={5:["2000","XP"],6:["Vista",7,8,"8.1"]};r.os.name="Windows "+u[h[1]][h[2]],r.os.nameFull+=" "+u[h[1]][h[2]]+" "+r.os.arch+"bit"}}else if(/^Mac/i.test(i)){r.os.vendor="Apple",r.os.family="Mac",r.os.arch=32,r.device.cpu=i.substr(3),r.device.type="desktop",r.os.nameFull=r.os.vendor+" "+r.os.family;if(/mac os x \d+.\d+/i.test(s)){r.os.name="OS X",h=s.match(/mac os x (\d+).(\d+)(?:.(\d+))?/i),r.os.version=h[1]+"."+h[2],r.os.versionFull=r.os.version,typeof h[3]!="undefined"&&(r.os.versionFull+="."+h[3]),r.os.versionMajor=h[1],r.os.versionMinor=h[2],r.os.versionRevision=h[3];if(r.os.versionMajor>10||r.os.versionMajor==10&&r.os.versionMinor>5)r.os.arch=64;var l=["Cheetah","Puma","Jaguar","Panther","Tiger","Leopard","Snow Leopard","Lion","Mountain Lion","Mavericks"];r.os.alias=l[h[2]],r.os.nameFull+=" "+r.os.name,typeof r.os.alias!="undefined"&&(r.os.nameFull+=" "+r.os.alias),r.os.nameFull+=" (v"+r.os.versionFull+") "+r.os.arch+"bit"}}else if(/^Linux/i.test(i)){r.device.cpu=i.substr(6),r.os.family="Linux",r.device.type="desktop",r.os.nameFull=r.os.family;var c=s.match(/android/i);if(c){r.os.vendor="Google";var h=s.match(/android ([\d\.]*)/i);h&&(r.os.version=h[1]),r.device.type=/mobile/i.test(s)?"mobile":"tablet",r.os.name="Android",r.os.nameFull+=" "+r.os.name,h&&(r.os.nameFull+=" v"+r.os.version)}}else if(/^iPhone/i.test(i)){r.os.vendor="Apple",r.os.family="Mac",r.os.name="iOS",r.device.name="iPhone/iPod",r.device.type="mobile",r.os.nameFull=r.os.vendor+" "+r.os.family+" "+r.os.name;var h=s.match(/iphone os ([\d\.\_]*)/i);h&&(r.os.version=h[1].split(/\D/).splice(0,2).join("."),r.os.nameFull+=" (v"+r.os.version+")")}else if(/^iPad/i.test(i)){r.os.vendor="Apple",r.os.family="Mac",r.os.name="iOS",r.device.name="iPad",r.device.type="tablet",r.os.nameFull=r.os.vendor+" "+r.os.family+" "+r.os.name;var h=s.match(/os ([\d\.\_]*)/i);h&&(r.os.version=h[1].split(/\D/).splice(0,2).join("."),r.os.nameFull+=" (v"+r.os.version+")")}r.device.type=r.device.cpu=="arm"&&r.device.type=="desktop"?"tablet":r.device.type,r.browser.activeX=!1,r.browser.userAgent=s,r.browser.metro=!1,r.browser.majorVersion=parseInt(o.version,10),r.browser.version=o.version,r.browser.engineVersion=o.engineVersion;if(o.msie===!0){r.browser.name="Internet Explorer",r.browser.engine="trident",r.browser.activeX="ActiveXObject"in e?"supported":"unavailable";if(r.browser.activeX==="supported")try{new ActiveXObject("htmlfile")}catch(p){r.browser.activeX="unavailable"}}else o.chrome===!0?(r.browser.name="Chrome",r.browser.engine=o.webkit===!0?"webkit":null):o.safari===!0?(r.browser.name="Safari",r.browser.engine=o.webkit===!0?"webkit":null):o.mozilla===!0&&(r.browser.name="Firefox",r.browser.engine=o.gecko===!0?"gecko":null);r.browser.nameFull=typeof r.browser.name!="undefined"?r.browser.name:"Unknown",r.browser.nameFull+=typeof r.browser.version!="undefined"?" v"+r.browser.version:"";var d=[];typeof r.browser.engine!="undefined"&&(d.push(r.browser.engine),typeof r.browser.engineVersion!="undefined"&&d.push("v"+r.browser.engineVersion)),d.length&&(r.browser.nameFull+=" ("+d.join(" ")+")"),r.browser.nameFull+=" "+r.browser.arch+"bit";var v={isIntel:/^Intel/i.test(r.device.cpu),isPPC:/^PPC/i.test(r.device.cpu),isArm:/^ARM/i.test(r.device.cpu),isWindows:r.os.family=="Windows",isMac:r.os.family=="Mac",isLinux:r.os.family=="Linux",is32bit:r.os.arch==32,is64bit:r.os.arch==64,is32bitBrowser:r.browser.arch==32,is64bitBrowser:r.browser.arch==64,isWebkit:r.browser.engine=="webkit",isGecko:r.browser.engine=="gecko",isTrident:r.browser.engine=="trident",isFirefox:r.browser.name=="Firefox",isChrome:r.browser.name=="Chrome",isSafari:r.browser.name=="Safari",isMSIE:r.browser.name=="Internet Explorer",isMobile:r.device.type=="mobile"||r.device.type=="tablet",isDesktop:r.device.type=="desktop",isTablet:r.device.type=="tablet",isMetro:!1,isTouch:r.device.touch==="supported",activeX:r.browser.activeX==="supported",isRetina:r.device.screen.pixelRatio>=2};for(key in v)r[key]=v[key];r.hasGCP=n,r.isGCPBlocked=n;try{if(typeof PluginDetect!="undefined"){var m=PluginDetect.detectGarminCommunicatorPlugin();r.hasGCP=m;var g=(r.isChrome||r.isSafari)&&r.hasGCP?this._isGCPBlocked:function(){return!1};r.isGCPBlocked=g,r.browser.gcp={installed:m,blocked:g}}}catch(p){}if(r.isWindows&&r.os.versionMajor==6&&r.os.versionMinor>=2)if(r.isMSIE)r.activeX===!1&&"ActiveXObject"in e&&(r.isMetro=!0,r.browser.metro=!0,r.os.nameFull+=" Metro");else if(r.isChrome){var y=!1;for(plugin in navigator.plugins)if(navigator.plugins[plugin].filename=="npGoogleUpdate3.dll"){y=!0;break}y||(r.isMetro=!0,r.browser.metro=!0)}else r.isFirefox&&navigator.plugins.length===0&&(r.isMetro=!0,r.browser.metro=!0);return this.osLocale(),r.user.language=r.os.language?r.os.language:"",r.user.country=r.os.country?r.os.country:"",r.user.locale=r.os.locale?r.os.locale:"",r.user.localeSrc="system",this.browserLocale(),r.browser.locale&&(r.user.language=r.browser.language?r.browser.language:"",r.user.country=r.browser.country?r.browser.country:"",r.user.locale=r.browser.locale?r.browser.locale:"",r.user.localeSrc="browser"),this.globalLocale(),r.global.locale&&(r.user.language=r.global.language?r.global.language:"",r.user.country=r.global.country?r.global.country:"",r.user.locale=r.global.locale?r.global.locale:"",r.user.localeSrc="global"),r},r.prototype._isGCPBlocked=function(){var e=this.env,n=!1,r=t.createElement("object");return r.setAttribute("type","application/vnd-garmin.mygarmin"),r.style.height="0",r.style.width="0",t.body.appendChild(r),typeof r.VersionXml=="undefined"&&(n=!0),t.body.removeChild(r),n},r.prototype.osLocale=function(){var e=this.env,t="";!t&&navigator.systemLanguage&&navigator.systemLanguage.length&&(t=navigator.systemLanguage);if(t.length&&typeof t=="string"){var n=t.split(/_|-/);n.length>1?(e.os.language=n[0].toLowerCase(),e.os.country=n[1].toUpperCase(),e.os.locale=e.os.language+"-"+e.os.country):n.length==1&&(e.os.language=n[0].toLowerCase(),e.os.locale=e.os.language)}},r.prototype.browserLocale=function(){var e=this.env,t="";!t&&navigator.userLanguage&&navigator.userLanguage.length&&(t=navigator.userLanguage),!t&&navigator.systemLanguage&&navigator.systemLanguage.length&&(t=navigator.systemLanguage),!t&&navigator.language&&navigator.language.length&&(t=navigator.language);if(t.length&&typeof t=="string"){var n=t.split(/_|-/);n.length>1?(e.browser.language=n[0].toLowerCase(),e.browser.country=n[1].toUpperCase(),e.browser.locale=e.browser.language+"-"+e.browser.country):n.length==1&&(e.browser.language=n[0].toLowerCase(),e.browser.locale=e.browser.language)}},r.prototype.globalLocale=function(){var t=this.env,n=e.garminGlobalStore.getGlobal("locale");if(n&&typeof n=="string"){var r=n.split(/_|-/);r.length>1?(t.global.language=r[0].toLowerCase(),t.global.country=r[1].toUpperCase(),t.global.locale=t.global.language+"-"+t.global.country):r.length==1&&(t.global.language=r[0].toLowerCase(),t.global.locale=t.global.language)}},r.prototype.requestLocale=function(e){var t=this.env,n=t.browser.request=t.browser.request?t.browser.request:{};if(e){var r=e.split(/_|-/);r.length>1?(n.language=r[0].toLowerCase(),n.country=r[1].toUpperCase(),n.locale=n.language+"-"+n.country):r.length==1&&(n.language=r[0].toLowerCase(),n.locale=n.language),t.user.language=n.language?n.language:"",t.user.country=n.country?n.country:"",t.user.locale=n.locale?n.locale:"",t.user.localeSrc="request"}},r.prototype.getRequestInfo=function(n){var r=this.env,i=this;try{e.garminEvent.on("garminHost:requestInfo:ready",n),e.parseHttpHeader=function(t){i.setRequestLocale(t),i.setRequestOrigin(t),e.garminEvent.trigger("garminHost:requestInfo:ready",!0)};var s=t.createElement("script");s.src="//services.garmin.com/request-header",s.onerror=function(){e.garminEvent.trigger("garminHost:locale:ready",!1),e.garminEvent.trigger("garminHost:origin:ready",!1),e.garminEvent.trigger("garminHost:requestInfo:ready",!1)},t.getElementsByTagName("head")[0].appendChild(s)}catch(o){}},r.prototype.setRequestLocale=function(t){if(t&&t.HTTP_ACCEPT_LANGUAGE){var n=t.HTTP_ACCEPT_LANGUAGE.split(/,\s*/)[0].split(/;/)[0];this.requestLocale(n)}e.garminEvent.trigger("garminHost:locale:ready",!0)},r.prototype.setRequestOrigin=function(t){var n=this.env;t&&t.origin&&(n.device.net={throughput:t.origin.throughput,bandwidth:t.origin.bw},delete t.origin.throughput,delete t.origin.bw,n.device.location=t.origin),e.garminEvent.trigger("garminHost:origin:ready",!0)},r.prototype.browser=function(t){var n={};n.trident=!1,n.msie=!1;var r=t.match(/(gecko|webkit|trident)\/([\d\.\_]*)/i);r&&r.length==3&&(n.webkit=/webkit/i.test(r[1]),n.gecko=/gecko/i.test(r[1]),n.trident=/trident/i.test(r[1]),n.engine=r[1].toLowerCase(),n.engineVersion=r[2]);var i=t.match(/(chrome|safari|firefox)\/([\d\.\_]*)/i);if(i&&i.length==3)n.chrome=/chrome/i.test(i[1]),n.safari=/safari/i.test(i[1]),n.mozilla=/firefox/i.test(i[1]),n.version=i[2];else if(e.ActiveXObject||n.trident)n.msie=!0,version=t.match(/(?:msie|rv:)\s*([\d\.\_]*)/i),version&&(n.version=version[1]);return n};if(!("garminHost"in e)){e.garminHost={};try{e.garminHost=new r}catch(i){}}}(window,document),define("garminhost",["jquery"],function(){}),define("text",["module"],function(e){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,i=typeof location!="undefined"&&location.href,s=i&&location.protocol&&location.protocol.replace(/\:/,""),o=i&&location.hostname,u=i&&(location.port||undefined),a=[],f=e.config(),l,c;return l={version:"2.0.0",strip:function(e){if(e){e=e.replace(n,"");var t=e.match(r);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var e,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(n=0;n<3;n++){r=t[n];try{e=new ActiveXObject(r)}catch(i){}if(e){t=[r];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=l.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r){n=t?l.strip(n):n,f.isBuild&&(a[e]=n),r(n)},load:function(e,t,n,r){if(r.isBuild&&!r.inlineText){n();return}f.isBuild=r.isBuild;var a=l.parseName(e),c=a.moduleName+"."+a.ext,h=t.toUrl(c),p=f.useXhr||l.useXhr;!i||p(h,s,o,u)?l.get(h,function(t){l.finishLoad(e,a.strip,t,n)},function(e){n.error&&n.error(e)}):t([c],function(e){l.finishLoad(a.moduleName+"."+a.ext,a.strip,e,n)})},write:function(e,t,n,r){if(a.hasOwnProperty(t)){var i=l.jsEscape(a[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=l.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";l.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},l.write(e,o,n,i)},i)}},typeof process!="undefined"&&process.versions&&!!process.versions.node?(c=require.nodeRequire("fs"),l.get=function(e,t){var n=c.readFileSync(e,"utf8");n.indexOf("ï»¿")===0&&(n=n.substring(1)),t(n)}):l.createXhr()?l.get=function(e,t,n){var r=l.createXhr();r.open("GET",e,!0),f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):t(r.responseText))},r.send(null)}:typeof Packages!="undefined"&&(l.get=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),l}),define("text!templates/main/BetaTestersSurveyBanner.html",[],function(){return'<div class="row-fluid">\n    <div class="span12 center">\n        <p>Have you ever wanted to influence future Garmin products? Now you can.\n            <a class="survey-link" href="https://www.questionpro.com/t/ABNiNZbDED" target="_blank">Join our research panel</a>!\n            <span class="icon-close js-close-survey-banner"></span>\n        </p>\n    </div>\n</div>'}),define("views/main/BetaTestersSurveyBanner",["require","underscore","backbone","models/user/UserPreference","models/system/SystemPreference","utils/extensions/Loadable","garminhost","text!templates/main/BetaTestersSurveyBanner.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("models/user/UserPreference"),i=e("models/system/SystemPreference"),s=e("utils/extensions/Loadable"),o=e("garminhost"),u=e("text!templates/main/BetaTestersSurveyBanner.html"),a=n.View.extend(s),f=a.extend({template:t.template(u),events:{"click .js-close-survey-banner":"closeSurvey","click a.survey-link":"closeSurvey"},initialize:function(){this.globalDisplaySurvey=new r({key:"BetaTestersSurveyBanner.displayed"}),this.userCompletedSurvey=new r({key:"BetaTestersSurveyBanner.2.user.done"})},provideDependencies:function(e){e.addModel({model:this.globalDisplaySurvey,required:!0}),e.addModel({model:this.userCompletedSurvey,required:!0})},onDependenciesLoaded:function(){this.displayBanner()},displayBanner:function(){window.garminHost.getRequestInfo(function(){var e=this.globalDisplaySurvey.get("value")==="true",t=this.userCompletedSurvey.get("value")==="true",n=window.garminHost.env.device.location.internal,r=window.garminHost.env.device.location.country_code||window.garminHost.user.country,i=r==="US";e&&!t&&!n&&i&&this.render()}.bind(this))},render:function(){this.$el.html(this.template()),$("body").addClass("show-takeover")},closeSurvey:function(){this.userCompletedSurvey.set("value","true"),this.userCompletedSurvey.save(),this.$el.html(""),$("body").removeClass("show-takeover")}});return f}),define("utils/tour/base/TourStep",["underscore","backbone","localizer"],function(e,t,n){return t.View.extend({headerKey:"",iconClass:"",bodyTemplate:"",prerequisitesMet:function(){return!0},performAction:function(){},cleanup:function(){},provideModels:function(){return{}},render:function(){var t=e.template(this.bodyTemplate),r=this.provideModels();r.Localizer=n,this.$el.html(t(r))},setZIndex:function(e,t){e.each(function(e,n){var r=jQuery(n),i=r.css("z-index");i&&r.data("originalz",i),r.css({"z-index":t})})},resetZIndex:function(e){e.each(function(e,t){var n=jQuery(t),r=n.data("originalz");r&&(n.css({"z-index":r}),n.removeData("originalz"))})}})}),define("text!utils/tour/templates/TourSlideShowView.html",[],function(){return'<div class="modal-header">\n</div>\n<div class="modal-body">\n\n</div>\n<div class="modal-footer">\n    <div class="control">\n        <% if (isFirstStep) {                                       %>\n            <i class="icon-arrow-left previous disabled"></i>\n        <% } else {                                                 %>\n            <i class="icon-arrow-left previous"></i>\n        <% }                                                        %>\n\n        <% if (isLastStep) {                                        %>\n            <i class="icon-arrow-right next disabled"></i>\n        <% } else {                                                 %>\n            <i class="icon-arrow-right next"></i>\n        <% }                                                        %>\n\n    </div>\n    <div class="end-tour">\n        <button type="button" class="" data-dismiss="modal" aria-hidden="true">\n            <% if (isLastStep) {                                        %>\n                <span ><%= Localizer.localize(\'tour.close_tour\') %></span>\n            <% } else {                                                 %>\n                <span><%= Localizer.localize(\'tour.skip_tour\') %></span>\n            <% }                                                        %>\n        </button>\n    </div>\n</div>\n<div class="bottom-line">\n    <div class="color-1"></div>\n    <div class="color-2"></div>\n    <div class="color-3"></div>\n    <div class="color-4"></div>\n    <div class="color-5"></div>\n    <div class="color-6"></div>\n</div>\n\n'}),define("text!utils/tour/templates/WhatsNewTourTemplate.html",[],function(){return'<div class="modal-header">\n</div>\n<div class="modal-content-container">\n  <div class="modal-variable-content">\n    \n  </div>\n  <div class="modal-footer">\n    <div class="pull-left new-feature-dots">\n      <% for (var i=0; i<numSteps; i++) {\n          if (stepIndex === i) { %>\n              <div class="feature-link active" data-step-index=<%= i %>></div>\n          <% } else { %>\n              <div class="feature-link" data-step-index=<%= i %>></div>\n          <%  }\n      } %>\n    </div>\n    <% if (isLastStep) { %>\n      <a href="#" data-dismiss="modal" class="control next pull-right view-next-feature done"><%=Localizer.localize("chart.power.mav.custom.done.label")%></a>\n    <% } else {%>\n      <a href="#" class="control next pull-right view-next-feature"><%=Localizer.localize("next")%></a>\n    <% } %>\n  </div>\n</div><!--end modal-content-container-->\n'}),define("utils/tour/views/TourSlideShowView",["underscore","backbone","localizer","utils/tour/base/TourStep","text!utils/tour/templates/TourSlideShowView.html","text!utils/tour/templates/WhatsNewTourTemplate.html"],function(e,t,n,r,i,s){var o={Next:"NEXT",Previous:"PREVIOUS",Closed:"CLOSED",MoveToStep:"MOVE_TO_STEP"},u={FISRT_TIME:"firstTime",WHATS_NEW:"whatsnew"},a=t.View.extend({firstTimeTemplate:e.template(i),whatsNewTemplate:e.template(s),events:{"click .previous":"onPreviousButtonClicked","click .next":"onNextButtonClicked","click .feature-link":"onFeatureLinkBulletClicked",click:"onTourSlideShowClicked"},onTourSlideShowClicked:function(e){e.preventDefault(),e.stopPropagation()},onPreviousButtonClicked:function(e){e.preventDefault(),this.trigger(o.Previous)},onNextButtonClicked:function(e){e.preventDefault(),this.trigger(o.Next)},onFeatureLinkBulletClicked:function(e){var t=$(e.target).data("step-index");this.trigger(o.MoveToStep,t)},initialize:function(e){this.tourId=e.tourId,this.tourStep=e.tourStep,this.numSteps=e.numSteps,this.stepIndex=e.stepIndex,this.tourHeader=e.tourHeader,this.tourClasses=e.tourClasses,this.tourContainerBackgroundColor=e.tourContainerBackgroundColor,this.tourName=e.tourName;if(!this.tourStep)throw"Tour step required by TourSlideShowView";if(!this.tourId)throw"Tour Id required by TourSlideShowView";if(typeof this.numSteps=="undefined")throw"numSteps required by TourSlideShowView";if(typeof this.stepIndex=="undefined")throw"stepIndex required by TourSlideShowView"},setTourStep:function(e,t){this.tourStep&&this.tourStep.remove(),this.tourStep=e,this.stepIndex=t},render:function(){if(!this.rendered){this.renderContent(),this.$el.addClass(this.tourClasses),jQuery("body").append(this.$el),this.$el.modal("show"),this.tourContainerBackgroundColor&&jQuery(".modal-backdrop").css({background:this.tourContainerBackgroundColor});var e=this;this.$el.on("hidden.bs.modal",function(t){e.hideModal()}),this.rendered=!0}else this.renderContent()},hideModal:function(){this.trigger(o.Closed),this.remove()},getTourTemplate:function(e){switch(e){case u.FISRT_TIME:return this.firstTimeTemplate;case u.WHATS_NEW:return this.whatsNewTemplate;default:throw"Please provide a valid tour name!"}},renderContent:function(){var e=this.getTourTemplate(this.tourName);this.$el.html(e({Localizer:n,headerText:n.localize(this.tourStep.headerKey),isLastStep:this.stepIndex==this.numSteps-1,isFirstStep:this.stepIndex==0,iconClass:this.tourStep.iconClass,numSteps:this.numSteps,stepIndex:this.stepIndex})),this.tourStep.render(),this.renderTourBodyContent(),this.$(".modal-header").append(this.tourHeader)},renderTourBodyContent:function(){switch(this.tourName){case u.WHATS_NEW:this.$(".modal-variable-content").append(this.tourStep.el);break;default:this.$(".modal-body").append(this.tourStep.el)}},cleanup:function(){}});return a.Events=o,a}),define("utils/tour/TourController",["backbone","utils/extensions/Loadable","utils/tour/views/TourSlideShowView"],function(e,t,n){var r=e.Model.extend(t),i=r.extend({propertyFiles:["/main/js/properties/tour/tour","/main/js/properties/activity-api/activity-api"],initialize:function(e){this.tour=e.tour,this.stepIndex=0;if(!this.tour)throw"tour object required for TourController"},getCurrentTourStep:function(){return this.tour.tourSteps[this.stepIndex]},start:function(){this.load()},onDependenciesLoaded:function(){var e=this;this.tour.loadStepsPreferences?this.tour.on("STEPS_LOADED",function(){e.renderSlideShow()}):this.renderSlideShow()},renderSlideShow:function(){this.tour.tourSteps=_.reject(this.tour.tourSteps,function(e){return!e.prerequisitesMet()});if(!this.tour.tourSteps.length)return;var e=this.getCurrentTourStep();this.tourSlideShowView=new n({tourId:this.tour.id,tourStep:e,tourHeader:this.tour.getTourHeader(e),tourClasses:this.tour.tourClasses,tourName:this.tour.tourName,tourContainerBackgroundColor:this.tour.tourContainerBackgroundColor,numSteps:this.tour.tourSteps.length,stepIndex:this.stepIndex}),this.tourSlideShowView.on(n.Events.Next,this.next,this),this.tourSlideShowView.on(n.Events.Previous,this.previous,this),this.tourSlideShowView.on(n.Events.Closed,this.close,this),this.tourSlideShowView.on(n.Events.MoveToStep,this.moveToStep,this),this.tourSlideShowView.render()},next:function(){this.stepIndex<this.tour.tourSteps.length-1&&this.moveToStep(this.stepIndex+1)},previous:function(){this.stepIndex>0&&this.moveToStep(this.stepIndex-1)},moveToStep:function(e){var t=this.getCurrentTourStep();t.cleanup(),this.stepIndex=e,t=this.getCurrentTourStep(),this.tourSlideShowView.setTourStep(t,this.stepIndex),this.tourSlideShowView.render(),t.performAction()},close:function(){var e=this.getCurrentTourStep();e.cleanup(),this.stepIndex=0,this.tour=null,this.tourSlideShowView.remove()}});return i}),define("text!utils/tour/templates/WhatsNewTourHeader.html",[],function(){return'<div class="new-features-title pull-left"><%= headerText %></div>\n<button type="button" class="pull-right close-me" data-dismiss="modal" aria-hidden="true">\n	<i class=<%= iconClass %> ></i>\n</button>'}),define("utils/tour/tour_steps/whatsnew/WhatsNewStep",["underscore","backbone","utils/tour/base/TourStep"],function(e,t,n){return n.extend({headerKey:"whats.new.title",initialize:function(e){if(!e)throw"Please provide arguments";this.bodyTemplate=e.template},prerequisitesMet:function(){return!0},performAction:function(){},cleanup:function(){}})}),define("utils/tour/tours/WhatsNewUserTour",["underscore","localizer","utils/LocaleMapper","models/user/UserPreference","models/user/ViewerUserPreferences","text!utils/tour/templates/WhatsNewTourHeader.html","utils/ModelSynchronizer","utils/tour/tour_steps/whatsnew/WhatsNewStep"],function(e,t,n,r,i,s,o,u){var a={STEPS_LOADED:"STEPS_LOADED"},f="proxy/dashboard-service/whatsnew/{locale}/{index}",l=Backbone.View.extend({initialize:function(){this.numOfPagesPref=new r({key:"WhatsNew.pageCount"}),this.stepTemplateUrlPref=new r({key:"WhatsNew.templateUrlFormat"}),this.loadStepsPreferences(),this.tourSteps=[],this.id="whats-new",this.tourName="whatsnew",this.tourClasses="modal new-features hide fade in"},loadStepsPreferences:function(){var e=new o;e.addModel({model:this.numOfPagesPref,required:!0}),e.addModel({model:this.stepTemplateUrlPref,required:!0}),e.bind(o.Events.SYNCHRONIZED,this.contentPrefsReceived,this),e.fetchModels()},contentPrefsReceived:function(){var e=this.numOfPagesPref.get("value")||0,t=n.getFullLocale(i.getLocale()),r=[],s=this,o=f.replace(/\{locale}/,t);for(var u=0;u<e;u++){var l=this.retriveStepHTMLData(o.replace(/\{index}/,u));l.done(function(e,t){this.getTourStep(t,e)}.bind(this,u)),r.push(l)}this.stepsDef=jQuery.when.apply(this,r).done(function(){s.trigger(a.STEPS_LOADED)})},retriveStepHTMLData:function(e){return jQuery.ajax({url:e,type:"GET"})},getTourStep:function(e,t){this.tourSteps[t]=new u({template:e})},getTourHeader:function(n){return e.template(s)({headerText:t.localize(n.headerKey),iconClass:"icon-close"})}});return l.Events=a,l}),define("utils/NavigationUtil",["backbone"],function(e){function n(t,n,r,i){typeof r=="undefined"&&(r=!0),typeof i=="undefined"&&(i=!1);if(n&&(n.ctrlKey||n.metaKey))return;return n&&n.preventDefault(),e.history.navigate(t,{trigger:r,replace:i}),!0}var t="/modern";return{url:function(e){if(e.indexOf(t)<0)return t+e},navigate:function(e,t,r){return n(e,t,r)},anchorTagHandler:function(e,r){var i=jQuery(e.currentTarget),s=i.attr("href");if(s&&s.substr(0,t.length)==t)return n(s.substr(t.length),e,r)},getHostUrl:function(){return window.location.protocol+"//"+window.location.host},displayNoPrivilegesPage:function(){Window.App.displayNoPrivilegesPage()},displayPageNotFoundPage:function(){Window.App.displayPageNotFoundPage()}}}),define("text!templates/main/Modal/ModalPopupView.html",[],function(){return'<% if (showHeader) { %>\r\n    <div class="modal-header">\r\n        <% if (showCloseButton) { %>\r\n        <button type="button" class="close js-close" aria-hidden="true">&times;</button>\r\n        <% } %>\r\n\r\n        <% if (customHeaderAction) { %>\r\n            <h3 class="js-custom-header-action"><%~ customHeaderAction %></h3>\r\n        <% } %>\r\n\r\n        <h3 class="js-modal-header-title"><%~ modalTitle %></h3>\r\n    </div>\r\n<% }                            %>\r\n\r\n<div class="modal-body <%= customBodyClasses %>">\r\n\r\n</div>\r\n\r\n<% if (showFooter) {            %>\r\n    <div class="modal-footer">\r\n\r\n    </div>\r\n<% }                            %>\r\n\r\n'}),define("text!templates/main/Modal/defaultFooterTemplate.html",[],function(){return'<% if (showCancelButton) { %>\n    <a href="#" class="btn btn-secondary cancel" data-dismiss="modal"><%= Localizer.localize(cancel_text_key) %></a>\n<% } %>\n<a href="#" class="btn btn-primary js-saveBtn <%=footerPrimaryButtonClasses%>"><%= Localizer.localize(confirmation_text_key) %></a>'}),define("views/main/Modal/ModalPopupView",["underscore","backbone","localizer","text!templates/main/Modal/ModalPopupView.html","text!templates/main/Modal/defaultFooterTemplate.html"],function(e,t,n,r,i){var s={ModalPopupClosed:"ModalPopupClosed",ON_CUSTOM_HEADER_ACTION_CLICKED:"ON_CUSTOM_HEADER_ACTION_CLICKED",CANCEL_CLICKED:"CANCEL_CLICKED"},o=t.View.extend({modalPopupTemplate:e.template(r),showHeader:!0,showFooter:!0,footerTemplate:e.template(i),events:{},baseEvents:{"click .js-saveBtn":"_onSaveButtonClicked","click .js-close":"_onCloseButtonClicked","click .cancel":"_onCancelClicked","click .close":"close","click .js-custom-header-action":"onCustomHeaderActionClicked",click:"onModalClick"},initialize:function(t){if(!t.view)throw"view is required for WidgetSheet";this.modalTitle=t.modalTitle,this.modalId=t.modalId,this.view=t.view,this.customClasses="",this.customBodyClasses="",this.customBackdropClasses="",this.options=t.options,this.showCloseButton=!0,this.showCancelButton=!0,this.cancelTextKey=t.cancelTextKey||"modal_close",this.confirmationTextKey=t.confirmationTextKey||"modal_save",this.footerPrimaryButtonClasses=t.footerPrimaryButtonClasses||"",this.closable=e.isUndefined(t.closable)?!0:t.closable,this.customHeaderAction=t.customHeaderAction,this.stopClickPropagationOnModalClick=t.stopClickPropagationOnModalClick||!1,typeof t.showFooter!="undefined"&&(this.showFooter=t.showFooter),typeof t.showHeader!="undefined"&&(this.showHeader=t.showHeader),typeof t.onSaveButtonClicked!="undefined"?this.onSaveButtonClicked=t.onSaveButtonClicked:!e.isUndefined(this.view.onSaveButtonClicked)&&e.isFunction(this.view.onSaveButtonClicked)&&(this.onSaveButtonClicked=this.view.onSaveButtonClicked),!e.isUndefined(t.onCloseButtonClicked)&&e.isFunction(t.onCloseButtonClicked)?this.onCloseButtonClicked=t.onCloseButtonClicked:!e.isUndefined(this.view.onCloseButtonClicked)&&e.isFunction(this.view.onCloseButtonClicked)&&(this.onCloseButtonClicked=this.view.onCloseButtonClicked),typeof t.footerTemplate!="undefined"&&(this.footerTemplate=t.footerTemplate),typeof t.customClasses!="undefined"&&(this.customClasses=t.customClasses),typeof t.customBodyClasses!="undefined"&&(this.customBodyClasses=t.customBodyClasses),t.customBackdropClasses!==undefined&&(this.customBackdropClasses=t.customBackdropClasses),typeof t.showCloseButton!="undefined"&&(this.showCloseButton=t.showCloseButton),typeof t.showCancelButton!="undefined"&&(this.showCancelButton=t.showCancelButton);if(this.baseEvents){var n={};for(var r in this.baseEvents)this.baseEvents.hasOwnProperty(r)&&(n[r]=this.baseEvents[r]);this.delegateEvents(e.extend(n,this.events))}this.parentEl=t.parentEl,this.listenTo(this.view,"ON_CLOSE",this.close),Window.App.registerModal(this),jQuery(document).on("click",".modal-backdrop",function(e){this.stopClickPropagationOnModalClick&&e.stopPropagation()}.bind(this))},render:function(){var t=this.modalPopupTemplate({modalTitle:this.modalTitle,customHeaderAction:this.customHeaderAction,showHeader:this.showHeader,showFooter:this.showFooter,showCloseButton:this.showCloseButton,customBodyClasses:this.customBodyClasses,Localizer:n});this.modalId&&this.el.setAttribute("id",this.modalId),this.$el.addClass("modal hide fade"),this.customClasses&&this.$el.addClass(this.customClasses),this.$el.html(t),this.$(".modal-body").replaceWith(this.view.$el.addClass("modal-body").addClass(this.customBodyClasses)),this.renderInnerView(),this.$(".modal-footer").html(this.footerTemplate({Localizer:n,showCancelButton:this.showCancelButton,cancel_text_key:this.cancelTextKey,confirmation_text_key:this.confirmationTextKey,footerPrimaryButtonClasses:this.footerPrimaryButtonClasses}));var r={backdrop:this.closable?!0:"static",keyboard:this.closable,show:!0};r=e.extend(r,this.options),jQuery(this.parentEl||"body").append(this.$el),jQuery(".modal").modal(r),this.customBackdropClasses&&$(".modal-backdrop").addClass(this.customBackdropClasses);var i=this;this.$el.attr("tabindex",0),this.$el.focus(),this.$el.on("hidden.bs.modal",function(){i.removeView()})},renderInnerView:function(){this.view.render()},removeView:function(){this.trigger(s.ModalPopupClosed),this.cleanUpView(),this.remove()},_onSaveButtonClicked:function(t){t.preventDefault();if(this.$(t.target).hasClass("disabled"))return;if(this.onSaveButtonClicked){var n=this;!e.isUndefined(this.view.onSaveButtonClicked)&&e.isFunction(this.view.onSaveButtonClicked)&&(n=this.view),this.onSaveButtonClicked.call(n)&&this.close()}this.cleanUpView()},_onCloseButtonClicked:function(t){t.preventDefault();if(this.onCloseButtonClicked){var n=this;!e.isUndefined(this.view.onCloseButtonClicked)&&e.isFunction(this.view.onCloseButtonClicked)&&(n=this.view),this.onCloseButtonClicked.call(n)&&this.close()}this.cleanUpView()},_onCancelClicked:function(){this.trigger(s.CANCEL_CLICKED),this.close()},onSaveButtonClicked:function(){return!0},onCustomHeaderActionClicked:function(){this.trigger(s.ON_CUSTOM_HEADER_ACTION_CLICKED)},showCustomHeader:function(){this.$(".js-custom-header-action").show(),this.$(".js-modal-header-title").hide()},hideCustomHeader:function(){this.$(".js-custom-header-action").hide(),this.$(".js-modal-header-title").show()},close:function(){this.$el.modal("hide"),this.customBackdropClasses&&$(".modal-backdrop").hasClass(this.customBackdropClasses)&&$(".modal-backdrop").removeClass(this.customBackdropClasses),this.trigger(s.ModalPopupClosed),this.unbind(),this.cleanUpView()},cleanUpView:function(){this.view&&typeof this.view.destroy=="function"&&this.view.destroy()},disableConfirmationButton:function(){var e=this.$(".js-saveBtn");e.addClass("disabled")},enableConfirmationButton:function(){var e=this.$(".js-saveBtn");e.hasClass("disabled")&&e.removeClass("disabled")},onModalClick:function(e){this.stopClickPropagationOnModalClick&&e.stopPropagation()},hideHeaderFooter:function(){this.$(".modal-header").css("visibility","hidden"),this.$(".modal-footer").css("visibility","hidden")}});return o.Events=s,o}),define("text!templates/main/Modal/ModalWarningView.html",[],function(){return'<div class="alert alert-error" style="display: none;"><%= errorMessage %></div>\n<p><%= message %></p>'}),define("views/main/Modal/ModalWarningView",["backbone","localizer","views/main/Modal/ModalPopupView","text!templates/main/Modal/ModalWarningView.html"],function(e,t,n,r){var i=e.View.extend({template:_.template(r),initialize:function(e){this.message=e.message,this.errorMessage=e.errorMessage},render:function(){this.$el.html(this.template({message:this.message,errorMessage:this.errorMessage}))}}),s=n.extend({initialize:function(e){if(!e.message)throw"Message required for ModalWarningView";this.messageView=new i({message:e.message,errorMessage:e.errorMessage||""}),e.view=this.messageView,n.prototype.initialize.call(this,e)},render:function(){n.prototype.render.call(this),this.$(".js-saveBtn").addClass("btn-danger")},errorOccurred:function(){this.messageView.errorMessage&&this.messageView.$(".alert-error").show()}});return s.Events=n.Events,s}),define("text!templates/main/Modal/ModalConfirmationView.html",[],function(){return"<% if(htmlFormat) { %>\n    <%~ message %>\n<% } else { %>\n    <p><%= message %></p>\n<% } %>\n"}),define("views/main/Modal/ModalConfirmationView",["underscore","backbone","localizer","views/main/Modal/ModalPopupView","text!templates/main/Modal/ModalConfirmationView.html"],function(e,t,n,r,i){var s=t.View.extend({template:e.template(i),initialize:function(e){this.message=e.message,this.htmlFormat=e.htmlFormat,this.showCloseButton=e.showCancelButton},render:function(){this.$el.html(this.template({message:this.message,htmlFormat:this.htmlFormat}))}}),o=r.extend({initialize:function(e){if(!e.message)throw"Message required for ModalConfirmationView";e.view=new s({message:e.message,htmlFormat:e.htmlFormat?!0:!1,showCloseButton:e.showCancelButton?e.showCancelButton:!0}),r.prototype.initialize.call(this,e)}});return o}),define("utils/MainNavUtil",["require","underscore"],function(e){var t=e("underscore");return{activeDashboardId:null,_openNavItems:[],setExpandCollapseHandler:function(e,n){if(!t.isFunction(e))throw"Error MainNavUtil.js - setNavExpandCollapseHandler: the provided handler is not a function";$(".main-nav").on("MAIN_NAV_EXPAND_COLLAPSE",this._triggerHandler.bind(this,e,n))},_triggerHandler:function(e,t){e();var n=t||20,r=setInterval(function(){e()}.bind(this),n);setTimeout(function(){clearInterval(r)},300)},removeExpandCollapseHandlers:function(){$(".main-nav").off("MAIN_NAV_EXPAND_COLLAPSE")},saveToggledNavItem:function(e){this._openNavItems.indexOf(e)!==-1?this._openNavItems=t.without(this._openNavItems,e):this._openNavItems.push(e)},handleOpenedNavItems:function(){t.each(this._openNavItems,function(e){e.hasClass("open-main-nav-menu")||e.addClass("open-main-nav-menu").find(".main-nav-menu").slideDown(200)}.bind(this))}}}),define("text!templates/navigation/DashboardMenuItemView.html",[],function(){return'<div class="inline-edit">\n    <a href="<%= url(\'/dashboard/\' + dashboard.dashboardId) %>" class="main-nav-link inline-edit-target animated fadeIn"><%= dashboardTitle %></a>\n        <!-- READ MODE -->\n        <div class="dashboard-actions">\n            <button class="inline-edit-trigger"><i class="icon-pencil has-tooltip" data-html="true" title="<%= Localizer.localize(\'button_rename\') %>"></i></button>\n            <button class="inline-edit-target js-delete-button"><i class="icon-trash has-tooltip" data-html="true" title="<%= Localizer.localize(\'button_delete\') %>"></i></button>\n        </div>\n\n        <!-- EDIT MODE -->\n        <div class="inline-edit-editable">\n            <div class="inline-edit-editable-text animated fadeIn" contenteditable="true"><%= dashboardTitle %></div>\n            <span class="inline-edit-actions">\n                <button class="inline-edit-save icon-checkmark has-tooltip" title="<%= Localizer.localize(\'button_save\') %>"></button>\n                <button class="inline-edit-cancel icon-close has-tooltip" title="<%= Localizer.localize(\'button_cancel\') %>"></button>\n            </span>\n        </div>\n</div>'}),define("views/navigation/DashboardMenuItemView",["require","underscore","backbone","localizer","utils/NavigationUtil","views/main/Modal/ModalWarningView","views/main/Modal/ModalConfirmationView","utils/MainNavUtil","text!templates/navigation/DashboardMenuItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/NavigationUtil"),s=e("views/main/Modal/ModalWarningView"),o=e("views/main/Modal/ModalConfirmationView"),u=e("utils/MainNavUtil"),a=e("text!templates/navigation/DashboardMenuItemView.html"),f={DASHBOARD_SELECTED:"DASHBOARD_SELECTED"},l=n.View.extend({tagName:"li",className:"main-nav-menu-item",NAME_MAX_LENGTH:20,events:{"click .main-nav-link":"goToDashboard","click .js-delete-button":"deleteDashboard","click .inline-edit-trigger":"enterEditMode","click .inline-edit-cancel":"cancelEditMode","click .inline-edit-save":"saveDashboard","keydown .inline-edit-editable-text":"validateName"},initialize:function(e){this.template=t.template(a),this.active=e.active,this.cancelAvailable=e.cancelAvailable,this.selected=e.selected},render:function(){var e=this.template({Localizer:r,dashboard:this.model.toJSON(),dashboardTitle:this.getDashboardTitle(),url:i.url});return this.$el.html(e),this.model.isNew()&&this.enterEditMode(),this.checkHighlight(),n.history.on("route",function(){this.checkHighlight(),this.cancelEditMode()}.bind(this)),this.setupEvents(),this},setupEvents:function(){this.$(".inline-edit-editable-text").on("focus",function(){setTimeout(function(){document.execCommand("selectAll",!1,null)},0)})},checkHighlight:function(){var e=window.location.pathname;if(u.activeDashboardId===this.model.get("dashboardId")||e.indexOf("/dashboard/"+this.model.get("dashboardId"))>0)this.trigger(f.DASHBOARD_SELECTED),this.highlight()},getDashboardTitle:function(){return this.model.get("dashboardTitle")||r.localize(this.model.get("dashboardTitleKey"))},deleteDashboard:function(){var e=r.localize("confirm_delete_dashboard",this.getDashboardTitle()),t=new s({modalTitle:r.localize("button_delete"),message:e,htmlFormat:!0,confirmationTextKey:"button_delete",cancelTextKey:"button_cancel",onSaveButtonClicked:this.deleteConfirmed.bind(this)});t.render()},goToDashboard:function(e){e?(!e.ctrlKey&&!e.metaKey&&e.preventDefault(),i.anchorTagHandler(e)):i.navigate("/dashboard/"+this.model.get("dashboardId"))},deleteConfirmed:function(){return this.model.isNew()?this.model.trigger("destroy",this.model):this.model.destroy(),this.remove(),!0},enterEditMode:function(){var e=this.$(".inline-edit"),t=this.$(".inline-edit-target").html();this.$(".inline-edit-editable-text").val(t),e.addClass("edit"),e.find(".inline-edit-target").hide(),e.find(".inline-edit-editable").css("display","inline-block"),this.$(".inline-edit-editable-text").focus()},cancelEditMode:function(){this.$(".inline-edit-editable-text").html(this.getDashboardTitle());if(this.model.isNew())this.cancelAvailable()?this.deleteConfirmed():this.saveDashboard();else{var e=this.$(".inline-edit");e.removeClass("edit"),e.find(".inline-edit-editable").hide(),e.find(".inline-edit-target").css("display","inline-block")}},saveDashboard:function(){var e=this.$(".inline-edit-editable-text").text().trim();if(!e){this.cancelEditMode();return}e=e.slice(0,this.NAME_MAX_LENGTH),this.model.set("dashboardTitle",e),this.model.save([],{success:function(){this.render(),this.selected()&&this.goToDashboard()}.bind(this)})},validateName:function(e){var t=this.$(".inline-edit-editable-text").text().trim();switch(e.keyCode){case 8:case 46:case 37:case 39:return!0;case 13:e.preventDefault(),this.saveDashboard();return;case 27:e.preventDefault(),this.cancelEditMode();return}t.length>=this.NAME_MAX_LENGTH&&e.preventDefault()},highlight:function(){this.$el.addClass("active")}});return l.Events=f,l}),define("text!templates/navigation/MenuItemChildView.html",[],function(){return'<a href="<%= url %>" class="main-nav-link"><%= title %></a>'}),define("views/navigation/MenuItemChildView",["require","underscore","backbone","localizer","utils/NavigationUtil","text!templates/navigation/MenuItemChildView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/NavigationUtil"),s=e("text!templates/navigation/MenuItemChildView.html"),o={NAV_ITEM_SELECTED:"NAV_ITEM_SELECTED"},u=n.View.extend({tagName:"li",className:"main-nav-menu-item",events:{"click .main-nav-link":"onClick"},initialize:function(e){this.template=t.template(s),this.active=e.active},render:function(){var e=this.getURL(),t=this.getLabel(),r=this.template({title:t,url:e});return this.$el.html(r),this.checkHighlight(),n.history.on("route",this.checkHighlight.bind(this)),this},checkHighlight:function(){this.matchesUrl()&&(this.trigger(o.NAV_ITEM_SELECTED),this.highlight())},getLabel:function(){return this.model.label?this.model.label:r.localize(this.model.title)},getURL:function(){return this.model.url.indexOf("http")!==-1?this.model.url:i.url(this.model.url)},onClick:function(e){!e.ctrlKey&&!e.metaKey&&e.preventDefault(),e.stopPropagation(),this.model.url.indexOf("http")!==-1?window.location=this.model.url:(i.anchorTagHandler(e),this.trigger(o.NAV_ITEM_SELECTED),this.highlight(!0))},matchesUrl:function(){var e=window.location.pathname;if(this.model.root)return e==="/modern"+this.model.url;var t=this.model.urlKeyword||this.model.url;return e.indexOf(t)!==-1},highlight:function(e){this.$el.addClass("active")}});return u.Events=o,u}),define("text!templates/navigation/MenuItemView.html",[],function(){return'<a href="<%= link %>" class="<%= linkClass %>">\n    <i class="nav-icon <%= icon %>"></i>\n    <span class="nav-text"><%= title %></span>\n    <% if(hasChildren){ %>\n        <i class="nav-toggle-icon icon-arrow-down"></i>\n    <% } %>\n</a>\n<% if(hasChildren){ %>\n    <ul class="main-nav-menu">\n    </ul>\n<% } %>\n'}),define("views/navigation/MenuItemView",["require","underscore","backbone","localizer","utils/NavigationUtil","views/navigation/MenuItemChildView","utils/MainNavUtil","text!templates/navigation/MenuItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/NavigationUtil"),s=e("views/navigation/MenuItemChildView"),o=e("utils/MainNavUtil"),u=e("text!templates/navigation/MenuItemView.html"),a={NAV_ITEM_SELECTED:"NAV_ITEM_SELECTED"},f=n.View.extend({tagName:"li",className:"main-nav-item",events:{"click .main-nav-link":"onClick"},initialize:function(e){this.template=t.template(u),this.active=e.active,this.className=e.className||"main-nav-item"},render:function(){var e="main-nav-link";e+=this.model.url?"":" main-nav-menu-toggle";var t=this.template({title:this.getLabel(),link:this.model.url?i.url(this.model.url):null,icon:this.model.icon,linkClass:e,hasChildren:this.hasChildren()});return this.$el.html(t),this.hasChildren()&&this.renderChildElements(),this.checkHighlight(),n.history.on("route",this.checkHighlight.bind(this)),this},checkHighlight:function(){this.matchesUrl()&&(this.trigger(a.NAV_ITEM_SELECTED),this.highlight())},getLabel:function(){return this.model.label?this.model.label:r.localize(this.model.title)},hasChildren:function(){return!!this.model.menuItems},renderChildElements:function(){t.each(this.model.menuItems,function(e){var t=new s({model:e});this.listenTo(t,a.NAV_ITEM_SELECTED,function(){this.trigger(a.NAV_ITEM_SELECTED),this.highlight()}),this.$(".main-nav-menu").append(t.render().el),t.matchesUrl()&&this.highlight()},this)},onClick:function(e){e&&(!e.ctrlKey&&!e.metaKey&&e.preventDefault(),e.stopPropagation()),this.hasChildren()?(this.$el.toggleClass("open-main-nav-menu"),this.$(".main-nav-menu").slideToggle(200),o.saveToggledNavItem(this.$el)):(i.anchorTagHandler(e),this.trigger(a.NAV_ITEM_SELECTED),this.highlight())},matchesUrl:function(){if(!this.hasChildren()){var e=window.location.pathname,t=this.model.urlKeyword;return t&&e.indexOf(t)!==-1?!0:e.indexOf(this.model.url)!==-1}return!1},highlight:function(){this.$(".main-nav-link").first().addClass("active")}});return f.Events=a,f}),define("text!templates/navigation/AddDashboardButton.html",[],function(){return'<li class="js-add-dashboard-button">\n    <button class="js-add-dashboard add-dashboard js-add-available"><%= Localizer.localize(\'add_dashboard\') %></button>\n    <button class="add-dashboard js-add-unavailable max" title="<%= Localizer.localize(\'max_dashboards_message\') %>"><%= Localizer.localize(\'add_dashboard\') %></button>\n</li>\n'}),define("views/utils/ToolTipView",["backbone","jquery"],function(e,t){var n={ON_TOOLTIP_OPENED:"ON_TOOLTIP_OPENED"};t(document.body).click(function(e){var n=e||window.event,r=t(n.target);r.is(".tooltip-active")||t(".tooltip-active").tooltip("hide").removeClass("tooltip-active")});var r=e.View.extend({events:{click:"onElementClicked",mouseenter:"onElementMouseEnter",mouseleave:"onElementMouseLeave"},initialize:function(e){this.content=e.content||this.$el.attr("title"),this.placement=e.placement||this.$el.data("placement"),this.container=e.container?e.container:".main-body",this.allowHtml="allowHtml"in e?e.allowHtml:!0,this.allowClickThrough="allowClickThrough"in e?e.allowClickThrough:!1,this.isSetup=!1,this.isHovering=!1,this.render()},onElementClicked:function(e){this.allowClickThrough||e.preventDefault(),this.show()},onElementMouseEnter:function(e){this.isHovering=!0,this.show()},onElementMouseLeave:function(){this.isHovering=!1,this.hide()},show:function(){if(!this.content)return;this.isSetup||(this.$el.tooltip({trigger:"manual",container:this.container}),this.isSetup=!0),this.isHovering&&this.$el.tooltip("show"),this.$el.hasClass("tooltip-active")||(this.$el.addClass("tooltip-active"),this.trigger(n.ON_TOOLTIP_OPENED)),this.$el.on("hidden.bs.modal",function(e){e.stopPropagation()}),this.$el.on("hide.bs.modal",function(e){e.stopPropagation()}),this.$el.on("hide",function(e){e.stopPropagation()})},hide:function(){this.isSetup&&this.$el.tooltip("hide"),this.$el.removeClass("tooltip-active")},render:function(){this.$el.attr("data-rel","tooltip"),this.$el.attr("data-html",this.allowHtml),this.$el.attr("data-original-title",this.content),this.placement&&this.$el.attr("data-placement",this.placement)},setContent:function(e){this.content=e},renderContent:function(){this.$el.attr("data-original-title",this.content),this.isHovering&&this.onElementMouseEnter()}});return r.Events=n,r.hideAll=function(){t(".tooltip-active").tooltip("hide").removeClass("tooltip-active")},r}),define("text!templates/navigation/DashboardsSidebarView.html",[],function(){return'<a href="#" class="main-nav-menu-toggle main-nav-link">\n    <i class="nav-icon icon-dashboards"></i>\n    <span class="nav-text"><%= Localizer.localize(\'dashboards\') %></span>\n    <i class="nav-toggle-icon icon-arrow-down"></i>\n</a>\n<ul class="main-nav-menu">\n</ul>'}),define("views/navigation/DashboardsSidebarView",["require","underscore","backbone","localizer","models/dashboard/Dashboard","views/navigation/DashboardMenuItemView","views/main/Modal/ModalConfirmationView","utils/NavigationUtil","views/navigation/MenuItemView","text!templates/navigation/AddDashboardButton.html","views/utils/ToolTipView","utils/MainNavUtil","text!templates/navigation/DashboardsSidebarView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("models/dashboard/Dashboard"),s=e("views/navigation/DashboardMenuItemView"),o=e("views/main/Modal/ModalConfirmationView"),u=e("utils/NavigationUtil"),a=e("views/navigation/MenuItemView"),f=e("text!templates/navigation/AddDashboardButton.html"),l=e("views/utils/ToolTipView"),c=e("utils/MainNavUtil"),h=e("text!templates/navigation/DashboardsSidebarView.html");return n.View.extend({events:{"click .main-nav-menu-toggle":"expandCollapse","click .js-add-dashboard-button .js-add-dashboard":"addDashboard"},template:t.template(h),maxDashboards:5,initialize:function(e){this.dashboards=e.dashboards,this.dashboardViews=[]},render:function(){var e=this.template({Localizer:r});this.$el.html(e),this.dashboardViews=[],this.renderAddDashboardButton(),this.renderDashboards(),this.checkAddDashboardButton(),new l({el:this.$(".js-add-unavailable"),container:".main-nav-list",content:r.localize("max_dashboards_message"),placement:"top"})},renderDashboards:function(){t.each(this.dashboards.models,function(e){this.renderDashboard(e)},this)},renderDashboard:function(e){var t=new s({model:e,cancelAvailable:this.cancelDashboardAvailable.bind(this),selected:this.selected.bind(this)});c.activeDashboardId===e.getId()&&this.matchesUrl()&&this.highlight(),this.listenTo(t,s.Events.DASHBOARD_SELECTED,function(){this.trigger(a.Events.NAV_ITEM_SELECTED),this.highlight()}.bind(this)),this.listenTo(e,"destroy",this.onDashboardDeleted.bind(this)),this.$(".js-add-dashboard-button").before(t.render().el),t.$(".inline-edit-editable-text").focus(),this.dashboardViews.push(t)},matchesUrl:function(){return window.location.pathname.indexOf("dashboard")!==-1||window.location.pathname==="/modern/"},selected:function(){return this.$(".main-nav-link").first().hasClass("active")&&this.dashboards.length===1},cancelDashboardAvailable:function(){return this.dashboards.length>1},onDashboardDeleted:function(e){this.dashboards.remove(e),this.dashboardViews=t.reject(this.dashboardViews,function(t){return t.model.cid===e.cid});if(e.getId()===c.activeDashboardId&&this.dashboards.at(0)){var n=this.dashboards.at(0).getId();this.$(".main-nav-menu-item")[0].className+=" active",u.navigate("/dashboard/"+n)}else this.dashboards.length===0&&this.addDashboard();this.checkAddDashboardButton()},renderAddDashboardButton:function(){var e=t.template(f),n=e({Localizer:r});this.$(".main-nav-menu").append(n)},expandCollapse:function(e){e.preventDefault(),this.$el.toggleClass("open-main-nav-menu"),this.$(".main-nav-menu").slideToggle(200,function(){this.$(".inline-edit-editable-text:visible").focus()}.bind(this)),c.saveToggledNavItem(this.$el)},addDashboard:function(){var e=new i({dashboardOrder:this.dashboards.length,dashboardTitle:r.localize("untitled_dashboard")});this.dashboards.add(e),this.renderDashboard(e),this.checkAddDashboardButton()},checkAddDashboardButton:function(){this.dashboards.length>=this.maxDashboards?(this.$(".js-add-available").hide(),this.$(".js-add-unavailable").show()):(this.$(".js-add-available").show(),this.$(".js-add-unavailable").hide())},highlight:function(){this.$(".main-nav-link").first().addClass("active")},cancelEditForAll:function(){t.each(this.dashboardViews,function(e){e.cancelEditMode()})},remove:function(){return this.$el.empty().off(),this.stopListening(),this}})}),define("utils/RoleUtil",["underscore","models/user/ViewerSocialProfile"],function(e,t){var n={isWellnessUser:function(){var e=!1,n=t.get("userRoles");for(var r=0;r<n.length;r++)n[r]==="ROLE_WELLNESS_USER"&&(e=!0);return e},isFitnessUser:function(){var e=!1,n=t.get("userRoles");for(var r=0;r<n.length;r++)n[r]==="ROLE_FITNESS_USER"&&(e=!0);return e},isWellnessUserOnly:function(){var e=!1,n=!1,r=t.get("userRoles");for(var i=0;i<r.length;i++)r[i]==="ROLE_FITNESS_USER"?e=!0:r[i]==="ROLE_WELLNESS_USER"&&(n=!0);return e==0&&n==1},isFitnessUserOnly:function(){var e=!1,n=!1,r=t.get("userRoles");for(var i=0;i<r.length;i++)r[i]==="ROLE_FITNESS_USER"?e=!0:r[i]==="ROLE_WELLNESS_USER"&&(n=!0);return e==1&&n==0},isDiveUserOnly:function(){var n=t.get("userRoles");return e.intersection(n,["ROLE_FITNESS_USER","ROLE_WELLNESS_USER","ROLE_OUTDOOR_USER","ROLE_MARINE_USER"]).length===0&&e.indexOf(n,"ROLE_DIVE_USER")>=0},isProUser:function(){var e=!1,n=t.get("userRoles");for(var r=0,i=n.length;r<i;r++)n[r]==="ROLE_CONNECTPRO"&&(e=!0);return e}};return n}),define("views/navigation/NavigationJsonBuilder",["require","models/user/ViewerSocialProfile","utils/RoleUtil"],function(e){var t=e("models/user/ViewerSocialProfile"),n=e("utils/RoleUtil");return{getMenuJson:function(e,r,i){var s={dashboards:[]},o=t.isFitnessUser(),u=t.isWellnessUser(),a=t.isOutdoorUser(),f=t.isDiveUser(),l=t.isMarineUser(),c=t.isAdminUser(),h=t.isDeviceAdmin(),p=t.isCustomerService(),d=t.isCustomerServiceAdmin();i||(i={}),u&&s.dashboards.push({title:"menu_step_summary_large",icon:"icon-layers",url:"/dailySummary/timeline",urlKeyword:"timeline"}),(o||u||f)&&s.dashboards.push({title:"challenges",icon:"icon-challenges",url:"/challenge",urlKeyword:"challenge/"}),(o||u||f)&&s.dashboards.push({title:"title_calendar_widget",icon:"icon-calendar",url:"/calendar"}),(o||u||a||f)&&s.dashboards.push({title:"news_feed",icon:"icon-newsfeed",url:"/connections"}),s.main=[],n.isDiveUserOnly()&&s.main.push({title:"title_diving_widget",icon:"icon-activity-diving",url:"/diving"}),u?s.main.push({title:"activities",icon:"icon-activities",menuItems:[{title:"activity_type_all",url:"/activities"},{title:"activity_type_steps",url:"/dailySummary/steps",urlKeyword:"steps"},{title:"label_floors_climbed_unit",url:"/dailySummary/floors",urlKeyword:"floors"},{title:"intensity_minutes",url:"/dailySummary/intensity-minutes",urlKeyword:"intensity-minutes"}]}):(o||f)&&s.main.push({title:"activities",icon:"icon-activities",url:"/activities"});if(o||u||f){var v=[];u&&v.push({title:"sleep",url:"/dailySummary/sleep",urlKeyword:"sleep"}),(o||u||f)&&v.push({title:"weight",url:"/weight",urlKeyword:"weight"},{title:"title_calories_widget",url:"/dailySummary/calories",urlKeyword:"calories"}),u&&v.push({title:"all_day_heart_rate_label",url:"/dailySummary/heart-rate",urlKeyword:"heart-rate"},{title:"title_stress_widget",url:"/dailySummary/stress",urlKeyword:"stress"}),s.main.push({title:"health_stats",icon:"icon-heart",menuItems:v})}if(a){var v=[];v.push({title:"scorecards",url:"/my-scorecards",urlKeyword:"scorecard"},{title:"title_golf_course_widget",url:"/my-golf-courses",urlKeyword:"golf-course"}),i["golf.liveleaderboards.enabled"]==="true"&&v.push({title:"title_golf_leaderboard_widget",url:"/golf-leaderboards",urlKeyword:"golf-leaderboard"}),v.push({title:"title_golf_swing_analysis_widget",url:"/my-swings",urlKeyword:"swing-analysis"}),s.main.push({title:"golf",icon:"icon-activity-golf",menuItems:v})}o||f?s.main.push({title:"training",icon:"icon-workouts",menuItems:[{title:"workouts",url:"/workouts",urlKeyword:"workout"},{title:"label_training_plans",url:"/training-plan"},{title:"course_widget_title",url:"/courses"},{title:"segments",url:"/segments"}]}):u&&s.main.push({title:"training",icon:"icon-workouts",menuItems:[{title:"queue.workout",url:"/workouts",urlKeyword:"workout"}]}),f&&!n.isDiveUserOnly()&&s.main.push({title:"title_diving_widget",icon:"icon-activity-diving",url:"/diving"}),l&&s.main.push({title:"quickdraw",icon:"icon-activity-marine",url:"/quickdrawDetails"}),(o||a||u||f)&&s.main.push({title:"label_gear",icon:"icon-steps",url:"/gear"}),u&&s.main.push({title:"title_insights_widget",icon:"icon-insights",url:"/insights"}),(o||u||f)&&s.main.push({title:"title_reports_widget",icon:"icon-reports-bar",url:"/report"}),s.social=[],(o||a||u||f)&&s.social.push({title:"connections",icon:"icon-people-2",url:"/connections/connections",urlKeyword:"search"}),(o||a||u||f)&&s.social.push({title:"title_groups_widget",icon:"icon-people-3",url:"/groups",urlKeyword:"group/"}),s.other=[],(o||u||f)&&s.other.push({title:"trophy_case",icon:"icon-personal-records",url:"/trophy-case"}),(o||f)&&s.other.push({title:"goals",icon:"icon-goals",url:"/goals",urlKeyword:"goal"}),s.admin=[];if(e){var m="https://"+r+"/config-admin",g=[];(c||d||p)&&g.push({label:"User",url:window.location.origin+"/web-admin/#/pages/user"}),(c||p)&&g.push({label:"myGarmin",url:"/admin/mygarmin"}),p&&g.push({label:"Upload",url:window.location.origin+"/web-admin/#/pages/upload",root:!0},{label:"Export",url:window.location.origin+"/web-admin/#/pages/export"},{label:"MAT Support",url:"/admin/support-tool-mat"},{label:"Blacklist Activity",url:window.location.origin+"/web-admin/#/pages/blacklist"}),h&&g.push({label:"Device Admin",url:window.location.origin+"/web-admin"}),c&&g.push({label:"Preferences",url:m}),s.admin.push({label:"Admin",icon:"icon-eye",menuItems:g})}return s}}}),define("text!templates/main/MainContainer/MainSidebarView.html",[],function(){return'<a class="logo" href="<%= url(\'/\') %>" title="<%= Localizer.localize(\'gc\') %>"><!-- <span class="mobile-logo"></span> --></a>\n<div class="main-nav-list">\n    <ul class="main-nav-group dashboards">\n        <!-- Dashboards -->\n        <li class="main-nav-item js-dashboards">\n        </li>\n    </ul>\n\n    <% if(showMain){ %>\n        <ul class="main-nav-group main">\n        </ul>\n    <% } %>\n\n    <% if(showSocial){ %>\n        <ul class="main-nav-group social">\n        </ul>\n    <% } %>\n\n    <% if(showOther){ %>\n        <ul class="main-nav-group other">\n        </ul>\n    <% } %>\n\n    <% if(admin){ %>\n        <ul class="main-nav-group admin">\n        </ul>\n    <% } %>\n\n    <% if(beta.isBetaUser){ \n        var betaKey = beta.isBetaPool ? \'beta_leave\' : \'beta_join\' ; %>\n        <button class="beta-switch"><%= Localizer.localize(betaKey) %></button>\n    <% } %>\n</div>'}),define("views/main/MainContainer/MainSidebarView",["require","underscore","backbone","localizer","utils/NavigationUtil","models/user/ViewerSocialProfile","views/navigation/DashboardsSidebarView","views/navigation/NavigationJsonBuilder","views/navigation/MenuItemView","utils/MainNavUtil","text!templates/main/MainContainer/MainSidebarView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/NavigationUtil"),s=e("models/user/ViewerSocialProfile"),o=e("views/navigation/DashboardsSidebarView"),u=e("views/navigation/NavigationJsonBuilder"),a=e("views/navigation/MenuItemView"),f=e("utils/MainNavUtil"),l=e("text!templates/main/MainContainer/MainSidebarView.html"),c={EXPAND_COLLAPSE:"EXPAND_COLLAPSE"},h=n.View.extend({template:t.template(l),events:{"click a.logo":"goToModern","click .beta-switch":"toggleBeta"},initialize:function(e){this.dashboards=e.dashboards,this.serviceHost=e.serviceHost,this.navCollapsedPref=e.navCollapsedPref,this.preferences=e.preferences,this.isAdmin=s.isAdminUser()||s.isCustomerServiceAdmin()||s.isCustomerService()||s.isDeviceAdmin(),this.isBetaUser=s.isBetaUser(),this.isBetaPool=jQuery(".beta-tag").length>0},render:function(){var e=u.getMenuJson(this.isAdmin,this.serviceHost,this.preferences),t=this.template({Localizer:r,menuJson:e,url:i.url,showMain:e.main.length>0,showSocial:e.social.length>0,showOther:e.other.length>0,admin:this.isAdmin,beta:{isBetaUser:this.isBetaUser,isBetaPool:this.isBetaPool}});if(!s.hasUserExperience())return;this.$el.html(t),this.addHoverEffect(),this.renderDashboardTabs(),this.renderStaticDashboards(e),this.renderMainEntries(e),this.renderSocialEntries(e),this.renderOtherEntries(e),this.isAdmin&&this.renderAdminEntries(e),this.isBetaPool&&jQuery(".beta-tag").show(),jQuery(window).on("resize.mobileView",function(){window.handleMobileView(),$(window).width()>670&&this.navCollapsedPref&&this.navCollapsedPref.get("value")==="true"&&$("body").addClass("minimize-main-nav")}.bind(this))},renderAdminEntries:function(e){t.each(e.admin,function(e){var t=new a({model:e});this.listenTo(t,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this,t)),this.$(".main-nav-group.admin").append(t.render().el)}.bind(this))},renderOtherEntries:function(e){t.each(e.other,function(e){var t=new a({model:e});this.listenTo(t,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this,t)),this.$(".main-nav-group.other").append(t.render().el)}.bind(this))},renderSocialEntries:function(e){t.each(e.social,function(e){var t=new a({model:e});this.listenTo(t,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this,t)),this.$(".main-nav-group.social").append(t.render().el)}.bind(this))},renderMainEntries:function(e){t.each(e.main,function(e){var t=new a({model:e});this.listenTo(t,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this,t)),this.$(".main-nav-group.main").append(t.render().el)}.bind(this))},onNavClicked:function(){this.clearActiveNavItems(),$("body").removeClass("mobile-open-main-nav")},clearActiveNavItems:function(){this.$(".main-nav-link").removeClass("active"),this.$(".main-nav-menu-item").removeClass("active")},renderStaticDashboards:function(e){t.each(e.dashboards,function(e){var t=new a({model:e});this.listenTo(t,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this,t)),this.$(".dashboards").append(t.render().el)}.bind(this))},renderDashboardTabs:function(){this.dashboardView&&this.dashboardView.remove(),this.dashboardView=new o({el:this.$(".js-dashboards"),dashboards:this.dashboards}),this.listenTo(this.dashboardView,a.Events.NAV_ITEM_SELECTED,this.onNavClicked.bind(this)),this.dashboardView.render()},expandCollapse:function(){var e=$("body"),t=e.hasClass("mobile")?"mobile-open-main-nav":"minimize-main-nav";e.hasClass(t)?(e.removeClass(t),this.navCollapsedPref.set("value",!1),f.handleOpenedNavItems()):(e.addClass(t),this.navCollapsedPref.set("value",!0),this.dashboardView.cancelEditForAll()),this.navCollapsedPref.save(),$(".minimize-main-nav .main-nav-item").removeClass("open-main-nav-menu"),$(".minimize-main-nav .main-nav-menu").slideUp(200),setTimeout(function(){$(window).trigger("resize.iframePage")},300)},addHoverEffect:function(){this.$el.hover(function(){var e=$("body");e.hasClass("minimize-main-nav")&&(e.addClass("main-nav-hover"),$(this).trigger("MAIN_NAV_EXPAND_COLLAPSE"),f.handleOpenedNavItems())},function(){$(".minimize-main-nav .main-nav-item").removeClass("open-main-nav-menu"),$(".minimize-main-nav .main-nav-menu").slideUp(200),$("body").removeClass("main-nav-hover"),$("body").hasClass("minimize-main-nav")&&$(this).trigger("MAIN_NAV_EXPAND_COLLAPSE")})},goToModern:function(e){!e.ctrlKey&&!e.metaKey&&e.preventDefault(),i.anchorTagHandler(e)},toggleBeta:function(){var e=function(){location.reload()};this.isBetaPool?jQuery.ajax({url:"service/beta",type:"DELETE"}).done(e):jQuery.post("service/beta").done(e)}});return h.Events=c,h}),define("models/notification/Notification",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/notification-service/notification/notification",idAttribute:"id"});return t}),define("collections/notification/Notifications",["backbone","models/notification/Notification"],function(e,t){var n=e.Collection.extend({model:t,url:"/proxy/notification-service/notification/notification"});return n}),define("models/connections/PendingConnection",["backbone"],function(e){var t=e.Model.extend({idAttribute:"connectionRequestId",url:function(){return"/proxy/userprofile-service/connection/request/"+this.connectionRequestId},initialize:function(e){this.connectionRequestId=e.connectionRequestId}});return t}),define("collections/connections/PendingConnections",["backbone","models/connections/PendingConnection"],function(e,t){var n=e.Collection.extend({model:t,url:"/proxy/userprofile-service/connection/pending"});return n}),define("models/groups/PendingGroupRequest",["backbone"],function(e){var t=e.Model.extend({url:function(){var e="/proxy/group-service/requestNotHandled/"+this.getDisplayName();return e},idAttribute:"groupId",setDisplayName:function(e){this.displayName=e},getDisplayName:function(){return this.displayName}});return t}),define("collections/groups/PendingGroupRequests",["backbone","models/groups/PendingGroupRequest"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/group-service/requestNotHandled/"+this.getDisplayName()},setDisplayName:function(e){this.displayName=e},getDisplayName:function(){return this.displayName}});return n}),define("models/device/DeviceInviteRequest",["backbone"],function(e){var t=e.Model.extend({idAttribute:"deviceInviteId",url:function(){return"/proxy/weightscale-service/weightscale/"+this.deviceId+"/invite"},initialize:function(e){this.deviceId=e.deviceId}});return t}),define("collections/device/PendingDeviceInviteRequests",["backbone","models/device/DeviceInviteRequest"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/weightscale-service/weightscale/invite"}});return n}),define("collections/adhocchallenge/PendingChallengeInviteRequests",["backbone"],function(e){var t=Backbone.Collection.extend({url:function(){return"/proxy/adhocchallenge-service/adHocChallenge/invite"}});return t}),define("models/notification/NotificationMeta",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/notification-service/notification/notificationMeta",poll:function(){if(!this.fetching){this.fetching=!0;var e=this;this.fetch({add:!0,success:function(e){e.fetching=!1},error:e.onPollingError})}},onPollingError:function(e,t){e.fetching=!1,e.pollingEnabled=!1,typeof console!="undefined"&&typeof console.log!="undefined"&&console.log((new Date).toString()+" - "+"Error polling: "+t.status+" "+t.statusText)},isPollingEnabled:function(){return!0},parse:function(e){this.set("count",e),this.trigger("add",this)}});return t}),define("models/connections/NotViewedConnection",["backbone"],function(e){var t=e.Model.extend({url:"/proxy/userprofile-service/connection/notViewedRequestCount"});return t}),define("models/connections/AcceptConnection",["backbone"],function(e){var t=e.Model.extend({idAttribute:"connectionRequestId",url:function(){return"/proxy/userprofile-service/connection/accept/"+this.connectionRequestId},initialize:function(e){this.connectionRequestId=e.connectionRequestId}});return t}),define("models/connections/IgnoreConnection",["backbone"],function(e){var t=e.Model.extend({idAttribute:"connectionRequestId",url:function(){return"/proxy/userprofile-service/connection/decline/"+this.connectionRequestId},initialize:function(e){this.connectionRequestId=e.connectionRequestId}});return t}),define("text!templates/privacy/PrivacyAlertFooterView.html",[],function(){return'    <button class="btn btn-secondary cancel" data-dismiss="modal" aria-hidden="true"><%= Localizer.localize(\'button_cancel\') %></button>\n    <button class="btn confirm"><%= Localizer.localize(\'button_save\') %></button>\n'}),define("views/privacy/PrivacyAlertModalView",["underscore","backbone","localizer","views/main/Modal/ModalPopupView","text!templates/privacy/PrivacyAlertFooterView.html"],function(e,t,n,r,i){var s={ON_SAVE:"ON_SAVE"},o=r.extend({events:{"click .confirm":"onSaveClicked","click .cancel":"onCloseClicked"},footerTemplate:e.template(i),onSaveClicked:function(){this.trigger(s.ON_SAVE),this.close()},onCloseClicked:function(){this.close()}});return o.Events=s,o}),define("models/user/SocialProfilePrivacy",["backbone"],function(e){var t={PUBLIC:"public",PRIVATE:"private",FOLLOWING:"following",GROUPS:"groups"},n=e.Model.extend({urlRoot:"/proxy/userprofile-service/socialProfile/privacy/",idAttribute:"displayName",defaults:{activityVisibility:"private",profileVisibility:"private"}});return n.Visibility=t,n}),define("text!templates/privacy/PrivacyAlertView.html",[],function(){return'    <p><%= Localizer.localize(\'privacy.alert.msg.1\') %></p>\n    <form id="change-privacy-alert" class="">\n        <div class="control-group control-profile-privacy" style="display: none">\n            <label class="control-label" for="profile-privacy-options"><%= Localizer.localize(\'privacy.alert.msg.3\') %> <button class="help-icon">\n                <i class="icon-help profile-privacy-tip" data-rel="tooltip" data-container="#change-privacy-alert"></i></button></label>\n\n            <div class="controls">\n                <select id="profile-privacy-options" name="profileVisibility" class="select size4">\n                    <option value="private" selected="selected"><%= Localizer.localize(\'privacy.alert.only.me\') %></option>\n                    <option value="following"><%= Localizer.localize(\'privacy.alert.connections\') %></option>\n                    <option value="groups"><%= Localizer.localize(\'privacy.alert.groups\') %></option>\n                    <option value="public"><%= Localizer.localize(\'privacy.alert.everyone\') %></option>\n                </select>\n            </div>\n        </div>\n        <div class="control-group control-activity-privacy" style="display: none">\n            <label class="control-label" for="activity-privacy-options"><%= Localizer.localize(\'privacy.alert.msg.4\') %> <button class="help-icon">\n                <i class="icon-help activity-privacy-tip" data-rel="tooltip" data-container="#change-privacy-alert"></i></button></label>\n            <div class="controls">\n                <select id="activity-privacy-options" name="activityVisibility" class="select size4">\n                    <option value="private" selected="selected"><%= Localizer.localize(\'privacy.alert.only.me\') %></option>\n                    <option value="following"><%= Localizer.localize(\'privacy.alert.connections\') %></option>\n                    <option value="groups"><%= Localizer.localize(\'privacy.alert.groups\') %></option>\n                    <option value="public"><%= Localizer.localize(\'privacy.alert.everyone\') %></option>\n                </select>\n            </div>\n        </div>\n    </form>\n'}),define("views/privacy/PrivacyAlertView",["underscore","backbone","localizer","utils/extensions/Loadable","models/user/SocialProfilePrivacy","models/user/ViewerSocialProfile","utils/ModelSynchronizer","views/utils/ToolTipView","text!templates/privacy/PrivacyAlertView.html","text!templates/privacy/PrivacyAlertFooterView.html"],function(e,t,n,r,i,s,o,u,a,f){var l={Closed:"CLOSED",Ready:"READY"},c=t.View.extend({footerTemplate:e.template(f),events:{"change select":"onValueChanged","click .btn-save-privacy":"onSaveClicked"},propertyFiles:["/main/js/properties/privacy_alert/privacy_alert"],initialize:function(t){this.userPreferences=t.userPreferences,this.requestType=t.requestType,this.profilePrivacyChanged=!1,this.activityPrivacyChanged=!1;var n=new o;this.socialProfilePrivacy=new i({displayName:s.get("displayName")}),n.addModel({model:this.socialProfilePrivacy,required:!0}),n.addEvent({model:n,event:o.Events.ON_DOCUMENT_READY,required:!0}),n.bind(o.Events.SYNCHRONIZED,this.onModelsFetched,this),n.fetchModels(),this.template=e.template(a)},onModelsFetched:function(){var e=this.socialProfilePrivacy.get("profileVisibility"),t=this.socialProfilePrivacy.get("activityVisibility");e==i.Visibility.PRIVATE||this.requestType=="group"&&(t==i.Visibility.PRIVATE||t==i.Visibility.FOLLOWING)||this.requestType=="connection"&&t==i.Visibility.PRIVATE?this.displayModal=!0:this.displayModal=!1,this.trigger(l.Ready)},render:function(){this.$el.html(this.template({Localizer:n}));if(this.socialProfilePrivacy.get("profileVisibility")==i.Visibility.PRIVATE){this.$(".control-profile-privacy").show();var e=new u({el:this.$(".icon-help.profile-privacy-tip"),content:n.localize("profile.privacy.description"),container:"#change-privacy-alert",placement:"right"})}else this.$(".control-profile-privacy").hide();var t=this.socialProfilePrivacy.get("activityVisibility"),r=t==i.Visibility.PRIVATE,s=t==i.Visibility.FOLLOWING;if(this.requestType=="group"&&(r||s)||this.requestType=="connection"&&r){this.$("#activity-privacy-options").val(t),this.$(".control-activity-privacy").show();var o=new u({el:this.$(".icon-help.activity-privacy-tip"),content:n.localize("activity.privacy.description"),container:"#change-privacy-alert",placement:"right"})}else this.$(".control-activity-privacy").hide()},getDisplayModal:function(){return this.displayModal},onValueChanged:function(e){var t=e.currentTarget,n=t.value,r={},i=t.name;r[i]=n,i=="activityVisibility"?(this.socialProfilePrivacy.set("activityVisibility",n),this.activityPrivacyChanged=!0):i=="profileVisibility"&&(this.socialProfilePrivacy.set("profileVisibility",n),this.profilePrivacyChanged=!0)},onSaveClicked:function(){(this.profilePrivacyChanged||this.activityPrivacyChanged)&&this.socialProfilePrivacy.save()},updateUserProfile:function(e){jQuery.ajax({url:"/updateprofile/",type:"POST",data:{defaultActivityPrivacy:e},success:function(e){}})}});return c.Events=l,c}),define("text!templates/notification/PendingConnectionItemView.html",[],function(){return'<%\nvar connectionName = pendingConnection.displayName;\nif (pendingConnection.fullName) {\n    connectionName = pendingConnection.fullName;\n}\nconnectionName = _.escape(connectionName);\n%>\n\n    <a class="request-image" href="<%= profileUrl %>">\n        <img class="avatar js-select-connection" src="<%= imageUrl %>" alt="<%= connectionName %>" title="<%= connectionName %>">\n    </a>\n    <div class="request-body">\n        <% if (pendingConnection.userPro) { %>\n            <!-- per UX, PRO is not translated -->\n            <span class="label-pro"><i class="icon-checkmark"></i>PRO</span>\n        <% } %>\n        <%~ Localizer.localize(\'connection.follow\', connectionName, profileUrl) %>\n        <div class="request-actions">\n            <button type="button" class="btn btn-small confirm"><%= Localizer.localize(\'connection.confirm\') %></button>\n            <button type="button" class="btn btn-small btn-secondary ignore"><%= Localizer.localize(\'connection.ignore\') %></button>\n            <span class="js-ignore-msg" style="display: none;"><i class="icon-checkmark"></i> <%= Localizer.localize(\'connection.ignored\') %></span>\n            <span class="js-confirm-msg" style="display: none;"><i class="icon-checkmark"></i> <%~ Localizer.localize(\'connection.connected\', pendingConnection.fullName || pendingConnection.displayName, profileUrl) %></span>\n        </div>\n    </div>\n'}),define("views/notification/PendingConnectionItemView",["require","underscore","backbone","localizer","personalizer","models/connections/AcceptConnection","models/connections/IgnoreConnection","views/privacy/PrivacyAlertModalView","views/privacy/PrivacyAlertView","utils/NavigationUtil","models/user/DefaultProfileImage","text!templates/notification/PendingConnectionItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("models/connections/AcceptConnection"),o=e("models/connections/IgnoreConnection"),u=e("views/privacy/PrivacyAlertModalView"),a=e("views/privacy/PrivacyAlertView"),f=e("utils/NavigationUtil"),l=e("models/user/DefaultProfileImage"),c=e("text!templates/notification/PendingConnectionItemView.html"),h={CONNECTION_CLICKED:"CONNECTION_CLICKED"},p=n.View.extend({events:{"click .confirm":"onConfirmButtonClicked","click .ignore":"onIgnoreButtonClicked","click .js-select-connection":"onConnectionClicked"},initialize:function(e){this.template=t.template(c),this.pendingConnection=e.pendingConnection,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences},render:function(){this.$el.append(this.template({Localizer:r,Personalizer:i,pendingConnection:this.pendingConnection,imageUrl:this.pendingConnection.profileImageUrlSmall||l.medium,profileUrl:f.url("/profile/"+this.pendingConnection.displayName)}))},onConfirmButtonClicked:function(e){e.preventDefault();var t=this,n=new s({connectionRequestId:this.pendingConnection.connectionRequestId});n.save(n.attributes,{success:t.enableMessages(!0)}),this.privacyAlertView=new a({requestType:"connection"}),this.privacyAlertView.on(a.Events.Closed,this.closeModal,this),this.privacyAlertView.on(a.Events.Ready,this.openModal,this)},openModal:function(){this.privacyAlertView.getDisplayModal()&&(this.modalView=new u({view:this.privacyAlertView,showFooter:!0,modalTitle:r.localize("privacy.alert.heading")}),this.modalView.on(u.Events.ON_SAVE,this.onSavePrivacyClicked,this),this.modalView.render())},closeModal:function(){this.modalView.close()},onSavePrivacyClicked:function(){this.privacyAlertView.onSaveClicked()},onIgnoreButtonClicked:function(e){e.preventDefault();var t=this,n=new o({connectionRequestId:this.pendingConnection.connectionRequestId});n.save(n.attributes,{success:t.enableMessages(!1)})},enableMessages:function(e){e?(this.$(".js-confirm-msg").show(),this.$(".js-ignore-msg").hide()):(this.$(".js-confirm-msg").hide(),this.$(".js-ignore-msg").show()),this.$(".confirm").hide(),this.$(".ignore").hide()},onConnectionClicked:function(e){var t="/profile/"+this.pendingConnection.displayName;this.trigger(h.CONNECTION_CLICKED),f.navigate(t,e,!0)}});return p.Events=h,p}),define("models/groups/GroupInviteRequest",["backbone"],function(e){var t=e.Model.extend({idAttribute:"userGroupId",url:function(){return"/proxy/group-service/invite/group/"+this.userGroupId},initialize:function(e){this.userGroupId=e.userGroupId,this.groupInviteId=e.groupInviteId}});return t}),define("models/groups/GroupInviteMemberRequest",["backbone"],function(e){var t=e.Model.extend({idAttribute:"groupMemberRequestId",url:function(){return"/proxy/group-service/private/group/"+this.userGroupId},initialize:function(e){this.userGroupId=e.userGroupId,this.groupMemberRequestId=e.groupMemberRequestId}});return t}),define("text!templates/notification/PendingGroupRequestItemView.html",[],function(){return'<%\nvar imageUrl = "/modern/images/avatar-default.png";\nif (pendingGroupRequest.profileImageUrlSmall) {\n    imageUrl = pendingGroupRequest.profileImageUrlSmall;\n}\n\nvar connectionName = pendingGroupRequest.displayName;\nif (pendingGroupRequest.fullName) {\n    connectionName = pendingGroupRequest.fullName;\n}\n\nvar pendingGroupRequestName = _.escape(pendingGroupRequest.groupName);\nconnectionName = _.escape(connectionName);\n%>\n\n    <a class="request-image" href="<%= pendingGroupRequest.groupMemberRequestId ? profileUrl : groupUrl %>">\n        <% if (pendingGroupRequest.groupMemberRequestId) { %>\n        <img class="avatar js-select-user" src="<%= imageUrl %>" alt="<%= connectionName %>" title="<%= connectionName %>">\n        <% } else { %>\n        <img class="avatar js-select-group" src="<%= imageUrl %>" alt="<%= pendingGroupRequestName %>" title="<%= pendingGroupRequestName %>">\n        <% } %>\n    </a>\n    <div class="request-body">\n        <% if (pendingGroupRequest.groupMemberRequestId) { %>\n        <%~ Localizer.localize(\'group.request\', connectionName, pendingGroupRequestName, profileUrl, groupUrl) %>\n        <% } else { %>\n        <%~ Localizer.localize(\'group.admin.invite\', pendingGroupRequestName, groupUrl) %>\n        <% } %>\n        <div class="request-actions">\n            <button type="button" class="btn btn-small confirm"><%= Localizer.localize(\'connection.confirm\') %></button>\n            <button type="button" class="btn btn-small btn-secondary ignore"><%= Localizer.localize(\'connection.ignore\') %></button>\n            <span class="js-ignore-msg" style="display: none;"><i class="icon-checkmark"></i> <%= Localizer.localize(\'group.request.ignored\') %></span>\n            <span class="js-confirm-msg" style="display: none;"><i class="icon-checkmark"></i> <%= Localizer.localize(\'group.request.accepted\') %></span>\n        </div>\n    </div>\n'}),define("views/notification/PendingGroupRequestItemView",["require","underscore","backbone","localizer","personalizer","models/groups/GroupInviteRequest","models/groups/GroupInviteMemberRequest","views/privacy/PrivacyAlertModalView","views/privacy/PrivacyAlertView","utils/NavigationUtil","text!templates/notification/PendingGroupRequestItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("models/groups/GroupInviteRequest"),o=e("models/groups/GroupInviteMemberRequest"),u=e("views/privacy/PrivacyAlertModalView"),a=e("views/privacy/PrivacyAlertView"),f=e("utils/NavigationUtil"),l=e("text!templates/notification/PendingGroupRequestItemView.html"),c={ON_NAVIGATION:"ON_NAVIGATION"},h=n.View.extend({events:{"click .confirm":"onConfirmButtonClicked","click .ignore":"onIgnoreButtonClicked","click .js-select-group":"onGroupClicked","click .js-select-user":"onUserClicked"},initialize:function(e){this.template=t.template(l),this.pendingConnection=e.pendingConnection,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences},render:function(){this.$el.html(this.template({Localizer:r,Personalizer:i,pendingGroupRequest:this.pendingConnection,profileUrl:f.url("/profile/"+this.pendingConnection.displayName),groupUrl:f.url("/group/"+this.pendingConnection.groupId)}))},onConfirmButtonClicked:function(e){e.preventDefault();var t=this;if(this.pendingConnection.groupInviteId){var n=new s({userGroupId:this.pendingConnection.groupId,groupInviteId:this.pendingConnection.groupInviteId});n.save(n.attributes,{success:t.enableMessages(!0)})}else{var r=new o({userGroupId:this.pendingConnection.groupId,groupMemberRequestId:this.pendingConnection.groupMemberRequestId});r.save(r.attributes,{success:t.enableMessages(!0)})}this.privacyAlertView=new a({requestType:"group"}),this.privacyAlertView.on(a.Events.Closed,this.closeModal,this),this.privacyAlertView.on(a.Events.Ready,this.openModal,this)},openModal:function(){this.privacyAlertView.getDisplayModal()&&(this.modalView=new u({view:this.privacyAlertView,showFooter:!0,modalTitle:r.localize("privacy.alert.heading")}),this.modalView.on(u.Events.ON_SAVE,this.onSavePrivacyClicked,this),this.modalView.render())},closeModal:function(){this.modalView.close()},onSavePrivacyClicked:function(){this.privacyAlertView.onSaveClicked()},onIgnoreButtonClicked:function(e){e.preventDefault();var t=this;if(this.pendingConnection.groupInviteId){var n=new s({userGroupId:this.pendingConnection.groupId,groupInviteId:this.pendingConnection.groupInviteId});n.save(n.attributes,{success:t.enableMessages(!1),beforeSend:function(e){e.setRequestHeader("X-HTTP-Method-Override","DELETE")}})}else{var r=new o({userGroupId:this.pendingConnection.groupId,groupMemberRequestId:this.pendingConnection.groupMemberRequestId});r.save(r.attributes,{success:t.enableMessages(!1),beforeSend:function(e){e.setRequestHeader("X-HTTP-Method-Override","DELETE")}})}},enableMessages:function(e){e?(this.$(".js-confirm-msg").show(),this.$(".js-ignore-msg").hide()):(this.$(".js-confirm-msg").hide(),this.$(".js-ignore-msg").show()),this.$(".confirm").hide(),this.$(".ignore").hide()},onUserClicked:function(e){var t="/profile/"+this.pendingConnection.displayName;this.trigger(c.ON_NAVIGATION),f.navigate(t,e,!0)},onGroupClicked:function(e){var t="/group/"+this.pendingConnection.groupId;this.trigger(c.ON_NAVIGATION),f.navigate(t,e,!0)}});return h.Events=c,h}),define("text!templates/notification/PendingWeightScaleRequestItemView.html",[],function(){return'<%\nvar imageUrl = "/modern/images/avatar-default.png";\nif (pendingRequest.invitorProfilePicURL) {\nimageUrl = pendingRequest.invitorProfilePicURL;\n}\n\nvar connectionName = pendingRequest.invitorName;\n%>\n\n<a class="request-image" href="<%= profileUrl %>">\n    <img class="avatar js-select-user" src="<%= imageUrl %>" alt="<%= connectionName %>" title="<%= connectionName %>">\n</a>\n<div class="request-body">\n    <a href="<%= profileUrl %>" class="colored js-select-user"><%= connectionName %></a> <%= Localizer.localize(\'weight.scale.invited\') %>\n    <div class="request-actions">\n        <a href="<%= getStartedUrl %>" class="btn btn-small btn-get-started"><%= Localizer.localize(\'weight.scale.get.started\')%></a>\n        <button type="button" class="btn btn-small btn-secondary decline btn-decline"><%= Localizer.localize(\'weight.scale.decline.button\')%></button>\n        <span class="inbox-response" style="display: none;"><i class="icon-checkmark"></i><%= Localizer.localize(\'weight.scale.decline.request\')%>\n            <a class="colored undo btn-undo-decline" href="#"><%= Localizer.localize(\'weight.scale.decline.undo.button\')%></a>\n        </span>\n    </div>\n</div>'}),define("views/notification/PendingWeightScaleRequestItemView",["require","underscore","backbone","localizer","personalizer","models/device/DeviceInviteRequest","utils/NavigationUtil","text!templates/notification/PendingWeightScaleRequestItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("models/device/DeviceInviteRequest"),o=e("utils/NavigationUtil"),u=e("text!templates/notification/PendingWeightScaleRequestItemView.html"),a={INVITED:"INVITED",DECLINED:"DECLINED",ACCEPTED:"ACCEPTED"},f={ON_NAVIGATION:"ON_NAVIGATION"},l=n.View.extend({events:{"click .btn-get-started":"onGetStartedButtonClicked","click .btn-decline":"onDeclineButtonClicked","click .btn-undo-decline":"onUndoDeclineButtonClicked","click .js-select-user":"onUserClicked"},initialize:function(e){this.template=t.template(u),this.pendingDeviceInviteRequest=e.pendingDeviceInviteRequest,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences},render:function(){this.$el.html(this.template({Localizer:r,Personalizer:i,pendingRequest:this.pendingDeviceInviteRequest.toJSON(),profileUrl:o.url("/profile/"+this.pendingDeviceInviteRequest.get("invitorDisplayName")),getStartedUrl:o.url(this.getGetStartedUrl())})),this.pendingDeviceInviteRequest.get("deviceInviteStatus")==a.DECLINED&&this.displayDeclineMessages(!0)},onGetStartedButtonClicked:function(e){e.preventDefault(),this.pendingDeviceInviteRequest.set("deviceInviteStatus",a.ACCEPTED);var t=this.getGetStartedUrl();this.trigger(f.ON_NAVIGATION),n.history.navigate(t,{trigger:!0})},getGetStartedUrl:function(){return"/device/get-started/"+this.pendingDeviceInviteRequest.get("deviceId")+"/invite/"+this.pendingDeviceInviteRequest.get("deviceInviteId")},onDeclineButtonClicked:function(e){e.preventDefault();var t=this;this.pendingDeviceInviteRequest.set("deviceInviteStatus",a.DECLINED),this.pendingDeviceInviteRequest.save(this.pendingDeviceInviteRequest.attributes,{success:function(e,n){t.displayDeclineMessages(!0)}})},onUndoDeclineButtonClicked:function(e){e.preventDefault();var t=this;this.pendingDeviceInviteRequest.set("deviceInviteStatus",a.INVITED),this.pendingDeviceInviteRequest.save(this.pendingDeviceInviteRequest.attributes,{success:function(){t.displayDeclineMessages(!1)}})},displayDeclineMessages:function(e){e?(this.$(".inbox-response").show(),this.$(".btn-get-started").hide(),this.$(".btn-decline").hide()):(this.$(".inbox-response").hide(),this.$(".media-action").show(),this.$(".btn-get-started").show(),this.$(".btn-decline").show())},onUserClicked:function(e){var t="/profile/"+this.pendingDeviceInviteRequest.get("invitorDisplayName");this.trigger(f.ON_NAVIGATION),o.navigate(t,e,!0)}});return l.STATUS=a,l.Events=f,l}),define("utils/date/DateParser",["moment","localizer"],function(e,t){function n(){}return n.parseEpoch=function(e){return new Date(e)},n.parseISO=function(t){return e(t).toDate()},n.parseISOUTC=function(t){return e.utc(t).toDate()},n.parseTime=function(e){var n=0,r=0,i="",s=e.split(/:| /);if(s.length>=2){n=+s[0],r=s[1],i=s[2];var o=n*3600+r*60;return i===t.localize("PM")&&n!==12?o+=43200:i===t.localize("AM")&&n===12&&(o-=43200),o}return 0},n}),define("utils/RankingUtil",["localizer","models/user/ViewerSocialProfile"],function(e,t){var n={getFormattedRanking:function(t,n){t=Number(t);if(isNaN(t)||t===0||t===null)return"";var r=n?" "+n:"",i="number_";switch(t){case 1:return i+="st",e.localize(i,t)+r;case 2:return i+="nd",e.localize(i,t)+r;case 3:return i+="rd",e.localize(i,t)+r;default:return t+r}},getCurrentMaxRanking:function(e){if(_.isUndefined(e))return 0;if(e.length>0&&_.isUndefined(e.at(0).get("ranking")))return 1;for(var t=e.length;t>=0;t--){var n=e.at(t);if(!_.isUndefined(n.get("ranking")))return n.get("ranking")}},setRankingInCollection:function(e){if(_.isUndefined(e))return 0;var t=this.getCurrentMaxRanking(e);for(var n=0;n<e.length;n++){var r=e.at(n);if(!_.isUndefined(r.get("ranking")))continue;if(n==0){r.set("ranking",1);continue}var i=e.at(n-1);r.get("value")<i.get("value")&&t++,r.set("ranking",t)}}};return n}),define("text!templates/notification/PendingCommentItemView.html",[],function(){return'<a href="<%= commentUrl %>" class="notification-body js-select-comment">\n    <%~ pendingComment.formatComment %>\n    <div class="date-stamp"><%= pendingComment.numberOfDaysAgo %></div>\n</a>\n'}),define("views/notification/PendingCommentItemView",["require","underscore","backbone","localizer","personalizer","utils/date/DateFormatter","utils/date/DateParser","moment","utils/RankingUtil","utils/NavigationUtil","text!templates/notification/PendingCommentItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("utils/date/DateFormatter"),o=e("utils/date/DateParser"),u=e("moment"),a=e("utils/RankingUtil"),f=e("utils/NavigationUtil"),l=e("text!templates/notification/PendingCommentItemView.html"),c={COMMENTED_ON_USER_ACTIVITY:"COMMENTED_ON_USER_ACTIVITY",COMMENTED_ON_USER_SEGMENT:"COMMENTED_ON_USER_SEGMENT",LEADERBOARD_EARN_FIRST_PLACE:"LEADERBOARD_EARN_FIRST_PLACE",LEADERBOARD_LOSE_FIRST_PLACE:"LEADERBOARD_LOSE_FIRST_PLACE",FAVORITE_SEGMENT_DELETED:"FAVORITE_SEGMENT_DELETED",FAVORITE_SEGMENT_EDITED:"FAVORITE_SEGMENT_EDITED",COMMENTED_ON_USER_DAILYSUMMARY:"COMMENTED_ON_USER_DAILYSUMMARY",COMMENTED_ON_USER_AUTOCHALLENGE:"COMMENTED_ON_USER_AUTOCHALLENGE",COMMENTED_ON_ACTIVITY_THREAD:"COMMENTED_ON_ACTIVITY_THREAD",AUTO_CHALLENGE_WINNER:"AUTO_CHALLENGE_WINNER",ALSO_COMMENTED_ON_USER_SEGMENT:"ALSO_COMMENTED_ON_USER_SEGMENT",ALSO_COMMENTED_ON_USER_DAILYSUMMARY:"ALSO_COMMENTED_ON_USER_DAILYSUMMARY",GROUP_NEWS_POST:"GROUP_NEWS_POST",COMMENTED_ON_GROUP_NEWS_POST:"COMMENTED_ON_GROUP_NEWS_POST",ALSO_COMMENTED_ON_GROUP_NEWS_POST:"ALSO_COMMENTED_ON_GROUP_NEWS_POST",GROUP_INVITE_ACCEPTED:"GROUP_INVITE_ACCEPTED",WEIGHT_SCALE_REMOVED:"WEIGHT_SCALE_REMOVED",WEIGHT_SCALE_MAX_USER:"WEIGHT_SCALE_MAX_USER",INACTIVE_ACTIVITY_TRACKER_USED:"INACTIVE_ACTIVITY_TRACKER_USED",GEAR_MAX_DISTANCE:"GEAR_MAX_DISTANCE",GROUP_CHALLENGE_CREATED:"GROUP_CHALLENGE_CREATED",GROUP_CHALLENGE_START:"GROUP_CHALLENGE_START",GROUP_CHALLENGE_OVER:"GROUP_CHALLENGE_OVER",GROUP_CHALLENGE_BADGE:"GROUP_CHALLENGE_BADGE",ADHOC_CHALLENGE_INVITED:"ADHOC_CHALLENGE_INVITED",ADHOC_CHALLENGE_ACCEPTED:"ADHOC_CHALLENGE_ACCEPTED",ADHOC_CHALLENGE_DECLINED:"ADHOC_CHALLENGE_DECLINED",ADHOC_CHALLENGE_START:"ADHOC_CHALLENGE_START",ADHOC_CHALLENGE_INVITE_WILL_EXPIRE:"ADHOC_CHALLENGE_INVITE_WILL_EXPIRE",ADHOC_CHALLENGE_START_TOMORROW:"ADHOC_CHALLENGE_START_TOMORROW",ADHOC_CHALLENGE_SUMMARY:"ADHOC_CHALLENGE_SUMMARY",CHALLENGE_RANKING_UP:"CHALLENGE_RANKING_UP",CHALLENGE_RANKING_TAKEN:"CHALLENGE_RANKING_TAKEN",CHALLENGE_RANKING_DOWN:"CHALLENGE_RANKING_DOWN",ADHOC_CHALLENGE_ENDING_SOON:"ADHOC_CHALLENGE_ENDING_SOON",ADHOC_CHALLENGE_ENDED:"ADHOC_CHALLENGE_ENDED",ADHOC_CHALLENGE_FIRST_PLACE:"ADHOC_CHALLENGE_FIRST_PLACE",ADHOC_CHALLENGE_NOT_FIRST_PLACE:"ADHOC_CHALLENGE_NOT_FIRST_PLACE",ADHOC_CHALLENGE_ALTERNATE_PRIZE:"ADHOC_CHALLENGE_ALTERNATE_PRIZE",COMMENTED_ON_ADHOC_CHALLENGE:"COMMENTED_ON_ADHOC_CHALLENGE"},h={COMMENT_CLICKED:"COMMENT_CLICKED"},p=n.View.extend({events:{"click .js-select-comment":"onCommentClicked"},initialize:function(e){this.template=t.template(l),this.pendingComment=e.pendingComment,this.viewerDisplayName=e.displayName},render:function(){this.buildCommentMessage(),this.$el.append(this.template({Localizer:r,Personalizer:i,pendingComment:this.pendingComment,commentUrl:f.url(this.pendingComment.relativeUrl)}))},buildCommentMessage:function(){this.pendingComment.numberOfDaysAgo=this.formatMessageDate();var e=t.escape(this.pendingComment.fullName!==null?this.pendingComment.fullName:this.pendingComment.displayName),n=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.name:null),i=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.act_name:null),s=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.act_owner_name:null),o=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.seg_name:null),u=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.well_owner_name:null),a=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.group_name:null),f=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.from_user_name:null),l=this.getMessageFormatEnding(),h=this.pendingComment.type,p="/resource/ui/images/segment-notifications.png";switch(h){case c.COMMENTED_ON_USER_SEGMENT:this.pendingComment.formatComment=r.localize("segment.comment",e),this.pendingComment.relativeUrl=this.buildSegmentUrl(this.pendingComment);break;case c.COMMENTED_ON_USER_ACTIVITY:this.pendingComment.formatComment=r.localize("activity.comment",e),this.pendingComment.relativeUrl=this.buildActivityUrl(this.pendingComment);break;case c.COMMENTED_ON_USER_DAILYSUMMARY:this.pendingComment.formatComment=r.localize("daily.summary.comment",e),this.pendingComment.relativeUrl=this.buildDailyStepUrl(this.pendingComment);break;case c.COMMENTED_ON_USER_AUTOCHALLENGE:this.pendingComment.formatComment=r.localize("auto.challenge.comment",e,this.getChallengeName(this.pendingComment)),this.pendingComment.relativeUrl=this.buildAutoChallengeUrl(this.pendingComment);break;case c.COMMENTED_ON_ACTIVITY_THREAD:i?this.pendingComment.formatComment=r.localize("activity.thread.comment",e,i):s&&(this.pendingComment.formatComment=r.localize("activity.thread.owner.comment",e,s)),this.pendingComment.relativeUrl=this.buildActivityUrl(this.pendingComment);break;case c.ALSO_COMMENTED_ON_USER_SEGMENT:this.pendingComment.formatComment=r.localize("segment.thread.comment",e,o),this.pendingComment.relativeUrl=this.buildSegmentUrl(this.pendingComment);break;case c.ALSO_COMMENTED_ON_USER_DAILYSUMMARY:this.pendingComment.formatComment=r.localize("daily.summary.thread.comment",e,u),this.pendingComment.relativeUrl=this.buildDailyStepAlsoCommentUrl(this.pendingComment);break;case c.AUTO_CHALLENGE_WINNER:this.pendingComment.formatComment=r.localize("autochallenge.last.week.subject",e),this.pendingComment.relativeUrl="/auto-challenge/previous";break;case c.LEADERBOARD_EARN_FIRST_PLACE:this.pendingComment.formatComment=r.localize("segment.leaderboard_earn_first_place",n),this.pendingComment.imageUrl=p,this.pendingComment.relativeUrl=this.buildSegmentUrl(this.pendingComment);break;case c.LEADERBOARD_LOSE_FIRST_PLACE:this.pendingComment.formatComment=r.localize("segment.leaderboard_lost_first_place",n),this.pendingComment.imageUrl=p,this.pendingComment.relativeUrl=this.buildSegmentUrl(this.pendingComment);break;case c.FAVORITE_SEGMENT_DELETED:this.pendingComment.preventClick=!0,this.pendingComment.formatComment=r.localize("segment.favorite_segment_deleted",n),this.pendingComment.imageUrl=p,this.pendingComment.relativeUrl="#";break;case c.FAVORITE_SEGMENT_EDITED:this.pendingComment.formatComment=r.localize("segment.favorite_segment_edited",n),this.pendingComment.imageUrl=p,this.pendingComment.relativeUrl=this.buildSegmentUrl(this.pendingComment);break;case c.GROUP_NEWS_POST:this.pendingComment.formatComment=r.localize("group.create.post",e,a),this.pendingComment.relativeUrl=this.buildGroupNewsPostUrl(this.pendingComment);break;case c.COMMENTED_ON_GROUP_NEWS_POST:this.pendingComment.formatComment=r.localize("group.comment.my.post",e,a),this.pendingComment.relativeUrl=this.buildGroupNewsPostUrl(this.pendingComment);break;case c.ALSO_COMMENTED_ON_GROUP_NEWS_POST:this.pendingComment.formatComment=r.localize("group.comment.other.post",e,a),this.pendingComment.relativeUrl=this.buildGroupNewsPostUrl(this.pendingComment);break;case c.GROUP_INVITE_ACCEPTED:this.pendingComment.formatComment=r.localize("group.invite.accepted",e,a),this.pendingComment.relativeUrl=this.buildGroupUrl(this.pendingComment);break;case c.INACTIVE_ACTIVITY_TRACKER_USED:var d=r.localize("devices.link");d="<a class='colored' href='/devices'>"+d+"</a>",this.pendingComment.formatComment=r.localize("activity.tracker.data.not.synced.message",this.getDeviceName(this.pendingComment),d),this.pendingComment.relativeUrl="/devices";break;case c.GEAR_MAX_DISTANCE:this.pendingComment.formatComment=r.localize("gear.max.distance.met.email.subject",this.getGearName(this.pendingComment)),this.pendingComment.relativeUrl=this.buildGearUrl(this.pendingComment);break;case c.GROUP_CHALLENGE_CREATED:this.pendingComment.formatComment=r.localize("group.challenge.created",a,this.getGroupChallengeName(),this.getGroupChallengeStartDate()),this.pendingComment.relativeUrl=this.getGroupChallengeUrl();break;case c.GROUP_CHALLENGE_START:this.pendingComment.formatComment=r.localize("group.challenge.start",a,this.getGroupChallengeName()),this.pendingComment.relativeUrl=this.getGroupChallengeUrl();break;case c.GROUP_CHALLENGE_OVER:this.pendingComment.formatComment=r.localize("group.challenge.over",this.getRank(),a,this.getGroupChallengeName()),this.pendingComment.relativeUrl=this.getGroupChallengeUrl();break;case c.GROUP_CHALLENGE_BADGE:this.pendingComment.formatComment=r.localize("group.challenge.badge",this.getRank(),a,this.getGroupChallengeName()),this.pendingComment.relativeUrl="/trophy-case";break;case c.WEIGHT_SCALE_REMOVED:this.pendingComment.formatComment=r.localize("weight.scale.has.removed.notification",e),this.pendingComment.relativeUrl="/devices";break;case c.WEIGHT_SCALE_MAX_USER:var v=this.buildDeviceUrl(this.pendingComment);this.pendingComment.formatComment=r.localize("weight.scale.max.user.notification",e,v),this.pendingComment.relativeUrl=v;break;case c.ADHOC_CHALLENGE_ACCEPTED:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_accepted_format"+l,f);break;case c.ADHOC_CHALLENGE_DECLINED:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_declined_format"+l,f);break;case c.ADHOC_CHALLENGE_START:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_start_format"+l);break;case c.ADHOC_CHALLENGE_INVITE_WILL_EXPIRE:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_invite_will_expire_format"+l,f);break;case c.ADHOC_CHALLENGE_START_TOMORROW:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_start_tomorrow_format"+l);break;case c.ADHOC_CHALLENGE_SUMMARY:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_summary_format"+l);break;case c.CHALLENGE_RANKING_UP:this.pendingComment.relativeUrl=this.getChallengeUrl();var n=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.name:null);this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_rank_up_format"+l,n);break;case c.CHALLENGE_RANKING_TAKEN:this.pendingComment.relativeUrl=this.getChallengeUrl();var n=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.name:null);this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_rank_taken_format"+l,n);break;case c.CHALLENGE_RANKING_DOWN:this.pendingComment.relativeUrl=this.getChallengeUrl();var n=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.name:null);this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_rank_down_format"+l,n);break;case c.ADHOC_CHALLENGE_ENDING_SOON:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_ending_soon_format"+l);break;case c.ADHOC_CHALLENGE_ENDED:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_ended_format"+l);break;case c.ADHOC_CHALLENGE_FIRST_PLACE:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_first_place_format"+l);break;case c.ADHOC_CHALLENGE_NOT_FIRST_PLACE:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_not_first_place_format"+l);break;case c.ADHOC_CHALLENGE_ALTERNATE_PRIZE:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_adhoc_challenge_alternate_prize_format"+l);break;case c.COMMENTED_ON_ADHOC_CHALLENGE:this.pendingComment.relativeUrl=this.getChallengeUrl(),this.pendingComment.formatComment=r.localize("pn_commented_on_adhoc_challenge",e);break;default:console&&console.log&&console.log("Unexpected notification type: "+h)}},getMessageFormatEnding:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.from_user_name:null);return e&&e>1?"_"+e:""},getChallengeUrl:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.challenge_uuid:null);return e||(e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.adhoc_challenge_uuid:null)),"/adhoc-challenge/"+e},getGroupChallengeUrl:function(){var e=this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.challengeId:null,t="/challenge";return e&&(t+="/"+e),t},getRank:function(){var e=this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.rank:null;return a.getFormattedRanking(e)},formatMessageDate:function(){var e=o.parseISOUTC(this.pendingComment.dateTimeString);return s.formatTimeAgo(e)},buildSegmentUrl:function(e){var t=null,n=e.relativeNameValue;return n&&n.segment&&(t="/segment/"+n.segment),t},buildActivityUrl:function(e){var t=null,n=e.relativeNameValue;return n&&n.group?t="/group/"+n.group:n&&n.activity&&(t="/activity/"+n.activity),t},buildDailyStepUrl:function(e){var t=null,n=e.relativeNameValue;return n&&(n.group?t="/group/"+n.group:n.welldaily&&(t="/daily-summary/"+this.viewerDisplayName+"/"+n.welldaily)),t},buildDailyStepAlsoCommentUrl:function(e){var t=null,n=e.relativeNameValue;return n&&(n.group?t="/group/"+n.group:n.welldaily&&(t="/daily-summary/"+n.well_owner_displayname+"/"+n.welldaily)),t},buildAutoChallengeUrl:function(e){var t="/auto-challenge",n=e.relativeNameValue;return n&&n.chall_period&&(t="/auto-challenge/previous"),t},buildGroupUrl:function(e){var t=null,n=e.relativeNameValue;return n&&n.group&&(t="/group/"+n.group),t},buildDeviceUrl:function(e){var t=null,n=e.relativeNameValue;return n&&n.device&&(t="/device/"+n.device),t},buildGroupNewsPostUrl:function(e){var t=null,n=e.relativeNameValue;return n&&n.group&&n.newspost&&(t="/group/"+n.group+"/newspost/"+n.newspost),t},buildGearUrl:function(e){var t="/gear",n=e.relativeNameValue;return n&&n.gear_type&&(t+="/"+n.gear_type),t},getChallengeName:function(e){var t=e.relativeNameValue;if(t&&t.chall_level){var n=t.chall_level,i=t.chall_steps;return i==0?r.localize("challenge_"+n):r.localize("challenge_level",n)}return""},getDeviceName:function(e){return t.escape(e.relativeNameValue?e.relativeNameValue.device_name:null)},getGearName:function(e){return t.escape(e.relativeNameValue?e.relativeNameValue.gear_name:null)},getGroupChallengeTypeKey:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.group_challenge_type:null),n=null;switch(e){case"0":n="group.challenge.most.walking.distance";break;case"1":n="group.challenge.most.running.distance";break;case"2":n="group.challenge.most.cycling.distance";break;case"3":n="group.challenge.most.swimming.distance";break;case"4":n="group.challenge.most.steps.count";break;case"5":n="group.challenge.most.steps.distance";break;case"6":n="group.challenge.most.calories.burned";break;default:n=null}return n},getGroupChallengeMonthKey:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.start_time_gmt:null),n=new Date(Number(e)),r=n.getMonth();r<=9&&(r="0"+r);var i="month."+r;return i},getGroupChallengeStartDate:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.start_time_gmt:null),n=new Date(Number(e));return s.formatDate(n)},getGroupChallengeName:function(){var e=t.escape(this.pendingComment.relativeNameValue?this.pendingComment.relativeNameValue.group_challenge_name:null);return e},onCommentClicked:function(e){this.pendingComment.relativeUrl&&(this.trigger(h.COMMENT_CLICKED),f.navigate(this.pendingComment.relativeUrl,e,!0))}});return p.Events=h,p}),define("models/adhocchallenge/AdhocChallengeConsent",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return"/proxy/adhocchallenge-service/adHocChallenge/invite/"+this.inviteId+"/"+this.scope},initialize:function(e,t){this.inviteId=e.inviteId,this.scope=e.scope,this.options=t}});return n}),define("text!templates/notification/PendingChallengeItemView.html",[],function(){return'<a class="request-image js-user-link" href="<%= profileUrl %>">\n    <img class="avatar js-select-user" src="<%= picture %>" alt="<%= ownerName %>" title="<%= ownerName %>">\n</a>\n<div class="request-body">\n    <%~ message %>\n    <div class="request-actions">\n        <button type="button" class="btn btn-small accept js-accept-btn"><%= acceptButtonText %></button>\n        <button type="button" class="btn btn-small btn-secondary decline js-decine-btn"><%= declineButtonText %></button>\n        <span class="js-ignore-msg" style="display: none;"><i class="icon-checkmark"></i> <%= challengeIgnoredMessage %></span>\n        <span class="js-confirm-msg" style="display: none;"><i class="icon-checkmark"></i> <%= challengeAcceptedMessage %></span>\n    </div>\n</div>'}),define("views/notification/PendingChallengeItemView",["require","underscore","localizer","personalizer","backbone","views/main/Modal/ModalWarningView","utils/NavigationUtil","models/adhocchallenge/AdhocChallengeConsent","models/user/DefaultProfileImage","text!templates/notification/PendingChallengeItemView.html"],function(e){var t=e("underscore"),n=e("localizer"),r=e("personalizer"),i=e("backbone"),s=e("views/main/Modal/ModalWarningView"),o=e("utils/NavigationUtil"),u=e("models/adhocchallenge/AdhocChallengeConsent"),a=e("models/user/DefaultProfileImage"),f=e("text!templates/notification/PendingChallengeItemView.html"),l={ON_NAVIGATION:"ON_NAVIGATION"},c=i.View.extend({events:{"click .js-accept-btn":"onConfirmButtonClicked","click .js-decine-btn":"onIgnoreButtonClicked","click .js-challenge-link":"gotoChallenge","click .js-select-user":"onUserClicked"},initialize:function(e){this.template=t.template(f),this.notification=e.notification},render:function(){var e=this.notification.get("userImageUrl")||a.medium,t=this.notification.get("adHocChallengeName"),r=this.notification.get("invitorName")||this.notification.get("invitorDisplayName"),i=o.url("/profile/"+this.notification.get("invitorDisplayName")),s=o.url("/adhoc-challenge/"+this.notification.get("adHocChallengeUuid")),u=n.localize("pn_adhoc_challenge_invited_format",r,t,i,s);this.$el.html(this.template({profileUrl:i,picture:e,message:u,challengeName:t,ownerName:r,acceptButtonText:n.localize("connection.confirm"),declineButtonText:n.localize("connection.ignore"),challengeIgnoredMessage:n.localize("challenge_ignored"),challengeAcceptedMessage:n.localize("challenge_accepted")}))},onConfirmButtonClicked:function(e){e.preventDefault();var t=this;this.adhocChallengeConsent=new u({inviteId:this.notification.get("adHocChallengeInviteId"),scope:"accept"}),this.enableMessages(!0),this.adhocChallengeConsent.save({},{type:"PUT"})},onIgnoreButtonClicked:function(e){e.preventDefault();var t=this;this.modalConfirmationView=new s({modalTitle:n.localize("decline_invite"),message:n.localize("are_you_sure_you_want_to_decline_challenge"),htmlFormat:!0,confirmationTextKey:"weight.scale.decline.button",cancelTextKey:"button_cancel",onSaveButtonClicked:t.declineChallenge.bind(t)}),this.modalConfirmationView.render()},declineChallenge:function(){this.modalConfirmationView.close(),this.adhocChallengeConsent=new u({inviteId:this.notification.get("adHocChallengeInviteId"),scope:"decline"}),this.enableMessages(!1),this.adhocChallengeConsent.save({},{type:"PUT"})},onUserClicked:function(e){var t="/profile/"+this.notification.get("invitorDisplayName");this.trigger(l.ON_NAVIGATION),o.navigate(t,e,!0)},gotoChallenge:function(e){var t=this.notification.get("adHocChallengeUuid");if(t){var n="/adhoc-challenge/"+t;this.trigger(l.ON_NAVIGATION),o.navigate(n,e,!0)}},enableMessages:function(e){e?(this.$(".js-confirm-msg").show(),this.$(".js-ignore-msg").hide()):(this.$(".js-confirm-msg").hide(),this.$(".js-ignore-msg").show()),this.$(".js-accept-btn").hide(),this.$(".js-decine-btn").hide()}});return c.Events=l,c}),define("utils/NotificationPoller",[],function(){var e=function(e){this.initialize(e)};return e.prototype={initialize:function(e){window.NotificationPoller=this,this.pollingTerminated=!1,this.collections=[],this.lastEventTime=new Date,this.pollTime=e.pollTime,this.idleTimeCheckInSeconds=600,this.interval=e.interval,this.lastEventTime=new Date,jQuery(window).unbind("beforeunload"),jQuery(window).bind("beforeunload",function(){typeof window.NotificationPoller!="undefined"&&window.NotificationPoller!=null&&(window.NotificationPoller.pollingTerminated=!0,window.NotificationPoller.stopPolling())}),jQuery(document).ready(function(e){e(document).bind("mousemove keyup mousewheel",window.NotificationPoller.keepAlive)})},addCollection:function(e){if(typeof e=="undefined"||e==null)throw new Error("Collection is required.");if(typeof e.poll=="undefined")throw new Error("Collection must implement a poll method.");if(typeof e.isPollingEnabled=="undefined")throw new Error("Collection must implement isPollingEnabled method.");this.collections.push(e)},poll:function(){var e=window.NotificationPoller;e.pollingTimeoutHandle=null;var t=new Date,n=(t.getTime()-e.lastEventTime.getTime())/1e3;n>e.idleTimeCheckInSeconds?(e.lastEventTime=new Date,e.log("NotificationPoller Idle time has elapsed"),e.stopPolling()):(e.log("Start notification polling operations."),e.removeInactiveCollections(),jQuery.each(e.collections,function(e,t){t.poll()}),e.start())},removeInactiveCollections:function(){var e=[];jQuery.each(this.collections,function(t,n){n.isPollingEnabled()&&e.push(n)}),this.collections=e},start:function(){var e=this;this.stopPolling(),this.collections.length>0?(this.pollingTimeoutHandle=window.setTimeout(e.poll,this.pollTime),this.log("Notification Polling is teed up.")):this.log("No enabled notification models available to poll.")},isPollingStarted:function(){return typeof this.pollingTimeoutHandle!="undefined"&&this.pollingTimeoutHandle!==null},stopPolling:function(){this.isPollingStarted()&&(window.clearTimeout(this.pollingTimeoutHandle),this.pollingTimeoutHandle=null,this.log("Notification Polling is stopped."))},keepAlive:function(){var e=window.NotificationPoller;e!=null&&(e.lastEventTime=new Date,e.pollingTimeoutHandle!=null&&!e.pollingTerminated&&!e.isPollingStarted()&&e.collections.length>0&&(e.log("User activity detected. Restarting notification polling."),e.start()))},log:function(e){return}},e}),define("text!templates/notification/NotificationsPopupMenuView.html",[],function(){return'<div class="alert alert-error hide">\n    <p><%= Localizer.localize(\'request.error.msg\') %></p>\n</div>\n<% if(notificationsLoaded) { %>\n    <% if(showItems) { %>\n    <div class="header-nav-menu-section section-header requests-header">\n        <h2 class="section-name"><%= Localizer.localize(\'requests.title\') %></h2>\n        <div class="js-new-requests-count new-items-alert hide"></div>\n    </div>\n\n    <span class="js-pending-requests-placeholder"></span>\n\n    <div class="header-nav-menu-section section-header notifications-header">\n        <h2 class="section-name"><%= Localizer.localize(\'notifications.title\') %></h2>\n        <div class="js-new-notifications-count new-items-alert hide"></div>\n    </div>\n\n    <span class="js-pending-notifications-placeholder"></span>\n\n    <% } else { %>\n    <div class="empty-state js-no-pending-requests-or-notifications"><%= Localizer.localize(\'no_requests_or_notifications\') %></div>\n    <% } %>\n<% } else { %>\n<div class="notifications-skeletons">\n    <div class="skeleton-item skeleton-request clearfix">\n        <div class="skeleton-object skeleton-avatar"></div>\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-button"></div>\n        <div class="skeleton-object skeleton-button"></div>\n    </div>\n    <div class="skeleton-item skeleton-request clearfix">\n        <div class="skeleton-object skeleton-avatar"></div>\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-button"></div>\n        <div class="skeleton-object skeleton-button"></div>\n    </div>\n    <div class="skeleton-item skeleton-notification">\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-date"></div>\n    </div>\n    <div class="skeleton-item skeleton-notification">\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-date"></div>\n    </div>\n    <div class="skeleton-item skeleton-notification">\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-text"></div>\n        <div class="skeleton-object skeleton-date"></div>\n    </div>\n</div>\n<% } %>\n\n'}),define("views/notification/NotificationsPopupMenuView",["require","underscore","backbone","localizer","collections/notification/Notifications","collections/connections/PendingConnections","collections/groups/PendingGroupRequests","collections/device/PendingDeviceInviteRequests","collections/adhocchallenge/PendingChallengeInviteRequests","models/notification/Notification","models/notification/NotificationMeta","models/connections/NotViewedConnection","models/connections/PendingConnection","models/groups/PendingGroupRequest","views/notification/PendingConnectionItemView","views/notification/PendingGroupRequestItemView","views/notification/PendingWeightScaleRequestItemView","views/notification/PendingCommentItemView","views/notification/PendingChallengeItemView","utils/extensions/Loadable","utils/ModelSynchronizer","utils/NotificationPoller","text!templates/notification/NotificationsPopupMenuView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("collections/notification/Notifications"),s=e("collections/connections/PendingConnections"),o=e("collections/groups/PendingGroupRequests"),u=e("collections/device/PendingDeviceInviteRequests"),a=e("collections/adhocchallenge/PendingChallengeInviteRequests"),f=e("models/notification/Notification"),l=e("models/notification/NotificationMeta"),c=e("models/connections/NotViewedConnection"),h=e("models/connections/PendingConnection"),p=e("models/groups/PendingGroupRequest"),d=e("views/notification/PendingConnectionItemView"),v=e("views/notification/PendingGroupRequestItemView"),m=e("views/notification/PendingWeightScaleRequestItemView"),g=e("views/notification/PendingCommentItemView"),y=e("views/notification/PendingChallengeItemView"),b=e("utils/extensions/Loadable"),w=e("utils/ModelSynchronizer"),E=e("utils/NotificationPoller"),S=e("text!templates/notification/NotificationsPopupMenuView.html"),x={REFRESH_COUNT:"REFRESH_COUNT",ON_NAVIGATION:"ON_NAVIGATION"},T={COMMENTED_ON_USER_ACTIVITY:"COMMENTED_ON_USER_ACTIVITY",COMMENTED_ON_USER_SEGMENT:"COMMENTED_ON_USER_SEGMENT",LEADERBOARD_EARN_FIRST_PLACE:"LEADERBOARD_EARN_FIRST_PLACE",LEADERBOARD_LOSE_FIRST_PLACE:"LEADERBOARD_LOSE_FIRST_PLACE",FAVORITE_SEGMENT_DELETED:"FAVORITE_SEGMENT_DELETED",FAVORITE_SEGMENT_EDITED:"FAVORITE_SEGMENT_EDITED",GROUP_INVITE:"GROUP_INVITE",MEMBER_REQUEST:"MEMBER_REQUEST",CONNECTION_REQUEST:"CONNECTION_REQUEST",COMMENTED_ON_USER_DAILYSUMMARY:"COMMENTED_ON_USER_DAILYSUMMARY",COMMENTED_ON_USER_AUTOCHALLENGE:"COMMENTED_ON_USER_AUTOCHALLENGE",COMMENTED_ON_ACTIVITY_THREAD:"COMMENTED_ON_ACTIVITY_THREAD",AUTO_CHALLENGE_WINNER:"AUTO_CHALLENGE_WINNER",ALSO_COMMENTED_ON_USER_SEGMENT:"ALSO_COMMENTED_ON_USER_SEGMENT",ALSO_COMMENTED_ON_USER_DAILYSUMMARY:"ALSO_COMMENTED_ON_USER_DAILYSUMMARY",GROUP_NEWS_POST:"GROUP_NEWS_POST",COMMENTED_ON_GROUP_NEWS_POST:"COMMENTED_ON_GROUP_NEWS_POST",ALSO_COMMENTED_ON_GROUP_NEWS_POST:"ALSO_COMMENTED_ON_GROUP_NEWS_POST",GROUP_INVITE_ACCEPTED:"GROUP_INVITE_ACCEPTED",WEIGHT_SCALE_INVITE:"WEIGHT_SCALE_INVITE",WEIGHT_SCALE_REMOVED:"WEIGHT_SCALE_REMOVED",WEIGHT_SCALE_MAX_USER:"WEIGHT_SCALE_MAX_USER",INACTIVE_ACTIVITY_TRACKER_USED:"INACTIVE_ACTIVITY_TRACKER_USED",GEAR_MAX_DISTANCE:"GEAR_MAX_DISTANCE",GROUP_CHALLENGE_CREATED:"GROUP_CHALLENGE_CREATED",GROUP_CHALLENGE_START:"GROUP_CHALLENGE_START",GROUP_CHALLENGE_OVER:"GROUP_CHALLENGE_OVER",GROUP_CHALLENGE_BADGE:"GROUP_CHALLENGE_BADGE",ADHOC_CHALLENGE_INVITED:"ADHOC_CHALLENGE_INVITED",ADHOC_CHALLENGE_ACCEPTED:"ADHOC_CHALLENGE_ACCEPTED",ADHOC_CHALLENGE_DECLINED:"ADHOC_CHALLENGE_DECLINED",ADHOC_CHALLENGE_START:"ADHOC_CHALLENGE_START",ADHOC_CHALLENGE_INVITE_WILL_EXPIRE:"ADHOC_CHALLENGE_INVITE_WILL_EXPIRE",ADHOC_CHALLENGE_START_TOMORROW:"ADHOC_CHALLENGE_START_TOMORROW",ADHOC_CHALLENGE_SUMMARY:"ADHOC_CHALLENGE_SUMMARY",CHALLENGE_RANKING_UP:"CHALLENGE_RANKING_UP",CHALLENGE_RANKING_TAKEN:"CHALLENGE_RANKING_TAKEN",CHALLENGE_RANKING_DOWN:"CHALLENGE_RANKING_DOWN",ADHOC_CHALLENGE_ENDING_SOON:"ADHOC_CHALLENGE_ENDING_SOON",ADHOC_CHALLENGE_ENDED:"ADHOC_CHALLENGE_ENDED",ADHOC_CHALLENGE_FIRST_PLACE:"ADHOC_CHALLENGE_FIRST_PLACE",ADHOC_CHALLENGE_NOT_FIRST_PLACE:"ADHOC_CHALLENGE_NOT_FIRST_PLACE",ADHOC_CHALLENGE_ALTERNATE_PRIZE:"ADHOC_CHALLENGE_ALTERNATE_PRIZE",COMMENTED_ON_ADHOC_CHALLENGE:"COMMENTED_ON_ADHOC_CHALLENGE"},N={COMMENTED_ON_USER_ACTIVITY:"comment",COMMENTED_ON_USER_SEGMENT:"comment",LEADERBOARD_EARN_FIRST_PLACE:"comment",LEADERBOARD_LOSE_FIRST_PLACE:"comment",FAVORITE_SEGMENT_DELETED:"comment",FAVORITE_SEGMENT_EDITED:"comment",COMMENTED_ON_USER_DAILYSUMMARY:"comment",COMMENTED_ON_USER_AUTOCHALLENGE:"comment",COMMENTED_ON_ACTIVITY_THREAD:"comment",AUTO_CHALLENGE_WINNER:"comment",ALSO_COMMENTED_ON_USER_SEGMENT:"comment",ALSO_COMMENTED_ON_USER_DAILYSUMMARY:"comment",GROUP_NEWS_POST:"group",COMMENTED_ON_GROUP_NEWS_POST:"group",ALSO_COMMENTED_ON_GROUP_NEWS_POST:"group",GROUP_INVITE_ACCEPTED:"group",WEIGHT_SCALE_REMOVED:"scale",WEIGHT_SCALE_MAX_USER:"scale",INACTIVE_ACTIVITY_TRACKER_USED:"system",GEAR_MAX_DISTANCE:"gear",GROUP_CHALLENGE_CREATED:"group",GROUP_CHALLENGE_START:"group",GROUP_CHALLENGE_OVER:"group",GROUP_CHALLENGE_BADGE:"group",ADHOC_CHALLENGE_ACCEPTED:"group",ADHOC_CHALLENGE_DECLINED:"group",ADHOC_CHALLENGE_START:"group",ADHOC_CHALLENGE_INVITE_WILL_EXPIRE:"group",ADHOC_CHALLENGE_START_TOMORROW:"group",ADHOC_CHALLENGE_SUMMARY:"group",CHALLENGE_RANKING_UP:"group",CHALLENGE_RANKING_TAKEN:"group",CHALLENGE_RANKING_DOWN:"group",ADHOC_CHALLENGE_ENDING_SOON:"group",ADHOC_CHALLENGE_ENDED:"group",ADHOC_CHALLENGE_FIRST_PLACE:"group",ADHOC_CHALLENGE_NOT_FIRST_PLACE:"group",COMMENTED_ON_ADHOC_CHALLENGE:"group"},C=n.View.extend(b),k=C.extend({propertyFiles:["/main/js/properties/notification/notification","/main/js/properties/privacy_alert/privacy_alert","/main/js/properties/challengewidget/challengewidget","/main/js/properties/email-template/email-template"],template:t.template(S),initialize:function(e){this.displayName=e.displayName,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences,this.notificationsLoaded=!1,this.pollTimeoutValue=parseInt(e.pollTimeoutValue,10),this.unviewedCount=0,this.newRequestsCount=0,this.newNotificationsCount=0,this.notifications=new i,this.notifications.bind("error",this.defaultErrorHandler,this),this.pendingConnections=new s,this.pendingConnections.bind("error",this.defaultErrorHandler,this),this.pendingGroupRequests=new o,this.pendingGroupRequests.setDisplayName(this.displayName),this.pendingGroupRequests.bind("error",this.defaultErrorHandler,this),this.pendingDeviceInviteRequests=new u,this.pendingGroupRequests.setDisplayName(this.displayName),this.pendingGroupRequests.bind("error",this.defaultErrorHandler,this),this.pendingChallengeInviteRequests=new a,this.pendingChallengeInviteRequests.bind("error",this.defaultErrorHandler,this),this.notificationCount=new l,this.notificationCount.bind("error",this.defaultErrorHandler,this),this.notificationCount.bind("add",this.handleNotificationCount,this),this.configurePolling()},configurePolling:function(){if(typeof this.notificationPoller=="undefined"||this.notificationPoller===null)this.notificationPoller=new E({pollTime:this.pollTimeoutValue});this.notificationPoller.isPollingStarted()===!1&&(this.notificationPoller.addCollection(this.notificationCount),this.notificationPoller.start())},handleNotificationCount:function(e){var t=e.get("count").counts;this.unviewedCount=0;if(t)for(var n=0;n<t.length;n++){var r=t[n];T[r.name]&&(this.unviewedCount+=r.count)}this.updateNonViewedMessageCount()},loadNotificationCounter:function(){var e=new w;e.addModel({model:this.notificationCount,required:!0}),e.bind(w.Events.SYNCHRONIZED,this.onNotificationsCounterFetched,this),e.fetchModels()},onNotificationsCounterFetched:function(){this.handleNotificationCount(this.notificationCount)},defaultErrorHandler:function(e,t){this.$(".alert-error").show(),this.$(".empty-state").hide(),this.log(arguments),this.notificationPoller.stopPolling()},updateNonViewedMessageCount:function(e){this.trigger(x.REFRESH_COUNT,t.isNumber(e)?e:this.unviewedCount)},render:function(){var e=this.template({Localizer:r,showItems:!this.thereAreNoItems(),notificationsLoaded:this.notificationsLoaded});this.$el.html(e),this.thereAreNoRequests()&&this.$(".requests-header").hide(),this.thereAreNoNotifications()&&this.$(".notifications-header").hide(),this.thereAreNoItems()?this.$(".js-no-pending-requests-or-notifications").show():(this.newRequestsCount=0,this.newNotificationsCount=0,this.renderRequests(),this.renderNotifications(),this.toggleNewItemsCount(),this.resetViewedItems(),this.updateNonViewedMessageCount(0))},thereAreNoRequests:function(){return this.pendingConnections.length===0&&this.pendingGroupRequests.length===0&&this.pendingDeviceInviteRequests.length===0&&this.pendingChallengeInviteRequests.length===0},thereAreNoNotifications:function(){return this.notifications.length===0},thereAreNoItems:function(){return this.thereAreNoRequests()&&this.thereAreNoNotifications()},toggleNewItemsCount:function(){this.newRequestsCount>0&&this.$(".js-new-requests-count").html(this.newRequestsCount).show(),this.newNotificationsCount>0&&this.$(".js-new-notifications-count").html(this.newNotificationsCount).show()},renderRequests:function(){var e=this.$(".js-pending-requests-placeholder");this.pendingConnections.each(function(t){e.append("<div class='header-nav-menu-section request-item js-pending-connection-"+t.get("connectionRequestId")+"'></div>")},this),this.pendingGroupRequests.each(function(t){e.append("<div class='header-nav-menu-section request-item js-pending-group-"+(t.get("groupMemberRequestId")?t.get("groupMemberRequestId"):t.get("groupInviteId"))+"'></div>")},this),this.pendingDeviceInviteRequests.each(function(t){e.append("<div class='header-nav-menu-section request-item js-pending-device-invite-"+t.get("deviceInviteId")+"'></div>")},this),this.pendingChallengeInviteRequests.each(function(t){var n="js-pending-challenge-invite-"+t.get("adHocChallengeUuid");e.append("<div class='header-nav-menu-section request-item "+n+"'></div>"),this.renderAdhocRequestNotificationItem(t,n)},this);var t=this;this.pendingConnections.each(function(e){e.get("requestViewed")||(t.$(".js-pending-connection-"+e.get("connectionRequestId")).addClass("unread"),this.newRequestsCount++);var n=new d({el:t.$(".js-pending-connection-"+e.get("connectionRequestId")),pendingConnection:e.toJSON(),userProfile:this.userProfile,userPreferences:this.userPreferences});this.listenTo(n,d.Events.CONNECTION_CLICKED,function(){this.trigger(x.ON_NAVIGATION)}),n.render()},this),this.pendingGroupRequests.each(function(e){var n=e.get("groupMemberRequestId")?e.get("groupMemberRequestId"):e.get("groupInviteId");e.get("requestViewed")||(t.$(".js-pending-group-"+n).addClass("unread"),this.newRequestsCount++);var r=new v({el:t.$(".js-pending-group-"+n),pendingConnection:e.toJSON(),userProfile:this.userProfile,userPreferences:this.userPreferences});this.listenTo(r,v.Events.ON_NAVIGATION,function(){this.trigger(x.ON_NAVIGATION)}),r.render()},this),this.pendingDeviceInviteRequests.each(function(e){if(e.get("deviceInviteStatus")===m.STATUS.ACCEPTED)return!0;var n=e.get("deviceInviteId");e.get("requestViewed")||(t.$(".js-pending-device-invite-"+n).addClass("unread"),this.newRequestsCount++);var r=new m({el:t.$(".js-pending-device-invite-"+n),pendingDeviceInviteRequest:e,userProfile:this.userProfile,userPreferences:this.userPreferences});this.listenTo(r,m.Events.ON_NAVIGATION,function(){this.trigger(x.ON_NAVIGATION)}),r.render()},this)},renderNotifications:function(){var e=0,t=this.$(".js-pending-notifications-placeholder");this.notifications.each(function(n){if(N[n.get("type")]){t.append("<div class='header-nav-menu-section notification-item "+N[n.get("type")]+"-notification js-pending-comment-"+e+"'></div>");var r=this.$(".js-pending-comment-"+e);n.get("viewed")||(r.addClass("unread"),this.newNotificationsCount++),this.renderGenericNotification(n,r),e++}},this)},renderAdhocRequestNotificationItem:function(e,t){e.get("requestViewed")||(this.$("."+t).addClass("unread"),this.newRequestsCount++);var n=new y({el:this.$("."+t),notification:e});this.listenTo(n,y.Events.ON_NAVIGATION,function(){this.trigger(x.ON_NAVIGATION)}),n.render()},renderGenericNotification:function(e,t){var n=new g({el:t,pendingComment:e.toJSON(),displayName:this.displayName});this.listenTo(n,g.Events.COMMENT_CLICKED,function(){this.trigger(x.ON_NAVIGATION)}),n.render()},provideDependencies:function(e){e.addModel({model:this.notifications,required:!0}),e.addModel({model:this.pendingConnections,required:!0}),e.addModel({model:this.pendingGroupRequests,required:!0}),e.addModel({model:this.pendingDeviceInviteRequests,required:!0}),e.addModel({model:this.pendingChallengeInviteRequests,required:!0})},onDependenciesLoaded:function(){this.notificationsLoaded=!0,this.render()},resetViewedItems:function(){var e=this;this.pendingConnections.each(function(t){t.get("requestViewed")||t.save(t.attributes,{url:"/proxy/userprofile-service/connection/notViewedRequestCount",contentType:"application/json; charset=utf-8",success:function(){e.unviewedCount--,e.updateNonViewedMessageCount()}})},this),this.pendingGroupRequests.each(function(t){t.get("requestViewed")||(t.setDisplayName(e.displayName),t.save(t.attributes,{success:function(){e.unviewedCount--,e.updateNonViewedMessageCount()}}))},this),this.pendingDeviceInviteRequests.each(function(t){if(!t.get("requestViewed")){var n="/proxy/weightscale-service/weightscale/invite/"+t.get("deviceInviteId")+"/requestViewed/1";t.save({},{url:n,contentType:"application/json; charset=utf-8",success:function(){e.unviewedCount--,e.updateNonViewedMessageCount()}})}},this),this.notifications.each(function(t){t.get("viewed")||(e.unviewedCount--,e.updateNonViewedMessageCount())},this)},log:function(){typeof console!="undefined"&&typeof console.log!="undefined"&&console.log(arguments)}});return k.Events=x,k}),define("utils/AuthenticationUtil",[],function(){var e={signOut:function(){this.signOutFromLegacy(function(){this.signOutFromModern()}.bind(this))},signOutFromModern:function(){location.href="/modern/auth/logout"},signOutFromLegacy:function(e){var t=location.protocol+"//"+location.host+"/sso-signout/",n=jQuery.get(t,function(e){}).always(function(){jQuery.cookie("JSESSIONID",null,{path:"/"}),typeof e=="function"&&e()})}};return e}),define("text!templates/main/MainContainer/UserPopupMenuView.html",[],function(){return'<div class="header-nav-menu-section">\n    <div class="full-name h5">\n        <% if (userIsPro) { %>\n            <!-- per UX, PRO is not translated -->\n            <span class="label-pro"><i class="icon-checkmark"></i>PRO</span>\n        <% } %>\n        <%= fullName %>\n    </div>\n    <a href="<%= profileUrl %>" class="colored view-profile"><%= Localizer.localize(\'view_user_profile\') %></a>\n</div>\n\n<div class="header-nav-menu-section">\n    <ul>\n        <li><a href="<%= settingsUrl %>" class="colored account-settings"><%= Localizer.localize(\'account_settings\') %></a></li>\n    </ul>\n</div>\n\n<div class="header-nav-menu-section">\n    <ul>\n        <li><a href="<%= helpUrl %>" class="colored"><%= Localizer.localize(\'help.title\') %></a></li>\n        <li><a href="#" class="sign-out colored"><%= Localizer.localize(\'sign.out.title\') %></a></li>\n    </ul>\n</div>'}),define("views/main/MainContainer/UserPopupMenuView",["require","underscore","backbone","localizer","models/user/UserPreference","models/user/ViewerUserPreferences","utils/tour/TourController","utils/tour/tours/WhatsNewUserTour","utils/AuthenticationUtil","utils/NavigationUtil","text!templates/main/MainContainer/UserPopupMenuView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("models/user/UserPreference"),s=e("models/user/ViewerUserPreferences"),o=e("utils/tour/TourController"),u=e("utils/tour/tours/WhatsNewUserTour"),a=e("utils/AuthenticationUtil"),f=e("utils/NavigationUtil"),l=e("text!templates/main/MainContainer/UserPopupMenuView.html"),c={ON_NAVIGATION:"ON_NAVIGATION"},h=n.View.extend({events:{"click .view-profile":"navigateLink","click .account-settings":"navigateLink","click .sign-out":"onSignOutClicked"},template:t.template(l),initialize:function(e){this.viewerSocialProfile=e.viewerSocialProfile},render:function(){var e=this.template({Localizer:r,fullName:this.viewerSocialProfile.get("fullName")||this.viewerSocialProfile.get("displayName"),userIsPro:this.viewerSocialProfile.get("userPro"),helpUrl:this.getHelpUrl(),profileUrl:this.getUserProfileUrl(),settingsUrl:f.url("/settings")});this.$el.html(e)},navigateLink:function(e){!e.ctrlKey&&!e.metaKey&&e.preventDefault(),this.trigger(c.ON_NAVIGATION),f.anchorTagHandler(e)},onSignOutClicked:function(e){e.preventDefault(),a.signOut()},getHelpUrl:function(){return"/"+s.getFullLocale().replace("_","-")+"/help"},getUserProfileUrl:function(){return f.url("/profile/"+this.viewerSocialProfile.get("displayName"))}});return h.Events=c,h}),define("models/device/WellnessDeviceInfo",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/wellness-service/wellness/deviceInfo/",idAttribute:"deviceId"});return t}),define("utils/device/ActiveIndicatorEnum",[],function(){return{DELETED:0,ACTIVE:1,NOT_ACTIVE:2,ACTIVE_NOT_TRACKING:3}}),define("utils/device/DeviceLinksUtil",["require","models/user/ViewerUserPreferences","utils/LocaleMapper"],function(e){var t=e("models/user/ViewerUserPreferences"),n=e("utils/LocaleMapper");return{garminAppStoreUrl:GARMIN_APP_URL,getAppStoreUrl:function(e){if(e){var r=t.get("preferredLocale"),i=n.getFullLocale(r),s=this.garminAppStoreUrl;return s=s.replace("{locale}",i),s=s+"&sku="+e.get("partNumber")+"&unitId="+e.get("deviceId"),s}},getAppUrl:function(e){var r=this.garminAppStoreUrl;r+="/"+e.metaData.appDetails.id;var i=t.get("preferredLocale"),s=n.getFullLocale(i);return r=r.replace("{locale}",s),r}}}),define("text!templates/navigation/DevicesPopupMenuItemView.html",[],function(){return'<div class="device">\n    <a href="<%= deviceUrl %>" class="js-device-link"><img class="device-image" src="<%= device.imageUrl %>" alt="<%= device.displayName %>"></a>\n\n    <div class="device-details">\n        <div class="device-name"><a href="<%= deviceUrl %>" class="js-device-link"><%= device.displayName %></a></div>\n\n        <% if(showBatteryLow) { %>\n            <div class="device-link battery-low"><i class="icon-battery-low"></i><%= Localizer.localize(\'device.battery.low\') %></div>\n        <% } %>\n\n        <% if(isRetired) { %>\n        <div class="label"><%= Localizer.localize(\'device.retired\') %></div>\n        <% } else { %>\n\n        <div class="device-link preferred js-set-as-activity-tracker" style="display: none;"><a href="#" class="colored"><%= Localizer.localize(\'device.set.activity.tracker.MAT\') %></a></div>\n        <div class="device-link preferred js-active-activity-tracker" style="display: none;"><i class="icon-checkmark"></i> <%= Localizer.localize(\'device.activity.tracker.title.MAT\') %></div>\n\n        <div class="device-link settings"><a href="<%= deviceUrl %>" class="colored js-device-link"><%= Localizer.localize(\'device.settings\') %></a></div>\n\n        <% if(device.appSupport) { %>\n        <div class="device-link ciq"><a href="<%= appStoreUrl %>" class="colored"><%= Localizer.localize(\'garmin.app.store\') %></a></div>\n        <% } %>\n        <% } %>\n    </div>\n\n    <% if(messagesCount > 0) { %>\n    <div class="new-items-alert" title="<%= messagesCount === 1 ? Localizer.localize(\'item_to_sync\') : Localizer.localize(\'items_to_sync\', messagesCount) %>"><%= messagesCount %></div>\n    <% } %>\n</div>\n\n<% if(messagesCount > 0) { %>\n<div class="sync-item-remove-confirm" style="display: none;">\n    <div class="confirm-text"></div>\n    <div class="confirm-buttons">\n        <button class="btn btn-small btn-secondary btn-keep"><%= Localizer.localize(\'queue.keep\') %></button>\n        <button class="btn btn-small btn-danger btn-confirm"><%= Localizer.localize(\'device.remove\') %></button>\n    </div>\n</div>\n\n<% var scaleMessageIsShown = false; %>\n\n<div class="sync-list hide">\n<% _.each(messages, function(message, index) { %>\n    <% var nextMessage = messages[index + 1]; %>\n    <% var isWeightScale = (message.applicationKey !== null && message.applicationKey.indexOf(\'indexSmartScale\') > -1); %>\n    <% var listElementTag = \'\'; %>\n\n    <% if(message.isGroupChild) { %>\n        <% if(message.messageType === \'software-update\') { %>\n        <li><%= message.messageName %></li>\n\n        <% } else { %>\n        <div class="sync-item sync-item-<%= message.messageId %>">\n            <div class="sync-item-content">\n                <a class="sync-item-title" href="<%= message.connectUrl %>"><%= message.messageName %></a>\n                <a href="#" class="sync-item-remove icon-close" title="<%= Localizer.localize(\'queue.remove\') %>" data-message="<%= JSON.stringify(message) %>" data-message-id="<%= message.messageId %>" data-message-name="<%= message.messageName %>" data-group-name=""></a>\n            </div>\n        </div>\n        <% } %>\n\n        <% if(!nextMessage) { %>\n            </<%= listElementTag %>>\n        </div>\n    </div>\n        <% } else if(!nextMessage.isGroupChild) { %>\n            </<%= listElementTag %>>\n        </div>\n    </div>\n</div>\n        <% } %>\n    <% } else { %>\n    <% if(isWeightScale && !scaleMessageIsShown) { %>\n        <% scaleMessageIsShown = true; %>\n        <div class="sync-item">\n            <div class="sync-item-content"><%= Localizer.localize(\'device.time.to.update\') %></div>\n        </div>\n    <% } %>\n    <div class="sync-item sync-item-<%= message.messageId %>">\n        <div class="sync-item-content">\n            <a class="sync-item-title" href="<%= message.connectUrl %>"><%= message.isGroupHeading ? message.groupName : message.messageName %></a>\n            <div class="sync-item-type"><%= message.displayMessageType %></div>\n\n            <a href="#" class="sync-item-remove icon-close" title="<%= Localizer.localize(\'queue.remove\') %>" data-message-id="<%= message.messageId %>" data-message-name="<%= message.isGroupHeading ? message.groupName : message.messageName %>" data-group-name="<%= message.groupName %>"></a>\n\n            <% if(message.isGroupHeading) { %>\n            <div class="sync-item-list-toggle"><a href="#" class="colored"><%= Localizer.localize(\'details\') %></a></div>\n\n                <% if(nextMessage.messageType === \'software-update\') {\n                    listElementTag = \'ul\';\n                } else {\n                    listElementTag = \'div\';\n                } %>\n\n            <<%= listElementTag %> class="sync-item-list">\n            <% } else {%>\n        </div>\n    </div>\n            <% } %>\n    <% } %>\n\n<% }); %>\n</div>\n<% } %>'}),define("views/navigation/DevicesPopupMenuItemView",["require","underscore","backbone","localizer","models/user/ViewerUserPreferences","models/device/WellnessDeviceInfo","utils/NavigationUtil","utils/LocaleMapper","utils/device/ActiveIndicatorEnum","utils/device/DeviceLinksUtil","text!templates/navigation/DevicesPopupMenuItemView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("models/user/ViewerUserPreferences"),s=e("models/device/WellnessDeviceInfo"),o=e("utils/NavigationUtil"),u=e("utils/LocaleMapper"),a=e("utils/device/ActiveIndicatorEnum"),f=e("utils/device/DeviceLinksUtil"),l=e("text!templates/navigation/DevicesPopupMenuItemView.html"),c={ON_NAVIGATION:"ON_NAVIGATION",ON_ACTIVITY_TRACKER_CHANGE:"ON_ACTIVITY_TRACKER_CHANGE",ON_SYNC_MESSAGE_REMOVE:"ON_SYNC_MESSAGE_REMOVE"},h=n.View.extend({template:t.template(l),events:{"click .js-device-link":"navigateLink","click .sync-item-title":"navigateLink","click .js-set-as-activity-tracker":"onSetActivityTrackerLinkClicked","click .new-items-alert":"onNewItemsBulletClick","click .sync-item-list-toggle a":"onSyncItemDetailsClick","click .sync-item-remove":"onSyncItemRemoveClick","click .sync-item-remove-confirm .btn-keep":"hideConfirmationPopup","click .sync-item-remove-confirm .btn-confirm":"onRemovePopupConfirmClick"},className:"header-nav-menu-section",initialize:function(e){this.device=e.device,this.messages=e.messages,this.trackerCount=e.trackerCount,this.isRetired=e.isRetired},render:function(){return this.$el.html(this.template({Localizer:r,device:this.device.toJSON(),deviceUrl:o.url(this.getDeviceUrl()),appStoreUrl:this.device.get("appSupport")?f.getAppStoreUrl(this.device):null,ActiveIndicatorEnum:a,url:o.url,messages:this.messages||[],messagesCount:this.getMessageCount(),isRetired:this.isRetired,showBatteryLow:this.device.get("batteryLow")||!1})),this.trackerCount>1&&(this.device.get("wellness")||this.device.get("hybrid"))&&this.renderActiveActivityTracker(),this},getMessageCount:function(){return t.reject(this.messages,function(e){return e.isGroupChild}).length},renderActiveActivityTracker:function(){!this.device.get("primaryActivityTrackerIndicator")&&this.device.get("activeInd")!==a.NOT_ACTIVE?(this.$(".js-active-activity-tracker").hide(),this.$(".js-set-as-activity-tracker").show()):this.device.get("activeInd")!==a.NOT_ACTIVE&&(this.$(".js-active-activity-tracker").show(),this.$(".js-set-as-activity-tracker").hide())},onSetActivityTrackerLinkClicked:function(e){e.preventDefault(),this.trigger(c.ON_ACTIVITY_TRACKER_CHANGE,this.device)},onSyncItemDetailsClick:function(e){e.preventDefault(),this.$(e.currentTarget).closest(".sync-item-content").find(".sync-item-list").slideToggle()},onSyncItemRemoveClick:function(e){e.preventDefault();var t="<strong>"+$(e.currentTarget).data("messageName")+"</strong>",n=$(e.currentTarget).data("messageId"),i=$(e.currentTarget).data("groupName");this.$(".sync-item-remove-confirm").show().find(".confirm-text").html(r.localize("connections.page.stop.follower.prompt",t)).end().find(".btn-confirm").data("messageId",n).data("groupName",i)},onRemovePopupConfirmClick:function(e){var t=$(e.currentTarget).data("messageId"),n=$(e.currentTarget).data("groupName"),r=$(e.currentTarget).data("message");this.trigger(c.ON_SYNC_MESSAGE_REMOVE,t,n,r)},hideMessageItem:function(e,t,n){var r=function(e){return function(){this.remove(),e&&e()}};t?$(".sync-item.sync-item-"+e).parent().closest(".sync-item").slideUp(400,r(n)):this.$(".sync-item.sync-item-"+e).slideUp(400,r(n))},updateMessagesCount:function(){var e=this.getMessageCount(),t=this.$(".new-items-alert");e>0?(t.html(e),e===1?t.attr("title",r.localize("item_to_sync")):t.attr("title",r.localize("items_to_sync",e))):(t.remove(),this.$(".sync-item-remove-confirm").remove(),this.$(".sync-list").remove())},hideConfirmationPopup:function(){this.$(".sync-item-remove-confirm").hide()},onNewItemsBulletClick:function(){this.$(".sync-list").slideToggle(200)},getDeviceUrl:function(){return"/device/"+this.device.get("deviceId")},navigateLink:function(e){!e.ctrlKey&&!e.metaKey&&e.preventDefault(),this.trigger(c.ON_NAVIGATION),o.anchorTagHandler(e)}});return h.Events=c,h}),define("text!templates/device/ActiveActivityTrackerView.html",[],function(){return"<p><strong><%= Localizer.localize('device.set.activity.tracker.verify.MAT') %></strong></p>\n<p><%= Localizer.localize('device.set.activity.tracker.info.MAT') %></p>"}),define("views/device/ActiveActivityTrackerView",["underscore","backbone","localizer","text!templates/device/ActiveActivityTrackerView.html"],function(e,t,n,r){var i=t.View.extend({initialize:function(t){this.template=e.template(r)},render:function(){this.$el.html(this.template({Localizer:n}))}});return i}),define("text!templates/device/ModalActiveTrackerFooterView.html",[],function(){return'<a class="colored btn btn-reverse pull-left" href="/en-US/help/how-to/#preferred-tracker" target="_blank"><%= Localizer.localize(\'agent.learn.more\') %></a>\n<button class="btn btn-secondary" data-dismiss="modal"><%= Localizer.localize(\'button_cancel\') %></button>\n<button class="btn set-active"><%= Localizer.localize(\'device.set\') %></button>'}),define("views/device/ModalActiveActivityTrackerView",["require","underscore","backbone","localizer","views/main/Modal/ModalPopupView","text!templates/device/ModalActiveTrackerFooterView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("views/main/Modal/ModalPopupView"),s=e("text!templates/device/ModalActiveTrackerFooterView.html"),o={ON_SET:"ON_SET"},u=i.extend({events:{"click .set-active":"onSetActiveClicked","click .close":"close"},footerTemplate:t.template(s),onSetActiveClicked:function(){this.trigger(o.ON_SET),this.close()}});return u.Events=o,u}),define("models/device/QueueCount",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/device-service/devicemessage/message/count",parse:function(e){this.set("count",e),this.trigger("add",this)},poll:function(){if(!this.fetching){this.fetching=!0;var e=this;this.fetch({add:!0,success:function(e){e.fetching=!1},error:e.onPollingError})}},onPollingError:function(e,t){e.fetching=!1,e.pollingEnabled=!1,typeof console!="undefined"&&typeof console.log!="undefined"&&console.log((new Date).toString()+" - "+"Error polling: "+t.status+" "+t.statusText)},isPollingEnabled:function(){return!0}});return t}),define("models/device/Device",["require","backbone","utils/device/ActiveIndicatorEnum"],function(e){var t=e("backbone"),n=e("utils/device/ActiveIndicatorEnum");return t.Model.extend({urlRoot:"/proxy/device-service/deviceservice/device-info/",idAttribute:"deviceId",save:function(e,n,r){return this.hasChanged("viewed")?this.urlRoot="/proxy/device-service/deviceservice/device-info/device":this.urlRoot="/proxy/device-service/deviceservice/device-info/",t.Model.prototype.save.call(this,e,n,r)},isVivoki:function(){return this.get("applicationKey")=="vivoki"},isInUseByAnotherUser:function(){return this.get("otherAssociation")&&this.get("activeInd")!==n.ACTIVE}})}),define("collections/device/Devices",["require","backbone","models/device/Device"],function(e){var t=e("backbone"),n=e("models/device/Device"),r=t.Collection.extend({model:n,comparator:function(e,t){return e.get("displayName").toLowerCase().localeCompare(t.get("displayName").toLowerCase())},url:function(){return"/proxy/device-service/deviceservice/device-info/all/"+this.getDisplayName()},initialize:function(e){this.displayName=e.displayName},setDisplayName:function(e){this.displayName=e},getDisplayName:function(){return this.displayName},parse:function(e){return e}});return r}),define("models/device/QueueNotification",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/device-service/devicemessage/message",idAttribute:"messageId"});return t}),window.Garmin==undefined&&(window.Garmin={}),window.Garmin.Queue==undefined&&(window.Garmin.Queue={});var Garmin=window.Garmin;define("constants/device/QueueConstants",[],function(){Garmin.Queue.Constants={GC_SYNC_URL:"connectagent://launch",GC_SYNC_ID:"#notify-agent",DEVICE_IMG_LOCATION:"//static.garmincdn.com/apps/connect/image/devices"},Garmin.Queue.NotificationWidgetQueueIds={QUEUE_NOTIFICATION:"#notify-agent"},Garmin.Queue.Events={SEND_TO_DEVICE_FROM_QUEUE:"SEND_TO_DEVICE_FROM_QUEUE",VIEW_PENDING_ITEMS:"VIEW_PENDING_ITEMS",MESSAGE_SENT:"MESSAGE_SENT",RETURN_TO_TRAINING_PLAN:"return.to.trainingplanpageview"},Garmin.Queue.MessageTypes={ACTIVITIES:{id:1,type:"courses",name:"activities"},COURSES:{id:2,type:"courses",name:"courses"},WORKOUTS:{id:3,type:"workouts",name:"workouts"},PR:{id:4,type:"personal-records",name:"personal-records"},SCHEDULES:{id:5,type:"schedules",name:"schedules"},SETTINGS:{id:6,type:"settings",name:"settings"},ZONES:{id:6,type:"settings",name:"zones"},GOALS:{id:7,type:"goals",name:"goals"},SOFTWARE_UPDATE:{id:8,type:"software_update",name:"software_update"},DEVICE_SETTINGS:{id:9,type:"device-settings",name:"device-settings"},LANGUAGE_SETTINGS:{id:10,type:"language-settings",name:"language-settings"},PROFILE:{id:11,type:"user-profile",name:"user-profile"},SPORTS:{id:12,type:"sports",name:"sports"},SEGMENT_LEADERS:{id:14,type:"segment-leaders",name:"segment-leaders"}}}),define("collections/device/QueueNotifications",["backbone","models/device/QueueNotification","constants/device/QueueConstants"],function(e,t,n){var r=e.Collection.extend({model:t,url:function(){return"/proxy/device-service/devicemessage/messages"},parse:function(e){var t={};for(var n=0;n<e.messages.length;n++)e.messages[n].messageType==="software-update"&&(t[e.messages[n].deviceId]==null&&(t[e.messages[n].deviceId]=0),t[e.messages[n].deviceId]++);for(var n=0;n<e.messages.length;n++)e.messages[n].messageType==="software-update"?(t[e.messages[n].deviceId]>=1&&(e.messages[n].metaData.groupName="zzzzz-software-update"),e.messages[n].metaData.priority=9999,e.messages[n].softwareUpdateCount=t[e.messages[n].deviceId]):(e.messages[n].messageName=e.messages[n].metaData.messageName,e.messages[n].messageUrl=e.messages[n].metaData.messageUrl),e.messages[n].groupName=e.messages[n].metaData.groupName,e.messages[n].priority=e.messages[n].metaData.priority,delete e.messages[n].metaData.deviceName,delete e.messages[n].metaData.groupName,delete e.messages[n].metaData.priority;return e.messages},removeGroup:function(t,n,r){var i=this,s={url:this.url()+"/"+t+"/"+n,success:function(){i.fetch({success:function(){r.hasOwnProperty("success")&&r.success()}})},error:function(e){r.hasOwnProperty("error")&&r.error(e)}};e.sync("delete",this,s)},sendAll:function(t){var n=this,r={url:this.url(),contentType:"application/json; charset=UTF-8",data:JSON.stringify(this),success:function(){n.trigger("sendAll",{numberSent:n.length,success:!0,extra:t})},error:function(e){n.trigger("sendAll",{numberSent:0,success:!1,xHR:e})}};e.sync("create",this,r)},sendEach:function(){this.startTime=(new Date).getTime();var e=1,t=this;for(var n=0;n<this.length;n++){var r=this.models[n];r.save(r.attributes,{success:function(){t.length>0&&e>=t.length&&(console.log("sendEach - Completed in "+((new Date).getTime()-t.startTime)+" ms."),t.trigger("sendEach",e)),e++},error:function(){t.length>0&&e>=t.length&&(console.log("sendEach - Completed in "+((new Date).getTime()-t.startTime)+" ms."),t.trigger("sendEach",e)),e++}})}},initialize:function(){}});return r}),define("events/ActivityTrackerDispatcher",["underscore","backbone"],function(e,t){var n={ON_ACTIVE_TRACKER:"ON_ACTIVE_TRACKER",SET_ACTIVE_CLICKED:"SET_ACTIVE_CLICKED"},r=e.clone(t.Events);return r.Events=n,r}),define("utils/QueuePoller",[],function(){var e=function(e){this.initialize(e)};return e.prototype={initialize:function(e){window.queuePoller=this,this.pollingTerminated=!1,this.collections=[],this.lastEventTime=new Date,this.pollTime=e.pollTime,this.idleTimeCheckInSeconds=600,this.interval=e.interval,this.lastEventTime=new Date,jQuery(document).ready(function(e){e(document).bind("mousemove keyup mousewheel",window.queuePoller.keepAlive)})},addCollection:function(e){if(typeof e=="undefined"||e===null)throw new Error("Collection is required.");if(typeof e.poll=="undefined")throw new Error("Collection must implement a poll method.");if(typeof e.isPollingEnabled=="undefined")throw new Error("Collection must implement isPollingEnabled method.");this.collections.push(e)},poll:function(){var e=window.queuePoller;e.pollingTimeoutHandle=null;var t=new Date,n=(t.getTime()-e.lastEventTime.getTime())/1e3;n>e.idleTimeCheckInSeconds?(e.lastEventTime=new Date,e.log("Idle time has elapsed"),e.stopPolling()):(e.log("Start poll operations."),e.removeInactiveCollections(),jQuery.each(e.collections,function(e,t){t.poll()}),e.start())},removeInactiveCollections:function(){var e=[];jQuery.each(this.collections,function(t,n){n.isPollingEnabled()&&e.push(n)}),this.collections=e},start:function(){var e=this;this.stopPolling(),this.collections.length>0?(this.pollingTimeoutHandle=window.setTimeout(e.poll,this.pollTime),this.log("Polling is teed up.")):this.log("No enabled collections available to poll.")},isPollingStarted:function(){return typeof this.pollingTimeoutHandle!="undefined"&&this.pollingTimeoutHandle!==null},stopPolling:function(){this.isPollingStarted()&&(window.clearTimeout(this.pollingTimeoutHandle),this.pollingTimeoutHandle=null,queuePoller.pollingTerminated=!0,this.log("Polling is stopped."))},keepAlive:function(){var e=window.queuePoller;e!=null&&(e.lastEventTime=new Date,!e.pollingTerminated&&!e.isPollingStarted()&&e.collections.length>0&&(e.log("User activity detected. Restarting polling."),e.start()))},log:function(e){typeof console!="undefined"&&typeof console.log!="undefined"&&console.log((new Date).toString()+" - "+e)}},e}),define("clients/device/PrimaryActivityTracker",["require","underscore"],function(e){var t=e("underscore"),n={setPrimaryActivityTracker:function(e,n,r,i){var s={},o="/modern/proxy/device-service/deviceservice/device-info/"+e+"/primary-activity-tracker";s.url=o,s.type="POST",s.data=n,s.contentType="application/json",t.isFunction(i)&&(s.error=i),t.isFunction(r)&&(s.success=r),s.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override","PUT")},jQuery.ajax(s)}};return n}),define("text!templates/main/MainContainer/DevicesPopupMenuView.html",[],function(){return'<div id="queueNotification-error" class="alert alert-error hide">\n    <p><%= Localizer.localize(\'queue.error\') %></p>\n</div>\n<% if(userHasDevices) { %>\n    <div class="header-nav-menu-section section-header">\n        <h2 class="section-name"><%= Localizer.localize(\'devices.link\') %></h2>\n        <a href="<%= url(\'/activity-sync\') %>" class="colored how-to-sync js-how-to-sync"><%= Localizer.localize(\'how.to.sync.msg\') %></a>\n    </div>\n<% } else { %>\n<div class="empty-state">\n    <%~ Localizer.localize(\'express.transfer.info\') %>\n</div>\n<% } %>'}),define("views/main/MainContainer/DevicesPopupMenuView",["require","underscore","backbone","localizer","utils/extensions/Loadable","views/navigation/DevicesPopupMenuItemView","views/main/Modal/ModalConfirmationView","views/device/ActiveActivityTrackerView","views/device/ModalActiveActivityTrackerView","models/device/QueueCount","models/device/WellnessDeviceInfo","collections/device/Devices","collections/device/QueueNotifications","events/ActivityTrackerDispatcher","utils/NavigationUtil","utils/device/ActiveIndicatorEnum","utils/device/DeviceLinksUtil","utils/QueuePoller","clients/device/PrimaryActivityTracker","text!templates/main/MainContainer/DevicesPopupMenuView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/extensions/Loadable"),s=e("views/navigation/DevicesPopupMenuItemView"),o=e("views/main/Modal/ModalConfirmationView"),u=e("views/device/ActiveActivityTrackerView"),a=e("views/device/ModalActiveActivityTrackerView"),f=e("models/device/QueueCount"),l=e("models/device/WellnessDeviceInfo"),c=e("collections/device/Devices"),h=e("collections/device/QueueNotifications"),p=e("events/ActivityTrackerDispatcher"),d=e("utils/NavigationUtil"),v=e("utils/device/ActiveIndicatorEnum"),m=e("utils/device/DeviceLinksUtil"),g=e("utils/QueuePoller"),y=e("clients/device/PrimaryActivityTracker"),b=e("text!templates/main/MainContainer/DevicesPopupMenuView.html"),w={ON_NAVIGATION:"ON_NAVIGATION",REFRESH_COUNT:"REFRESH_COUNT"},E=n.View.extend(i),S=E.extend({propertyFiles:["/main/js/properties/connections/connections","/main/js/properties/power_zone/power_zone","/main/js/properties/send_to_device/send_to_device","/main/js/properties/device/device","/main/js/properties/segment/segment","/main/js/properties/common/common","/main/js/properties/reportswidget/reportswidget","/main/js/properties/activity-api/activity-api","/main/js/properties/notification/notification"],template:t.template(b),initialize:function(e){this.displayName=e.displayName,this.userPreferences=e.userPreferences,this.pollTimeoutValue=parseInt(e.pollTimeoutValue,10),this.queuePoller=null,this.devices=new c({displayName:this.displayName}),this.messages=new h,this.listenTo(this.messages,"error",this.showErrorMessage()),p.on(p.Events.ON_ACTIVE_TRACKER,this.fetchUpdatedDevices,this),this.queueCount=new f,this.queueCount.bind("add",this.handleQueueCount,this),this.batteryInfos={},this.configurePolling()},configurePolling:function(){this.queuePoller||(this.queuePoller=new g({pollTime:this.pollTimeoutValue})),this.queuePoller.isPollingStarted()===!1&&(this.queuePoller.addCollection(this.queueCount),this.queuePoller.start())},provideDependencies:function(e,n){n===0?(e.addModel({model:this.devices,required:!0}),e.addModel({model:this.messages,required:!0}),e.addModel({model:this.queueCount,required:!0})):t.each(this.devices.models,function(t){if(t.get("wellness")){var n=t.get("deviceId"),r=new l({deviceId:n});e.addModel({model:r,required:!0}),this.batteryInfos[n]=r}}.bind(this))},onDependenciesLoaded:function(e){return e===0?!1:(this.hideErrorMessage(),this.getBatteryStatusForDevices(),!0)},onDependenciesLoadFailed:function(){this.showErrorMessage()},getBatteryStatusForDevices:function(){var e=t.filter(this.batteryInfos,function(e){return e.get("batteryLow")===!0});t.each(e,function(e){var t=this.devices.get(e.get("deviceId"));t.set("batteryLow",!0)}.bind(this)),this.sortDevices(),this.render()},sortDevices:function(){this.devices.sort();var e=this.devices.where({activeInd:v.NOT_ACTIVE}),n=this.devices.where({batteryLow:!0}),r=t.reject(this.devices.models,function(e){return e.get("activeInd")===v.NOT_ACTIVE||e.get("batteryLow")===!0});t.each(e,function(e){r.push(e)}),t.each(n,function(e){r.unshift(e)}),this.devices.reset(r,{sort:!1})},render:function(){var e=this.devices.length>0;this.$el.html(this.template({Localizer:r,url:d.url,userHasDevices:e}));if(!e){var t=this.userPreferences.getFullLocale();this.$("#express-link").attr("href","/"+t+"/start"),this.$("#mobile-link").attr("href","https://buy.garmin.com/en-US/US/on-the-go/apps/garmin-connect-mobile/prod125677.html")}this.renderDevices()},renderDevices:function(){var e=this.groupByDeviceId(),n=this.prepareForOutput(e),r=this.getTrackerCount();t.each(this.devices.models,function(e){var t=new s({device:e,messages:n[e.get("deviceId")],trackerCount:r,isRetired:e.get("activeInd")===v.NOT_ACTIVE});this.listenTo(t,s.Events.ON_ACTIVITY_TRACKER_CHANGE,this.onActivityTrackerChange),this.listenTo(t,s.Events.ON_SYNC_MESSAGE_REMOVE,this.onMessageRemove.bind(this,t)),this.listenTo(t,s.Events.ON_NAVIGATION,function(){this.trigger(w.ON_NAVIGATION)}),this.$el.append(t.render().el)},this)},onActivityTrackerChange:function(e){e.isInUseByAnotherUser()?this.displayActivityTrackerHelpMessage():this.displaySetActivityTrackerConfirmation(e)},onMessageRemove:function(e,n,r){var i=t.isNumber(n)?n:parseInt(n.replace(/[^0-9\.]/g,""),10),s=this.messages.get(i),o=!1;r&&(o=!0),s&&(o?this.messages.removeGroup(s.get("deviceId"),s.get("groupName"),{error:function(){this.showErrorMessage(),e.hideConfirmationPopup()}.bind(this),success:function(){this.handleRemoveSuccess(e,n)}.bind(this)}):s.destroy({success:function(t){this.handleRemoveSuccess(e,n,t)}.bind(this),error:function(t){this.messages.get(t.get("messageId"))||this.messages.add(t),this.showErrorMessage(),e.hideConfirmationPopup()}.bind(this)}))},handleRemoveSuccess:function(e,n,r){if(r){var i=r.get("groupName"),s=i?this.messages.where({groupName:i}).length===0:!1;e.messages=t.reject(e.messages,{messageId:n}),e.hideMessageItem(n,s,e.updateMessagesCount.bind(e))}else{var o=this.groupByDeviceId(),u=this.prepareForOutput(o);e.messages=u[e.device.get("deviceId")]||[],e.hideMessageItem(n,!1,e.updateMessagesCount.bind(e))}this.queueCount.fetch(),e.hideConfirmationPopup()},displayActivityTrackerHelpMessage:function(){var e=new o({modalTitle:r.localize("device.set.activity.tracker.MAT").toUpperCase(),message:r.localize("set.up.activity.tracker.message.MAT"),confirmationTextKey:"ok",showCancelButton:!1,stopClickPropagationOnModalClick:!0,onSaveButtonClicked:function(e){return!0}});e.render()},displaySetActivityTrackerConfirmation:function(e){var t=new u({}),n=new a({view:t,showHeader:!0,modalTitle:r.localize("device.set.activity.tracker.MAT"),stopClickPropagationOnModalClick:!0});this.listenTo(n,a.Events.ON_SET,this.onSetActiveButtonClicked.bind(this,e)),n.render()},onSetActiveButtonClicked:function(e){e&&y.setPrimaryActivityTracker(e.get("deviceId"),"true",this.preferredTrackerUpdateSuccess.bind(this),this.preferredTrackerUpdateFail.bind(this))},preferredTrackerUpdateSuccess:function(){this.hideErrorMessage(),this.load()},preferredTrackerUpdateFail:function(){this.showErrorMessage()},getTrackerCount:function(){var e=0;return t.each(this.devices.models,function(t){(t.get("wellness")||t.get("hybrid"))&&(t.get("activeInd")===v.ACTIVE||t.get("activeInd")===v.ACTIVE_NOT_TRACKING)&&e++},this),e},groupByDeviceId:function(){var e=t.sortBy(this.messages.toJSON(),function(e){return e.priority});return e=this.groupByMulti(e,["deviceId","groupName"]),t.toArray(e)},groupByMulti:function(e,n){if(!n.length)return e;var r=t.groupBy(e,n[0]),i=n.slice(1);for(var s in r)r[s]=this.groupByMulti(r[s],i);return r},prepareForOutput:function(e){var n={};for(var i=0;i<e.length;i++){var s=!0,o=[];for(var u in e[i])o.push(u);o.sort();var a=[],f=null;for(var l=0;l<o.length;l++){var c=e[i][o[l]];c=t.sortBy(c,function(e){return e.messageId});for(var h=0;h<c.length;h++)if(!c[h].hidden){var p=c[h],d=p.groupName!=="null"&&p.groupName!==null&&p.groupName!==undefined,v=d&&h==0,g=d&&h>0,y=d?p.groupName.split(" ").join("_")+p.deviceId:"",b=!0;f||(f=p.deviceId);if(v){var w={deviceName:p.deviceName,applicationKey:p.applicationKey,deviceId:p.deviceId,messageId:"__"+p.messageId,wifiSetup:p.wifiSetup,groupName:p.groupName,hasGroupName:!0,isGroupHeading:!0,isGroupChild:!1,groupNameClass:y,displaySendButton:!1,messageType:p.messageType,showDeleteButton:b,metaData:p.metaData,groupHeadingText:""};this.addMessageTypeToQueue(w),p.messageType==="schedules"?w.displayMessageType=r.localize("queue.training.plan"):p.messageType==="software-update"?w.groupName=r.localize("queue.software.header"):p.groupName&&p.groupName.toLowerCase().indexOf("strava-")>-1&&(w.groupHeadingText='<span class="sync-type">'+r.localize(p.groupName.toLowerCase().indexOf("running")>-1?"running":"cycling")+"</span>",w.groupName=r.localize("strava_live_segments","")),v=!1,g=!0,a.push(w)}p.messageType!=="schedules"&&p.messageType!=="segment-leaders"&&p.messageType!=="segment-leaders-running"&&(b=!1),p.messageType==="software-update"?p.useSyncUpdateClass=p.softwareUpdateCount===1:p.useSyncUpdateClass=!1,p.showDeleteButton=b,p.hasGroupName=d,p.isGroupHeading=v,p.isGroupChild=g,p.groupNameClass=y,p.displaySendButton=s,p.appSupport=this.supportApps(p),this.addMessageTypeToQueue(p),p.appSupport===!0&&(p.appStoreUrl=m.getAppStoreUrl(this.getDevice(p))),a.push(p)}}n[f]=a}return n},supportApps:function(e){var t=!1,n=this.getDevice(e);return n!=null&&(t=n.get("appSupport")),t},getDevice:function(e){var t=null;for(var n=0;n<this.devices.length;n++)if(e.deviceId==this.devices.models[n].get("deviceId")){t=this.devices.models[n];break}return t},addMessageTypeToQueue:function(e){if(e.messageType==="workouts")e.displayMessageType=r.localize("queue.workout"),e.connectUrl=d.url("/workout/"+e.metaData.messageUrl.substring(e.metaData.messageUrl.lastIndexOf("/")+1));else if(e.messageType==="activities")e.displayMessageType=r.localize("queue.activity"),e.connectUrl=d.url("/activity/"+e.messageUrl.substring(e.messageUrl.lastIndexOf("/")+1));else if(e.messageType==="courses")e.messageUrl.indexOf("activity-service")>-1?(e.displayMessageType=r.localize("queue.activity"),e.connectUrl=d.url("/activity/"+e.messageUrl.substring(e.messageUrl.lastIndexOf("/")+1))):(e.displayMessageType=r.localize("queue.courses"),e.connectUrl=d.url("/course/"+e.messageUrl.substring(e.messageUrl.indexOf("fit/")+4,e.messageUrl.lastIndexOf("/"))));else if(e.messageType==="personal-records")e.displayMessageType=r.localize("queue.pr"),e.connectUrl=d.url("/trophy-case");else if(e.messageType==="schedules")e.displayMessageType=r.localize("queue.workout"),e.connectUrl=d.url("/calendar"),e.messageName=="Schedule"?e.messageName=r.localize("queue.schedule"):e.messageName=="Configuration"&&(e.messageName=r.localize("queue.configuration"));else if(e.messageType==="settings"||e.messageType==="user-profile")e.displayMessageType=r.localize("queue.settings"),e.connectUrl=d.url("/settings/userSettings"),e.messageType==="settings"?e.messageName=r.localize("queue.personal.information"):e.messageType==="user-profile"&&(e.messageName=r.localize("queue.personalInf.training.zones"));else if(e.messageType==="goals")e.displayMessageType=r.localize("queue.goals"),e.connectUrl=d.url("/goals");else if(e.messageType==="software-update"){if(e.metaData.dataType.indexOf("Chipset")>-1)e.messageName=e.metaData.productName;else if(e.metaData.dataType==="Other"||e.metaData.dataType==="Firmware")e.messageName=r.localize("fileType.version",e.metaData.productName,e.metaData.version);else if(e.metaData.dataType==="Text"){var t=e.metaData.productName.split(",");t.length==3?e.messageName=t[0]+", "+t[2]:e.messageName=e.metaData.productName}else console.log("Unexpected dataType "+e.metaData.dataType),e.messageName=r.localize("fileType.version",e.metaData.productName,e.metaData.version);e.displayMessageType="",e.connectUrl="#"}else e.messageType==="language-settings"?(e.displayMessageType=r.localize("queue.device.settings"),e.connectUrl=d.url("/settings/device")):e.messageType==="sports"?(e.connectUrl=d.url("/device/"+e.deviceId+"?zones=true"),e.messageUrl.toLowerCase().indexOf("/powerzones")>-1?e.messageName=r.localize("power.zones"):e.messageUrl.toLowerCase().indexOf("/default")>-1?e.messageName=r.localize("queue.hrz.other"):e.messageUrl.toLowerCase().indexOf("/cycling")>-1?e.messageUrl.toLowerCase().indexOf("?subsport-type=generic")>-1?e.messageName=r.localize("queue.options.bike"):e.messageName=r.localize("queue.hrz.cycling"):e.messageUrl.toLowerCase().indexOf("/swimming")>-1?e.messageName=r.localize("queue.hrz.swimming"):e.messageUrl.toLowerCase().indexOf("/walking")>-1?e.messageName=r.localize("queue.options.walk"):e.messageUrl.toLowerCase().indexOf("/cardio")>-1?e.messageName=r.localize("queue.options.cardio"):e.messageUrl.toLowerCase().indexOf("/running")>-1&&(e.messageUrl.indexOf("device-service")!=-1?(e.applicationKey.indexOf("edge")!=-1?e.messageName=r.localize("device.settings.options.Cycling"):e.messageUrl.toLowerCase().indexOf("?subsport-type=treadmill")>-1?e.messageName=r.localize("queue.options.runIndoor"):e.applicationKey.indexOf("forerunner35")===0||e.applicationKey.indexOf("foreathlete35")===0?e.messageName=r.localize("queue.options.runOutdoor"):e.messageName=r.localize("queue.options.running"),e.connectUrl=d.url("/device/"+e.deviceId)):e.messageName=r.localize("queue.hrz.running")),e.displayMessageType=r.localize("queue.settings")):e.messageType==="device-settings"&&e.messageName==="auto-sync"?(e.messageName=r.localize("queue.auto.sync"),e.displayMessageType=r.localize("queue.device.settings"),e.connectUrl="#"):e.messageType==="device-settings"?(e.displayMessageType=r.localize("queue.device.settings"),e.connectUrl=d.url("/device/"+e.deviceId)):e.messageType==="segment-leaders"||e.messageType==="segment-leaders-running"?e.isGroupHeading?e.messageName=r.localize("queue.segments"):(e.groupName&&e.groupName.toLowerCase().indexOf("strava-")>-1?(e.displayMessageType=null,e.connectUrl="#"):e.displayMessageType=r.localize("queue.segment"),e.messageUrl.indexOf("strava")>-1?e.connectUrl="#":e.connectUrl!=="#"&&(e.connectUrl=d.url("/segment/"+e.messageUrl.substring(e.messageUrl.lastIndexOf("/")+1)))):e.messageType==="golf_club"?(e.messageName=r.localize("queue.golf.club"),e.displayMessageType=r.localize("queue.golf.club"),e.connectUrl="#"):e.messageType==="install_app"?(e.displayMessageType=this.updateMessageType(e.metaData.appDetails.type,e.metaData.appDetails.developerName),e.connectUrl=m.getAppUrl(e)):(console.log("Unknown message type: "+e.messageType),e.displayMessageType="",e.connectUrl="#")},updateMessageType:function(e,t){var n="";switch(e){case"watchface":n=r.localize("queue.venu.faces",t);break;case"datafield":n=r.localize("queue.venu.data.fields",t);break;case"widget":n=r.localize("queue.venu.widgets",t);break;case"application":n=r.localize("queue.venu.apps",t)}if(t===null||jQuery.trim(t).length===0){var i=n,s=n.indexOf("("),o=n.indexOf(")");n=n.substring(0,s),i=i.substring(o+1),n+=i}return n},showErrorMessage:function(){this.queuePoller&&this.queuePoller.stopPolling(),this.$("#queueNotification-error").show()},hideErrorMessage:function(){this.$("#queueNotification-error").hide()},closeLists:function(){this.$(".sync-list").hide()},handleQueueCount:function(e){var t=e.get("count");this.trigger(w.REFRESH_COUNT,t)}});return S.Events=w,S}),define("text!templates/main/MainContainer/TopHeaderBarView.html",[],function(){return'<div class="header-controls">\n    <div class="main-nav-toggle">\n        <i class="icon-arrow-left"></i>\n        <i class="icon-menu"></i>\n    </div>\n    <a class="logo" href="<%= url(\'/\') %>" title="Garmin Connect"></a>\n</div>\n\n<div class="header-nav">\n    <div class="header-nav-item upload-import">\n        <a href="#" class="header-nav-link icon-activity-upload"></a>\n        <div class="header-nav-menu">\n            <div class="header-nav-menu-section">\n                <ul>\n                    <li><a href="<%= url(\'/activity-sync\') %>" class="colored js-how-to-sync"><%= Localizer.localize(\'how.to.sync.msg\') %></a></li>\n                    <li><a href="<%= url(\'/import-data\') %>" class="colored js-import-data"><%= Localizer.localize(\'import.data\') %></a></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n\n    <div class="header-nav-item notifications">\n        <a href="#" class="header-nav-link icon-inbox">\n            <span class="new-items-alert hide"></span>\n        </a>\n        <div class="header-nav-menu"></div>\n    </div>\n\n    <div class="header-nav-item device-sync">\n        <a href="#" class="header-nav-link icon-devices">\n            <span class="new-items-alert hide"></span>\n        </a>\n        <div class="header-nav-menu"></div>\n    </div>\n\n    <div class="header-nav-item user-profile">\n        <a href="#" class="header-nav-link">\n            <img class="avatar" alt="" src="">\n        </a>\n        <div class="header-nav-menu"></div>\n    </div>\n\n</div>'}),define("views/main/MainContainer/TopHeaderBarView",["require","underscore","backbone","localizer","views/notification/NotificationsPopupMenuView","views/main/MainContainer/UserPopupMenuView","views/main/MainContainer/MainSidebarView","views/main/MainContainer/DevicesPopupMenuView","views/utils/ToolTipView","utils/NavigationUtil","models/user/ViewerSocialProfile","text!templates/main/MainContainer/TopHeaderBarView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("views/notification/NotificationsPopupMenuView"),s=e("views/main/MainContainer/UserPopupMenuView"),o=e("views/main/MainContainer/MainSidebarView"),u=e("views/main/MainContainer/DevicesPopupMenuView"),a=e("views/utils/ToolTipView"),f=e("utils/NavigationUtil"),l=e("models/user/ViewerSocialProfile"),c=e("text!templates/main/MainContainer/TopHeaderBarView.html"),h=[{selector:".connect-iq",label:"garmin.app.store"},{selector:".upload-import",label:"upload_or_import_activity"},{selector:".notifications",label:"requests_and_notifications"},{selector:".device-sync",label:"device_and_sync_status"},{selector:".user-profile",label:"profile_and_account"}],p=n.View.extend({events:{"click .main-nav-toggle":"toggleSidebar","click .js-import-data":"handleNavigationLink","click .js-how-to-sync":"handleNavigationLink","click .logo":"handleNavigationLink","click .notifications .header-nav-link":"onNotificationTriggerClicked","click .device-sync .header-nav-link":"onDeviceSyncTriggerClicked","click .header-nav-link":"handleDropdownClick","click .header-nav-menu":"handleDropdownContentClick"},template:t.template(c),initialize:function(e){this.pollRate=e.pollRate,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences},render:function(){var e=this.template({Localizer:r,url:f.url});this.$el.html(e),this.renderProfileImage(),l.on("change",function(){this.renderProfileImage()},this),this.notificationsPopupMenuView=new i({pollTimeoutValue:this.pollRate,el:this.$(".notifications .header-nav-menu"),displayName:this.userProfile.get("displayName"),userProfile:this.userProfile,userPreferences:this.userPreferences}),this.notificationsPopupMenuView.loadNotificationCounter(),this.notificationsPopupMenuView.render(),this.listenTo(this.notificationsPopupMenuView,i.Events.REFRESH_COUNT,this.refreshNotificationCount,this),this.listenTo(this.notificationsPopupMenuView,i.Events.ON_NAVIGATION,this.closeDropdowns,this),this.devicePopupMenuView=new u({pollTimeoutValue:this.pollRate,el:this.$(".device-sync .header-nav-menu"),displayName:this.userProfile.get("displayName"),userPreferences:this.userPreferences}),this.listenTo(this.devicePopupMenuView,u.Events.ON_NAVIGATION,this.closeDropdowns,this),this.listenTo(this.devicePopupMenuView,u.Events.REFRESH_COUNT,this.refreshSyncItemsCount,this),this.devicePopupMenuView.load(),this.userPopupMenuView=new s({el:this.$(".user-profile .header-nav-menu"),viewerSocialProfile:l}),this.listenTo(this.userPopupMenuView,s.Events.ON_NAVIGATION,this.closeDropdowns,this),this.userPopupMenuView.render(),this.setupTooltips()},refreshNotificationCount:function(e){var t=this.$(".notifications .header-nav-link .new-items-alert");e>0?t.show():t.hide()},onNotificationTriggerClicked:function(e){$(e.currentTarget).hasClass("active")||this.notificationsPopupMenuView.load()},onDeviceSyncTriggerClicked:function(e){$(e.currentTarget).hasClass("active")||(this.devicePopupMenuView.closeLists(),this.devicePopupMenuView.load())},refreshSyncItemsCount:function(e){var t=this.$(".device-sync .header-nav-link .new-items-alert");e>0?t.show():t.hide()},renderProfileImage:function(){var e=f.url("/profile/"+l.get("displayName")),t=l.get("fullName")||l.get("displayName"),n=l.getProfileImageUrlMedium();this.$(".user-profile .header-nav-link").attr("href",e).find(".avatar").attr("src",n).attr("alt",t)},setupTooltips:function(){t.each(h,function(e){new a({el:this.$(e.selector+" .header-nav-link"),content:r.localize(e.label),placement:"bottom"})}),this.setupEvents()},hideTooltips:function(){$(".tooltip").hide()},handleNavigationLink:function(e){if(!e.ctrlKey&&!e.metaKey){e.preventDefault();var t=f.anchorTagHandler(e);t||(window.location.href=e.currentTarget.href)}},handleDropdownClick:function(e){this.$(".header-nav-link").not(e.currentTarget).removeClass("active"),this.hideTooltips(),$(e.currentTarget).toggleClass("active"),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},handleDropdownContentClick:function(e){e.stopPropagation()},setupEvents:function(){$(document).on("click",function(){this.closeDropdowns()}.bind(this)),n.history.on("route",this.closeDropdowns.bind(this))},closeDropdowns:function(){this.$(".header-nav-link").removeClass("active")},toggleSidebar:function(){this.trigger(o.Events.EXPAND_COLLAPSE)}});return p}),define("models/segments/StravaOptionalFeature",["backbone"],function(e){var t={OPT_IN:"OPT_IN",OPT_OUT:"OPT_OUT"},n=e.Model.extend({url:function(){return"/proxy/userprofile-service/userprofile/optional-feature/strava-segments"}});return n.USER_OPTION_TYPES=t,n}),define("text!templates/main/MainContainer/WidgetListNavView.html",[],function(){return'<nav class="nav-widgets">\n    <header class="nav-widgets-header">\n        <h3><%= Localizer.localize(\'add_to_dashboard\') %></h3>\n        <p><%= Localizer.localize(\'select_widget\') %></p>\n    </header>\n    <ul class="nav-widgets-list"></ul>\n    <footer class="nav-widgets-footer">\n        <div class="nav-widgets-cancel"><%= Localizer.localize(\'cancel\') %></div>\n    </footer>\n</nav>'}),define("text!templates/main/MainContainer/WidgetMenuItemTemplate.html",[],function(){return'<li><a href="<%= linkUrl %>" class="widget-add" title="<%= name %>" data-widget-definition-id="<%= widgetDefinitionId %>"><%= name %></a></li>'}),define("views/main/MainContainer/WidgetListNavView",["require","underscore","backbone","localizer","utils/extensions/Loadable","utils/NavigationUtil","utils/LocaleMapper","models/segments/StravaOptionalFeature","models/user/ViewerUserPreferences","text!templates/main/MainContainer/WidgetListNavView.html","text!templates/main/MainContainer/WidgetMenuItemTemplate.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/extensions/Loadable"),s=e("utils/NavigationUtil"),o=e("utils/LocaleMapper"),u=e("models/segments/StravaOptionalFeature"),a=e("models/user/ViewerUserPreferences"),f=e("text!templates/main/MainContainer/WidgetListNavView.html"),l=e("text!templates/main/MainContainer/WidgetMenuItemTemplate.html"),c={desc_segment_widget:{imageName:"segments-strava-widget.png",descKey:"desc_segment_strava_widget",descKeyArgs:[o.getFullLocale(a.get("preferredLocale"))],truthTest:function(){return this.stravaOptionsFeature&&this.stravaOptionsFeature.get("userOptionType")===u.USER_OPTION_TYPES.OPT_IN}}},h={ON_ADD_WIDGET_CLICKED:"ON_ADD_WIDGET_CLICKED",ON_WIDGET_LIST_HIDDEN:"ON_WIDGET_LIST_HIDDEN"},p=n.View.extend(i),d=p.extend({template:t.template(f),className:"nav-widgets-container",events:{"click .widget-add":"onAddWidgetClicked","click .nav-widgets-cancel":"toggleWidgetsList"},initialize:function(e){this.displayName=e.displayName,this.widgetDefinitions=e.widgetDefinitions,this.stravaOptionsFeature=new u([]),this.widgetMenuItemTemplate=t.template(l),n.history.on("route",this.hideWidgetsList,this),this.handleEscapeKeyPress()},provideDependencies:function(e){e.addModel({model:this.stravaOptionsFeature,required:!0})},onDependenciesLoaded:function(){this.render(),this.listenTo(this.widgetDefinitions,"update",function(){this.renderWidgetMenuItems()})},render:function(){return this.$el.html(this.template({Localizer:r})),this.renderWidgetMenuItems(),this},renderWidgetMenuItems:function(){if(this.widgetDefinitions.length){var e=this.$(".nav-widgets-list");this.widgetDefinitions.comparator=this.widgetDefinitionsComparator,this.widgetDefinitions.sort(),this.widgetDefinitions.each(function(t){var n={};for(var i in c)i&&c[i]&&t.get("desc_key")===i&&c[i].truthTest.call(this)&&(n=c[i]);e.append(this.widgetMenuItemTemplate({name:r.localize(t.get("title_key")),linkUrl:s.url(t.get("linkUrl")||""),widgetDefinitionId:t.get("id")}))},this)}},onAddWidgetClicked:function(e){e.preventDefault(),$("body").hasClass("show-widget-nav")&&(this.trigger(h.ON_ADD_WIDGET_CLICKED,$(e.currentTarget).data("widgetDefinitionId")),this.hideWidgetsList())},toggleWidgetsList:function(){$("body").toggleClass("show-widget-nav")},hideWidgetsList:function(){$("body").removeClass("show-widget-nav"),this.trigger(h.ON_WIDGET_LIST_HIDDEN)},widgetDefinitionsComparator:function(e,t){var n=r.localize(e.get("title_key")),i=r.localize(t.get("title_key"));return n.localeCompare(i)},handleEscapeKeyPress:function(){$(document).on("keyup",function(e){e.keyCode===27&&$("body").hasClass("show-widget-nav")&&this.hideWidgetsList()}.bind(this))}});return d.Events=h,d}),define("utils/groupChallenge/GroupChallengeTypes",[],function(){return{Steps:"steps",Walking:"walking",Running:"running",Cycling:"cycling",Swimming:"swimming",Calories:"calories"}}),define("utils/groupChallenge/GroupChallengeTypesMapper",["utils/groupChallenge/GroupChallengeTypes"],function(e){var t={Steps:"4",Walking:"0",Running:"1",Cycling:"2",Swimming:"3",Calories:"6"},n=["WEEK","MONTH","CUSTOM"],r=["walking","running","cycling","swimming","steps","steps_distance","calories"],i={Steps:"icon-steps-1",Walking:"icon-activity-walking",Running:"icon-activity-running",Cycling:"icon-activity-cycling",Swimming:"icon-activity-swimming",Calories:"icon-calories"},s={Steps:"activity_type_steps",Walking:"activity_type_walking",Running:"activity_type_running",Cycling:"activity_type_cycling",Swimming:"activity_type_swimming",Calories:"calories"},o={Steps:"activity_type_steps",Walking:"activity_type_walking",Running:"activity_type_running",Cycling:"activity_type_cycling",Swimming:"activity_type_swimming",Calories:"calories"},u={Steps:"walk.the.most.steps",Walking:"walk.the.farthest",Running:"run.the.farthest.distance",Cycling:"ride.the.farthest.distance",Swimming:"swim.the.farthest.distance",Calories:"burn.the.most.calories"},a={WEEK:"in.a.week",MONTH:"in.a.month",CUSTOM:"by.time",WEEKEND:"saturday.and.sunday",ONEDAY:"midnight.to.midnight",WEEK:"monday.through.sunday"},f={Steps:"group.settings.leaderboard.steps",Walking:"group.settings.leaderboard.walking",Running:"group.settings.leaderboard.running",Cycling:"group.settings.leaderboard.cycling",Swimming:"group.settings.leaderboard.swimming",Calories:"group.settings.leaderboard.calories"},l={WEEK:"week",MONTH:"month",CUSTOM:"custom"},c=["week","month","custom","weekend","oneDay"],h=["Walking_Distance","Running_Distance","Cycling_Distance","Swimming_Distance","Wellness_Steps_Count","Wellness_Steps_Distance","Calories_Burned"],p=["READY","STARTED","STOPPED","LOCKED","COMPLETED"],d={ready:0,started:1,stopped:2,locked:3,completed:4},v={oneday:"4",week:"0",custom:"2",month:"1",weekend:"3"};return{mapTypesId:function(e){var n=t[e];return n},mapDurationTypes:function(e){var t=n[e];return t},mapDurationTypesId:function(e){var t=n.indexOf(e);return t},mapPicurePathTypes:function(e){var t=r[e];return t},mapClassIcon:function(e){var t=i[e];return t},mapTitle:function(e){var t=s[e];return t},mapChallengeTitles:function(e){var t=o[e];return t},mapActivityTypeString:function(e){var t=f[e];return t},mapActionTypeDesc:function(e){return u[e]},mapDurationTypeDesc:function(e){return a[e]},mapDurationBadgesImgFile:function(e){return l[e]},getDurationBadgesImgFileById:function(e){return c[e]},typeById:function(e){switch(e){case 0:return"Walking";case 1:return"Running";case 2:return"Cycling";case 3:return"Swimming";case 4:return"Steps";case 6:return"Calories"}},mapActivityType:function(e){return h[e]},mapChallengeStatusAttr:function(e){return p[e]},getChallengeStatusIds:function(){return d},getDurationTypeId:function(e){return e=e.toLowerCase(),v[e]}}}),define("models/badges/Badge",["backbone"],function(e){var t=e.Model.extend({urlRoot:"/proxy/badge-service/badge/userBadge/",idAttribute:"userBadgePk"});return t}),define("text!templates/badges/BadgeTooltipTemplate.html",[],function(){return"<strong><%= badgeTitle %></strong><br />\r\n<%= tooltipContent %>"}),define("utils/BadgeUtil",["backbone","localizer","utils/groupChallenge/GroupChallengeTypesMapper","models/badges/Badge","text!templates/badges/BadgeTooltipTemplate.html"],function(e,t,n,r,i){var s={0:"milestone_5k",1:"milestone_10k",2:"milestone_25k",3:"milestone_50k",4:"milestone_75k",5:"milestone_100k",6:"milestone_150k",7:"milestone_200k",8:"milestone_300k",9:"milestone_400k",10:"milestone_500k",11:"milestone_600k",12:"milestone_700k",13:"milestone_800k",14:"milestone_900k",15:"milestone_1m",16:"milestone_1_and_a_half_m",17:"milestone_2m",34:"exceeded_goal_first_time_to_double_goal",35:"exceeded_goal_first_time_to_triple_goal",36:"exceeded_goal_first_time_to_quadruple_goal",47:"winner_first_time_winner",48:"winner_second_time_winner",49:"winner_third_time_winner",51:"winner_fifth_time_winner",52:"stepped_it_up_moved_up_to_5k_level",53:"stepped_it_up_moved_up_to_10k_level",54:"stepped_it_up_moved_up_to_15k_level",55:"stepped_it_up_moved_up_to_20k_level",56:"stepped_it_up_moved_up_to_25k_level",57:"stepped_it_up_moved_up_to_30k_level",58:"stepped_it_up_moved_up_to_35k_level",59:"stepped_it_up_moved_up_to_40k_level",60:"stepped_it_up_moved_up_to_45k_level",61:"stepped_it_up_moved_up_to_50k_level",62:"stepped_it_up_moved_up_to_55k_level",63:"stepped_it_up_moved_up_to_60k_level",64:"stepped_it_up_moved_up_to_65k_level",65:"stepped_it_up_moved_up_to_70k_level",66:"stepped_it_up_moved_up_to_75k_level",67:"stepped_it_up_moved_up_to_80k_level",68:"stepped_it_up_moved_up_to_85k_level",69:"stepped_it_up_moved_up_to_90k_level",70:"stepped_it_up_moved_up_to_95k_level",71:"stepped_it_up_moved_up_to_100k_level",72:"stepped_it_up_moved_up_to_125k_level",73:"stepped_it_up_moved_up_to_150k_level",74:"stepped_it_up_moved_up_to_175k_level",75:"stepped_it_up_moved_up_to_200k_level",76:"stepped_it_up_moved_up_to_225k_level",77:"stepped_it_up_moved_up_to_250k_level",78:"stepped_it_up_moved_up_to_275k_level",79:"stepped_it_up_moved_up_to_300k_level",80:"stepped_it_up_moved_up_to_325k_level",81:"stepped_it_up_moved_up_to_350k_level",82:"stepped_it_up_moved_up_to_375k_level",83:"stepped_it_up_moved_up_to_400k_level",84:"stepped_it_up_moved_up_to_425k_level",85:"stepped_it_up_moved_up_to_450k_level",86:"stepped_it_up_moved_up_to_475k_level",87:"stepped_it_up_moved_up_to_500k_level"},o={getBadgeLabel:function(e){return e=this.getBadge(e),e.get("badgeCategory")==="group_challenge"?e.get("groupChallengeName"):t.localize(e.get("badgeCategoryType"))},getTooltipContent:function(e){e=this.getBadge(e);if(e.get("badgeCategory")==="group_challenge")return o.getGroupChallengeTooltip(e);var n=_.template(i),r=n({badgeTitle:t.localize(e.get("badgeCategoryType")),tooltipContent:t.formatMediumDate(e.get("badgeAwardedDate"))});return r},getGroupChallengeTooltip:function(e){e=this.getBadge(e);var n=e.get("groupName"),r=e.get("createDate"),s=o.getChallengeDuration(e),u=_.template(i),a=t.formatMediumDate(r);s&&(a+=" | "+s);var f=u({badgeTitle:e.get("groupName"),tooltipContent:a});return f},getChallengeDuration:function(e){e=this.getBadge(e);var r=e.get("groupChallengeDurationTypeId"),i=n.mapDurationTypes(r);return t.localize(i.toLowerCase()+"_"+"challenge")},getBadgeTitleFromCalendarItem:function(e){var n=e.get("badgeCategoryTypeId"),r=s[""+n];if(!r){r=e.get("badgeCategoryTypeDesc");if(r)return r}return r=r||"untitled",t.localize(r)},getBadge:function(t){return t instanceof e.Model||(t=new r(t)),t}};return o}),define("utils/diving/DiveUtil",["require","localizer"],function(e){var t=e("localizer"),n=999;return{maxHoursOfBottomTime:n,maxSecondsOfBottomTime:n*60*60,apneaActivityListMetrics:["maxDepth","bottomTime","numberOfApneaDives","totalSurfaceTime","summarizedDiveInfo.waterType"],defaultGasTank:{gasIndex:0,heliumContent:0,oxygenContent:21,tankEndingPressure:null,tankEndingPressureUnit:null,tankSize:null,tankSizeUnit:null,tankStartingPressure:null,tankStartingPressureUnit:null,tankType:null,status:1},formatNumberOfDives:function(e){return e===null?"":e<2?e+" "+t.localize("label_num_dives_singular"):e+" "+t.localize("label_num_dives")}}}),define("models/prs/PersonalRecord",["require","backbone"],function(e){var t=e("backbone"),n={Run:"RUN",Cycle:"CYCLE",Steps:"STEPS",Swim:"SWIM"},r=t.Model.extend({initialize:function(e){},urlRoot:"/proxy/personalrecord-service/personalrecord/"});return r.Sports=n,r}),define("models/prs/PersonalRecordType",["backbone"],function(e){var t=e.Model.extend({initialize:function(e){},comparator:function(e){var t=e.get("key");return t},urlRoot:"/proxy/personalrecord-service/personalrecordtype"});return t}),define("collections/prs/PersonalRecordTypes",["backbone","models/prs/PersonalRecordType"],function(e,t){var n={RUN_1K:"pr.label.1k.run",RUN_5K:"pr.label.5k.run",RUN_10K:"pr.label.10k.run",RUN_HALF_MARATHON:"pr.label.half.marathon",RUN_MARATHON:"pr.label.full.marathon",RUN_FARTHEST:"pr.label.farthest.run",RUN_1Mile:"pr.label.1mile.run",CYCLE_FARTHEST:"pr.label.farthest.cycle",CYCLE_MAX_ELEV:"pr.label.max.elev",CYCLE_MAX_POWER:"pr.label.max.power",CYCLE_40K:"pr.label.40k.cycle",STEPS_BEST_DAY:"pr.label.steps.best.day",STEPS_BEST_WEEK:"pr.label.steps.best.week",STEPS_BEST_MONTH:"pr.label.steps.best.month",STEPS_LONGEST_STREAK:"pr.label.steps.longest.streak",STEPS_CURRENT_STREAK:"pr.label.steps.current.streak",SWIM_LONGEST:"pr.label.longest.poolswim",SWIM_100M:"pr.label.100m.poolswim",SWIM_400M:"pr.label.400m.poolswim",SWIM_750M:"pr.label.750m.poolswim",SWIM_1000M:"pr.label.1000m.poolswim",SWIM_1500M:"pr.label.1500m.poolswim",SWIM_100YD:"pr.label.100yd.poolswim",SWIM_500YD:"pr.label.500yd.poolswim",SWIM_1000YD:"pr.label.1000yd.poolswim",SWIM_1650YD:"pr.label.1650yd.poolswim"},r=function(e){var t=99;switch(e){case n.RUN_1K:t=0;break;case n.RUN_1Mile:t=1;break;case n.RUN_5K:t=2;break;case n.RUN_10K:t=3;break;case n.RUN_HALF_MARATHON:t=4;break;case n.RUN_MARATHON:t=5;break;case n.RUN_FARTHEST:t=6;break;case n.CYCLE_40K:t=10;break;case n.CYCLE_MAX_ELEV:t=11;break;case n.CYCLE_MAX_POWER:t=12;break;case n.CYCLE_FARTHEST:t=13;break;case n.STEPS_BEST_DAY:t=14;break;case n.STEPS_BEST_WEEK:t=15;break;case n.STEPS_BEST_MONTH:t=16;break;case n.STEPS_LONGEST_STREAK:t=17;break;case n.STEPS_CURRENT_STREAK:t=18;break;case n.SWIM_100M:t=20;break;case n.SWIM_100YD:t=21;break;case n.SWIM_400M:t=22;break;case n.SWIM_500YD:t=23;break;case n.SWIM_750M:t=24;break;case n.SWIM_1000M:t=25;break;case n.SWIM_1000YD:t=26;break;case n.SWIM_1500M:t=27;break;case n.SWIM_1650YD:t=28;break;case n.SWIM_LONGEST:t=29}return t},i=e.Collection.extend({model:t,url:function(){var e=this.displayName||"";return"/proxy/personalrecord-service/personalrecordtype/prtypes/"+e},initialize:function(e,t){this.displayName=t.displayName},comparator:function(e,t){var n=r(e.get("key")),i=r(t.get("key"));return n<i?-1:n>i?1:0}});return i.Types=n,i.GetSortOrder=r,i}),define("utils/PersonalRecordTypeMapper",["require","localizer","personalizer","models/prs/PersonalRecord","collections/prs/PersonalRecordTypes"],function(e){var t=e("localizer"),n=e("personalizer"),r=e("models/prs/PersonalRecord"),i=e("collections/prs/PersonalRecordTypes"),s={getPersonalizerFunction:function(e){switch(e){case i.Types.RUN_FARTHEST:case i.Types.CYCLE_FARTHEST:return function(e){return n.personalizeDistance(e)+" "+t.localize(n.getDistanceUnitKey())};case i.Types.SWIM_LONGEST:return function(e,r){var i=null;return r?i=r.key==="yard"||r.unitKey==="yard"?"statute_us":"metric":i=n.inferPoolMeasurementSystemFromDistance(e),n.personalizeSwimDistance(e,i)+" "+t.localize(n.getDistanceUnitKey("lap_swimming",e,r))};case i.Types.CYCLE_MAX_ELEV:return function(e){return n.personalizeElevation(e)+" "+t.localize(n.getElevationUnitKey())};case i.Types.CYCLE_MAX_POWER:return function(e){return n.personalizePower(e)+" "+t.localize(n.getPowerUnitKey())};case i.Types.RUN_1K:case i.Types.RUN_5K:case i.Types.RUN_10K:case i.Types.RUN_HALF_MARATHON:case i.Types.RUN_MARATHON:case i.Types.RUN_1Mile:case i.Types.CYCLE_40K:case i.Types.SWIM_100M:case i.Types.SWIM_400M:case i.Types.SWIM_750M:case i.Types.SWIM_1000M:case i.Types.SWIM_1500M:case i.Types.SWIM_100YD:case i.Types.SWIM_500YD:case i.Types.SWIM_1000YD:case i.Types.SWIM_1650YD:return function(e){return n.personalizeDuration(e)};case i.Types.STEPS_BEST_DAY:case i.Types.STEPS_BEST_WEEK:case i.Types.STEPS_BEST_MONTH:return function(e){return n.personalizeSteps(e)};case i.Types.STEPS_LONGEST_STREAK:return function(e){return e?t.localize("pr.label.steps.longest.streak.unit",e):null};case i.Types.STEPS_CURRENT_STREAK:return function(e){return e?t.localize("pr.label.steps.current.streak.unit",e):null}}},getSortOrder:function(e){var t=i.GetSortOrder(e);return typeof t=="undefined"&&(console&&console.log("Unrecognized Personal Record Type: "+e),t=99),t},getRecordTypeFromKey:function(e){var t=i.Types;switch(e){case t.CYCLE_40K:case t.CYCLE_MAX_ELEV:case t.CYCLE_FARTHEST:case t.CYCLE_MAX_POWER:return r.Sports.Cycle;case t.RUN_1K:case t.RUN_5K:case t.RUN_10K:case t.RUN_HALF_MARATHON:case t.RUN_MARATHON:case t.RUN_FARTHEST:case t.RUN_1Mile:return r.Sports.Run;case t.STEPS_BEST_DAY:case t.STEPS_BEST_WEEK:case t.STEPS_BEST_MONTH:case t.STEPS_LONGEST_STREAK:case t.STEPS_CURRENT_STREAK:return r.Sports.Steps;case t.SWIM_100M:case t.SWIM_100YD:case t.SWIM_400M:case t.SWIM_500YD:case t.SWIM_750M:case t.SWIM_1000M:case t.SWIM_1000YD:case t.SWIM_1500M:case t.SWIM_1650YD:case t.SWIM_LONGEST:return r.Sports.Swim}return null}};return s}),define("models/activity/ActivityType",["backbone"],function(e){var t=e.Model.extend({idAttribute:"typeId",initialize:function(){}});return t}),define("collections/activity/ActivityTypes",["backbone","models/activity/ActivityType"],function(e,t){var n=["multi_sport","steps"],r=e.Collection.extend({model:t,url:"/proxy/activity-service/activity/activityTypes",comparator:function(e){return e.get("sortOrder")},parse:function(e){return _.reject(e,function(e){return _.contains(n,e.typeKey)})},isSameParentActivityType:function(e,t){if(e.id===t.id)return!0;var n=e.get("parentTypeId"),r=t.get("parentTypeId"),i=this.findByTypeId(n),s=this.findByTypeId(r);return e.get("typeKey")==="all"?!1:t.get("typeKey")==="all"?!1:e.id===r||t.id===n?!0:i.get("typeKey")==="all"?!1:n===r},findByTypeId:function(e){if(!this.idMap){var t={};this.each(function(e){t[e.get("typeId")]=e}),this.idMap=t}return this.idMap[e]},findByTypeKey:function(e){return this.find(function(t){return e==t.get("typeKey")})},findByParentTypeId:function(e){return this.filter(function(t){return e==t.get("parentTypeId")})},getParentType:function(e){var t=this.findByTypeKey(e);if(t){var n=t.get("parentTypeId");if(_.isUndefined(n)||n==null)return t;var r=this.findByTypeId(n);return r.get("typeKey")=="all"?t:r}return null},toJSONParentChild:function(){var e=this.findByTypeKey("all"),t=e.get("typeId"),n=new r;this.each(function(e){if(e.get("parentTypeId")==t){var i=e.clone();i.children=new r,n.add(i)}},this),this.each(function(e){if(e.get("typeId")!=t&&e.get("parentTypeId")!=t){var r=e.get("parentTypeId"),i=n.findByTypeId(r);i.children.add(e)}},this);var i=n.toJSON();return _.each(i,function(e){e.children=n.findByTypeId(e.typeId).children.toJSON(),e.children=_.sortBy(e.children,function(e){return e.typeKey})}),i}});return r}),define("utils/activity/ActivitiesUtil",["require","underscore","backbone","collections/activity/ActivityTypes"],function(e){var t=e("underscore"),n=e("backbone"),r=e("collections/activity/ActivityTypes");return{MAX_COMPARE_ITEMS:4,numberOfSelectedItems:0,unknownActivityTypeDefault:"uncategorized",activityListColumnConfigDefaults:{running:["distance","duration","averageSpeed","elevationGain","averageHR"],cycling:["distance","duration","averageSpeed","elevationGain","avgPower"],swimming:["distance","duration","averageSpeed","calories","averageHR"],walking:["distance","duration","averageSpeed","averageHR","calories"],hiking:["distance","calories","duration","averageHR","averageSpeed"],fitness_equipment:["duration","averageHR","calories","averageHR","averageSpeed"],other:["distance","duration","averageSpeed","averageHR","calories"],uncategorized:["distance","calories","duration","averageHR","maxHR"],multi_sport:["duration","distance","calories","elevationGain","averageSpeed"],yoga:["duration","averageHR","calories","maxHR","elevationGain"],motorcycling:["distance","duration","averageSpeed","averageHR","calories"],diving:["maxDepth","bottomTime","minTemperature","calories","surfaceInterval"]},dummyMetricValues:{distance:"--",duration:"--",averageSpeed:"--",maxSpeed:"--",elevationGain:"--",elevationLoss:"--",averageHR:"--",maxHR:"--",avgPower:"--",maxPower:"--",calories:"--",averageBikingCadenceInRevPerMinute:"--",maxBikingCadenceInRevPerMinute:"--",averageRunningCadenceInStepsPerMinute:"--",maxRunningCadenceInStepsPerMinute:"--",averageSwimCadenceInStrokesPerMinute:"--",avgStrideLength:"--",avgVerticalRatio:"--",avgVerticalOscillation:"--",avgGroundContactTime:"--",avgGroundContactBalance:"--",normPower:"--",leftBalance:"--",trainingStressScore:"--",max20MinPower:"--",strokes:"--",averageSwolf:"--",aerobicTrainingEffect:"--",maxDepth:"--",minTemperature:"--",bottomTime:"--",isDecoDive:"--",gasType:"--",visibility:"--",surfaceInterval:"--","summarizedDiveInfo.weight":"--","summarizedDiveInfo.current":"--","summarizedDiveInfo.surfaceCondition":"--","summarizedDiveInfo.waterType":"--"},activityListAllDisplayableMetrics:{running:["distance","calories","duration","averageHR","maxHR","aerobicTrainingEffect","averageRunningCadenceInStepsPerMinute","maxRunningCadenceInStepsPerMinute","averageSpeed","maxSpeed","elevationGain","elevationLoss","avgStrideLength","avgVerticalRatio","avgVerticalOscillation","avgGroundContactTime","avgGroundContactBalance"],cycling:["distance","calories","duration","averageHR","maxHR","aerobicTrainingEffect","averageBikingCadenceInRevPerMinute","maxBikingCadenceInRevPerMinute","averageSpeed","maxSpeed","normPower","leftBalance","trainingStressScore","max20MinPower","avgPower","maxPower","elevationGain","elevationLoss"],swimming:["distance","calories","duration","averageHR","maxHR","strokes","averageSwolf","averageSwimCadenceInStrokesPerMinute","averageSpeed"],walking:["distance","calories","duration","averageHR","maxHR","averageRunningCadenceInStepsPerMinute","maxRunningCadenceInStepsPerMinute","averageSpeed","maxSpeed","elevationGain","elevationLoss","avgStrideLength"],hiking:["distance","calories","duration","averageHR","maxHR","averageRunningCadenceInStepsPerMinute","maxRunningCadenceInStepsPerMinute","averageSpeed","maxSpeed","elevationGain","elevationLoss","avgStrideLength"],fitness_equipment:["distance","calories","duration","averageHR","maxHR","averageSpeed","maxSpeed","elevationGain","elevationLoss","avgStrideLength"],yoga:["duration","averageHR","calories","maxHR","elevationGain"],other:["distance","calories","duration","averageHR","maxHR","averageSpeed"],uncategorized:["distance","calories","duration","averageHR","maxHR","averageSpeed"],multi_sport:["duration","distance","calories","elevationGain","averageSpeed"],motorcycling:["distance","calories","duration","averageHR","maxHR","averageSpeed"],diving:["maxDepth","bottomTime","minTemperature","gasType","surfaceInterval","isDecoDive","calories","summarizedDiveInfo.weight","summarizedDiveInfo.current","summarizedDiveInfo.surfaceCondition","summarizedDiveInfo.waterType"]},alternateMetricNames:{averageSpeed:"avgSpeed",averageHR:"avgHr",maxHR:"maxHr",averageRunningCadenceInStepsPerMinute:"avgRunCadence",maxRunningCadenceInStepsPerMinute:"maxRunCadence",averageBikingCadenceInRevPerMinute:"avgBikeCadence",maxBikingCadenceInRevPerMinute:"maxBikeCadence",averageSwimCadenceInStrokesPerMinute:"avgStrokeCadence",maxSwimCadenceInStrokesPerMinute:"maxStrokeCadence",averageSwolf:"avgSwolf",leftBalance:"avgLeftBalance"},formatActivityTypesForDropdownList:function(e){e instanceof n.Collection||(e=new r(e));var i=e.toJSONParentChild(),s=[];return t.each(i,function(e){var n={nameKey:"activity_type_"+e.typeKey,value:e.typeId,typeKey:e.typeKey,children:[]};t.each(e.children,function(e){n.children.push({nameKey:"activity_type_"+e.typeKey,typeKey:e.typeKey,value:e.typeId})}),s.push(n)},this),s},filterFormattedActivityTypesByUsage:function(e,n){var r=n.get("performanceBasedIndicators").activityIndicators,i=t.filter(e,function(e){if(r[e.typeKey])return r[e.typeKey].lastActivityDate}),s=t.keys(this.activityListColumnConfigDefaults);return i=t.filter(i,function(e){return t.contains(s,e.typeKey)}),i},getAlternateMetricName:function(e){return this.alternateMetricNames.hasOwnProperty(e)?this.alternateMetricNames[e]:t.findKey(this.alternateMetricNames,function(t){return t===e}.bind(this))},isActivityTypeFound:function(e,n,r){var i=this.formatActivityTypesForDropdownList(r),s=t.filter(i,function(r){if(r[e]===n)return r;var i={};return i[e]=n,t.findWhere(r.children,i)});return s.length>0},isDivingActivity:function(e){return e==="diving"||e==="multi_gas_diving"||e==="single_gas_diving"||e==="apnea_diving"||e==="gauge_diving"||e==="apnea_hunting"},isApneaDiving:function(e){return e==="apnea_diving"||e==="apnea_hunting"},isGasDiving:function(e){return e==="multi_gas_diving"||e==="single_gas_diving"}}}),define("utils/ActivityTypeCssClassMapper",[],function(){var e={cycling:"cycling",transition:"transition",equipment:"fitness-equipment",other:"other",multisport:"multisport",swimming:"swimming",walking:"walking",hiking:"hiking",running:"running",uncategorized:"uncategorized",motorcycling:"motorcycle",elliptical:"elliptical",diving:"diving",divingSingleGas:"diving-single-gas",divingMultiGas:"diving-multi-gas",divingGauge:"diving-gauge",divingApnea:"diving-apnea",divingApneaHunt:"diving-apnea-hunt",yoga:"yoga"},t={};t.cycling=e.cycling,t.mountain_biking=e.cycling,t.road_biking=e.cycling,t.recumbent_cycling=e.cycling,t.track_cycling=e.cycling,t.downhill_biking=e.cycling,t.cyclocross=e.cycling,t.indoor_cycling=e.cycling,t.bmx=e.cycling,t.gravel_cycling=e.cycling,t.virtual_ride=e.cycling,t.running=e.running,t.trail_running=e.running,t.street_running=e.running,t.track_running=e.running,t.treadmill_running=e.running,t.virtual_run=e.running,t.obstacle_run=e.running,t.swimming=e.swimming,t.lap_swimming=e.swimming,t.open_water_swimming=e.swimming,t.multi_sport=e.multisport,t.walking=e.walking,t.speed_walking=e.walking,t.casual_walking=e.walking,t.hiking=e.hiking,t.stair_climbing=e.equipment,t.indoor_rowing=e.equipment,t.strength_training=e.equipment,t.indoor_cardio=e.equipment,t.elliptical=e.elliptical,t.fitness_equipment=e.equipment,t.other=e.other,t.skating=e.other,t.skate_skiing=e.other,t.cross_country_skiing=e.other,t.sailing=e.other,t.boating=e.other,t.backcountry_skiing_snowboarding=e.other,t.resort_skiing_snowboarding=e.other,t.inline_skating=e.other,t.whitewater_rafting_kayaking=e.other,t.paddling=e.other,t.flying=e.other,t.snowmobiling=e.other,t.motorcycling=e.other,t.driving_general=e.other,t.horseback_riding=e.other,t.wind_kite_surfing=e.other,t.rowing=e.other,t.snow_shoe=e.other,t.mountaineering=e.other,t.stand_up_paddleboarding=e.other,t.golf=e.other,t.steps=e.other,t.sky_diving=e.other,t.hunting_fishing=e.other,t.surfing=e.other,t.wakeboarding=e.other,t.rc_drone=e.other,t.rock_climbing=e.other,t.hang_gliding=e.other,t.wingsuit_flying=e.other,t.swimToBikeTransition=e.transition,t.bikeToRunTransition=e.transition,t.runToBikeTransition=e.transition,t.transition=e.transition,t.multi_sport=e.multisport,t.motorcycling=e.motorcycling,t.motocross=e.motorcycling,t.atv=e.motorcycling,t.floor_climbing=e.other,t.yoga=e.yoga,t.stop_watch=e.other,t.diving=e.diving,t.single_gas_diving=e.divingSingleGas,t.multi_gas_diving=e.divingMultiGas,t.apnea_diving=e.divingApnea,t.apnea_hunting=e.divingApneaHunt,t.gauge_diving=e.divingGauge;var n={map:function(t){var n=this.classMap[t];return typeof n=="undefined"?e.uncategorized:n}};return n.classMap=t,n}),define("utils/ActivitySpeedModelUtil",["require","personalizer","localizer"],function(e){function o(e){if(!e)throw"ActivitySpeedModel: activityJson is required.";if(e.hasOwnProperty("activityTypeDTO"))s=e.activityTypeDTO.typeKey;else{if(!e.hasOwnProperty("activityType"))throw"ActivitySpeedModel: activity type is not defined.";s=e.activityType.typeKey}r=t.getSpeedTypeFromActivityType(s),i=e;switch(r){case t.SpeedTypes.SwimPace:return f();case t.SpeedTypes.SwimSpeed:return l();case t.SpeedTypes.Pace:return c();case t.SpeedTypes.RowingPace:return h();case t.SpeedTypes.RowingSpeed:return p();case t.SpeedTypes.Flying:return d();default:return v()}}function u(e){r=e}function a(e){i=e}function f(){var e=i.unitOfPoolLength?i.unitOfPoolLength.unitKey:null,r=null;e==="meter"?r=t.MeasurementSystems.METRIC:e==="yard"&&(r=t.MeasurementSystems.STATUTE_US);var s=v();return s.avgSpeedOrPace=t.personalizeSwimPace(i.averageSpeed,r),s.avgSpeedOrPaceUnit=n.localize(t.getSwimPaceUnitKey(r)),s.avgSpeedOrPaceLabel=n.localize(t.getAvgPaceLabelKey("lap_swimming")),s.avgMovingSpeedOrPace=t.personalizeSwimPace(i.averageMovingSpeed,r),s.avgMovingSpeedOrPaceUnit=n.localize(t.getSwimPaceUnitKey(r)),s.avgMovingSpeedOrPaceLabel=n.localize(t.getAvgMovingSpeedTypeLabelKey("lap_swimming")),s.maxSpeedOrPace=i.maxSpeed?t.personalizeSwimPace(i.maxSpeed,r):null,s.maxSpeedOrPaceUnit=n.localize(t.getSwimPaceUnitKey(r)),s.maxSpeedOrPaceLabel=n.localize(t.getMaxSpeedTypeLabelKey("lap_swimming")),s}function l(){var e=i.unitOfPoolLength?i.unitOfPoolLength.unitKey:null,r=null;e==="meter"?r=t.MeasurementSystems.METRIC:e==="yard"&&(r=t.MeasurementSystems.STATUTE_US);var s=v();return s.avgSpeedOrPace=t.personalizeSwimSpeed(i.averageSpeed,r),s.avgSpeedOrPaceUnit=n.localize(t.getSwimSpeedUnitKey(r)),s.avgSpeedOrPaceLabel=n.localize(t.getAvgPaceLabelKey("cycling")),s.avgMovingSpeedOrPace=t.personalizeSwimSpeed(i.averageMovingSpeed,r),s.avgMovingSpeedOrPaceUnit=n.localize(t.getSwimSpeedUnitKey(r)),s.avgMovingSpeedOrPaceLabel=n.localize(t.getAvgMovingSpeedTypeLabelKey("cycling")),s.maxSpeedOrPace=t.personalizeSwimSpeed(i.maxSpeed,r),s.maxSpeedOrPaceUnit=n.localize(t.getSwimSpeedUnitKey(r)),s.maxSpeedOrPaceLabel=n.localize(t.getMaxSpeedTypeLabelKey("cycling")),s}function c(){var e=v();return e.avgSpeedOrPace=t.personalizeSpeed(i.averageSpeed,"running"),e.avgSpeedOrPaceUnit=n.localize(t.getPaceUnitKey()),e.avgSpeedOrPaceLabel=n.localize(t.getAvgPaceLabelKey("running")),e.avgMovingSpeedOrPace=t.personalizeSpeed(i.averageMovingSpeed,"running"),e.avgMovingSpeedOrPaceUnit=n.localize(t.getPaceUnitKey()),e.avgMovingSpeedOrPaceLabel=n.localize(t.getAvgMovingSpeedTypeLabelKey("running")),e.maxSpeedOrPace=t.personalizeSpeed(i.maxSpeed,"running"),e.maxSpeedOrPaceUnit=n.localize(t.getPaceUnitKey()),e.maxSpeedOrPaceLabel=n.localize(t.getMaxSpeedTypeLabelKey("running")),e}function h(){var e=c(),r=t.getRowingPaceUnitKey();return e.avgSpeedOrPaceUnit=n.localize(r),e.avgMovingSpeedOrPaceUnit=n.localize(r),e.maxSpeedOrPaceUnit=n.localize(r),e.avgMovingSpeedOrPace=t.personalizeRowingPace(i.averageMovingSpeed),e.maxSpeedOrPace=i.maxSpeed?t.personalizeRowingPace(i.maxSpeed):null,e.avgSpeedOrPace=i.averageSpeed>0?t.personalizeRowingPace(i.averageSpeed):0,e}function p(){var e=v(),r=t.getRowingSpeedUnitKey();return e.avgSpeedOrPaceUnit=n.localize(r),e.avgMovingSpeedOrPaceUnit=n.localize(r),e.maxSpeedOrPaceUnit=n.localize(r),e.avgMovingSpeedOrPace=t.formatSpeed(t.convertSpeed(i.averageMovingSpeed,t.MeasurementSystems.METRIC,s)),e.maxSpeedOrPace=i.maxSpeed?t.formatSpeed(t.convertSpeed(i.maxSpeed,t.MeasurementSystems.METRIC,s)):null,e.avgSpeedOrPace=t.formatSpeed(t.convertSpeed(i.averageSpeed,t.MeasurementSystems.METRIC,s)),e}function d(){var e=v();return e.avgSpeedOrPaceLabel=n.localize(t.getAvgSpeedTypeLabelKey(t.SpeedTypes.Flying)),e.avgMovingSpeedOrPaceLabel=n.localize(t.getAvgMovingSpeedTypeLabelKey(t.SpeedTypes.Flying)),e.maxSpeedOrPaceLabel=n.localize(t.getMaxSpeedTypeLabelKey(t.SpeedTypes.Flying)),e}function v(){return{time:t.personalizeDuration(i.duration),movingTime:t.personalizeDuration(i.movingDuration),elapsedTime:t.personalizeDuration(i.elapsedDuration),avgSpeedOrPace:t.personalizeSpeed(i.averageSpeed,"cycling"),avgSpeedOrPaceUnit:n.localize(t.getSpeedUnitKey()),avgSpeedOrPaceLabel:n.localize(t.getAvgSpeedTypeLabelKey("cycling")),avgMovingSpeedOrPace:t.personalizeSpeed(i.averageMovingSpeed,"cycling"),avgMovingSpeedOrPaceUnit:n.localize(t.getSpeedUnitKey()),avgMovingSpeedOrPaceLabel:n.localize(t.getAvgMovingSpeedTypeLabelKey("cycling")),maxSpeedOrPace:t.personalizeSpeed(i.maxSpeed,"cycling"),maxSpeedOrPaceUnit:n.localize(t.getSpeedUnitKey()),maxSpeedOrPaceLabel:n.localize(t.getMaxSpeedTypeLabelKey("cycling"))}}var t=e("personalizer"),n=e("localizer"),r,i,s;return{getSpeedModelforActivity:o,setSpeedType:u,setActivity:a,getSwimPaceModel:f,getSwimSpeedModel:l,getPaceModel:c,getSpeedModel:v,getRowingPaceModel:h,getRowingSpeedModel:p,getFlyingModel:d}}),define("models/calendar/UserCalendarPreferences",["backbone"],function(e){var t={1:"9FEDFF",2:"A0FFB2",3:"B9FF41",4:"E2FF1F",5:"FFF000",6:"FFDD00",7:"FFBF00",8:"FF9059",9:"FF787C",10:"F28ACE",11:"E8A7FF",12:"D2BAFF",13:"F1E3C2",14:"EBD6A1",15:"E1C682",16:"EEEEEE",17:"DDDDDD",18:"CCCCCC"},n={1:"1AA2FF",2:"12B79F",3:"4BA900",4:"87A000",5:"AE9F00",6:"C79600",7:"E27900",8:"DB6000",9:"DB0000",10:"CC2692",11:"9822E6",12:"793EAC",13:"CCBA91",14:"B3995D",15:"80692E",16:"BBBBBB",17:"888888",18:"333333"},r=e.Model.extend({url:function(){return"/proxy/calendar-service/preferences"},initialize:function(e){this.isDirty=!1,this.bind("change",this.onChange,this),this.bind("sync",this.onSync,this)},backup:function(){this.backupAttributes=_.clone(this.attributes)},restore:function(){this.backupAttributes&&(this.set(this.backupAttributes),this.isDirty=!1)},isNew:function(){return!1},onSync:function(){this.isDirty=!1,this.backup()},onChange:function(){this.isDirty=!0;var e=Array.prototype.toJSON;delete Array.prototype.toJSON,this.save(),Array.prototype.toJSON=e},parse:function(e){return e==null?e:(e.trainingPlans=_.sortBy(e.trainingPlans,function(e){return e.name}),e.groups=_.sortBy(e.groups,function(e){return e.name}),_.each(e,function(e,t,n){if(t.indexOf("Color")!==-1&&e==0){switch(t){case"eventColor":e=8;break;case"goalColor":e=3;break;case"workoutColor":e=5;break;default:e=0}n[t]=e}}),_.each(e.trainingPlans,function(e,t,n){e.color==0&&(e.color=11)}),_.each(e.groups,function(e,t,n){e.color==0&&(e.color=2)}),_.each(e.activityTypes,function(e,t,n){var r=e.color;if(r==0){switch(e.key){case"running":r=1;break;case"diving":r=2;break;case"cycling":r=9;break;case"swimming":r=7;break;case"multi_sport":r=4;break;default:r=17}e.color=r}}),e)}});return r.colors=t,r.textColors=n,r}),define("utils/parsers/NumberParser",["personalizer","numberformatter"],function(e){var t=function(e){this.numberFormat=e,this.numberFormat||(this.numberFormat="#,###.00")};return t.prototype.parse=function(t){var n=+jQuery.parseNumber(t,{format:this.numberFormat,locale:e.getNumberSeparator()}),r=/^0*$/.test(t);if(n===0&&!r&&t!==0)throw"NumberParser - invalid number";return n},t}),define("utils/WeightClassMapper",["require","personalizer","utils/parsers/NumberParser"],function(e){var t=e("personalizer"),n=e("utils/parsers/NumberParser"),r=function(e){if(!e)throw"Invalid measurement system";this.measurementSystem=e,this.numberParser=new n};return r.prototype.getWeightClass=function(e){var n=this.numberParser.parse(e);return this.measurementSystem===t.MeasurementSystems.METRIC?n<46?"1-45":n<57?"46-56":n<69?"57-68":n<75?"69-74":n<82?"75-81":n<91?"82-90":"91+":n<100?"1-99":n<125?"100-124":n<150?"125-149":n<165?"150-164":n<180?"165-179":n<200?"180-199":"200+"},r}),define("pages/activity_details_2/views/utils/ActivityTypeStyleMapper",[],function(){var e={cycling:"map_marker_activity_cycling_pin.svg",hiking:"map_marker_activity_hiking_pin.svg",other:"map_marker_activity_other_pin.svg",running:"map_marker_activity_running_pin.svg",swimming:"map_marker_activity_swimming_pin.svg",transition:"map_marker_activity_transition_pin.svg",uncategorized:"map_marker_activity_uncategorized_pin.svg",walking:"map_marker_activity_walking_pin.svg",fitness_equipment:"map_marker_activity_fitness_equipment_pin.svg",motorcycling:"map_marker_activity_other_pin.svg",diving:"map_marker_activity_diving.svg",single_gas_diving:"map_marker_activity_singlegas.svg",multi_gas_diving:"map_marker_activity_multigas.svg",gauge_diving:"map_marker_activity_gauge.svg",apnea_diving:"map_marker_activity_apnea.svg",apnea_hunting:"map_marker_activity_apneahunt.svg"},t={cycling:"#DA3B61",hiking:"#C8661F",other:"#A7A7A7",running:"#0093C7",swimming:"#AE1297",transition:"#A7A7A7",uncategorized:"#A7A7A7",walking:"#439727",fitness_equipment:"#A10023",motorcycling:"#A7A7A7",diving:"#439727",single_gas_diving:"#439727",multi_gas_diving:"#439727",gauge_diving:"#439727",apnea_diving:"#439727",apnea_hunting:"#439727"},n={mapStartPin:function(t){var n=e[t];return n||(n=e.other),n},mapPolylineColor:function(e){var n=t[e];return n||(n=t.other),n}};return n}),define("views/map/MapViewUtils",["pages/activity_details_2/views/utils/ActivityTypeStyleMapper","utils/NavigationUtil"],function(e,t){var n=33,r=50,i=5,s=33,o=50,u=5,a=16,f=16,l=11,c=11,h=0,p=26,d=26,v=26;return{getSmallStartMarkerOptions:function(s){var o=t.url("/images/map/large/map_marker_start.svg");return s&&(o=t.url("/images/map/large/"+e.mapStartPin(s))),{iconURL:o,iconAnchor:{x:Math.ceil(n/4),y:r/2-i/2},iconSize:{width:n/2,height:r/2},cursor:"default",zIndex:91}},getStartMarkerOptions:function(s){var o=t.url("/images/map/large/map_marker_start.svg");return s&&(o=t.url("/images/map/large/"+e.mapStartPin(s))),{iconURL:o,iconAnchor:{x:Math.ceil(n/2),y:r-i},iconSize:{width:n,height:r},cursor:"default",zIndex:91}},getEndMarkerOptions:function(){return{iconURL:t.url("/images/map/large/map_marker_end.svg"),iconAnchor:{x:Math.ceil(s/2),y:o-u},iconSize:{width:s,height:o},cursor:"default",zIndex:90}},getPlayerPositionMarkerOptions:function(){return{iconURL:t.url("/images/map/map_marker_player.svg"),iconAnchor:{x:Math.ceil(a/2),y:Math.ceil(f)-f/2},iconSize:{height:f,width:a},cursor:"pointer",zIndex:90}},getLapMarkerOptions:function(e){return{iconUTL:e,iconAnchor:{x:Math.ceil(s/2),y:Math.ceil(o)},iconSize:{height:r,width:n},cursor:"pointer",zIndex:91,visible:!0}},getSegmentStartMarkerOptions:function(){return{iconURL:t.url("/images/map/map_marker_start_small.svg"),iconAnchor:{x:Math.ceil(c/2)-h,y:Math.ceil(l/2)-h},iconSize:{height:l,width:c},zIndex:89}},getSegmentEndMarkerOptions:function(){return{iconURL:t.url("/images/map/map_marker_end_small.svg"),iconAnchor:{x:Math.ceil(c/2)-h,y:Math.ceil(l/2)-h},iconSize:{height:l,width:c},zIndex:89}},getActivityMarkerOptions:function(n){if(!n)throw"activity type required";var r=t.url("/images/map/large/"+e.mapStartPin(n));return{iconURL:r,iconAnchor:{x:Math.ceil(p/2),y:d-v},iconSize:{width:p,height:d},cursor:"default",zIndex:91}},userInChina:function(){var e=window.location.href;return e.indexOf("garmin.cn")!==-1},isMapProviderValid:function(e){return!this.isBaiduEnabled()&&e==="BAIDU_V_1_4"?!1:!0},isBaiduEnabled:function(){var e=Globalize.cultureSelector.replace("-","_"),t=window.location.href;return t.indexOf("garmin.cn")!=-1?!0:e!="zh_TW"&&e!="zh_CN"?!1:!0},getStandardizedPoint:function(e){var t={};if(!e||!e.hasOwnProperty("lat"))return;t.lat=e.lat;if(e.hasOwnProperty("lng"))t.lon=e.lng;else{if(!e.hasOwnProperty("lon"))return;t.lon=e.lon}return t},getBigSegmentStartMarkerOptions:function(){return{iconUrl:"/modern/images/map/map-marker-start.svg",shadowUrl:"",iconSize:[30,45],iconAnchor:[16,40],className:"active has-tooltip",html:'<span class="course-pt course-pt-start active has-tooltip" title=""></span>'}},getBigSegmentEndMarkerOptions:function(){return{iconUrl:"/modern/images/map/map-marker-end.svg",shadowUrl:"",iconSize:[30,45],iconAnchor:[16,40],className:"active has-tooltip",html:'<span class="course-pt course-pt-finish active has-tooltip" title=""></span>'}}}}),define("utils/date/TimeUtil",["jquery","moment","localizer","utils/parsers/NumberParser","personalizer","utils/personalizer/NumberSeparators","utils/date/DateFormatter"],function(e,t,n,r,i,s,o){var u={secondsToTime:function(e){var t=Math.floor(e/3600),n=e%3600,r=Math.floor(n/60),i=n%60,s=Math.ceil(i);s>=60&&(r++,s-=60),r>=60&&(t++,r-=60);var o={h:t,m:r,s:s};return o},formatSeconds:function(e){var t=this.secondsToTime(e);return t=(t.h>0?u.pad2(t.h)+":":"")+u.pad2(t.m)+":"+u.pad2(t.s),t},floatToTime:function(e){var t=Math.floor(e),n=(e-t)*60;return t+":"+this.pad2(Math.floor(n))},hrsMinToFloat:function(e,t){var n=t/60;return Number((e+n).toFixed(2))},timeObjectToSeconds:function(e){var t=0;return e.h&&(t+=Number(e.h*3600)),e.m&&(t+=Number(e.m*60)),e.s&&(t+=Number(e.s)),t},dateTimeToSeconds:function(e){var t=e.getSeconds()+e.getMinutes()*60+e.getHours()*3600;return t},formatTime12Hour:function(e,t,r){var i=this.secondsToTime(e),s=i.h,o=i.m,u=n.localize("AM");return s===0||s===12||s===24?(u=s===12?n.localize("PM"):n.localize("AM"),s=12):(u=s>12?n.localize("PM"):n.localize("AM"),s%=12),u=r?"":u,(t?s+u.substr(0,1).toLowerCase():s+":"+this.pad2(o)+" "+u).trim()},getShortHourFromDate:function(e){var t=e.getHours();switch(t){case 0:case 24:return 0;case 12:return 12;default:return t%12}},formatTime24Hour:function(e,t){var n=this.secondsToTime(e),r=n.h,i=n.m;return r===24&&(r=0),t?r+"":r+":"+this.pad2(i)},pad2:function(e){var t=""+e;return t.length>=2?t:t.length===1?"0"+t:"00"},formatTime:function(e,t,n,r){return t?this.formatTime24Hour(e,n):this.formatTime12Hour(e,n,r)},timeToMinutes:function(e){var t=e.split(":");if(t.length!=2&&t.length!=3)throw new Error("Invalid format! Can only be hh:mm:ss or mm:ss");var n=parseInt(t.length===2?0:t[0]),r=parseInt(t.length===2?t[0]:t[1]),i=parseInt(t.length===2?t[1]:t[2]),s=n*60+r+i*(1/60);return s},hoursMinutesAndSecondsToSeconds:function(t){var n=e.trim(t).split(/:| /),o=new r,u=i.getNumberSeparator()===s.DECIMAL_PERIOD?",":".";if(t.indexOf(u)>=0)throw new Error("Invalid Format");try{for(var a=0;a<n.length;a++)n[a]=o.parse(n[a])}catch(f){throw new Error("Invalid Format")}var l=n.length===3?n[0]:0,c=n.length>2?+n[1]:+n[0],h=+n[n.length-1];return l*3600+c*60+h},timeToSeconds:function(t){var r=0,i=0,s="",o=0,u=[];u=e.trim(t).split(/:| /);if(isNaN(u[0])||isNaN(u[1]))throw new Error("Invalid Format");if(u.length>2&&u[2]!==n.localize("AM")&&u[2]!==n.localize("PM"))throw new Error("Invalid Format");return r=Number(u[0]),i=Number(u[1]),o=r*3600+i*60,u.length>2&&(s=u[2],o+=r!==12&&s===n.localize("PM")?43200:0,o-=r===12&&s===n.localize("AM")?43200:0),o},time24ToSeconds:function(t){var n=e.trim(t).split(/:| /),r=+n[0],i=+n[1],s=n.length===3?+n[2]:0;return 3600*r+60*i+s},timeDifferenceRoundingUp:function(r,i){r=t(r),i=t(i);var s=this.durationBetweenDates(r,i);if(s===0||s===null)return null;if(s.years()>0)return o.formatMonthDayYear(i.toDate());if(s.months()>0){var u=s.months();return s.weeks()>0&&u++,u===1?n.localize("one_month"):n.localize("months",u)}if(s.weeks()>0){var a=s.weeks();return s.days()%7>0&&a++,a===1?n.localize("one_week"):n.localize("weeks",a)}if(s.days()>0){var f=s.days();return s.hours()>0&&f++,f===1?n.localize("one.day"):n.localize("days",f)}return s.add(1,"minutes"),s.days()===1?"24:00":e.formatNumber(s.hours(),{format:"#0"})+":"+e.formatNumber(s.minutes(),{format:"00"})},durationBetweenDates:function(e,n){var e=t(e),n=t(n),r=n.diff(e);return r<0?0:t.duration(r)},secondsToHoursAndMinutes:function(e){if(!e)return"";var t=Math.floor(e/3600),n=Math.floor((e-t*3600)/60);return n<10&&(n="0"+n),t+":"+n}};return u}),define("utils/CalorieUtil",[],function(){var e={determineMETS:function(e,t){switch(e){case"running":case"street_running":case"track_running":case"trail_running":case"virtual_run":case"obstacle_run":case"treadmill_running":return!t||t<5.2?8:t<5.5?9:t<5.7?9.3:t<6?9.7:t<6.3?10:t<6.7?10.5:t<7?11:t<7.5?11.5:t<8?12.5:t<8.6?13.5:t<9?14:t<10?15:t<10.9?16:18;case"cycling":case"mountain_biking":return t?t<10?4:t<12?6:t<14?8:t<16?10:12:8;case"cyclocross":case"downhill_biking":case"indoor_cycling":case"recumbent_cycling":case"road_biking":case"virtual_ride":case"track_cycling":return t?t<10?4:t<12?6:t<14?8:t<16?10:12:8.5;case"driving_general":case"flying":case"rc_drone":return 2;case"motorcycling":case"boating":case"yoga":return 2.5;case"walking":case"casual_walking":case"sailing":case"steps":case"wind_kite_surfing":case"surfing":return 3;case"snowmobiling":case"sky_diving":case"hang_gliding":case"wingsuit_flying":return 3.5;case"horseback_riding":case"motocross":case"atv":case"hunting_fishing":return 4;case"golf":return 4.5;case"elliptical":case"strength_training":case"speed_walking":case"whitewater_rafting_kayaking":return 5;case"fitness_equipment":case"indoor_cardio":case"hiking":case"wakeboarding":return 6;case"floor_climbing":return 6.4;case"indoor_rowing":case"backcountry_skiing_snowboarding":case"paddling":case"resort_skiing_snowboarding":case"rowing":case"skate_skiing":case"skating":case"stand_up_paddleboarding":return 7;case"cross_country_skiing":case"snow_shoe":return 8;case"bmx":return 8.5;case"stair_climbing":return 9;case"swimming":case"lap_swimming":case"open_water_swimming":return 10;case"rock_climbing":return 11;case"inline_skating":return 12;case"mountaineering":return 16.5}return null},autoCalcCalories:function(t,n,r,i){if(n&&t&&r){var s=r/3600,o=Math.round(i/s*.000621371192*10)/10;return Math.round(e.determineMETS(t,o)*n*s)}return null}};return e}),define("pages/workouts/util/Types",[],function(){return{SportTypes:{Running:"running",Cycling:"cycling",Other:"other",Swimming:"swimming",Strength_Training:"strength_training",Cardio:"cardio_training"},StepTypes:{Warm_Up:"warmup",Interval:"interval",Cool_Down:"cooldown",Recovery:"recovery",Rest:"rest",Repeat:"repeat",Other:"other"},TargetTypes:{No_Target:"no.target",Cadence:"cadence",Heart_Rate_Zone:"heart.rate.zone",Pace_Zone:"pace.zone",Power_Zone:"power.zone",Speed_Zone:"speed.zone"},ConditionTypes:{Calories:"calories",Distance:"distance",Heart_Rate:"heart.rate",Lap_Button:"lap.button",Iterations:"iterations",Power:"power",Time:"time",Fixed_Rest:"fixed.rest",Fixed_Repetition:"fixed.repetition",Reps:"reps"},IntensityTypes:{Active:"active",Rest:"rest",Warm_Up:"warmup",Cool_Down:"cooldown"},DurationTypes:{No_Duration:"no.duration",Calories:"calories",Distance:"distance",Lap_Button:"lap.button",Time:"time",Heart_Zone:"heart.rate.zone",Power_Zone:"power.zone",Fixed_Rest:"fixed.rest",Fixed_Repetition:"fixed.repetition",Reps:"reps"},StrokeTypes:{Any:"any_stroke",Backstroke:"backstroke",Breaststroke:"breaststroke",Drill:"drill",Fly:"fly",Free:"free",IM:"individual_medley",Mixed:"mixed"},EquipmentTypes:{No_Equipment:"no.equipment",Fins:"fins",Kickboard:"kickboard",Paddles:"paddles",Pull_Buoy:"pull_buoy",Snorkel:"snorkel"}}}),define("pages/workouts/util/PoolLengthUtil",["localizer","personalizer"],function(e,t){function o(e){var t=$.trim(String(e)).split("."),n="",r=0,i=1e-15,s,o,u,a,f,l,c,h;if(t.length===2){n=t[0],r=parseFloat("."+t[1]),h=r,c=Math.floor(h),o=1,f=0,s=c,a=1;while(h-c>i*a*a)h=1/(h-c),c=Math.floor(h),u=o,o=s,l=f,f=a,s=u+c*o,a=l+c*f;return o===1&&f===1?parseInt(n,10)+1:u===0?(n===0?"":n+" ")+o+"/"+f:(n===0?"":n+" ")+u+"/"+l}return e}function u(e){if(e){var t=/\.\d(0{4}|1{4}|2{4}|3{4}|4{4}|5{4}|6{4}|7{4}|8{4}|9{4})/;if(t.exec(e)===null){var n,r,i=String(e),s=i.split(".");s.length===2&&(n=s[0],r=s[1].substr(0,1),e=parseFloat(n+"."+r+r+r+r))}}return e}function a(e){return String(e).indexOf(".")>-1}var n=[1,2,3,4,5,6,8,10,12,16,20],r=["1/3","2/3"],i=33.3333,s=function(){};return s.prototype.getDecimalFromFraction=function(e,t){var n=0,r=0,i=0,s=$.trim(String(e)).split(" ");if(s.length===2){n=parseInt(s[0],10),r=s[1],r=r.split("/"),r.length===2?r=parseInt(r[0],10)/parseInt(r[1],10):r=+r,i=n+r;var o=String(i).indexOf(".");return o>-1?String(i).slice(0,o+5):String(i)}if(s.length===1&&s[0]&&t){r=String(+s[0]-1),r+=".99999";if(r.indexOf("99.")>-1)return r}return e},s.prototype.isValueIncrementalValid=function(e){var t="",n=!0,i=function(e){var t=e-1;return String(t).indexOf("99")>-1?!0:!1};a(e)&&(e=o(e),n=!1),e=$.trim(String(e));if(!n){t=e.split(" ");if(t.length===2)return $.inArray(t[1],r)===-1?!1:!0}return i(+e)},s.prototype.isValueDivisibleByPoolLength=function(e,t){return parseInt(e%t,10)===0?!0:!1},s.prototype.getMultiplier=function(){return n},s.prototype.getFractionalValue=function(e){return o(e)},s.prototype.getFormattedFractionalValue=function(e){var n=o(e),r="";if(typeof n=="string"){if(n.indexOf(" ")>-1){var i=n.split(" ");r=t.formatWholeNumber(parseInt(i[0]));switch(i[1]){case"1/3":r+=" &frac13;";break;case"1/2":r+=" &frac12;";break;case"2/3":r+=" &frac23;";break;default:r+=i[1]}}else r=t.formatWholeNumber(parseInt(n));return r}return t.formatWholeNumber(n)},s.prototype.getAvailablePoolLengths=function(t){function h(t,i){r=[];for(var s=0,u=n.length;s<u;s+=1){var a=t%1!==0,h=null;if(a){c=n[s],f=c*t,h="("+c+" "+(c>1?e.localize("swim.lengths"):e.localize("label.length"))+")",l=String(f).split(".");if(l&&l.length===2){var p=String(l[1]).slice(0,1);f=l[0]+"."+p+p+p+p}}else f=n[s]*t;a?r.push({displayValue:o(f),value:f,unit:i,postfixLabel:h}):r.push({displayValue:f,value:f,unit:i,postfixLabel:h})}return r}var r=[],i=e.localize("pool_length_unit_statute"),s,u=0,a=0,f=0,l="",c=0;if(t){s=t.split(" "),s&&s.length===2&&(u=s[0],a=s[1]),a==="m"&&(i=e.localize("pool_length_unit_metric"));if(u)return h(u,i)}return[]},s.prototype.getFractionalValueForDisplayWithLength=function(t,n){var r=o(t),s=parseInt(t/i);return r+" "+n+" ("+s+" "+(s>1?e.localize("swim.lengths"):e.localize("label.length"))+")"},s.prototype.getDecimalValueOfFractionFromLength=function(e){var t=e*i,n=String(t).split(".");if(n&&n.length===2){var r=String(n[1]).slice(0,1);t=n[0]+"."+r+r+r+r}return t},s.prototype.getLengthFromFractionalPoolDistance=function(e){return e?parseInt(this.getDecimalFromFraction(e,!1)/i):0},s.prototype.getLengthFromNonFractionalPoolDistance=function(e){if(e){String(e).indexOf("/")!==-1&&(e=this.getDecimalFromFraction(e));var t=e/i;t=String(t).split(".");if(t.length===2&&t[1].slice(0,1)==="0")return+t[0]}return 0},s.prototype.addPoolLengthDistance=function(e,t){var n,r=1e4,i=0;if(t){if(e===0)return t;n=String(e);if(n.indexOf(".")>-1){var s=(n.indexOf("9")>-1?e*r+1:e*r)+t*r;i=s/r}else i=e+t}else if(!t&&e)return e;return u(i)},s.prototype.multiplyPoolLengthDistance=function(e,t){var n=0;if(e&&t)if(String(e).indexOf(".")>-1){n=e;for(var r=1;r<t;r+=1)n=this.addPoolLengthDistance(n,e)}else n=e*t;return n},s}),define("pages/workouts/util/StepUtil",["underscore","backbone","localizer","personalizer","utils/date/TimeUtil","utils/Conversion","pages/workouts/util/Types","pages/workouts/util/PoolLengthUtil","models/user/ViewerUserPreferences"],function(e,t,n,r,i,s,o,u,a){var f=t.Model.extend({initialize:function(e){if(!e.sportType)throw new Error("SportType is required");this.sportType=e.sportType,this.powerZones=e.powerZones,this.heartZones=e.heartZones,this.poolLengthUtil=new u},getZone:function(e){return e>=8&&(e=7),e},getHeartRateZoneCount:function(){var e=1;return Object.keys(this.heartZones).forEach(function(t,n){t.indexOf("zone")>-1&&(e+=1)}),e},getPowerZoneCount:function(){var e=1;return Object.keys(this.powerZones).forEach(function(t,n){t.indexOf("zone")>-1&&(e+=1)}),e},isSwimSportType:function(){return this.sportType===o.SportTypes.Swimming},getStepNoteText:function(e,t){var u="workout.step.duration",f="";if(t)if(e.stepType.stepTypeKey==o.StepTypes.Interval)switch(this.sportType){case o.SportTypes.Running:f=n.localize("sport.type.running");break;case o.SportTypes.Cycling:f=n.localize("sport.type.cycling");break;case o.SportTypes.Other:f=n.localize("sport.type.other");break;case o.SportTypes.Swimming:f=n.localize("sport.type.swim");break;case o.SportTypes.Strength_Training:case o.SportTypes.Cardio:f=e.exerciseName?n.localize("exercise_type_"+e.exerciseName):n.localize("category_type_"+e.category)}else f=n.localize("workout.stepType."+e.stepType.stepTypeKey),e.stepType.stepTypeKey===o.StepTypes.Other&&(this.sportType===o.SportTypes.Strength_Training||this.sportType===o.SportTypes.Cardio)&&(f=""),this.shouldAddExerciseToStepType(e)&&(f!==""&&(f+=" - "),f+=e.exerciseName?n.localize("exercise_type_"+e.exerciseName):n.localize("category_type_"+e.category));var l=null,c=e.targetValueOne,h=e.targetValueTwo,p=e.zoneNumber;if(e.endCondition&&e.endCondition.conditionTypeKey)switch(e.endCondition.conditionTypeKey){case o.ConditionTypes.Time:var d=i.secondsToTime(parseFloat(e.endConditionValue));d.h>0&&(d.m+=d.h*60),l=i.pad2(d.m)+":"+i.pad2(d.s),l+=" "+n.localize("workout.duration.min.sec.time");break;case o.ConditionTypes.Heart_Rate:e.endConditionCompare=="lt"?u+=".power.below":u+=".power.above",l=e.endConditionValue+" "+n.localize("heart_rate_unit");break;case o.ConditionTypes.Lap_Button:u+=".lap.button";break;case o.ConditionTypes.Distance:if(this.isSwimSportType()){var v=e.preferredEndConditionUnit.unitKey==="meter"?n.localize("distance_unit_lap_swim_metric"):n.localize("distance_unit_lap_swim_statute");String(e.endConditionValue).indexOf(".")===-1?l=this.poolLengthUtil.getFractionalValue(e.endConditionValue)+" "+v:l=this.poolLengthUtil.getFractionalValueForDisplayWithLength(e.endConditionValue,v)}else{e.preferredEndConditionUnit==null&&(e.preferredEndConditionUnit={unitKey:a.getMeasurementSystem()==r.MeasurementSystems.METRIC?"kilometer":"mile"}),l=s.convertDistance(e.endConditionValue,"meter",e.preferredEndConditionUnit.unitKey),l=r.personalizeDistanceValue(l);switch(e.preferredEndConditionUnit.unitKey){case"mile":l+=" "+n.localize("distance.mile");break;case"kilometer":l+=" "+n.localize("distance.kilometer");break;case"yard":l+=" "+n.localize("distance.yard");break;case"meter":l+=" "+n.localize("distance.meter")}}break;case o.ConditionTypes.Calories:l=e.endConditionValue+" "+n.localize("label_calories");break;case o.ConditionTypes.Power:e.endConditionCompare=="lt"?u+=".power.below":u+=".power.above",l=e.endConditionValue+" "+n.localize("max_avg_power_unit");break;case o.ConditionTypes.Fixed_Rest:u+=".rest.fixed";var d=i.secondsToTime(parseFloat(e.endConditionValue));d.h>0&&(d.m+=d.h*60),l=i.pad2(d.m)+":"+i.pad2(d.s);break;case o.ConditionTypes.Fixed_Repetition:u+=".rest.fixed.repetition";var d=i.secondsToTime(parseFloat(e.endConditionValue));d.h>0&&(d.m+=d.h*60),l=i.pad2(d.m)+":"+i.pad2(d.s);break;case o.ConditionTypes.Reps:l=e.endConditionValue+" "+n.localize("label_reps")}if(e.targetType&&e.targetType.workoutTargetTypeKey)switch(e.targetType.workoutTargetTypeKey){case o.TargetTypes.Power_Zone:p!=null?u+=".with.target.power.zone":(u+=".with.target",h+=" "+n.localize("max_avg_power_unit"));break;case o.TargetTypes.Pace_Zone:u+=".with.target",c=this.personalizePace(c),h=this.personalizePace(h),a.getMeasurementSystem()==r.MeasurementSystems.METRIC?h+=" "+n.localize("pace_unit_metric"):h+=" "+n.localize("pace_unit_statute");break;case o.TargetTypes.Heart_Rate_Zone:p!=null?(u+=".with.target.heart.rate.zone",c=n.localize("workout.step.target.heart.zone.name."+p)):(u+=".with.target",h+=" "+n.localize("heart_rate_unit"));break;case o.TargetTypes.Speed_Zone:u+=".with.target",c=r.personalizeSpeed(c,"cycling",null),h=r.personalizeSpeed(h,"cycling",null),a.getMeasurementSystem()==r.MeasurementSystems.METRIC?h+=" "+n.localize("speed_unit_metric"):h+=" "+n.localize("speed_unit_statute");break;case o.TargetTypes.Cadence:u+=".with.target",c=r.personalizeCadence(c,this.sportType),h=r.personalizeCadence(h,this.sportType),this.sportType==o.SportTypes.Cycling?h+=" "+n.localize("bike_cadence_unit"):h+=" "+n.localize("run_cadence_unit");break;case o.TargetTypes.No_Target:if(e.weightUnit&&e.weightValue&&e.weightValue>0){var m=e.weightUnit.unitKey==="pound"?r.WeightUnitKeys.STATUTE:r.WeightUnitKeys.METRIC,g=r.convertWeightToGramsByUnit(e.weightValue,m);g=r.personalizeWeight(g),c=g+" "+n.localize(r.getWeightUnitKey()),h="",u+=".with.weight"}else u+=".no.target"}else u+=".no.target";e.strokeType&&e.strokeType.strokeTypeKey&&(u+=".distance.stroke",c=n.localize("workout.stoke.type."+e.strokeType.strokeTypeKey)),e.equipmentType&&e.equipmentType.equipmentTypeKey&&(e.strokeType&&e.strokeType&&e.strokeType.strokeTypeKey?(u+=".equipment",h=n.localize("workout.equipment."+e.equipmentType.equipmentTypeKey)):(u+=".distance.equipment",c=n.localize("workout.equipment."+e.equipmentType.equipmentTypeKey)));var y=null;return l!=null&&p!=null?y=n.localize(u,f,l,p,c,h):l!=null&&p==null?y=n.localize(u,f,l,c,h):c!=null&&h!=null&&p!=null?y=n.localize(u,f,p,c,h):c!=null&&h!=null&&p==null?y=n.localize(u,f,c,h):c!=null&&h==null&&p!=null?y=n.localize(u,f,p,c):c==null&&h==null&&p!=null?y=n.localize(u,f,p):y=n.localize(u,f),y},personalizePace:function(e){var t=r.convertSpeed(e);if(t==0)return 0;var n=Math.round(3600/t),i=Math.floor(n/3600),s=Math.floor((n-i*3600)/60);n=Math.floor(n-i*3600-s*60);var o=s+i*60+":"+jQuery.formatNumber(n,{format:r.NumberFormats.NO_DECIMAL_PAD_2_ZEROS});return o},getStepClass:function(e){var t=null;if(e.stepType.stepTypeKey==o.StepTypes.Interval)switch(this.sportType){case o.SportTypes.Running:t="run";break;case o.SportTypes.Cycling:t="bike";break;case o.SportTypes.Swimming:t="pool";break;case o.SportTypes.Strength_Training:t="workout"}else switch(e.stepType.stepTypeKey){case o.StepTypes.Warm_Up:t="warm";break;case o.StepTypes.Recovery:t="recover";break;case o.StepTypes.Rest:t="rest";break;case o.StepTypes.Cool_Down:t="cool";break;default:t=e.stepType.stepTypeKey}return t},shouldAddExerciseToStepType:function(e){var t=e.stepType.stepTypeKey!==o.StepTypes.Rest;return!e.exerciseName&&!e.category&&(t=!1),t},log:function(e){}});return f}),define("models/device/AgentDevice",["backbone"],function(e){var t=e.Model.extend({initialize:function(e){this.isDirty=!1,this.bind("change",this.onChange,this),this.bind("sync",this.onSync,this)},backup:function(){this.backupAttributes=_.clone(this.attributes)},restore:function(){this.backupAttributes&&(this.set(this.backupAttributes),this.isDirty=!1)},onSync:function(){this.isDirty=!1,this.backup()},onChange:function(){this.isDirty=!0}});return t}),define("collections/device/AgentDevices",["underscore","backbone","models/device/AgentDevice"],function(e,t,n){var r=t.Collection.extend({model:n,url:function(){var t="/proxy/device-service/deviceregistration/devices";return e.isUndefined(this.displayName)||(t+="/all/"+this.displayName),t},parse:function(e){return e!=null&&(r.cache=e),r.cache},fetch:function(e){var n=!0;e&&typeof e.useCache!="undefined"&&(n=e.useCache);if(r.cache==undefined||!n)return t.Collection.prototype.fetch.call(this,e);this.add(r.cache),e.success()},filter:function(e,t){if(typeof e=="function"){var n=[];for(var r=0;r<this.models.length;r++)e(this.models[r])&&n.push(this.models[r]);this.reset(n,{silent:t})}},hasDeviceWithCapability:function(e){return this.find(function(t){return t.get(e)})!==undefined},initialize:function(e,t){this.cache=null,t&&(this.displayName=t.displayName||null)}});return r}),define("utils/GCSyncUtil",["constants/device/QueueConstants"],function(e){var t={openAgent:function(e){if(e==null||typeof e=="undefined")typeof console!="undefined"&&console.log&&this.log("A device id wasn't passed into GCSyncUtil.openAgent()"),e="";this.log("calling "+Garmin.Queue.Constants.GC_SYNC_URL+"?deviceId="+e),window.location.assign(Garmin.Queue.Constants.GC_SYNC_URL+"?deviceId="+e)},log:function(e){typeof console!="undefined"&&console.log&&console.log(new Date+": "+e)},scrollToRank:function(e){var t={scrollTop:e};jQuery("body,html").animate(t)}};return t}),define("utils/AnalyticsUtil",["require","views/map/MapViewUtils"],function(e){var t=e("views/map/MapViewUtils");return{push:function(e){if(!t.userInChina()){window._ga_universal=window._ga_universal||[],window._ga_universal.push([e.event,e.category,e.action,e.label||"",e.value||""]);if(!e.event||!e.category||!e.action)throw"Invalid event, category, or action in Google Analytics push.";var n=[e.event,e.category,e.action];typeof e.label!="undefined"&&e.label!==null&&n.push(e.label),typeof e.value!="undefined"&&e.value!==null&&n.push(e.value),window._ga_universal.push(n)}}}}),define("text!templates/SendToDevice/SendToDevicePageView.html",[],function(){return'    <div class="loading-mask" style="display: none;">\n        <div class="open-express">\n            <h3 class="bottom-m"><%= Localizer.localize(\'agent.connecting\') %></h3>\n            <p><%= Localizer.localize(\'agent.wait\') %></p>\n        </div>\n        <div class="still-waiting text-left alert alert-info bottom-none" style="display: none;">\n            <p><%= Localizer.localize(\'send.to.device.message\') %></p>\n            <p><%~ Localizer.localize(\'send.to.device.message2\') %></p>\n        </div>\n    </div>\n\n    <div class="message message-error margin-small-all queue-error" style="display: none">\n        <p><%= Localizer.localize(\'queue.error\') %></p>\n    </div>\n\n    <% if (hasDevices) { %>\n        <div id="send-body">\n            <span class="header-content-placeholder"></span>\n            <span class="additional-content-placeholder"></span>\n\n            <% if (devices && devices.length > 0) { %>\n            <select class="bottom-l select selected-device">\n                <% for (var i = 0; i < devices.length; i++) { %>\n                <option value="<%= devices[i].get(\'deviceId\') %>"><%= devices[i].get(\'displayName\') %></option>\n                <% }; %>\n            </select>\n            <p><a href="#" class="btn btn-large device-selected"><%= Localizer.localize(\'queue.send.now\') %></a></p>\n            <% } else { %>\n            <div><%= Localizer.localize(\'no.devices.found\') %></div>\n            <% } %>\n\n\n            <div class="need-help">\n                <a href="#" class="colored need-help-link open-help"><%= Localizer.localize(\'agent.need.help\') %></a>\n                <a href="#" class="colored close-help" style="display: none;"><%= Localizer.localize(\'agent.close.help\') %></a>\n            </div>\n            <div class="send-help text-left" style="display: none;">\n                <h4><%= Localizer.localize(\'agent.help.title\') %></h4>\n                <p><%= Localizer.localize(\'agent.help.reason\') %></p>\n                <ul>\n                    <li><%= Localizer.localize(\'device.not.supported\') %></li>\n                    <li><%= Localizer.localize(\'device.not.setup\') %></li>\n                </ul>\n                <p><%~ Localizer.localize(\'agent.download.info\') %></p>\n                <hr>\n                <h4><%= Localizer.localize(\'agent.help.title2\') %></h4>\n                <p><%= Localizer.localize(\'device.send.course.title\') %></p>\n                <ul>\n                    <li><%= Localizer.localize(\'device.send.course.info\') %></li>\n                    <li><%= Localizer.localize(\'device.send.course.info2\') %></li>\n                    <li><%= Localizer.localize(\'device.send.course.info3\') %></li>\n                </ul>\n\n            </div>\n        </div>\n\n    <% } else { %>\n\n    <div id="download-body">\n        <p><%= Localizer.localize(\'agent.additional.info\') %></p>\n        <div class="text-center">\n            <p><a href="/modern/activity-sync" class="btn btn-large"><%= Localizer.localize(\'agent.download\') %></a></p>\n        </div>\n        <div class="text-center get-started-overview top-m">\n            <div class="get-started-item">\n                <div class="get-started-img download"></div>\n                <span><%= Localizer.localize(\'agent.download.install\') %></span>\n            </div>\n            <div class="get-started-item">\n                <div class="get-started-img plug-in"></div>\n                <span><%= Localizer.localize(\'agent.plugin\') %></span>\n            </div>\n            <div class="get-started-item">\n                <div class="get-started-img link-device"></div>\n                <span><%= Localizer.localize(\'agent.link.device\') %></span>\n            </div>\n            <div class="get-started-item">\n                <div class="get-started-img connect"></div>\n                <span><%= Localizer.localize(\'gc\') %></span>\n            </div>\n        </div>\n    </div>\n    <% }  %>\n\n'}),define("views/SendToDevice/SendToDevicePageView",["backbone","models/user/UserPreferences","utils/ModelSynchronizer","utils/GCSyncUtil","utils/date/DateParser","utils/date/DateUtil","utils/AnalyticsUtil","models/device/QueueNotification","collections/device/QueueNotifications","utils/LocaleMapper","localizer","constants/device/QueueConstants","text!templates/SendToDevice/SendToDevicePageView.html","views/map/MapViewUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={WORKOUT_CAPABLE:"workoutCapable",RUNNING_WORKOUT_CAPABLE:"runningWorkoutCapable",CYCLING_WORKOUT_CAPABLE:"cyclingWorkoutCapable",SWIM_WORKOUT_CAPABLE:"swimWorkoutCapable",CUSTOM_WORKOUT_CAPABLE:"customWorkoutCapable",STRENGTH_TRAINING_WORKOUT_CAPABLE:"strengthWorkoutCapable",CARDIO_TRAINING_WORKOUT_CAPABLE:"cardioCapable"},v={RENDERED:"RENDERED",ON_CLOSE:"ON_CLOSE",NOTIFICATIONS_SENT:"NOTIFICATIONS_SENT"},m=e.View.extend({events:{"click .btn.device-selected":"onSendToDeviceClicked","click .need-help":"onNeedHelpClicked","click .close-help ":"onHideHelpClicked"},initialize:function(e){this.contentLoaded=!1,this.queueNotifications=new a,this.userLocale=e.userLocale,this.displayName=e.displayName,this.template=_.template(h),this.collection.bind("change",this.render,this),this.collection.bind("error",this.defaultErrorHandler,this),this.additionalWorkoutFilter=e.additionalWorkoutFilter||null,this.titleView=e.titleView,this.detailView=e.detailView;var t=this;this.queueNotifications.bind("sendAll",function(e){this.queueNotifications.reset(),e.success?(this.trigger(v.NOTIFICATIONS_SENT,e),typeof e.extra=="undefined"&&(e.extra.wifiSetup=!1,e.extra.deviceName="",typeof e.extra.openExpress=="undefined"&&(e.extra.openExpress=!0),typeof e.extra.poll=="undefined"&&(this.extra.poll=!0)),jQuery(Garmin.Queue.NotificationWidgetQueueIds.QUEUE_NOTIFICATION).trigger(Garmin.Queue.Events.SEND_TO_DEVICE_FROM_QUEUE,{messageType:t.messageType,wifiSetup:e.extra.wifiSetup,name:e.extra.deviceName,deviceId:e.extra.deviceId}),jQuery(Garmin.Queue.NotificationWidgetQueueIds.QUEUE_NOTIFICATION).trigger(Garmin.Queue.Events.MESSAGE_SENT,{messageCount:e.numberSent}),this.$(".btn.device-selected").attr({disabled:!1}),e.extra.openExpress==1&&r.openAgent(e.extra.deviceId)):(console.log("xHR:",e.xHR),this.$(".btn.device-selected").attr({disabled:!0}),this.$(".queue-error").show())},this),this.propertiesPath="/main/js/properties/send_to_device/",this.propertiesFile="send_to_device",this.messageType=e.messageType,this.id=e.id,this.messageName=e.messageName,this.initLanguageHash(),this.initUrlHash()},defaultErrorHandler:function(e,t){this.$(".btn.device-selected").attr({disabled:!0}),this.$(".queue-error").show()},initUrlHash:function(){this.urlHash={},this.urlHash[Garmin.Queue.MessageTypes.COURSES.id]="course-service/course/{0}/",this.urlHash[Garmin.Queue.MessageTypes.WORKOUTS.id]="workout-service/workout/{0}/",this.urlHash[Garmin.Queue.MessageTypes.ACTIVITIES.id]="course-service/course/copyFromActivity/{0}/",this.urlHash[Garmin.Queue.MessageTypes.PR.id]="personalrecord-service/personalrecord/FIT/",this.urlHash[Garmin.Queue.MessageTypes.SCHEDULES.id]="workout-service/schedule/export/{0}",this.urlHash[Garmin.Queue.MessageTypes.PROFILE.id]="user-service-1.0/tcx/user/",this.urlHash[Garmin.Queue.MessageTypes.SETTINGS.id]="user-service-1.0/fit/user/",this.urlHash[Garmin.Queue.MessageTypes.SPORTS.id]=["user-service-1.0/fit/sportSettings/other","user-service-1.0/fit/sportSettings/running","user-service-1.0/fit/sportSettings/cycling"],this.urlHash[Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS.id]=["http://garmindeveloper.com/download/rgn/ldr_{0}.rgn","http://garmindeveloper.com/download/udr/Updates_{0}.udr"],this.urlHash[Garmin.Queue.MessageTypes.DEVICE_SETTINGS.id]="",this.urlHash[Garmin.Queue.MessageTypes.SEGMENT_LEADERS.id]="course-service/leaderboard/fit/"},initLanguageHash:function(){this.languageHash={},this.languageHash.hr="CROATIAN",this.languageHash.cs="CZECH",this.languageHash.el="GREEK",this.languageHash.hu="HUNGARIAN",this.languageHash.pl="POLISH",this.languageHash.pt="PORTUGUESE",this.languageHash.ru="RUSSIAN",this.languageHash.sk="SLOVAKIAN",this.languageHash.sl="SLOVENIAN"},setTrainingPlanModel:function(e){this.calendarTrainingPlans=e,window.SEND_TO_DEVICE_TITLE=l.localize("send.to.device.workouts",this.calendarTrainingPlans.count)},render:function(){var e=this.messageType,t=_.filter(this.collection.models,function(t){return e["id"]==Garmin.Queue.MessageTypes.COURSES["id"]||e["id"]==Garmin.Queue.MessageTypes.ACTIVITIES["id"]?p.userInChina()?t.get("courseCapable")&&t.get("gcj02CourseCapable"):t.get("courseCapable"):e["id"]==Garmin.Queue.MessageTypes.SCHEDULES["id"]?t.get("workoutCapable"):e["id"]==Garmin.Queue.MessageTypes.WORKOUTS["id"]?this.additionalWorkoutFilter==null?t.get(d.WORKOUT_CAPABLE):t.get(this.additionalWorkoutFilter)&&t.get(d.WORKOUT_CAPABLE):e["id"]==Garmin.Queue.MessageTypes.PR["id"]?t.get("personalRecordCapable"):e["id"]==Garmin.Queue.MessageTypes.GOALS["id"]?t.get("goalCapable"):e["id"]==Garmin.Queue.MessageTypes.SETTINGS["id"]||e["id"]==Garmin.Queue.MessageTypes.PROFILE["id"]?t.get("settingCapable")||t.get("userProfileCapable"):e["id"]==Garmin.Queue.MessageTypes.ZONES["id"]?t.get("hrZoneCapable"):e["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]?t.get("languageSettingCapable"):e["id"]==Garmin.Queue.MessageTypes.DEVICE_SETTINGS["id"]?t.get("deviceSettingCapable"):e["id"]==Garmin.Queue.MessageTypes.SEGMENT_LEADERS["id"]?t.get("segmentCapable")||t.get("runningSegmentCapable"):t},this),n=typeof window.SEND_TO_DEVICE_TITLE=="undefined"?"":window.SEND_TO_DEVICE_TITLE,r=this.getSendToDeviceTitle(n),i=this.template({devices:t,hasDevices:this.hasDevices,sendToDeviceTitle:r,Localizer:l});this.$el.html(i),this.titleView?this.$(".header-content-placeholder").replaceWith(this.titleView.render().el):this.$(".header-content-placeholder").replaceWith('<h3 class="bottom-m">'+r+"</h3>"),this.detailView?this.$(".additional-content-placeholder").replaceWith(this.detailView.render().el):this.$(".additional-content-placeholder").remove(),this.hasDevices==0?(this.$("#download-body").show(),this.$("#send-body").hide()):(this.$("#download-body").hide(),this.$("#send-body").show()),f.formatHelpStartForExpressionEngine(this.userLocale),this.fetched=!1,this.$(".queue-error").hide(),this.$(".btn.device-selected").attr({disabled:!1}),this.trigger(v.RENDERED)},getSendToDeviceTitle:function(e){var t="send.to.device.title2";return this.messageType["id"]==Garmin.Queue.MessageTypes.COURSES["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.ACTIVITIES["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.WORKOUTS["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]?t="send.to.device.title":this.messageType["id"]==Garmin.Queue.MessageTypes.GOALS["id"]?t="send.to.device.goals":this.messageType["id"]==Garmin.Queue.MessageTypes.PR["id"]?t="send.to.device.pr":this.messageType["id"]==Garmin.Queue.MessageTypes.SETTINGS["id"]?this.messageType["name"]==Garmin.Queue.MessageTypes.ZONES["name"]?t="send.to.device.zones":t="send.to.device.personal":this.messageType["id"]==Garmin.Queue.MessageTypes.ZONES["id"]?t="send.to.device.zones":this.messageType["id"]==Garmin.Queue.MessageTypes.SEGMENT_LEADERS["id"]&&(t="send.to.device.segment"),l.localize(t,e)},getExportTypeByMessageType:function(e){var t=null;return this.messageType["id"]==Garmin.Queue.MessageTypes.SCHEDULES["id"]?t=e.get("workoutFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]?t=e.get("languageSettingFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.ACTIVITIES["id"]?t=e.get("courseFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.COURSES["id"]?t=e.get("courseFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.DEVICE_SETTINGS["id"]?t=e.get("deviceSettingFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.GOALS["id"]?t="TCX":this.messageType["id"]==Garmin.Queue.MessageTypes.PR["id"]?t=e.get("personalRecordFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.SETTINGS["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.ZONES["id"]?e.get("settingCapable")?t="FIT":e.get("userProfileCapable")&&(t="TCX"):this.messageType["id"]==Garmin.Queue.MessageTypes.WORKOUTS["id"]?t=e.get("workoutFileType"):this.messageType["id"]==Garmin.Queue.MessageTypes.SEGMENT_LEADERS["id"]&&(t="FIT"),t},onNeedHelpClicked:function(e){e.preventDefault(),e.stopPropagation(),this.$(".need-help-link").hide(),this.$(".send-help").show(),this.$(".close-help").show()},onHideHelpClicked:function(e){e.preventDefault(),e.stopPropagation(),this.$(".send-help").hide(),this.$(".need-help-link").show(),this.$(".close-help").hide()},onSendToDeviceClicked:function(e){this.$(".queue-error").hide(),e.preventDefault(),e.stopPropagation();var t=this.$(".btn.device-selected");if(t.attr("disabled")==0||!t.attr("disabled")){this.enableSendButton(t,!1),this.wifiSetup=!1,this.deviceName=this.$("select.selected-device option:selected")[0].text;var n=null,r=this.$("select.selected-device").val(),i=this,o=null;for(var u=0;u<this.collection.models.length;u++)if(this.collection.models[u].attributes.deviceId==r){o=this.collection.models[u],this.wifiSetup=o.get("wifiSetup"),n=this.getExportTypeByMessageType(o);break}n==null&&(console.log("Could not get export file type for messageType: ",this.messageType),n="FIT");if(n=="TCX"&&(this.messageType["id"]==Garmin.Queue.MessageTypes.SCHEDULES["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.WORKOUTS["id"])){var a=l.localize("sendToDevice.confirmation.powerWorkout1")+"\n\n"+l.localize("sendToDevice.confirmation.powerWorkout2")+"\n\n"+l.localize("sendToDevice.confirmation.powerWorkout3")+"\n\n"+l.localize("sendToDevice.confirmation.powerWorkout4")+"\n\n"+l.localize("sendToDevice.confirmation.powerWorkout5")+"\n\n"+l.localize("sendToDevice.confirmation.powerWorkout6")+"\n\n",f=confirm(a);if(!f){this.messageType["id"]==Garmin.Queue.MessageTypes.SCHEDULES["id"]&&this.trigger(Garmin.Queue.Events.RETURN_TO_TRAINING_PLAN),this.enableSendButton(t,!0);return}}var c=[],h=null,p={wifiSetup:this.wifiSetup,deviceName:this.deviceName,openExpress:!0,deviceId:r};if(this.messageType["id"]==Garmin.Queue.MessageTypes.SCHEDULES["id"]){var d=this.urlHash[this.messageType.id];d=d.replace("{0}",n.toUpperCase()),d+="?startDate="+s.toISODateString(new Date)+"&includeTP="+o.get("trainingPlanCapable"),c.push(d);if(n=="FIT"){this.createMessagesFromTrainingPlanData(r,o,d),this.queueNotifications.sendAll(p),this.enableSendButton(t,!1);return}this.messageName=l.localize("queue.calendar.workouts.tcx",this.calendarTrainingPlans.count,this.calendarTrainingPlans.startDate,this.calendarTrainingPlans.endDate)}else if(this.messageType["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]){var v=jQuery("#languageComboSelect").val();n=i.getLanguage(v),this.messageName=n,h=l.localize("send.to.device.language.title",n)}else{if(this.messageType["id"]==Garmin.Queue.MessageTypes.ACTIVITIES["id"]){this.addActivityToDevice(this.id,this.messageName,n,r),this.queueNotifications.sendAll(p),this.enableSendButton(t,!0);return}if(this.messageType["id"]!=Garmin.Queue.MessageTypes.WORKOUTS["id"]){if(this.messageType["id"]==Garmin.Queue.MessageTypes.COURSES["id"]){this.addCourseToDevice(this.id,this.messageName,n,r),this.queueNotifications.sendAll(p),this.enableSendButton(t,!0);return}if(this.messageType["id"]==Garmin.Queue.MessageTypes.SETTINGS["id"]){this.addPersonalInfoAndSportsToDevice(r,n,o),this.queueNotifications.sendAll(p),this.enableSendButton(t,!0);return}if(this.messageType["id"]==Garmin.Queue.MessageTypes.SEGMENT_LEADERS["id"]){this.addSegmentToDevice(this.id,this.messageName,n,r),this.queueNotifications.sendAll(p),this.enableSendButton(t,!0);return}}}c.length==0&&(c=c.concat(this.urlHash[this.messageType.id]));var m=null;for(var u=0;u<c.length;u++){var g=null;this.messageType["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]?g=c[u].replace("{0}",n):g=c[u].replace("{0}",this.getFormattedExportType(n)),this.id!="undefined"&&this.id!=null&&(g+=this.id),this.messageType["id"]==Garmin.Queue.MessageTypes.LANGUAGE_SETTINGS["id"]&&(m=g.substring(g.lastIndexOf(".")+1)),this.addMessageToQueue(r,g,this.messageType.type,this.messageName,h,u+1,m==null?n:m,this.id=="undefined"||this.id==null||this.id==""?null:this.id)}this.queueNotifications.sendAll(p),(this.messageType["id"]==Garmin.Queue.MessageTypes.PR["id"]||this.messageType["id"]==Garmin.Queue.MessageTypes.WORKOUTS["id"])&&this.pushSendToDeviceAnalyticsEvents(this.messageType.name)}},pushSendToDeviceAnalyticsEvents:function(e){o.push({event:"track_event",category:"Personal Records Page Events",action:"Send "+e+" To Device"})},getFormattedExportType:function(e){return this.messageType==Garmin.Queue.MessageTypes.WORKOUTS?e.toUpperCase():e.toLowerCase()},addCourseToDevice:function(e,t,n,r){var i=this.urlHash[this.messageType.id]+e+"/"+r+"?elevation=true",s=i.replace("{0}",n.toLowerCase());this.addMessageToQueue(r,s,this.messageType.type,t,null,0,n,e)},addActivityToDevice:function(e,t,n,r){var i=this.urlHash[this.messageType.id]+e+"/"+r+"?elevation=true",s=i.replace("{0}",n.toLowerCase());this.addMessageToQueue(r,s,this.messageType.type,t,null,0,n,e)},addPersonalInfoAndSportsToDevice:function(e,t,n){this.addMessageToQueue(e,this.urlHash[t=="FIT"?Garmin.Queue.MessageTypes.SETTINGS.id:Garmin.Queue.MessageTypes.PROFILE.id],t=="FIT"?Garmin.Queue.MessageTypes.SETTINGS.type:Garmin.Queue.MessageTypes.PROFILE.type,t=="FIT"?l.localize("queue.personal.information"):l.localize("queue.personalInf.training.zones"),null,1,t,null);if(t=="FIT"&&n.get("sportCapable"))for(var r=0;r<this.urlHash[Garmin.Queue.MessageTypes.SPORTS.id].length;r++){if(this.urlHash[Garmin.Queue.MessageTypes.SPORTS.id][r].indexOf("cycling")>-1&&n.get("powerZonesCapable")==0)continue;this.addMessageToQueue(e,this.urlHash[Garmin.Queue.MessageTypes.SPORTS.id][r],Garmin.Queue.MessageTypes.SPORTS.type,"SPORTS",null,r+2,t,null)}},addSegmentToDevice:function(e,t,n,r){var i=this.urlHash[this.messageType.id]+e,s=i.replace("{0}",n.toLowerCase());this.addMessageToQueue(r,s,this.messageType.type,t,"Segments",0,n,null)},enableSendButton:function(e,t){t?e.attr({disabled:!1}):(e.attr({disabled:!0}),this.$("#send-body").hide(),this.$(".loading-mask").show(),this.$(".still-waiting").show())},getLanguage:function(e){var t=this.languageHash[e];if(typeof t=="undefined")throw new Error("Language not found in URL path pairs. Check that the parameter is being passed in or see SendToDevicePageView.js");return t},createMessagesFromTrainingPlanData:function(e,t,n){var r=null,i=this.urlHash[Garmin.Queue.MessageTypes.WORKOUTS.id];i=i.replace("{0}","FIT");var s="",o="workouts";for(var u=0;u<this.calendarTrainingPlans.models.length;u++){t.get("scheduleCapable")&&u==0&&this.addMessageToQueue(e,n,this.messageType.type,"Schedule","",1,"FIT",null);for(var a=0;a<this.calendarTrainingPlans.models[u].length;a++)this.calendarTrainingPlans.models[u][a].attributes.nameChanged==1?r=this.calendarTrainingPlans.models[u][a].attributes.newName:r=this.calendarTrainingPlans.models[u][a].attributes.workout.workoutName,s=this.calendarTrainingPlans.models[u][a].attributes.groupName,this.addMessageToQueue(e,i+this.calendarTrainingPlans.models[u][a].attributes.workout.workoutId,o,r,s,this.calendarTrainingPlans.models[u][a].attributes.priority,"FIT",this.calendarTrainingPlans.models[u][a].attributes.workout.workoutId)}},addMessageToQueue:function(e,t,n,r,i,s,o,a){var f=new u({deviceId:e,messageUrl:t,messageType:n,messageName:r,groupName:i,priority:s,fileType:o,metaDataId:a});this.queueNotifications.add(f)},loadContent:function(){if(!this.contentLoaded){this.userPreferences=new t({displayName:this.viewerDisplayName,propertiesPath:this.propertiesPath,propertiesFile:this.propertiesFile});var e=new n;e.addModel({model:this.userPreferences,required:!0}),e.addModel({model:this.collection,required:!0}),e.bind(n.Events.SYNCHRONIZED,this.onModelsFetched,this),e.bind(n.Events.SYNCHRONIZE_FAILED,this.onModelsFailed,this),e.fetchModels()}else this.render()},onModelsFetched:function(){this.contentLoaded=!0,this.hasDevices=this.collection.length>0,this.render()},onModelsFailed:function(e){},close:function(){this.remove(),this.trigger(v.ON_CLOSE)}});return m.Events=v,m.DEVICE_CAPABILITIES=d,m}),define("utils/CalendarUtil",["require","localizer","utils/date/DateUtil","models/calendar/UserCalendarPreferences","collections/device/AgentDevices","views/SendToDevice/SendToDevicePageView","models/user/ViewerUserPreferences","views/main/Modal/ModalPopupView"],function(e){var t=e("localizer"),n=e("utils/date/DateUtil"),r=e("models/calendar/UserCalendarPreferences"),i=e("collections/device/AgentDevices"),s=e("views/SendToDevice/SendToDevicePageView"),o=e("models/user/ViewerUserPreferences"),u=e("views/main/Modal/ModalPopupView"),a={event:1,goal:2,tp:3,trainingPlan:3,"trainingPlan-workout":4,workout:5,activity:6},f={getCalendarDayClass:function(e){return e>6&&(e-=7),e==(new Date).getDay()?"current-day":""},getDayItems:function(e,t){return e==null?null:e.getItemForDate(n.toISODateString(t))},getIncludedItems:function(e){return e==null||e.length==0?null:_.chain(e).filter(function(e){return e.get("itemType")!="note"&&e.get("itemType")!="weight"}).sortBy(function(e){return e.get("itemType")=="workout"&&e.get("trainingPlanId")?a["trainingPlan-workout"]:a[e.get("itemType")]}).value()},localizeDay:function(e,n){var r=new Date;return e>6&&(e-=7),e==r.getDay()&&n.getDate()==r.getDate()&&n.getMonth()==r.getMonth()&&n.getFullYear()==r.getFullYear()?t.localize("today"):t.localize("day."+e+".short")},localizeDayFromDate:function(e){var n=new Date,r=e.getDay();r>6&&(r-=7);if(e.getFullYear()==n.getFullYear()&&e.getMonth()==n.getMonth()&&e.getDate()==n.getDate())return t.localize("today");var i=Math.round((e.getTime()-n.getTime())/864e5);return i>5?t.localize("day."+r+".short")+"<br>"+t.formatDate(e,"MMM dd"):t.localize("day."+r+".short")},getItems:function(e){return e==null||e.length==0?null:_.chain(e).filter(function(e){return e.get("itemType")!="note"&&e.get("itemType")!="weight"}).sortBy(function(e){return e.get("itemType")=="workout"&&e.get("trainingPlanId")?a["trainingPlan-workout"]:a[e.get("itemType")]}).value()},getDateRelClass:function(e,t){var r=new Date,i="";return t==1&&(i+=" outside-current-date"),e<r&&(e.getFullYear()==r.getFullYear()&&e.getMonth()==r.getMonth()&&e.getDate()==r.getDate()?i+=" current-day":i+=" before-today"),i+=" day-"+n.toISODateString(e),i},getItemVisibility:function(e,t,n,r){if(r)return!0;if(e!=null)switch(e.get("itemType")){case"activity":var i=e.get("activityTypeId"),s=e.get("isParent")?!0:!1,o=e.get("parentId")&&e.get("parentId")>0?!0:!1,u=t.findByTypeId(i),a=typeof u=="undefined"?"multi_sport":u.get("typeKey"),f=typeof u=="undefined"?null:u.get("parentTypeId"),l=null;if(f){var c=t.findByTypeId(f);l=c.get("typeKey")}var h=_.find(n.activityTypes,function(e){return e.key==a||l&&e.key==l});if(s||o){var p=_.find(n.activityTypes,function(e){return e.key=="multi_sport"}),d=!1;return p&&(d=p.show),d?s?!0:!1:s?!1:h&&h.show?!0:!1}return h&&h.show?!0:!1;case"goal":return n.showGoal?!0:!1;case"workout":if(e.get("trainingPlanId")!=null&&e.get("trainingPlanId")!=0){var v=_.find(n.trainingPlans,function(t){return t.id==e.get("trainingPlanId")});return v!=null&&v.show?!0:!1}return n.showWorkout?!0:!1;case"event":if(r)return!0;if(e.get("groupId")){var m=_.find(n.groups,function(t){return t.id==e.get("groupId")});return m==null||m.show?!0:!1}return n.showEvent?!0:!1;case"trainingPlan":var v=_.find(n.trainingPlans,function(t){return t.id==e.get("trainingPlanId")});return v!=null&&v.show?!0:!1}return!0},getItemColor:function(e,t,n,i){var s="";if(e!=null)switch(e.get("itemType")){case"activity":var o=e.get("activityTypeId"),u=t.findByTypeId(o),a=typeof u=="undefined"?"multi_sport":u.get("typeKey"),f=typeof u=="undefined"?null:u.get("parentTypeId"),l=null;if(f){var c=t.findByTypeId(f);l=c.get("typeKey")}var h=_.find(n.activityTypes,function(e){return e.key==a||l&&e.key==l});return r.colors[h.color];case"goal":return r.colors[n.goalColor];case"workout":if(e.get("trainingPlanId")!=null&&e.get("trainingPlanId")!=0){var p=_.find(n.trainingPlans,function(t){return t.id==e.get("trainingPlanId")});return r.colors[p.color]}return r.colors[n.workoutColor];case"event":if(i)return!0;if(e.get("groupId")){var d=_.find(n.groups,function(t){return t.id==e.get("groupId")});return r.colors[d.color]}return r.colors[n.eventColor];case"trainingPlan":var p=_.find(n.trainingPlans,function(t){return t.id==e.get("trainingPlanId")});return r.colors[p.color]}return s},sendCalendarWorkoutsToDevice:function(e){var t=new i([]),n=new s({collection:t,model:t,messageName:"",messageType:Garmin.Queue.MessageTypes.SCHEDULES,id:"",displayName:o.get("displayName"),userLocale:o.get("preferredLocale")});return n.setTrainingPlanModel(e),n.loadContent(),n},showSendCalendarWorkoutsToDeviceModal:function(e){var n=new u({view:e,customBodyClasses:"text-center",showFooter:!1,modalTitle:t.localize("queue.send.to.device")});n.render()}};return f}),define("models/office_integration/Office365LoginURL",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return this.url},initialize:function(e){this.url="/proxy/calendar-service/calendarSync/office365/loginurl/web"}});return n}),define("models/office_integration/Office365TokenExchange",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return this.url},initialize:function(e){this.url="proxy/calendar-service/calendarSync/office365/connect/web"}});return n}),define("models/office_integration/Office365ConnectionStatus",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return this.url},initialize:function(e){this.url="/proxy/calendar-service/calendarSync/office365/status"}});return n}),define("models/office_integration/Office365SharingSettings",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return this.url},initialize:function(e){this.url="/proxy/calendar-service/calendarSync/office365/setting"}});return n}),define("models/office_integration/Office365Disconnect",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return this.url},initialize:function(e){this.url="/proxy/calendar-service/calendarSync/office365/disconnect"},isNew:function(){return!1}});return n}),define("text!utils/office365/SharingManagerModal.html",[],function(){return'<% if (firstConnect) { %>\n	<div class="alert alert-success">\n		<%= Localizer.localize(\'office_account_connected\') %>\n	</div>\n<% } %>\n\n<p><%= Localizer.localize(\'office_manage_sharing\') %></p>\n\n<div class="row">\n	<!-- OPTION 1 -->\n	<div class="span12 experience-container">\n		<div class="experience-type-identifier">\n			<label for="button-experience-activities">\n				<div class="icon-container">\n					<i class="icon-activities"></i>\n				</div>\n			</label>\n		</div>\n		<div class="experience-type-body">\n			<label for="button-experience-activities">\n				<h5><%= Localizer.localize(\'office_activities\') %></h5>\n			</label>\n		</div>\n		<div class="connect-checkbox pull-right">\n		  <input type="checkbox" value="None" id="button-experience-activities" name="check" <% if (sharingOptions.pushActivity) { %> checked="" <% } %> data-option="pushActivity">\n		  <label for="button-experience-activities"></label>\n		</div>\n	</div>\n\n	<!-- OPTION 2 -->\n	<div class="span12 experience-container">\n		<div class="experience-type-identifier">\n			<label for="button-experience-events">\n				<div class="icon-container">\n					<i class="icon-race"></i>\n				</div>\n			</label>\n		</div>\n		<div class="experience-type-body">\n			<label for="button-experience-events">\n				<h5><%= Localizer.localize(\'office_events\') %></h5>\n			</label>\n		</div>\n		<div class="connect-checkbox pull-right">\n		  <input class="connect-checkbox-input" type="checkbox" value="None" id="button-experience-events" name="check" <% if (sharingOptions.pushEvent) { %> checked="" <% } %> data-option="pushEvent">\n		  <label for="button-experience-events"></label>\n		</div>\n	</div>\n\n	<!-- OPTION 3 -->\n	<div class="span12 experience-container">\n		<div class="experience-type-identifier">\n			<label for="button-experience-workouts">\n				<div class="icon-container">\n					<i class="icon-workouts"></i>\n				</div>\n			</label>\n		</div>\n		<div class="experience-type-body">\n			<label for="button-experience-workouts">\n				<h5><%= Localizer.localize(\'office_workouts\') %></h5>\n			</label>\n		</div>\n\n		<div class="connect-checkbox pull-right">\n		  <input type="checkbox" value="None" id="button-experience-workouts" name="check" <% if (sharingOptions.pushWorkout) { %> checked="" <% } %> data-option="pushWorkout">\n		  <label for="button-experience-workouts"></label>\n		</div>\n	</div>\n</div>'}),define("utils/office365/SharingManagerModal",["require","underscore","backbone","localizer","utils/extensions/Loadable","utils/ModelSynchronizer","models/office_integration/Office365ConnectionStatus","text!utils/office365/SharingManagerModal.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/extensions/Loadable"),s=e("utils/ModelSynchronizer"),o=e("models/office_integration/Office365ConnectionStatus"),u=e("text!utils/office365/SharingManagerModal.html"),a={CAN_SAVE:"CAN_SAVE"},f=n.View.extend(i),l=f.extend({events:{"click .experience-container":"onOptionClick"},initialize:function(e){this.canSave=!0,this.firstConnect=e.firstConnect,this.template=t.template(u),this.office365ConnectionStatus=new o},provideDependencies:function(e,t){e.addModel({model:this.office365ConnectionStatus,required:!0})},onDependenciesLoaded:function(){this.sharingOptions={pushActivity:this.office365ConnectionStatus.get("pushActivity"),pushEvent:this.office365ConnectionStatus.get("pushEvent"),pushWorkout:this.office365ConnectionStatus.get("pushWorkout")},this.displayModalContent()},displayModalContent:function(){this.$el.html(this.template({Localizer:r,firstConnect:this.firstConnect,sharingOptions:this.sharingOptions}))},onOptionClick:function(e){e.stopPropagation();var t=$(e.currentTarget).find("input");this.sharingOptions[t.data("option")]=t.is(":checked"),this.sharingOptions.pushActivity||this.sharingOptions.pushEvent||this.sharingOptions.pushWorkout?this.canSave||(this.canSave=!0,this.trigger(a.CAN_SAVE,!0)):(this.canSave=!1,this.trigger(a.CAN_SAVE,!1))}});return l.Events=a,l}),define("text!utils/office365/MenuItems.html",[],function(){return'<ul class="js_custom_dropdown_opt" style="list-style-type: none;">\n	<li class="h-divider">------</li>\n	<% if (connected) { %>\n		<li>\n			<a href="#" class="disconnect-office-365 js_disconnect_office"><%= Localizer.localize(\'office_disconnect\') %></a>\n		</li>\n\n		<li>\n			<a href="#" class="manage-sharing-options js_manage_office"><%= Localizer.localize(\'office_sharing_options\') %></a>\n		</li>\n	<% } else { %>\n		<li>\n			<a href="#" class="connect-third-party-sharing js_connect_office"><%= Localizer.localize(\'office_connect\') %></a>\n		</li>\n	<% } %>\n</ul>'}),define("utils/Office365Auth",["require","underscore","backbone","localizer","utils/ModelSynchronizer","views/main/Modal/ModalPopupView","models/office_integration/Office365LoginURL","models/office_integration/Office365TokenExchange","models/office_integration/Office365ConnectionStatus","models/office_integration/Office365SharingSettings","models/office_integration/Office365Disconnect","utils/office365/SharingManagerModal","text!utils/office365/MenuItems.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("utils/ModelSynchronizer"),s=e("views/main/Modal/ModalPopupView"),o=e("models/office_integration/Office365LoginURL"),u=e("models/office_integration/Office365TokenExchange"),a=e("models/office_integration/Office365ConnectionStatus"),f=e("models/office_integration/Office365SharingSettings"),l=e("models/office_integration/Office365Disconnect"),c=e("utils/office365/SharingManagerModal"),h=e("text!utils/office365/MenuItems.html"),p={MESSAGE:"MESSAGE",DISCONNECTED:"DISCONNECTED",READY:"READY"},d="/main/js/properties/calendar/calendar",v="",m=!1,g={connect:{0:"office_account_connected"},disconnect:{0:"office_account_no_longer_connected"},manage:{0:"office_changes_saved"},errors:{1:"office_calendar_feature_not_supported",2:"office_cannot_connect_account",3:"office_cannot_save_changes_due_to_error",4:"office_cannot_connect_account",5:"office_cannot_connect_account",6:"office_accunt_already_associated"}},y=n.View.extend({initialize:function(e){this.args=e,r.loadPropertyFile(d,this.onPropertyFileLoaded,this)},onPropertyFileLoaded:function(){this.menuItems=t.template(h),this.getLoginURL(),this.args&&this.args.code?(this.code=this.args.code,this.proccessCode(),this.removeURLQueryString()):this.isCalendarConnected()},getLoginURL:function(){var e=new o;e.fetch({complete:function(e){if(e.status!==200||!e.responseText)throw"No URL provided";v=e.responseText}})},isCalendarConnected:function(){var e=this;this.status=new a,this.status.fetch({success:function(t){m=t.get("connected"),m&&t.get("returnError").code&&e.displayMessage("connect",t.get("returnError").code),e.trigger(p.READY,t)}})},connect:function(){window.location.href=v},disconnect:function(){var e=this;this.office365Disconnect=new l,this.office365Disconnect.destroy({success:function(t,n){e.displayMessage("disconnect",n.returnError.code),e.trigger(p.DISCONNECTED),m=!1},error:function(t){e.displayMessage("disconnect",3)}})},manage:function(){this.showManageOfficeModal()},proccessCode:function(){var e=this.code.split("code=")[1]&&this.code.split("code=")[1].split("&")[0]?this.code.split("code=")[1].split("&")[0]:"",t=this.code.split("error=")[1]&&this.code.split("error=")[1].split("&")[0]?this.code.split("error=")[1].split("&")[0]:"";!e&&t?this.displayMessage("connect",3):this.saveCode(e)},saveCode:function(e){var t=this;this.office365TokenExchange=new u({authCode:e,pushActivity:!0,pushEvent:!0,pushWorkout:!0}),this.office365TokenExchange.save(null,{success:function(e){e.get("returnError").code?t.displayMessage("connect",e.get("returnError").code):(t.showManageOfficeModal(!0),m=!0)},error:function(){t.displayMessage("connect",response.get("returnError").code)}})},removeURLQueryString:function(){var e=window.location.href;window.history.pushState("","",e.split("?")[0])},showManageOfficeModal:function(e){var t=this;this.sharingManagerModalView=new c({firstConnect:e}),this.listenTo(this.sharingManagerModalView,c.Events.CAN_SAVE,this.enableDisableSaveButton,this),this.sharingManagerModalView.load(),this.sharingManagerModal=new s({view:this.sharingManagerModalView,showFooter:!0,showCancelButton:!0,modalTitle:r.localize("office_sharing_options"),customClasses:"select-your-experience single in",onSaveButtonClicked:this.saveSharingOptions.bind(t)}),this.sharingManagerModal.render()},saveSharingOptions:function(){var e=this;this.office365SharingSettings=new f,this.office365SharingSettings.save(this.sharingManagerModalView.sharingOptions,{type:"PUT",success:function(t){e.displayMessage("manage",t.get("returnError").code)},error:function(t){e.displayMessage("manage",t.get("returnError").code)}}),this.sharingManagerModal.close()},enableDisableSaveButton:function(e){var t=this.sharingManagerModal.$el.find(".js-saveBtn");e?t.removeAttr("disabled").removeClass("disabled"):t.attr("disabled","disabled").addClass("disabled")},getMenuItemsHtml:function(){return this.menuItems({Localizer:r,connected:m})},displayMessage:function(e,t){var n=t?g.errors[t]:g[e][t],i=!t&&t!==0||t&&t!==0?"error":"success";n=r.localize(n),this.trigger(p.MESSAGE,{status:i,message:n})},getConnectedStatus:function(){return m}});return y.Events=p,y}),define("pages/activity_details_2/views/charts/utils/XAxisTypes",[],function(){return{Duration:"sumDuration",Distance:"sumDistance",SwimLengths:"directLengthIndex",SwimDuration:"cumulativeDuration",SwimDistance:"cumulativeDistance"}}),define("activity2/views/charts/SeriesType",["underscore","backbone","personalizer","pages/activity_details_2/views/charts/utils/XAxisTypes"],function(e,t,n,r){var i,s=function(e){this.activitySummary=e.activitySummary,this.activityDetails=e.activityDetails,this.activitySplits=e.activitySplits,this.usersWeight=e.usersWeight,this.xAxisType=e.xAxisType,this.mean=this.getAvgValue()};return e.extend(s.prototype,{yAxisMinMaxPadding:"padded",reset:function(){this.data=null},hasAvgValue:function(){var t=this.activitySummary.get(this.avgValueKey);return!e.isUndefined(t)&&t!=null},getColor:function(e){return this.chartColorMapperObject.mapSeriesType(this,e)},getAvgValue:function(t){var n=this.activitySummary.get(this.avgValueKey);return!e.isUndefined(n)&&n!=null?this.conversionFunction(n,t||this.measurementSystem()):i},shouldBeVisible:function(){return!0},setXAxisType:function(e){this.xAxisType=e,this.data=null},formatToolTipRow:function(e,t,n,r,i,s,o){return this.formattingFunction(n)+" "+r},colorMapper:null,chartColorMapperObject:null,formattingFunction:e.identity,conversionFunction:e.identity,generateData:function(e,t,n){return this.data&&!t?this.data:(e=e||this.colorMapper||function(){return i},this.data=this.getData(),this.mainChartFilter&&(this.data=this.mainChartFilter(this.data)),this.data&&(this.data=this.buildData(e,t,n)),this.data)},getData:function(){return this.activityDetails.getData(this.seriesKey,this.getXAxisKey())},hasData:function(){return this.activityDetails.hasData(this.seriesKey)},buildData:function(e,t,i){var s,o,u=[];for(var a=0,f=this.data.length;a<f;a++)this.data[a]&&(s=this.data[a][0],this.xAxisType===r.Distance&&(s=n.convertDistance(s,this.activitySummary.getActivityTypeKey())),o=this.data[a][1],u[a]={x:s,y:o===null?null:this.conversionFunction(o,this.measurementSystem()),color:this.getDataColor(e.call(this,o),i,this.data[a][0])});return u},getDataColor:function(e,t,n){return t&&typeof t.isOverlay=="function"&&t.isOverlay(n)?t.color:e},getXAxisKey:function(){return this.xAxisType},getClosestPoint:function(e){var t=this.data,n=t.length;for(var r=0;r<n;r++)if(t[r].x>=e)break;var i=Math.min(t.length-1,r);if(i>0&&t[i].x!=e){var s=Math.abs(t[i].x-e),o=Math.abs(t[i-1].x-e);o<s&&i--}return this.data[i]},measurementSystem:function(){return n.measurementSystem},getLowerRange:function(e,t){var n=this.calculateMean(t);if(!e)return this.calculateMin(t);var r=this.calculateStdDeviation(t)*e;return Math.max(n-r,0)},getUpperRange:function(e,t){var n=this.calculateMean(t);if(!e)return this.calculateMax();var r=this.calculateStdDeviation(t)*e;return n+r},getLowerRangeWithMinRange:function(e){var t=this.getLowerRange(0),n=this.getUpperRange(0),r=n-t;return r<e&&(t-=(e-r)/2),t},getUpperRangeWithMinRange:function(e){var t=this.getLowerRange(0),n=this.getUpperRange(0),r=n-t;return r<e&&(n+=(e-r)/2),n},calculateMean:function(e){if(typeof this.mean=="undefined"||this.mean===null){var t=this.yValueFunc(),n=0,r,i=0,s;if(e)for(s=0;s<this.data.length;s++)r=t(this.data[s]),r&&(n+=r,i++);else for(s=0;s<this.data.length;s++)r=t(this.data[s]),n+=r,i++;i&&(this.mean=n/i)}return this.mean},calculateStdDeviation:function(t){if(this.stdDev===null||typeof this.stdDev=="undefined"){var n=this.calculateMean(),r=this.yValueFunc(),i=[],s,o;if(t){var u;for(o=0;o<this.data.length;o++)u=r(this.data[o]),u&&(s=u-n,i.push(s*s))}else for(o=0;o<this.data.length;o++)s=r(this.data[o])-n,i.push(s*s);if(i.length){var a=e.reduce(i,function(e,t){return e+t})/i.length;this.stdDev=Math.sqrt(a)}else this.stdDev=0;return this.stdDev}return this.stdDev},calculateMax:function(t){if(!this.maxValue){var n=this.yValueFunc();t?this.maxValue=e.max(this.data,function(e){return n(e)>=t?-999999:n(e)}):this.maxValue=e.max(this.data,n),this.maxValue&&(this.maxValue=n(this.maxValue))}return this.maxValue},yValueFunc:function(e){var t=e||this.data;return Array.isArray(t[0])?function(e){return e[1]}:function(e){return e.y}},xValueFunc:function(){return Array.isArray(this.data[0])?function(e){return e[0]}:function(e){return e.x}},calculateMin:function(t){if(!this.minValue){var n=this.yValueFunc();t?this.minValue=e.min(this.data,function(e){return n(e)||99999999},this):this.minValue=e.min(this.data,n),this.minValue&&(this.minValue=n(this.minValue))}return this.minValue},filter:function(e,t){if(!e||e.length<2)return e;var n=e[0],r=e[e.length-1],i=this.yValueFunc(e),s=[n],o,u;for(var a=1;a<e.length;a++)o=e[a],u=i(o),t(u)||s.push(o);return s.length<2?[n,r]:(t(i(n))&&(typeof n.y!="undefined"?n.y=s[1].y:n[1]=s[1][1]),r!==s[s.length-1]&&(s.push(r),typeof r.y!="undefined"?r.y=s[s.length-1].y:r[1]=s[s.length-2][1]),s)},isZero:function(e){return e===0},isNegative:function(e){return e<0},filterZeros:function(e){return this.filter(e,this.isZero)},filterNulls:function(t){return this.filter(t,e.isNull)},filterBadPCOs:function(e){return this.filter(e,this.getIsBadPCOTest())},getIsBadPCOTest:function(){var t=this.min,n=this.max;return function(r){return e.isNull(r)||r>n||r<t}},filterNegatives:function(e){return this.filter(e,this.isNegative)},filterValues:function(e){if(!this.data||this.data.length<2)return this.data;var t=this.calculateMean();if(!t)return this.data;var n=this.yValueFunc(),r=this.data[0],i=this.data[this.data.length-1],s=this.calculateStdDeviation()*e,o=t-s,u=t+s,a=[],f,l;for(var c=0;c<this.data.length;c++)f=this.data[c],l=n(f),l>=o&&l<=u&&a.push(f);return r[1]=Math.min(u,n(r)),i[1]=Math.min(u,n(i)),r[1]=Math.max(o,n(r)),i[1]=Math.max(o,n(i)),a[0]=r,a.push(i),a},filterRestsIfXAxisIsDistance:function(e){if(!e||e.length<2||this.xAxisType!=r.SwimDistance)return e;var t=this.xValueFunc(),n=[],i,s,o,u=e.length-1;for(var a=0;a<u;a++)i=e[a],s=e[a+1],o=t(i),o!=t(s)&&n.push(i);var f=e[e.length-1];return n.push(f),n},getExtremeMax:function(){var e=Math.abs(this.calculateMin()),t=Math.abs(this.calculateMax());return t>=e?t:e},getExtremeMin:function(){return-this.getExtremeMax()}}),s.extend=t.Model.extend,s}),define("collections/activity/ActivitySplits",["underscore","backbone"],function(e,t){var n={RIDER_POSITION:"RIDER_POSITION",TIMER_TRIGGER:"TIMER_TRIGGER",OFF_COURSE:"OFF_COURSE"},r=t.Model.extend({url:function(){return"/proxy/activity-service/activity/"+this.activityId+"/splits"},initialize:function(e,t){if(typeof t.activityId=="undefined")throw"ActivitySplits requires an activity ID";this.activityId=t.activityId},getEventDataBySectionTypeKey:function(t){return e.filter(this.get("eventDTOs"),function(e){return e.sectionTypeDTO.sectionTypeKey===t})}});return r.EventSectionTypeKeys=n,r}),define("utils/activity/power/PowerUtil",[],function(){return{convertObtuseAnglesToNegativeAngles:function(e){return e>180?e-360:e},convertNegativeAnglesToObtuseAngles:function(e){return e<0?e+360:e},rebaseDegrees:function(e,t){return e+=t,e>360?e-=360:e<0&&(e+=360),e}}}),define("models/activity/MaxAveragePower",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({url:function(){return"/proxy/activity-service/activity/"+this.activityId+"/cyclingDynamicsForMaxAvgPowerDuration?startTimeMillis="+this.startTime+"&durationInSeconds="+this.duration},initialize:function(e){this.activityId=e.activityId,this.startTime=e.startTimeMilliseconds,this.duration=e.duration},setData:function(e,t){this.startTime=e,this.duration=t},getStartTime:function(){return this.get("maxAverageDTO").timerDurationStartMillis},getEndTime:function(){return this.get("maxAverageDTO").timerDurationEndMillis},getStartDistance:function(){return this.get("maxAverageDTO").startDistance/100},getEndDistance:function(){return this.get("maxAverageDTO").endDistance/100},getValue:function(){return this.get("maxAverageDTO").value}});return n}),define("utils/validators/Validator",["backbone"],function(e){var t={ValidationFailure:"VALIDATION_FAILURE_EVENT",ValidationSuccess:"VALIDATION_SUCCESS_EVENT"},n={Pending:"VALIDATION_PENDING"},r=e.Model.extend({initialize:function(e){this.initializeValidator(e)},initializeValidator:function(e){if(!e.elementId&&!e.element)throw"Validator missing element";e.element?this.$inputField=jQuery(e.element):this.$inputField=jQuery("#"+e.elementId),this.parser=e.parser,this.formatter=e.formatter,this.reporter=e.reporter;var t=this;this.$inputField.bind("change",function(e){t.onValueChanged(t.getTargetValue())}),this.$inputField.bind("keydown",function(e){e.keyCode==9?t.onValueChanged(t.getTargetValue()):t.onInputChanged(t.getTargetValue())})},validateInputNow:function(){return this.onValueChanged(this.getTargetValue())},onInputChanged:function(e){this.clearReport()},onValueChanged:function(e){var t=this.validateInput(e);if(t!=n.Pending)return t?(this.triggerFailureEvent(e,t),this.report(e,t)):(this.triggerSuccessEvent(e),this.clearReport()),t},triggerSuccessEvent:function(e){this.trigger(t.ValidationSuccess,this.makeValidationResult(e))},triggerFailureEvent:function(e,n){this.trigger(t.ValidationFailure,this.makeValidationResult(e,n))},makeValidationResult:function(e,t){return{validator:this,error:t,enteredValue:e,parsedValue:this.parse(e),formattedValue:this.format(e)}},parse:function(e){if(!this.parser)return e;try{return this.parser.parse(e)}catch(t){return null}},format:function(e){return this.formatter?this.formatter.format(e):e},report:function(e,t){this.reporter&&this.reporter.report(e,t)},clearReport:function(){this.reporter&&this.reporter.remove()},validateInput:function(e){return""},destroy:function(){this.reporter&&this.reporter.remove()},getTargetValue:function(){return this.$inputField.val()||this.$inputField.text()}});return r.Events=t,r.ValidationResults=n,r}),define("utils/validators/NumberValidator",["utils/validators/Validator","utils/parsers/NumberParser"],function(e,t){var n={InvalidNumber:"invalid_chars",NegativeNumber:"negative_number",OutOfRange:"out_of_range",Required:"required"},r=e.extend({initialize:function(e){this.initializeNumberValidator(e);var t=this;this.$inputField.bind("keydown",function(e){t.validCharacterKeydownHandler(e)})},initializeNumberValidator:function(e){this.initializeValidator(e),this.validKeys=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Backspace","Delete","End","Home"],typeof e.typeFormat!="undefined"&&e.typeFormat=="integer"?(this.typeFormat=e.typeFormat,this.validChars=[8,9,37,38,39,40,46,35,36]):(this.typeFormat="decimal",this.validChars=[8,9,37,38,39,40,46,110,188,190,35,36],this.validKeys.push(","),this.validKeys.push(".")),typeof e.mustBePositive!="undefined"?this.mustBePositive=e.mustBePositive:this.mustBePositive=!0,e.parser||(this.parser=new t),this.conversionFunction=e.conversionFunction,this.minValue=e.minValue,this.maxValue=e.maxValue,this.required=e.required,this.mustBePositive==0&&(this.validChars.push(189),this.validChars.push(173),this.validChars.push(109))},validateInput:function(e){if(this.required&&(!e||e.length<1))return n.Required;if(e.length>0){try{e=this.parser.parse(e)}catch(t){return n.InvalidNumber}if(typeof e=="undefined"||!!isNaN(e))return n.InvalidNumber;var r=+e;this.conversionFunction&&(r=this.conversionFunction.call(this,r));if(typeof this.minValue!="undefined"&&r<this.minValue)return n.OutOfRange;if(typeof this.maxValue!="undefined"&&r>this.maxValue)return n.OutOfRange;if(this.mustBePositive&&r<0)return n.NegativeNumber}return},validCharacterKeydownHandler:function(e){var t=e.originalEvent,n=typeof t.which=="number"?t.which:t.keyCode,r=!1;t.key&&typeof t.key=="string"?r=this.isNumberKey(t.key):(!t.key||typeof t.key!="string")&&this.isNumberKeyCode(n)&&(r=!0),this.validChars.indexOf(n)>-1&&(r=!0);if(!r)return e.preventDefault(),!1},isNumberKeyCode:function(e){return!this.isNotANumberKeyCode(e)},isNumberKey:function(e){return/\d/.test(e)||this.validKeys.indexOf(e)>-1},isNotANumberKeyCode:function(e){return e<48||e>57&&e<96||e>105},setMaxValue:function(e){this.maxValue=e},setMinValue:function(e){this.minValue=e}});return r.Errors=n,r}),define("views/utils/ErrorToolTipView",["backbone","jquery"],function(e,t){var n=e.View.extend({events:{"click body":"onBodyClicked"},initialize:function(e){this.content=e.content,this.placement=e.placement,this.hideOnBodyClick=e.hideOnBodyClick?!0:!1,this.container=e.container||".main-body"},show:function(){this.rendered||this.render();var e="";this.hideOnBodyClick&&(e="hide-on-body-click"),this.$el.addClass("error"),this.$el.addClass("error-tooltip-active"),this.$el.data("title",this.content),this.$el.tooltip({placement:this.placement,template:'<div class="tooltip tooltip-error '+e+'"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"manual",container:this.container}).tooltip("show"),this.$el.on("hidden.bs.modal",function(e){e.stopPropagation()}),this.$el.on("hide.bs.modal",function(e){e.stopPropagation()}),this.$el.on("hide",function(e){e.stopPropagation()})},hide:function(){this.$el.removeClass("error").removeClass("error-tooltip-active").tooltip("destroy")},render:function(){this.rendered=!0,this.onBodyClicked()},onBodyClicked:function(){if(this.hideOnBodyClick){var e=this;t("body").one("click",function(){t(".hide-on-body-click").fadeOut(100),e.hide()})}}});return n.hideAll=function(){t(".error-tooltip-active").tooltip("hide").removeClass("tooltip-active")},n}),define("utils/reporters/ToolTipErrorReporter",["views/utils/ErrorToolTipView"],function(e){var t=function(e){this.message=e.message,this.element=e.element,this.position=e.position,this.scrollableElement=e.scrollableElement,this.value=null,this.result=null;if(!this.message)throw"Message is required.";if(!this.element)throw"Element is required.";if(this.scrollableElement){var t=this;jQuery(this.scrollableElement).scroll(function(e){t.onContentScrolled(e)})}this.container=e.container};return t.prototype.report=function(e,t){this.remove(),this.value=e,this.result=t,this.show()},t.prototype.remove=function(){this.value=null,this.result=null,this.hide()},t.prototype.hide=function(){this.errorToolTipView&&(this.errorToolTipView.hide(),this.errorToolTipView=null)},t.prototype.show=function(){if(this.value||this.result){var t=this.message;t=_.isFunction(t)?t.call(this,this.value,this.result):t,this.errorToolTipView=new e({el:jQuery(this.element),content:t,placement:this.position,container:this.container}),this.errorToolTipView.show()}},t.prototype.onContentScrolled=function(e){this.hide();var t=this;this.pendingShow||(this.pendingShow=!0,setTimeout(function(){t.show(),t.pendingShow=!1},200))},t}),define("pages/activity_details_2/views/charts/views/BaseChartRangeSelector",["underscore","backbone"],function(e,t){var n={RangeSelected:"RangeSelected",RangeReset:"OnRangeReset"},r=t.View.extend({initialize:function(e){this.activitySummary=e.activitySummary,this.activityDetails=e.activityDetails,this.xAxisType=e.xAxisType;if(!this.activitySummary)throw"ActivitySummary required for Range Selector";if(!this.activityDetails)throw"ActivityDetails required for Range Selector"},render:function(){this.$el.addClass(this.customClasses),this.$el.html(this.template({})),this.$el.show()}});return r.Events=n,r}),define("pages/activity_details_2/views/utils/PowerRangeUtil",["require","localizer","personalizer"],function(e){var t=e("localizer"),n=e("personalizer"),r={getDurationLabelValue:function(e){switch(e){case-1:return t.localize("avg_power_range_none");case 5:return t.localize("avg_power_range_customsec",5);case 60:return t.localize("avg_power_range_custommin",1);case 300:return t.localize("avg_power_range_custommin",5);case 1200:return t.localize("avg_power_range_custommin",20)}return null},getCustomDurationLabelValue:function(e,n){return t.localize("avg_power_max_avg",t.localize("avg_power_range_custom"+n,e))},formatLabel:function(e){return t.localize("avg_power_max_avg",this.getDurationLabelValue(e))},formatAvgTimeValue:function(e,r,i){return n.personalizePower(i)+" "+t.localize(n.getPowerUnitKey())+" ("+n.personalizeDuration(e)+"-"+n.personalizeDuration(r)+")"},formatAvgDistanceValue:function(e,r,i){return n.personalizePower(i)+" "+t.localize(n.getPowerUnitKey())+" ("+n.personalizeDistance(e)+"-"+n.personalizeDistance(r)+")"},isCustomRange:function(e){return e!==-1&&e!==5&&e!==60&&e!==300&&e!==1200}};return r}),define("text!pages/activity_details_2/views/charts/views/AvgPowerRangeSelector.html",[],function(){return'<div class="dropdown">\n    <button class="dropdown-toggle chart-header-item" data-toggle="dropdown">\n        <%= Localizer.localize(\'avg_power_max_avg\', Localizer.localize(\'avg_power_range_none\')) %><i class="icon-pointer-down"></i>\n    </button>\n    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">\n        <li data-timerange="-1" class="active range-item"><a tabindex="-1" href="#"><%= Localizer.localize(\'avg_power_range_none\') %></a></li>\n        <li data-timerange="5" class="range-item"><a tabindex="-1" href="#"><%= Localizer.localize(\'avg_power_range_customsec\', 5) %></a></li>\n        <li data-timerange="60" class="range-item"><a tabindex="-1" href="#"><%= Localizer.localize(\'avg_power_range_custommin\', 1) %></a></li>\n        <li data-timerange="300" class="range-item"><a tabindex="-1" href="#"><%= Localizer.localize(\'avg_power_range_custommin\', 5) %></a></li>\n        <li data-timerange="1200" class="range-item"><a tabindex="-1" href="#"><%= Localizer.localize(\'avg_power_range_custommin\', 20) %></a></li>\n        <li class="divider"></li>\n        <li class="range-item-custom">\n            <a tabindex="-1" href="#" class="custom-max-avg-power-toggle"><%= Localizer.localize(\'avg_power_range_custom\') %></a>\n            <div class="custom-max-avg-power" style="display: none;">\n                <input type="text" class="input-mini time-input-field" maxlength="3">\n                <select class="input-small min-sec-selection">\n                    <option value="min"><%= Localizer.localize(\'avg_power_range_unit_min\') %></option>\n                    <option value="sec"><%= Localizer.localize(\'avg_power_range_unit_sec\') %></option>\n                </select>\n                <div id="power-go-btn" class="btn btn-form"><%= Localizer.localize(\'avg_power_calculate_btn\') %></div>\n            </div>\n        </li>\n    </ul>\n    <span id="avg-power-range-selector-value" class="chart-max-avg-power-detail"><%= avgValue %></span>\n</div>'}),define("pages/activity_details_2/views/charts/views/AvgPowerRangeSelector",["underscore","localizer","models/activity/MaxAveragePower","utils/date/DateParser","utils/validators/NumberValidator","utils/reporters/ToolTipErrorReporter","pages/activity_details_2/views/charts/views/BaseChartRangeSelector","pages/activity_details_2/views/utils/PowerRangeUtil","text!pages/activity_details_2/views/charts/views/AvgPowerRangeSelector.html"],function(e,t,n,r,i,s,o,u,a){var o=o.extend({events:{"mouseleave .dropdown":"onLeaveDropdown","mouseover #power-go-btn":"onGoHovered","click .range-item":"onRangeItemClicked","click .range-item-custom":"onCustomRangeClicked","click .btn-form":"onGoBtnClicked"},template:e.template(a),customClasses:"chart-max-avg-power",render:function(){this.$el.addClass(this.customClasses),this.$el.html(this.template({Localizer:t,avgValue:""})),this.$el.show(),this.duration=this.activitySummary.get("duration"),this.disableRanges(this.duration),this.numberValidator=new i({typeFormat:"integer",minValue:1,maxValue:999,element:this.$(".time-input-field"),required:!0,reporter:new s({message:function(e,n){return t.localize("error.custom.max.avg.invalid")},position:"top",element:this.$(".time-input-field"),container:this.$el})})},disableRanges:function(e){var t=this,n;this.$(".range-item").each(function(){n=$(this).attr("data-timerange"),n>e&&t.$('.range-item[data-timerange="'+n+'"]').hide()})},reset:function(){this.populateLabel(u.formatLabel(-1)),this.$("#avg-power-range-selector-value").text(""),this.trigger(o.Events.RangeReset)},onRangeItemClicked:function(e){e.preventDefault(),this.$("li").removeClass("active");var t=jQuery(e.currentTarget),n=+t.attr("data-timeRange");t.addClass("active");if(n===-1){this.reset();return}var r=u.formatLabel(n);this.populateLabel(r),this.$(".custom-max-avg-power").hide(),this.$(".custom-max-avg-power-toggle").show(),this.fetchPower(n)},populateLabel:function(e){this.$(".chart-header-item").html(e+'<i class="icon-pointer-down"></i>')},onCustomRangeClicked:function(e){e.preventDefault(),e.stopPropagation(),this.$("li").removeClass("active"),this.$(".custom-max-avg-power").show(),this.$(".custom-max-avg-power-toggle").hide()},onGoBtnClicked:function(e){e.preventDefault();if(this.$("#power-go-btn").is("[disabled=disabled]"))return;this.$(".dropdown").removeClass("open");var t=this.$(".time-input-field").val();if(!t)return;t=+t;var n=t,r=this.$(".min-sec-selection").val();r==="min"&&(n*=60),this.fetchPower(n),this.populateLabel(u.getCustomDurationLabelValue(t,r))},fetchPower:function(e){var t=new n({activityId:this.activitySummary.id,duration:e,startTimeMilliseconds:r.parseISOUTC(this.activitySummary.get("startTimeGMT")).getTime()});t.once("sync",this.onPowerFetched,this),t.once("error",this.onPowerFetchedFailed,this),t.fetch()},onPowerFetched:function(e){var t=e.getEndTime()-e.getStartTime()+1;this.xAxisType==="sumDuration"?(this.$("#avg-power-range-selector-value").text(u.formatAvgTimeValue(e.getStartTime(),e.getEndTime(),e.getValue())),this.trigger(o.Events.RangeSelected,e.getStartTime(),e.getEndTime(),t)):(this.$("#avg-power-range-selector-value").text(u.formatAvgDistanceValue(e.getStartDistance(),e.getEndDistance(),e.getValue())),this.trigger(o.Events.RangeSelected,e.getStartDistance(),e.getEndDistance(),t))},onPowerFetchedFailed:function(){alert(t.localize("error_calculating_max_avg_power")),this.reset()},setChartRangeSelector:function(e,t,n,r){if(!r)return;var i,s="sec";u.isCustomRange(r)&&r%60===0&&(r/=60,s="min"),u.isCustomRange(r)?i=u.getCustomDurationLabelValue(r,s):i=u.formatLabel(r),this.populateLabel(i),r===-1?this.$("#avg-power-range-selector-value").text(""):this.xAxisType==="sumDuration"?this.$("#avg-power-range-selector-value").text(u.formatAvgTimeValue(e,t,n)):this.$("#avg-power-range-selector-value").text(u.formatAvgDistanceValue(e,t,n))},onLeaveDropdown:function(){!this.$(".dropdown").hasClass("open")&&this.numberValidator&&this.numberValidator.clearReport()},onGoHovered:function(){var e=+this.$(".time-input-field").val(),t=this.$("select.input-small.min-sec-selection").val(),n=this.$("#power-go-btn"),r=1;t==="min"&&(r=60),e*=r,e>this.duration?this.numberValidator.report(e,i.Errors.OutOfRange):this.numberValidator.clearReport();var s=this.$(".tooltip-error:visible").length!==0;s||e===0?n.addClass("disabled").attr("disabled","disabled"):n.removeClass("disabled").removeAttr("disabled")}});return o}),define("pages/activity_details_2/views/charts/SeriesTypes",["underscore","localizer","personalizer","utils/date/DateParser","activity2/views/charts/SeriesType","collections/activity/ActivitySplits","utils/activity/power/PowerUtil","pages/activity_details_2/views/charts/ChartColorMapper","pages/activity_details_2/views/charts/utils/XAxisTypes","pages/activity_details_2/views/charts/views/AvgPowerRangeSelector"],function(e,t,n,r,i,s,o,u,a,f){var l=function(e){return e&&e.activitySummary.get("activityTypeDTO")&&e.activitySummary.get("activityTypeDTO").typeKey?e.activitySummary.get("activityTypeDTO").typeKey:""},c={RunCadence:{name:"RunCadence",seriesKey:"directDoubleCadence",label:"label_run_cadence",unit_key:"run_cadence_unit",defaultChartType:"scatter",mainChartFilter:i.prototype.filterNulls,formattingFunction:e.bind(n.formatWholeNumber,n),expandedMin:e.partial(i.prototype.getLowerRange,0,!0),expandedMax:e.partial(i.prototype.getUpperRange,0),primaryChartMin:e.partial(i.prototype.getLowerRange,2,!0),primaryChartMax:e.partial(i.prototype.getUpperRange,2,!0),avgValueKey:"averageRunCadence",helpKey:"directDoubleCadence",colorMapper:function(e){return e<153?u.Colors.red:e<164?u.Colors.orange:e<174?u.Colors.green:e<184?u.Colors.blue:u.Colors.purple}},BikeCadence:{name:"BikeCadence",seriesKey:"directBikeCadence",label:"label_bike_cadence",unit_key:"bike_cadence_unit",formattingFunction:e.bind(n.formatWholeNumber,n),defaultChartType:"line",avgValueKey:"averageBikeCadence",expandedMin:0},Speed:{name:"Speed",seriesKey:"directSpeed",label:"label_speed",unit_key:function(){return n.getSpeedUnitKey(l(this))},defaultChartType:"line",conversionFunction:function(e,t){return n.convertSpeed(e,t,l(this))},formatToolTipRow:function(e,t,n,r,i,s,o,u){return this.activityDetails.hasGForceData()&&u&&u.y?this.formattingFunction(u.y)+" "+r:this.formattingFunction(n)+" "+r},formattingFunction:e.bind(n.formatSpeed,n),avgValueKey:"averageSpeed",expandedMin:0},Pace:{name:"Pace",seriesKey:"directSpeed",label:"label_pace",unit_key:function(){return n.getPaceUnitKey(l(this))},defaultChartType:"line",conversionFunction:function(e,t){return l(this)!=="rowing"?n.convertFractionalPace(e):n.convertRowingPace(e)},formattingFunction:e.bind(n.formatPace,n),avgValueKey:"averageSpeed",primaryChartMin:e.partial(i.prototype.getLowerRange,0),primaryChartMax:e.partial(i.prototype.getUpperRange,2),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,2),reversed:!0,threshold:9999},OpenWaterSwimPace:{name:"OpenWaterSwimPace",seriesKey:"directSpeed",label:"label_swim_pace",unit_key:n.getSwimPaceUnitKey(),defaultChartType:"line",conversionFunction:e.bind(n.convertFractionalSwimPace,n),formattingFunction:e.bind(n.formatPace,n),avgValueKey:"averageSpeed",reversed:!0,primaryChartMin:e.partial(i.prototype.getLowerRange,0),primaryChartMax:e.partial(i.prototype.getUpperRange,.6),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,.6),threshold:9999},OpenWaterSwimSpeed:{name:"OpenWaterSwimSpeed",seriesKey:"directSpeed",label:"label_speed",unit_key:n.getSwimSpeedUnitKey(),defaultChartType:"line",conversionFunction:e.bind(n.convertSwimSpeed,n),formattingFunction:e.bind(n.formatSpeed,n),avgValueKey:"averageSpeed",expandedMin:0},OpenWaterSwimStrokes:{name:"OpenWaterSwimStrokes",seriesKey:"directSwimCadence",label:"label_strokes",unit_key:"swim_cadence_unit",formattingFunction:e.bind(n.formatWholeNumber,n),defaultChartType:"line",avgValueKey:"averageSwimCadence",expandedMin:0},HeartRate:{name:"HeartRate",seriesKey:"directHeartRate",label:"label_heart_rate",unit_key:n.getHeartRateUnitKey(),defaultChartType:"line",primaryChartMin:e.partial(i.prototype.getLowerRange,2,!0),primaryChartMax:e.partial(i.prototype.getUpperRange,0,!0),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),avgValueKey:"averageHR",formatToolTipRow:function(e,t,n,r,i,s,o,u){return this.activityDetails.hasGForceData()&&u&&u.y?this.formattingFunction(u.y)+" "+r:this.formattingFunction(n)+" "+r},formattingFunction:e.bind(n.personalizeHeartRate,n)},HeartRateLapSwimming:{name:"HeartRateLapSwimming",seriesKey:"directHeartRate",label:"label_heart_rate",unit_key:n.getHeartRateUnitKey(),defaultChartType:"line",mainChartFilter:function(t){var n=this.activitySummary.get("duration");return e.reject(t,function(e){return e[0]>n})},primaryChartMin:e.partial(i.prototype.getLowerRange,2,!0),primaryChartMax:e.partial(i.prototype.getUpperRange,0,!0),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),avgValueKey:"averageHR",formattingFunction:e.bind(n.personalizeHeartRate,n),getXAxisKey:function(){return this.xAxisType===a.SwimDuration?"interpolatedSwimDuration":this.xAxisType===a.SwimLengths?"interpolatedSwimLengths":this.xAxisType===a.SwimDistance?"interpolatedSwimDistance":null},shouldBeVisible:function(){return!0}},Elevation:{name:"Elevation",seriesKey:"directElevation",label:"label_elevation",conversionFunction:e.bind(n.convertElevation,n),formatToolTipRow:function(e,t,n,r,i,s,o,u){return this.activityDetails.hasGForceData()&&u&&u.y?this.formattingFunction(u.y)+" "+r:this.formattingFunction(n)+" "+r},formattingFunction:e.bind(n.formatElevation,n),unit_key:n.getElevationUnitKey(),defaultChartType:"line",primaryChartMin:function(){var e=400;return n.measurementSystem!==n.MeasurementSystems.STATUTE_US&&(e*=n.ConversionFactors.FeetToMeters),this.getLowerRangeWithMinRange(e)},primaryChartMax:function(){var e=400;return n.measurementSystem!==n.MeasurementSystems.STATUTE_US&&(e*=n.ConversionFactors.FeetToMeters),this.getUpperRangeWithMinRange(e)},expandedMin:function(){var e=1e3;return n.measurementSystem!==n.MeasurementSystems.STATUTE_US&&(e*=n.ConversionFactors.FeetToMeters),this.getLowerRangeWithMinRange(e)},expandedMax:function(){var e=1e3;return n.measurementSystem!==n.MeasurementSystems.STATUTE_US&&(e*=n.ConversionFactors.FeetToMeters),this.getUpperRangeWithMinRange(e)},threshold:-9999},Gforce:{name:"Gforce",seriesKey:"directGforce",label:"label_g_force",unit_key:"g_force_unit",defaultChartType:"line",mainChartFilter:i.prototype.filterNulls,primaryChartMin:e.partial(i.prototype.getLowerRange,2,!0),primaryChartMax:e.partial(i.prototype.getUpperRange,0,!0),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),avgValueKey:"averageGforce",formatToolTipRow:function(e,t,n,r,i,s,o,u){return u&&u.y?this.formattingFunction(u.y)+" "+r:this.formattingFunction(n)+" "+r},formattingFunction:function(e){return n.formatDecimalNumber(e,1,"##,##0")}},GroundContactTime:{name:"GroundContactTime",seriesKey:"directGroundContactTime",label:"label_ground_contact_time",formattingFunction:e.bind(n.personalizeVerticalOscillation,n),unit_key:n.getGroundContactTimeUnitKey(),defaultChartType:"scatter",avgValueKey:"groundContactTime",mainChartFilter:i.prototype.filterNulls,primaryChartMin:e.partial(i.prototype.getLowerRange,2),primaryChartMax:e.partial(i.prototype.getUpperRange,2),expandedMin:e.partial(i.prototype.getLowerRange,0),colorMapper:function(e){return e<218?u.Colors.purple:e<249?u.Colors.blue:e<278?u.Colors.green:e<309?u.Colors.orange:u.Colors.red},helpKey:"directGroundContactTime",shouldBeVisible:function(){return!1}},GroundContactTimeBalance:{name:"GroundContactTimeBalance",seriesKey:"directGroundContactBalanceLeft",label:"label_ground_contact_time_balance",unit_key:"percentage_unit",defaultChartType:"scatter",expandedMin:40,expandedMax:60,primaryChartMin:40,primaryChartMax:60,mainChartFilter:i.prototype.filterNulls,avgValueKey:"groundContactBalanceLeft",helpKey:"directGroundContactTimeBalance",yAxisFormattingFunction:function(e,n){return e<50?t.localize("power_balance_right_format",100-e):e>50?t.localize("power_balance_left_format",e):"50/50"},conversionFunction:function(e){return e},formatToolTipRow:function(e,r,i,s,o,u,a){var f=n.getGroundContactBalance(i);return t.localize(n.getPowerBalanceUnitKey(),f.left,f.right)},colorMapper:function(e){if(e<47.6)return u.Colors.red;if(e>=47.6&&e<=49.4)return u.Colors.orange;if(e>=49.3&&e<=50.7)return u.Colors.green;if(e>=50.6&&e<=52.2)return u.Colors.orange;if(e>52.2)return u.Colors.red},shouldBeVisible:function(){return!1}},VerticalOscillation:{name:"VerticalOscillation",seriesKey:"directVerticalOscillation",label:"label_vert_oscillation",unit_key:n.getVerticalOscillationUnitKey(),formattingFunction:e.bind(n.personalizeVerticalOscillation,n),defaultChartType:"scatter",avgValueKey:"verticalOscillation",mainChartFilter:i.prototype.filterNulls,primaryChartMin:e.partial(i.prototype.getLowerRange,2),primaryChartMax:e.partial(i.prototype.getUpperRange,2),helpKey:"directVerticalOscillation",helpKeyAdditionalData:function(){var e=this.activitySummary?this.activitySummary.hasPodSenor():!1;return u.getVerticalOscillationColorRange(e)},colorMapper:function(e){var t=this.activitySummary&&this.activitySummary.hasPodSenor()||!1,n=u.getVerticalOscillationColorRange(t);return e=+$.formatNumber(e,{format:"####0.0"}),e<n.Purple.cutoffMax?u.Colors.purple:e<=n.Blue.cutoffMax?u.Colors.blue:e<=n.Green.cutoffMax?u.Colors.green:e<=n.Orange.cutoffMax?u.Colors.orange:u.Colors.red},shouldBeVisible:function(){return!1}},VerticalRatio:{name:"VerticalRatio",seriesKey:"directVerticalRatio",label:"label_vert_ratio",expandedMin:0,expandedMax:20,unit_key:n.getVerticalRatioUnitKey(),formattingFunction:e.bind(n.personalizeVerticalRatio,n),defaultChartType:"scatter",avgValueKey:"verticalRatio",mainChartFilter:i.prototype.filterNulls,primaryChartMin:e.partial(i.prototype.getLowerRange,2),primaryChartMax:e.partial(i.prototype.getUpperRange,2),helpKey:"directVerticalRatio",helpKeyAdditionalData:function(){var e=this.activitySummary?this.activitySummary.hasPodSenor():!1;return u.getVerticalRatioColorRange(e)},colorMapper:function(e){var t=this.activitySummary&&this.activitySummary.hasPodSenor()||!1,n=u.getVerticalRatioColorRange(t);return e=+$.formatNumber(e,{format:"####0.0"}),e<n.Purple.cutoffMax?u.Colors.purple:e<=n.Blue.cutoffMax?u.Colors.blue:e<=n.Green.cutoffMax?u.Colors.green:e<=n.Orange.cutoffMax?u.Colors.orange:u.Colors.red},shouldBeVisible:function(){return!1}},Temperature:{name:"Temperature",seriesKey:"directAirTemperature",label:"label_temperature",avgValueKey:"averageTemperature",unit_key:n.getTemperatureUnitKey(),conversionFunction:e.bind(n.convertTemperature,n),formattingFunction:e.bind(n.formatTemperature,n),defaultChartType:"line",primaryChartMin:function(){var e=10;return n.measurementSystem===n.MeasurementSystems.METRIC&&(e*=5/9),this.getLowerRangeWithMinRange(e)},primaryChartMax:function(){var e=10;return n.measurementSystem===n.MeasurementSystems.METRIC&&(e*=5/9),this.getUpperRangeWithMinRange(e)},expandedMin:function(){var e=30;return n.measurementSystem===n.MeasurementSystems.METRIC&&(e*=5/9),this.getLowerRangeWithMinRange(e)},expandedMax:function(){var e=30;return n.measurementSystem===n.MeasurementSystems.METRIC&&(e*=5/9),this.getUpperRangeWithMinRange(e)}},LeftRightPowerBalance:{name:"LeftRightPowerBalance",seriesKey:"directRightBalance",label:"label_left_right_balance",unit_key:"",defaultChartType:"scatter",expandedMin:0,expandedMax:100,mainChartFilter:i.prototype.filterNulls,yAxisFormattingFunction:function(e,n){return e<50?t.localize("power_balance_right_format",100-e):e>50?t.localize("power_balance_left_format",e):"50/50"},conversionFunction:function(e){return 100-e},formatToolTipRow:function(e,r,i,s,o,u,a){var f=i,l=100-f;return t.localize(n.getPowerBalanceUnitKey(),f,l)}},PowerWatts:{name:"PowerWatts",seriesKey:"directPower",label:["label_full_power","label_power_unit"],avgValueKey:"averagePower",unit_key:n.getPowerUnitKey(),defaultChartType:"line",expandedMin:0,formattingFunction:e.bind(n.personalizePower,n),chartRangeSelectorType:f},PowerKg:{name:"PowerKg",seriesKey:"directPower",label:["label_full_power","label_power_kg"],avgValueKey:"averagePower",unit_key:"label_power_kg",defaultChartType:"line",expandedMin:0,conversionFunction:function(e){return e/this.usersWeight},formattingFunction:e.bind(n.personalizePowerKg,n),chartRangeSelectorType:f},LeftPPStart:{name:"LeftPPStart",seriesKey:"directLeftPowerPhaseStart",label:"label_cd_left_power_phase_start",parentLabel:"label_cd_power_phase_start",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,reversed:!0,mainChartFilter:i.prototype.filterNulls,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(o.rebaseDegrees(e,-90))},conversionFunction:function(e){return o.rebaseDegrees(e,90)},formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("left")+"</span>: "+this.formattingFunction(r)+i},tickInterval:45,tickPositions:[0,45,90,135,180],expandedMin:0,expandedMax:180,shouldBeVisible:function(){return!1}},RightPPStart:{name:"RightPPStart",seriesKey:"directRightPowerPhaseStart",label:"label_cd_right_power_phase_start",parentLabel:"label_cd_power_phase_start",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,reversed:!0,mainChartFilter:i.prototype.filterNulls,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(o.rebaseDegrees(e,-90))},conversionFunction:function(e){return o.rebaseDegrees(e,90)},tickInterval:45,tickPositions:[0,45,90,135,180],expandedMin:0,expandedMax:180,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("right")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},LeftPeakPPStart:{name:"LeftPeakPPStart",seriesKey:"directLeftPowerPhasePeakStart",label:"label_cd_left_peak_power_phase_start",parentLabel:"label_cd_peak_power_phase_start",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(e)},tickInterval:45,tickPositions:[0,45,90,135],expandedMin:0,expandedMax:135,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("left")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},RightPeakPPStart:{name:"RightPeakPPStart",seriesKey:"directRightPowerPhasePeakStart",label:"label_cd_right_peak_power_phase_start",parentLabel:"label_cd_peak_power_phase_start",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(e)},tickInterval:45,tickPositions:[0,45,90,135],expandedMin:0,expandedMax:135,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("right")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},LeftPPEnd:{name:"LeftPPEnd",seriesKey:"directLeftPowerPhaseEnd",label:"label_cd_left_power_phase_end",parentLabel:"label_cd_power_phase_end",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(o.rebaseDegrees(e,90))},conversionFunction:function(e){return o.rebaseDegrees(e,-90)},tickInterval:45,tickPositions:[45,90,135,180,225],expandedMin:45,expandedMax:225,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("left")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},RightPPEnd:{name:"RightPPEnd",seriesKey:"directRightPowerPhaseEnd",label:"label_cd_right_power_phase_end",parentLabel:"label_cd_power_phase_end",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(o.rebaseDegrees(e,90))},conversionFunction:function(e){return o.rebaseDegrees(e,-90)},tickInterval:45,tickPositions:[45,90,135,180,225],expandedMin:45,expandedMax:225,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("right")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},LeftPeakPPEnd:{name:"LeftPeakPPEnd",seriesKey:"directLeftPowerPhasePeakEnd",label:"label_cd_left_peak_power_phase_end",parentLabel:"label_cd_peak_power_phase_end",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(e)},tickInterval:45,tickPositions:[45,90,135,180],expandedMin:45,expandedMax:180,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("left")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},RightPeakPPEnd:{name:"RightPeakPPEnd",seriesKey:"directRightPowerPhasePeakEnd",label:"label_cd_right_peak_power_phase_end",parentLabel:"label_cd_peak_power_phase_end",helpTooltip:"help.cycling.dynamics.tdc.bdc.description",unit_key:"degree_unit",defaultChartType:"scatter",scatterLineRadius:2,mainChartFilter:i.prototype.filterNulls,reversed:!0,yAxisFormattingFunction:function(e){return e=this.formattingFunction(e),e==0?"TDC 0":e==180?"BDC 180":e},formattingFunction:function(e){return n.personalizePowerPhaseAngle(e)},tickInterval:45,tickPositions:[45,90,135,180],expandedMin:45,expandedMax:180,formatToolTipRow:function(e,n,r,i,s,o,u,a){var f=a||e.getColor(!0);return'<span style="color:'+f+'">'+t.localize("right")+"</span>: "+this.formattingFunction(r)+i},shouldBeVisible:function(){return!1}},LeftPCO:{name:"LeftPCO",seriesKey:"directLeftPlatformCenterOffset",label:"label_cd_left_pedal_center_offset",avgValueKey:"leftPlatformCenterOffset",unit_key:"platform_center_offset_unit",defaultChartType:"scatter",scatterLineRadius:1,primaryChartMin:-30,primaryChartMax:30,expandedMin:-30,expandedMax:30,tickInterval:15,mainChartFilter:i.prototype.filterBadPCOs,formattingFunction:e.bind(n.personalizePlatformCenterOffset,n),plotLines:[{color:"#888888",width:2,value:0}]},RightPCO:{name:"RightPCO",seriesKey:"directRightPlatformCenterOffset",label:"label_cd_right_pedal_center_offset",avgValueKey:"rightPlatformCenterOffset",unit_key:"platform_center_offset_unit",defaultChartType:"scatter",scatterLineRadius:1,primaryChartMin:-30,primaryChartMax:30,expandedMin:-30,expandedMax:30,tickInterval:15,mainChartFilter:i.prototype.filterBadPCOs,conversionFunction:function(e){return-e},formattingFunction:function(e){return n.personalizePlatformCenterOffset(-e)},plotLines:[{color:"#888888",width:2,value:0}]},SwimPace:{name:"SwimPace",seriesKey:"weightedMeanSpeed",label:"label_swim_pace",unit_key:function(e){return n.getSwimPaceUnitKey(e)},defaultChartType:"line",conversionFunction:function(e,t){return n.convertFractionalSwimPace(e,t)},formattingFunction:function(e){var t=this.activitySummary.get("unitOfPoolLength").unitKey,r=n.poolUnitKeyToMeasurementSystem(t);return e>=60?"--":n.formatPace(e,r)},mainChartFilter:i.prototype.filterRestsIfXAxisIsDistance,avgValueKey:"averageSpeed",expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:function(){return i.prototype.calculateMax.call(this,60)+1},reversed:!0},SwimSpeed:{name:"SwimSpeed",seriesKey:"weightedMeanSpeed",label:"label_speed",unit_key:function(e){return n.getSwimSpeedUnitKey(e)},defaultChartType:"line",conversionFunction:function(e,t){return n.convertSwimSpeed(e,t)},formattingFunction:function(e){var t=this.activitySummary.get("unitOfPoolLength").unitKey,r=n.poolUnitKeyToMeasurementSystem(t);return n.formatSpeed(e,r)},mainChartFilter:i.prototype.filterRestsIfXAxisIsDistance},SwimStrokes:{name:"SwimStrokes",seriesKey:"sumStrokes",label:"label_strokes",unit_key:n.getStrokesUnitKey(),defaultChartType:"line",expandedMin:0,mainChartFilter:i.prototype.filterRestsIfXAxisIsDistance},SwimSwolf:{name:"SwimSwolf",seriesKey:"weightedMeanSwolf",label:"label_swolf",unit_key:"label_swolf",defaultChartType:"line",expandedMin:0,mainChartFilter:i.prototype.filterRestsIfXAxisIsDistance},SwimLengths:{name:"SwimLengths",seriesKey:"sumDuration",label:"label_swim_lengths",unit_key:null,defaultChartType:"column",formattingFunction:e.bind(n.personalizeDuration,n)},StrideLength:{name:"StrideLength",seriesKey:"directStrideLength",label:"label_stride_length",unit_key:n.getAvgStrideLengthUnitKey(),defaultChartType:"scatter",mainChartFilter:i.prototype.filterNulls,primaryChartMin:e.partial(i.prototype.getLowerRange,2,!0),primaryChartMax:e.partial(i.prototype.getUpperRange,0,!0),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),avgValueKey:"strideLength",formattingFunction:e.bind(n.formatStrideLength,n),conversionFunction:e.bind(n.convertStrideLength,n)},StrokeRate:{name:"StrokeRate",seriesKey:"directStrokeCadence",label:"label_chart_stroke_rate",unit_key:"run_cadence_unit",formattingFunction:e.bind(n.formatWholeNumber,n),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),defaultChartType:"line",avgValueKey:"averageStrokeCadence"},DistancePerStroke:{name:"DistancePerStroke",seriesKey:"directStrokeDistance",label:"label_stroke_distance",mainChartFilter:i.prototype.filterNulls,expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0),unit_key:function(){return l(this)!=="rowing"?n.getDistancePerStrokeUnitKey():"distance.meter"},formattingFunction:e.bind(n.formatDistancePerStroke,n),conversionFunction:function(e,t){return l(this)!=="rowing"?n.convertDistancePerStroke(e):e},yAxisFormattingFunction:function(e,t){return t!==n.MeasurementSystems.METRIC&&(e=n.convertDistancePerStroke(e)),n.formatDistancePerStroke(e)},defaultChartType:"scatter",avgValueKey:"averageStrokeDistance"},Position:{name:"Position",seriesKey:"directTimestamp",label:"label_position",unit_key:"",defaultChartType:"line",hasData:function(){var e=s.EventSectionTypeKeys.RIDER_POSITION,t=this.activitySplits.getEventDataBySectionTypeKey(e);return t&&t.length>0},buildData:function(e,t,r){var i,o,u=0,f=this.data.length,l=s.EventSectionTypeKeys.RIDER_POSITION,c=this.activitySplits.getEventDataBySectionTypeKey(l),h=[];if(c)for(var p=0,d=c.length;p<d;p++){i=c[p].riderPosition,p===d-1?o=this.data[f-1][1]:o=c[p+1].startTimeGMTDoubleValue,u=h.length;for(u;u<f;u++){if(!(this.data[u][1]<=o))break;this.xAxisType===a.Distance&&(this.data[u][0]=n.convertDistance(this.data[u][0],this.activitySummary.getActivityTypeKey())),h[u]=[this.data[u][0],i]}}return h},getClosestPoint:function(e){var t=this.data,n=t.length;for(var r=0;r<n;r++)if(t[r][0]>=e)break;var i=Math.min(t.length-1,r);if(i>0&&t[i][0]!=e){var s=Math.abs(t[i][0]-e),o=Math.abs(t[i-1][0]-e);Math.abs(o-s)<=1e-5&&i--}return this.data[i]},formatToolTipRow:function(e,n,r,i,s,o,u,a){return r!==null?"<span>"+t.localize(r===0?"label_sitting":"label_standing")+"</span>":""}},PerformanceCondition:{name:"PerformanceCondition",seriesKey:"directPerformanceCondition",label:"label_performance_condition",defaultChartType:"area",helpKey:"directPerformanceCondition",primaryChartMin:i.prototype.getExtremeMin,primaryChartMax:i.prototype.getExtremeMax,expandedMin:i.prototype.getExtremeMin,expandedMax:i.prototype.getExtremeMax,formatToolTipRow:function(t,n,r,i,s,o,u){var a=function(e){return'<span style="min-width: 64px;">&nbsp;&nbsp;'+e+"&nbsp;&nbsp;</span>"};if(!e.isNumber(r))return r;var f=r>0?"+"+r:r;return a(f)}},Ascent:{name:"Ascent",seriesKey:"directElevation",label:"label_ascent",defaultChartType:"line",conversionFunction:e.bind(n.convertElevation,n),formatToolTipRow:function(e,t,n,r,i,s,o,u){return this.formattingFunction(n)+" "+r},buildData:function(e,t,r){var i=[],s,o,u;for(var f=0,l=this.data.length;f<l;f++)this.data[f]&&(u=this.data[0][1],s=this.data[f][0],this.xAxisType===a.Distance&&(s=n.convertDistance(s,this.activitySummary.getActivityTypeKey())),o=this.data[f][1]-u,i[f]={x:s,y:o===null?null:this.conversionFunction(o,this.measurementSystem()),color:this.getDataColor(e.call(this,o),r,this.data[f][0])});return i},formattingFunction:e.bind(n.formatElevation,n),unit_key:n.getElevationUnitKey(),primaryChartMin:e.partial(i.prototype.getLowerRange,0),primaryChartMax:e.partial(i.prototype.getUpperRange,2),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,2)},FloorClimbingPace:{name:"FloorClimbingPace",seriesKey:"directVerticalSpeed",label:"label_pace",unit_key:function(){return n.getPaceUnitKey(l(this))},defaultChartType:"line",buildData:function(e,t,r){var i,s,o=[],u=this.data.length;while(u--)this.data[u][1]<0&&this.data.splice(u,1);for(var f=0,u=this.data.length;f<u;f++)this.data[f]&&(i=this.data[f][0],this.xAxisType===a.Distance&&(i=n.convertDistance(i,this.activitySummary.getActivityTypeKey())),s=this.data[f][1],o[f]={x:i,y:s===null?null:this.conversionFunction(s,this.measurementSystem()),color:this.getDataColor(e.call(this,s),r,this.data[f][0])});return o},conversionFunction:e.bind(n.personalizeFloorClimbingPace,n),avgValueKey:"avgVerticalSpeed",primaryChartMin:e.partial(i.prototype.getLowerRange,0),primaryChartMax:e.partial(i.prototype.getUpperRange,0),expandedMin:e.partial(i.prototype.getLowerRange,0),expandedMax:e.partial(i.prototype.getUpperRange,0)},DiveDepth:{name:"DiveDepth",seriesKey:"directDepth",label:"label_depth_profile",conversionFunction:e.bind(n.convertMetersFt,n),formattingFunction:e.bind(n.formatMetersFt,n),unit_key:n.getDepthUnitKey(),defaultChartType:"line",reversed:!0,threshold:9999,primaryChartMin:0,primaryChartMax:function(){return this.getUpperRange()}},DecoCeiling:{name:"DecoCeiling",seriesKey:"directNextStopDepth",label:"label_depth_profile",conversionFunction:e.bind(n.convertMetersFt,n),formattingFunction:e.bind(n.formatMetersFt,n),unit_key:n.getDepthUnitKey(),defaultChartType:"line",reversed:!0,threshold:0}};for(var h in c)if(c.hasOwnProperty(h)){var p=c[h];c[h]=i.extend(p)}return c}),define("pages/activity_details_2/views/charts/ChartColorMapper",["pages/activity_details_2/views/charts/SeriesTypes"],function(e){var t={red:"#ff0035",royalRed:"#f6192e",orange:"#ed7e00",mango:"#ff9e0d",hatorade:"#daf200",green:"#50b012",lightGreen:"#baf792",peakGreen:"#72ea24",blue:"#11a9ed",lightBlue:"#b0e1f7",skyBlue:"#73d4ff",royalBlue:"#4169E1",babyBlue:"#57c4E8",purple:"#cf23b8",grey:"#888",baseGrey:"#e6e6e6",expandGrey:"#6d8595",performanceGrey:"#7d919f",diveGrey:"#C8D8E3",decoRed:"#D0021B"},n={mapSeriesType:function(n,r){if(n==null)return"";if(n.chartColor&&typeof n.chartColor=="function")return n.chartColor();switch(n.name||n.prototype.name){case e.Elevation.prototype.name:case e.Ascent.prototype.name:return t.green;case e.StrokeRate.prototype.name:case e.SwimStrokes.prototype.name:case e.OpenWaterSwimStrokes.prototype.name:case e.BikeCadence.prototype.name:case e.RunCadence.prototype.name:return t.orange;case e.SwimSwolf.prototype.name:case e.PowerKg.prototype.name:case e.PowerWatts.prototype.name:case e.VerticalRatio.prototype.name:case e.VerticalOscillation.prototype.name:return t.purple;case e.Gforce.prototype.name:case e.HeartRate.prototype.name:case e.HeartRateLapSwimming.prototype.name:return t.red;case e.LeftRightPowerBalance.prototype.name:return"rgba(207,35,184,.5)";case e.LeftPCO.prototype.name:return r?"rgb(191,15,36)":"rgba(191,15,36,.5)";case e.RightPCO.prototype.name:return r?"rgb(255,158,13)":"rgba(255,158,13,.5)";case e.LeftPPStart.prototype.name:return r?"rgb(80,176,18)":"rgba(80,176,18,.5)";case e.LeftPeakPPStart.prototype.name:return r?"rgb(80,176,18)":"rgba(80,176,18,.5)";case e.RightPPStart.prototype.name:return r?"rgb(17,169,237)":"rgba(17,169,237,.5)";case e.RightPeakPPStart.prototype.name:return r?"rgb(17,169,237)":"rgba(17,169,237,.5)";case e.LeftPPEnd.prototype.name:return r?"rgb(80,176,18)":"rgba(80,176,18,.5)";case e.LeftPeakPPEnd.prototype.name:return r?"rgb(80,176,18)":"rgba(80,176,18,.5)";case e.RightPPEnd.prototype.name:return r?"rgb(17,169,237)":"rgba(17,169,237,.5)";case e.RightPeakPPEnd.prototype.name:return r?"rgb(17,169,237)":"rgba(17,169,237,.5)";case e.GroundContactTimeBalance.prototype.name:case e.GroundContactTime.prototype.name:case e.SwimSpeed.prototype.name:case e.SwimPace.prototype.name:case e.Speed.prototype.name:case e.Pace.prototype.name:case e.FloorClimbingPace.prototype.name:case e.OpenWaterSwimPace.prototype.name:case e.OpenWaterSwimSpeed.prototype.name:case e.Position.prototype.name:return t.blue;case e.Temperature.prototype.name:return t.grey;case e.DistancePerStroke.prototype.name:case e.StrideLength.prototype.name:return t.royalBlue;case e.DiveDepth.prototype.name:return t.diveGrey;case e.DecoCeiling.prototype.name:return t.decoRed;default:return""}},getVerticalOscillationColorRange:function(e){return e?{Purple:{zone:"95",range:"6.4",cutoffMin:0,cutoffMax:6.4},Blue:{zone:"70 - 95",range:"6.4 - 8.6",cutoffMin:0,cutoffMax:8.6},Green:{zone:"30 - 69",range:"8.7 - 10.8",cutoffMin:0,cutoffMax:10.8},Orange:{zone:"5 - 29",range:"10.9 - 13.1",cutoffMin:0,cutoffMax:13.1},Red:{zone:"5",range:"13.1",cutoffMin:0,cutoffMax:0}}:{Purple:{zone:"95",range:"6.4",cutoffMin:0,cutoffMax:6.4},Blue:{zone:"70 - 95",range:"6.4 - 8.1",cutoffMin:0,cutoffMax:8.2},Green:{zone:"30 - 69",range:"8.2 - 9.7",cutoffMin:0,cutoffMax:9.8},Orange:{zone:"5 - 29",range:"9.8 - 11.5",cutoffMin:0,cutoffMax:11.6},Red:{zone:"5",range:"11.5",cutoffMin:0,cutoffMax:0}}},getVerticalRatioColorRange:function(e){return e?{Purple:{zone:"95",range:"6.4",cutoffMin:0,cutoffMax:6.4},Blue:{zone:"70 - 95",range:"6.4 - 8.2",cutoffMin:6.4,cutoffMax:8.2},Green:{zone:"30 - 69",range:"8.3 - 9.9",cutoffMin:8.3,cutoffMax:9.9},Orange:{zone:"5 - 29",range:"10.0 - 11.8",cutoffMin:10,cutoffMax:11.8},Red:{zone:"5",range:"11.8",cutoffMin:11.8,cutoffMax:0}}:{Purple:{zone:"95",range:"6.1",cutoffMin:0,cutoffMax:6.1},Blue:{zone:"70 - 95",range:"6.1 - 7.4",cutoffMin:6.1,cutoffMax:7.5},Green:{zone:"30 - 69",range:"7.5 - 8.6",cutoffMin:7.5,cutoffMax:8.7},Orange:{zone:"5 - 29",range:"8.7 - 10.1",cutoffMin:8.7,cutoffMax:10.1},Red:{zone:"5",range:"10.1",cutoffMin:10.1,cutoffMax:0}}},mapStroke:function(e){return e=="FREESTYLE"?t.purple:e=="BACKSTROKE"?t.green:e=="BREASTSTROKE"?t.red:e=="BUTTERFLY"?t.blue:e=="DRILL"?t.orange:e=="MIXED"?t.grey:t.grey}};return n.Colors=t,n});if(Garmin==null)var Garmin={};Garmin.Map==null&&(Garmin.Map={}),Garmin.Map.Listener=function(e,t){if(typeof e=="undefined")throw new Error("Name must not be null");if(typeof t=="undefined")throw new Error("Action must not be null");this.name=e,this.fire=t},Garmin.Map.Event={SWAP_MARKER_ID:"swapmarkerid",ELEVATION_CHANGE:"elevationChange",RESET_ROUTE:"resetRoute"},Garmin.Map.Route=function(){this.distance=0,this.speed=0,this.pace=0,this.seconds=0,this.markers=new Array,this.lines=new Array,this.listeners=new Array,this.metric=!1},Garmin.Map.Route.prototype={addListener:function(e,t){this.listeners.push(new Garmin.Map.Listener(e,t))},removeListeners:function(e){var t=new Array;for(var n=0;n<this.listeners.length;n++){var r=this.listeners[n];r.name!=e&&t.push(r)}this.listeners=t},fireListener:function(e,t){for(var n=0;n<this.listeners.length;n++){var r=this.listeners[n];r.name==e&&r.fire(t)}},addPoint:function(e,t){if(typeof e=="undefined"||e===null)throw"Shape ID required to add point";if(typeof t=="undefined"||t===null)throw"Point required to add point";var n=new Garmin.Map.Marker(e,t);return this.appendMarker(n),n},appendMarker:function(e){if(typeof e=="undefined"||e===null)throw"Marker is required.";if(typeof e.markerId=="undefined"||e.getMarkerId()===null)throw"Marker ID required to add a marker.";var t=this.getMarker(e.getMarkerId());if(t!=null)throw new Error("A marker with id "+e.getMarkerId()+" already exists in the route.");var n=this.getEnd();n!=null&&(n.setNextMarkerId(e.getMarkerId()),e.setPreviousMarkerId(n.getMarkerId())),this.markers.push(e)},prependMarker:function(e){if(typeof e=="undefined"||e===null)throw"Marker is required.";if(typeof e.markerId=="undefined"||e.getMarkerId()===null)throw"Marker ID required to add a marker.";var t=this.getMarker(e.getMarkerId());if(t!=null)throw new Error("A marker with id "+e.getMarkerId()+" already exists in the route.");var n=this.getStart();n!=null&&(n.setPreviousMarkerId(e.getMarkerId()),e.setNextMarkerId(n.getMarkerId())),this.markers.push(e)},insertMarker:function(e){if(typeof e=="undefined"||e===null)throw"Marker is required.";if(typeof e.getMarkerId()=="undefined"||e.getMarkerId()===null)throw"Marker must have an ID.";var t=this.getMarker(e.getMarkerId());if(t!=null)throw new Error("A marker with id "+e.getMarkerId()+" already exists in the route.");if(e.getPreviousMarkerId()==null){var n=this.getStart();n!=null&&(n.setPreviousMarkerId(e.getMarkerId()),e.setNextMarkerId(n.getMarkerId()))}else{var r=this.getMarker(e.getPreviousMarkerId());if(r==null)throw e.getPreviousMarkerId()+" does not exist";r.setNextMarkerId(e.getMarkerId())}if(e.getNextMarkerId()==null){var i=this.getEnd();i.setNextMarkerId(e.getMarkerId()),e.setPreviousMarkerId(i.getMarkerId())}else{var s=this.getMarker(e.getNextMarkerId());s.setPreviousMarkerId(e.getMarkerId())}this.markers.push(e)},getLineForEndMarkers:function(e,t){var n=null;for(var r=0;r<this.lines.length;r++)if(this.lines[r].hasMarkerId(e)&&this.lines[r].hasMarkerId(t)){n=this.lines[r];break}return n},getMarker:function(e){var t=null;if(typeof e!="undefined"&&e!=null)for(var n=0;n<this.markers.length;n++){var r=this.markers[n];if(e===r.getMarkerId()){t=r;break}}return t},removeFirstMarker:function(){var e=this.getStart();if(e!=null){var t=e.getMarkerId(),n=e.getNextMarkerId();this.deleteMarker(t),n!=null&&this.fireListener(Garmin.Map.Event.SWAP_MARKER_ID,{oldMarkerId:t,newMarkerId:n})}},removeLastMarker:function(){var e=this.getEnd();if(e!=null){var t=e.getMarkerId(),n=e.getPreviousMarkerId();this.deleteMarker(t),n!=null&&this.fireListener(Garmin.Map.Event.SWAP_MARKER_ID,{oldMarkerId:t,newMarkerId:n})}},swapMarker:function(e,t){if(e===null||typeof e=="undefined")throw"Old marker Id is required.";if(t===null||typeof t=="undefined")throw"New marker Id is required.";for(var n=0;n<this.markers.length;n++)this.markers[n].swapMarkerIds(e,t);for(var r=0;r<this.lines.length;r++)this.lines[r].swapMarkerIds(e,t);this.fireListener(Garmin.Map.Event.SWAP_MARKER_ID,{oldMarkerId:e,newMarkerId:t})},setLineElevation:function(e,t){var n=this.getLine(e);n!=null&&n.setElevations(t),this.isElevationComplete()&&this.fireListener(Garmin.Map.Event.ELEVATION_CHANGE,{})},setLineElevationError:function(e,t){var n=this.getLine(e);n!=null&&n.setElevations(null),this.isElevationComplete()&&this.fireListener(Garmin.Map.Event.ELEVATION_CHANGE,{})},isElevationComplete:function(){var e,t=this.getLines();for(var n=0;n<t.length;n++){e=t[n];if(e.getElevations()!=null&&e.getElevations().length==0)return!1}return!0},deleteMarker:function(e){var t=new Array;for(var n=0;n<this.markers.length;n++)this.markers[n].getMarkerId()!=e&&(this.markers[n].getPreviousMarkerId()==e&&this.markers[n].setPreviousMarkerId(null),this.markers[n].getNextMarkerId()==e&&this.markers[n].setNextMarkerId(null),t.push(this.markers[n]));this.markers=t},linkAdjacentPointsForDeletedMarker:function(e){if(typeof e=="undefined"&&e===null)throw"linkAdjacentPointsForDeletedMarker: markerId is required.";var t=this.getMarker(e);if(t!=null){if(t.getPreviousMarkerId()!=null){var n=this.getMarker(t.getPreviousMarkerId());typeof n!="undefined"&&n.setNextMarkerId(t.getNextMarkerId())}t.getNextMarkerId()!=null&&(n=this.getMarker(t.getNextMarkerId()),typeof n!="undefined"&&n.setPreviousMarkerId(t.getPreviousMarkerId()))}},addLine:function(e){if(e.getLineId()==null||typeof e.getLineId()=="undefined")throw"Line Id is required to add line.";var t=this.getLine(e.getLineId());if(typeof t!="undefined"&&t!=null)throw"Line Id "+e.getLineId()+" already exists in Route.";if(e.getStartMarkerId()==null||typeof e.getStartMarkerId()=="undefined")throw"Start Element ID is required to add line.";if(e.getEndMarkerId()==null||typeof e.getEndMarkerId()=="undefined")throw"End Element ID is required to add line.";if(e.getDistance()==0){var n=null,r=null,i=0,s=e.getPoints().length-1;for(var o=0;o<s;o++)n=e.getPoints()[o],r=e.getPoints()[o+1],i+=Garmin.Map.Utils.calculateDistanceBetweenPoints(n,r,this.isMetric());e.setDistance(i)}var u=this.getMarker(e.getStartMarkerId());if(u==null)throw"Start marker does not exist.";var a=this.getMarker(e.getEndMarkerId());if(a==null)throw"End marker does not exist.";u.getPreviousMarkerId()==null?u.setDistanceFromStart(0):u.getNextMarkerId()==null&&u.setDistanceFromStart(this.distance),a.setDistanceFromStart(u.getDistanceFromStart()+e.getDistance()),a.getNextMarkerId()==null?(this.distance+=e.getDistance(),this.seconds=Garmin.Map.Utils.calculateTime(this.distance,this.speed)*3600):this.recalculateDistance(),this.lines.push(e)},recalculateDistance:function(){this.distance=0;var e=null,t=null,n=this.getLines();for(var r=0;r<n.length;r++){var i=n[r];e=this.getMarker(i.getStartMarkerId()),e.setDistanceFromStart(this.distance),i.getDistance()==0&&i.setDistance(Garmin.Map.Utils.calculateDistanceOfPoints(i.getPoints(),this.isMetric())),this.distance+=i.getDistance(),t=this.getMarker(i.getEndMarkerId()),t!=null&&t.setDistanceFromStart(this.distance),this.seconds=Garmin.Map.Utils.calculateTime(this.distance,this.speed)*3600}},getLines:function(){var e=new Array,t=this.getStart();while(t!=null){var n=this.getLineByStartingMarkerId(t.getMarkerId());n!=null&&e.push(n),t=this.getMarker(t.getNextMarkerId())}return e},getLine:function(e){if(typeof e=="undefined")throw"lineMarkerId is required";var t=null;for(var n=0;n<this.lines.length;n++){var r=this.lines[n];if(r.getLineId()===e){t=r;break}}return t},joinAdjacentLines:function(e){var t=this.getLineByEndingMarkerId(e),n=this.getLineByStartingMarkerId(e);for(var r=0;r<n.getPoints().length;r++)t.getPoints().push(n.getPoints()[r]);for(var i=0;i<n.getElevations().length;i++)t.getElevations().push(n.getElevations()[i]);t.setEndMarkerId(n.getEndMarkerId()),t.setDistance(t.getDistance()+n.getDistance()),this.deleteLine(n.getLineId())},getLinesForMarkerId:function(e){var t=new Array,n=null,r=null,i=this.getLines();for(var s=0;s<i.length;s++){var o=i[s];o.getEndMarkerId()===e?n=o:o.getStartMarkerId()===e&&(r=o)}return n!=null&&t.push(n),r!=null&&t.push(r),t},getLineByStartingMarkerId:function(e){var t=null;for(var n=0;n<this.lines.length;n++){var r=this.lines[n];if(r.getStartMarkerId()===e){t=r;break}}return t},getLineByEndingMarkerId:function(e){var t=null;for(var n=0;n<this.lines.length;n++){var r=this.lines[n];r.getEndMarkerId()===e&&(t=r)}return t},deleteLine:function(e){var t=new Array;for(var n=0;n<this.lines.length;n++)this.lines[n].getLineId()!=e&&t.push(this.lines[n]);this.lines=t},getDistance:function(){return this.distance},setDistance:function(e){if(typeof e=="undefined"||e===null)throw"Distance is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Distance must be numeric: "+e;this.distance=e},getSpeed:function(){return this.speed},setSpeed:function(e){if(typeof e=="undefined"||e===null)throw"Speed is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Speed must be numeric: "+e;this.speed=e},getPace:function(){return this.pace},setPace:function(e){this.pace=e},getSeconds:function(){return this.seconds},setSeconds:function(e){if(typeof e=="undefined"||e===null)throw"Seconds is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Seconds must be numeric: "+e;this.seconds=e},setMetric:function(e){this.metric=e},isMetric:function(){return this.metric},getStart:function(){var e=null;if(this.markers.length>1){for(var t=0;t<this.markers.length;t++)if(this.markers[t].getPreviousMarkerId()==null){if(e!=null)throw"Duplicate start markers found : "+e.getMarkerId()+", "+this.markers[t].getMarkerId();e=this.markers[t]}}else this.markers.length==1&&(e=this.markers[0]);return e},getEnd:function(){var e=null;if(this.markers.length>1){for(var t=0;t<this.markers.length;t++)if(this.markers[t].getNextMarkerId()==null){if(e!=null)throw"Duplicate end markers found : "+e.getMarkerId()+", "+this.markers[t].getMarkerId();e=this.markers[t]}}else this.markers.length==1&&(e=this.markers[0]);return e},getMarkerCount:function(){return this.markers.length},getPoints:function(){var e=null,t=new Array,n=this.getMarkers(),r=this.getStart();r!=null&&t.push(r.getPoint());for(var i=0;i<n.length;i++){r=n[i],e=this.getLineByStartingMarkerId(r.getMarkerId());if(e!=null)for(var s=1;s<e.getPoints().length;s++)t.push(e.getPoints()[s])}return t},getMarkers:function(){var e=new Array,t=this.getStart();while(t!=null)e.push(t),t=this.getMarker(t.getNextMarkerId());if(this.markers.length!=e.length)throw"Marker Link list error. Found "+e.length+" but there should be "+this.markers.length;return e},reset:function(){this.markers.clear(),this.lines.clear(),this.distance=0,this.seconds=0,this.fireListener(Garmin.Map.Event.RESET_ROUTE,{})},toJSON:function(){var e=new Array;return e.push("{"),e.push(',"distance":'),e.push(this.distance),e.push(',"metric":'),e.push(this.metric),e.push(',"points":'),e.push(this.getPoints().toJSON()),e.push("}"),e.join("")}},Garmin.Map.Marker=function(e,t){if(typeof e=="undefined"||e===null)throw"shapeId is required";if(typeof t=="undefined"||t===null)throw"point is required";this.markerId=e,this.point=t},Garmin.Map.Marker.prototype={previousMarkerId:null,nextMarkerId:null,distanceFromStart:0,getMarkerId:function(){return this.markerId},setMarkerId:function(e){this.markerId=e},getNextMarkerId:function(){return this.nextMarkerId},setNextMarkerId:function(e){this.nextMarkerId=e},getPreviousMarkerId:function(){return this.previousMarkerId},setPreviousMarkerId:function(e){this.previousMarkerId=e},getDistanceFromStart:function(){return this.distanceFromStart},swapMarkerIds:function(e,t){this.getMarkerId()==e&&this.setMarkerId(t),this.getPreviousMarkerId()==e&&this.setPreviousMarkerId(t),this.getNextMarkerId()==e&&this.setNextMarkerId(t)},setDistanceFromStart:function(e){if(typeof e=="undefined"||e===null)throw"Distance is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Distance must be numeric: "+e;this.distanceFromStart=e},getPoint:function(){return this.point},setPoint:function(e){if(typeof e=="undefined"||e===null)throw"A valid point is required.";this.point=e},toJSON:function(){var e=new Array;return e.push("{"),e.push('"markerId":'),e.push('"'+this.markerId+'"'),e.push(',"point":'),e.push(this.point.toJSON()),e.push(", previousMarkerId:"),e.push('"'+this.previousMarkerId+'"'),e.push(", nextMarkerId:"),e.push('"'+this.nextMarkerId+'"'),e.push(', "distanceFromStart":'),e.push(this.distanceFromStart),e.push("}"),e.join("")}},Garmin.Map.Line=function(e,t,n,r){if(typeof e=="undefined"||e===null)throw"lineMarkerId is required.";if(typeof t=="undefined"||t===null)throw"startMarkerId is required.";if(typeof n=="undefined"||n===null)throw"endMarkerId is required.";if(typeof r=="undefined"||r===null)throw"points are required.";if(r.length<2)throw"A minimum of two points are required.";this.lineId=e,this.startMarkerId=t,this.endMarkerId=n,this.points=r,this.elevations=new Array,this.rgb=Garmin.Map.Utils.LINE_COLOR},Garmin.Map.Line.prototype={startMarkerId:null,endMarkerId:null,distance:0,bearing:0,points:new Array,getPoints:function(){return this.points},getLineId:function(){return this.lineId},setLineId:function(e){this.lineId=e},getStartMarkerId:function(){return this.startMarkerId},setStartMarkerId:function(e){this.startMarkerId=e},getEndMarkerId:function(){return this.endMarkerId},setEndMarkerId:function(e){this.endMarkerId=e},getDistance:function(){return this.distance},setDistance:function(e){if(typeof e=="undefined"||e===null)throw"Distance is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Distance must be numeric: "+e;this.distance=e},setElevations:function(e){this.elevations=e},clearElevations:function(){this.elevations=new Array},getElevations:function(){if(typeof this.elevations=="undefined"||this.elevations==null)this.elevations=new Array;return this.elevations},getBearing:function(){return this.bearing},setBearing:function(e){if(typeof e=="undefined"||e===null)throw"Bearing is required.";if(!Garmin.Map.Validator.isNumeric(e))throw"Bearing must be numeric: "+e;this.bearing=e},getRgb:function(){return this.rgb},setRgb:function(e){this.rgb=e},getPoints:function(){return this.points},setPoints:function(e){this.points=e},swapMarkerIds:function(e,t){this.getStartMarkerId()==e&&this.setStartMarkerId(t),this.getEndMarkerId()==e&&this.setEndMarkerId(t)},hasMarkerId:function(e){return this.startMarkerId===e||this.endMarkerId===e},toJSON:function(){var e=new Array;return e.push("{"),e.push('"startMarkerId":'),e.push('"'+this.startMarkerId+'"'),e.push(', "endMarkerId":'),e.push('"'+this.endMarkerId+'"'),e.push(', "distance":'),e.push(this.distance),e.push(', "bearing":'),e.push(this.bearing),e.push(', "points":'),e.push(this.points.toJSON()),e.push("}"),e.join("")},clone:function(){var e=new Garmin.Map.Line(this.lineId,this.startMarkerId,this.endMarkerId,this.points.clone());return e.setDistance(this.distance),e.setBearing(this.bearing),this.elevations!=null&&this.elevations.length>0&&e.setElevations(this.elevations.clone()),e}},Garmin.Map.Point=function(e,t,n){this.lat=parseFloat(e);if(!Garmin.Map.Validator.isValidLatitude(e))throw"Latitude is not valid: "+e;this.lon=parseFloat(t);if(!Garmin.Map.Validator.isValidLongitude(t))throw"Longitude is not valid: "+t;if(typeof n!="undefined"){if(!Garmin.Map.Validator.isNumeric(n))throw"Elevation must be numeric: "+n;this.elevation=parseFloat(n)}},Garmin.Map.Point.prototype={getLat:function(){return this.lat},setLat:function(e){if(!Garmin.Map.Validator.isValidLatitude(e))throw"Latitude is not valid: "+e;this.lat=e},getLon:function(){return this.lon},setLon:function(e){if(!Garmin.Map.Validator.isValidLongitude(e))throw"Longitude is not valid: "+e;this.lon=e},getElevation:function(){return this.elevation},setElevation:function(e){if(!Garmin.Map.Validator.isNumeric(e))throw"Elevation must be numeric: "+e;this.elevation=e},toJSON:function(){return typeof this.elevation=="undefined"&&(this.elevation=0),'{"lat":'+this.lat+', "lon":'+this.lon+', "elevation":'+this.elevation+"}"},toString:function(){var e=this.lat+","+this.lon;return typeof this.elevation!="undefined"&&(e+=","+this.elevation),e}},Garmin.Map.Validator={},Garmin.Map.Validator.isNumeric=function(e){return isNaN(parseFloat(e))?!1:!0},Garmin.Map.Validator.isValidLatitude=function(e){var t=!1;return Garmin.Map.Validator.isNumeric(e)&&Math.abs(e)<91&&(t=!0),t},Garmin.Map.Validator.isValidLongitude=function(e){var t=!1;return Garmin.Map.Validator.isNumeric(e)&&Math.abs(e)<181&&(t=!0),t},Garmin.Map.DirectionCallbackParam=function(e,t){if(typeof e=="undefined"||e===null)throw"marker1 is required";if(typeof t=="undefined"||t===null)throw"marker2 is required";this.marker1=e,this.marker2=t},define("garminmapmodel",function(){}),typeof Number.prototype.toRad=="undefined"&&(Number.prototype.toRad=function(){return this*Math.PI/180}),typeof Number.prototype.toDeg=="undefined"&&(Number.prototype.toDeg=function(){return this*180/Math.PI}),typeof Number.prototype.toPrecisionFixed=="undefined"&&(Number.prototype.toPrecisionFixed=function(e){if(isNaN(this))return"NaN";var t=this<0?-this:this,n=this<0?"-":"";if(t==0){i="0.";while(e--)i+="0";return i}var r=Math.ceil(Math.log(t)*Math.LOG10E),i=String(Math.round(t*Math.pow(10,e-r)));if(r>0){l=r-i.length;while(l-->0)i+="0";r<i.length&&(i=i.slice(0,r)+"."+i.slice(r))}else{while(r++<0)i="0"+i;i="0."+i}return n+i}),typeof String.prototype.trim=="undefined"&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")});if(Garmin==undefined)var Garmin={};Garmin.Map==undefined&&(Garmin.Map={}),Garmin.Map.Utils={MEASURE_STATUTE:"statute",RADIUS_KILOMETERS:6371,RADIUS_MILES:3959,FEET_PER_METER:3.28083989501312,MARKER:"marker-",POLYLINE:"polyline-",LAP_MARKER_URL:"/modern/images/feature/courses/lap-marker-",SHADOW_URL:"/api/activity-search/style/explore/images/pin-shadow.png",METRIC:"metric",GEO_OFFSET:7e-5,GEO_BUFFER:7e-5,BUSY_DIV_ID:"loading-mask",MAP_STYLE_ROAD:"road",MAP_STYLE_SATELLITE:"satellite",MAP_STYLE_HYBRID:"hybrid",MAP_STYLE_AUTO:"auto",MAP_STYLE_TERRAIN:"terrain",MAP_STYLE_BICYCLE:"bicycle",MAP_STYLE_OSM:"osm",PROVIDER_TYPE_BING:"bing",PROVIDER_TYPE_GOOGLE:"google",PROVIDER_TYPE_OSM:"osm",PROVIDER_TYPE_NUMAP:"numap",PROVIDER_TYPE_BAIDU:"BAIDU_V_1_4",PROVIDER_TYPE_MOCK:"mock",MAXIMUM_ELEVATION_SAMPLES:512,MAXIMUM_ELEVATION_PATH_POINTS:375,LINE_COLOR:[255,0,0],LINE_OPACITY:.8,LINE_WIDTH:4,EVENT_MARKER_CHANGED:"changed",EVENT_MOUSE_CLICK:"click",EVENT_MOUSE_DBLCLICK:"doubleclick",EVENT_MOUSE_DOWN:"mousedown",EVENT_MOUSE_OUT:"mouseout",EVENT_MOUSE_OVER:"mouseover",EVENT_MOUSE_UP:"mouseup",EVENT_MOUSE_WHEEL:"mousewheel",EVENT_MOUSE_RIGHT_CLICK:"rightclick",EVENT_MAP_VIEW_CHANGE_START:"viewchangestart",EVENT_MAP_VIEW_CHANGE_END:"viewchangeend",EVENT_MAP_ZOOM_CHANGED:"zoomchanged",EVENT_MAP_IDLE:"idle",EVENT_DRAG_START:"dragstart",EVENT_DRAG_END:"dragend",EVENT_DRAGGING:"dragging",EVENT_TARGET_MAP:"map",EVENT_TARGET_MARKER:"marker",EVENT_TARGET_POLYLINE:"polyline",EVENT_TOGGLE_HEATMAP_ITEMS:"toggleHeatmapItems",EVENT_OSM_MAP_READY:"osmMapReady",LAYER_POLYLINES:"polylineLayer",LAYER_TERMINUS:"terminusLayer",LAYER_MARKERS:"markerLayer",LAYER_SEGMENTS:"segmentsLayer",LAYER_SEGMENT:"segmentLayer",LAYER_DISTANCE_CLOSE:"distanceLayerClose",LAYER_DISTANCE_MEDIUM:"distanceLayerMedium",LAYER_DISTANCE_FAR:"distanceLayerFar",LAYER_DISTANCE_MAX:"distanceLayerMax",heatmapPreferences:null,heatmapFolderDataList:null,heatmapRenderedTileDataList:new Object,activityType:"",findMinMaxPoints:function(e){if(typeof e!="undefined"&&e!=null&&e.length>0){var t=0,n=0,r=null,i=null,s=null,o=null,u=null;for(var a=0;a<e.length;a++){u=e[a],t+=u.lat,n+=u.lon;if(s==null||u.lat>s)s=u.lat;if(r==null||u.lat<r)r=u.lat;if(o==null||u.lon>o)o=u.lon;if(i==null||u.lon<i)i=u.lon}var f={minimum:new Garmin.Map.Point(r,i),maximum:new Garmin.Map.Point(s,o),center:new Garmin.Map.Point(t/e.length,n/e.length)}}return f},calculateDistanceOfPoints:function(e,t){var n=0;if(typeof e!="undefined"){var r,i,s=e.length-1;for(var o=0;o<s;o++)r=e[o],i=e[o+1],n+=this.calculateDistanceBetweenPoints(r,i,t)}return n},calculateDistanceBetweenPoints:function(e,t,n){if(typeof e=="undefined")throw"point 1 is required";if(typeof t=="undefined")throw"point 2 is required";var r=Garmin.Map.Utils.RADIUS_MILES;n&&(r=Garmin.Map.Utils.RADIUS_KILOMETERS);var i=(t.lat-e.lat).toRad(),s=(t.lon-e.lon).toRad(),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e.lat.toRad())*Math.cos(t.lat.toRad())*Math.sin(s/2)*Math.sin(s/2),u=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return r*u},calculateBearingOfPoints:function(e,t){if(typeof e=="undefined")throw"start is required";if(typeof t=="undefined")throw"end is required";var n=e.lat.toRad(),r=t.lat.toRad(),i=(t.lon-e.lon).toRad(),s=Math.sin(i)*Math.cos(r),o=Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(i);return Math.atan2(s,o).toDeg()},calculateDestinationPoint:function(e,t,n,r){if(typeof e=="undefined")throw"point 1 is required";if(typeof t=="undefined")throw"Distance is required";if(typeof n=="undefined")throw"Bearing is required";var i=Garmin.Map.Utils.RADIUS_MILES;r&&(i=Garmin.Map.Utils.RADIUS_KILOMETERS);var s=n.toRad(),o=e.lat.toRad(),u=e.lon.toRad(),a=t/i,f=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(s)),l=u+Math.atan2(Math.sin(s)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(f));return l=(l+3*Math.PI)%(2*Math.PI)-Math.PI,new Garmin.Map.Point(f.toDeg(),l.toDeg())},isExactlyBetweenPoints:function(e,t,n){typeof buffer=="undefined"&&(buffer=0);var r=!1,i=!1;return e.lat<n.lat?r=e.lat<=t.lat&&t.lat<=n.lat:r=e.lat>=t.lat&&t.lat>=n.lat,e.lon<n.lon?i=e.lon<=t.lon&&t.lon<=n.lon:i=e.lon>=t.lon&&t.lon>=n.lon,r&&i},isRoughlyBetweenPoints:function(e,t,n,r){typeof r=="undefined"&&(r=0);var i=!1,s=!1;e.lat<n.lat?i=e.lat<=t.lat&&t.lat<=n.lat:i=e.lat>=t.lat&&t.lat>=n.lat,e.lon<n.lon?s=e.lon<=t.lon&&t.lon<=n.lon:s=e.lon>=t.lon&&t.lon>=n.lon;var o=r,u=r*2;if(!i||!s){var a=0,f=0;s?i||(a=Math.abs(e.lat-t.lat),f=Math.abs(n.lat-t.lat),i=a<o&&f<o):(a=Math.abs(e.lon-t.lon),f=Math.abs(n.lon-t.lon),s=a<u&&f<u)}return i&&s},decodeLine:function(e){var t=0,n=[],r=0,i=0;if(e&&e!=undefined){var s=e.length;while(t<s){var o,u=0,a=0;do o=e.charCodeAt(t++)-63,a|=(o&31)<<u,u+=5;while(o>=32);var f=a&1?~(a>>1):a>>1;r+=f,u=0,a=0;do o=e.charCodeAt(t++)-63,a|=(o&31)<<u,u+=5;while(o>=32);var l=a&1?~(a>>1):a>>1;i+=l,n.push([r*1e-5,i*1e-5])}}return n},calculateTime:function(e,t){return e==0||t==0?0:e/t},calculateSpeed:function(e,t){return e==0||t==0?0:e/t},formatTime:function(e){e=Math.round(e);var t=new Array,n=Math.floor(e/3600);n>0&&(t.push(n),t.push(":"));var r=Math.floor((e-n*3600)/60);r<10&&e>=3600&&t.push(0),t.push(r),t.push(":");var i=Math.floor(e-n*3600-r*60);return i<10&&t.push(0),i.length>2&&(i=i.substring(2)),t.push(i),t.join("")},formatFloat:function(e,t){var n="";if(typeof e!="undefined"){n=e.toFixed(2);var r=n.substr(n.length-1);r=="0"&&(n=n.substr(0,n.length-1),r=n.substr(n.length-1))}return typeof t=="undefined"||t!="decimal_comma"?this.addNumberSeparators(n,",","."):this.addNumberSeparators(n,".",",")},formatSpeed:function(e,t){var n="";return typeof e!="undefined"&&(n=e.toFixed(1)),typeof t=="undefined"||t!="decimal_comma"?this.addNumberSeparators(n,",","."):this.addNumberSeparators(n,".",",")},addNumberSeparators:function(e,t,n){var r;e+="",r=e.split(".");var i=r[0],s=r.length>1?n+r[1]:"",o=/(\d+)(\d{3})/;while(o.test(i))i=i.replace(o,"$1"+t+"$2");return i+s},getCityFolderMatchesForBoundingBoxAndActivityType:function(e,t,n,r,i,s,o){var u="",a=new Array;if(Garmin.Map.Utils.heatmapFolderDataList!=null&&Garmin.Map.Utils.heatmapFolderDataList.length>0)for(var f=0;f<Garmin.Map.Utils.heatmapFolderDataList.length;f++){var l=Garmin.Map.Utils.heatmapFolderDataList[f],c=new Garmin.Map.Point(l.boundBoxNWLatitude,l.boundBoxNWLongitude,0),h=new Garmin.Map.Point(l.boundBoxSELatitude,l.boundBoxSELongitude,0);a.length<3&&l.activityType==n&&Garmin.Map.Utils.doBoundingBoxesIntersect(e,t,c,h)&&(r?Garmin.Map.Utils.doTileCoordindatesHaveRenderedTilesForFolderName(i,s,o,l.folderName,l.folderId)&&(u=l.folderName,a.push(u)):(u=l.folderName,a.push(u)))}return a},getCityFolderMatchesForLocationAndActivityType:function(e,t,n,r,i){var s=Garmin.Map.Utils.minPointToLatLng(e,t,n),o=Garmin.Map.Utils.maxPointToLatLng(e,t,n),u=new Garmin.Map.Point(s.lat,s.lon,0),a=new Garmin.Map.Point(o.lat,o.lon,0);return Garmin.Map.Utils.getCityFolderMatchesForBoundingBoxAndActivityType(u,a,r,i,e,t,n)},getGlobalFolderMatchesForLocationAndActivityType:function(e,t,n,r,i){var s="",o=new Array;if(Garmin.Map.Utils.heatmapFolderDataList!=null&&Garmin.Map.Utils.heatmapFolderDataList.length>0)for(var u=0;u<Garmin.Map.Utils.heatmapFolderDataList.length;u++){var a=Garmin.Map.Utils.heatmapFolderDataList[u];o.length<3&&a.activityType==r&&a.boundBoxNWLatitude==0&&(i?Garmin.Map.Utils.doTileCoordindatesHaveRenderedTilesForFolderName(e,t,n,a.folderName,a.folderId)&&(s=a.folderName,o.push(s)):(s=a.folderName,o.push(s)))}return o},doTileCoordindatesHaveRenderedTilesForFolderName:function(e,t,n,r,i){var s=!1;Garmin.Map.Utils.heatmapRenderedTileDataList[i]==null&&(Garmin.Map.Utils.heatmapRenderedTileDataList[i]=Garmin.Map.Utils.getHeatMapRenderedTileDataForFolder(r));if(Garmin.Map.Utils.heatmapRenderedTileDataList[i]!=null&&Garmin.Map.Utils.heatmapRenderedTileDataList[i].length>0)for(var o=0;o<Garmin.Map.Utils.heatmapRenderedTileDataList[i].length;o++){var u=Garmin.Map.Utils.heatmapRenderedTileDataList[i][o];if(u.tileZoomLevel==n&&u.tileXCoordinate==e&&u.tileYCoordinate==t)return s=!0,s}return s},populateTileUrls:function(e,t,n,r,i){if(e!=null&&e.length>0){if(e[2]!=null){var s=t+Garmin.Map.Utils.heatmapPreferences.heatmapActiveVersion+"/"+e[2]+"/"+n+"/tile_"+r.x+"_"+r.y+".png";i.push(s)}if(e[1]!=null){var o=t+Garmin.Map.Utils.heatmapPreferences.heatmapActiveVersion+"/"+e[1]+"/"+n+"/tile_"+r.x+"_"+r.y+".png";i.push(o)}if(e[0]!=null){var u=t+Garmin.Map.Utils.heatmapPreferences.heatmapActiveVersion+"/"+e[0]+"/"+n+"/tile_"+r.x+"_"+r.y+".png";i.push(u)}}},getHeatMapPreferences:function(){return jQuery.ajax({type:"GET",contentType:"application/json",async:!0,url:"/modern/proxy/image-service/heatmapservice/heatmap/pref",cache:!0,success:function(e,t){Garmin.Map.Utils.heatmapPreferences=e},error:function(e,t,n){e.status!=401&&e.status!=403&&e.status!=404&&Garmin.Map.Utils.log("Error finding heatmap preference data. Status=",e.status,", status text=",e.statusText)}})},getAllHeatMapFolderData:function(e){return jQuery.ajax({type:"GET",contentType:"application/json",async:!0,url:"/modern/proxy/image-service/heatmapservice/heatmap/folders/"+e,cache:!0,success:function(e,t){Garmin.Map.Utils.heatmapFolderDataList=e},error:function(t,n,r){Garmin.Map.Utils.log("Error finding heatmap folder data for version=",e,". Status=",t.status,", status text=",t.statusText)}})},getHeatMapRenderedTileDataForFolder:function(e){var t=null;return jQuery.ajax({type:"GET",contentType:"application/json",async:!1,url:"/modern/proxy/image-service/heatmapservice/heatmap/tiles/"+e+"?version="+Garmin.Map.Utils.heatmapPreferences.heatmapActiveVersion,cache:!0,success:function(e,n){t=e},error:function(t,n,r){Garmin.Map.Utils.log("Error finding heatmap rendered tile data for foldername=",e,". Status=",t.status,", status text=",t.statusText)}}),t},log:function(){typeof console!="undefined"&&typeof console.log!="undefined"&&console.log(arguments)},getHeatMapUrls:function(e,t,n){var r=Garmin.Map.Utils.getNormalizedCoord(e,t,n);if(!r)return null;var i=new Array,s=Garmin.Map.Utils.heatmapPreferences.s3Url+Garmin.Map.Utils.heatmapPreferences.heatmapBaseBucketName+"/";if(n>=Garmin.Map.Utils.heatmapPreferences.heatmapCityZoomLevelStart){var o=Garmin.Map.Utils.getCityFolderMatchesForLocationAndActivityType(e,t,n,Garmin.Map.Utils.activityType,Garmin.Map.Utils.heatmapPreferences.performRenderedTileCheck);Garmin.Map.Utils.populateTileUrls(o,s,n,r,i)}else if(n>=Garmin.Map.Utils.heatmapPreferences.heatmapGlobalZoomLevelStart){var u=Garmin.Map.Utils.getGlobalFolderMatchesForLocationAndActivityType(e,t,n,Garmin.Map.Utils.activityType,Garmin.Map.Utils.heatmapPreferences.performRenderedTileCheck);Garmin.Map.Utils.populateTileUrls(u,s,n,r,i)}return i},getNormalizedCoord:function(e,t,n){var r=1<<n;if(t<0||t>=r)return null;if(e<0||e>=r)e=(e%r+r)%r;return{x:e,y:t}},doBoundingBoxesIntersect:function(e,t,n,r){var i=Math.abs(e.lon+t.lon-n.lon-r.lon),s=Math.abs(e.lat+t.lat-n.lat-r.lat),o=t.lon-e.lon+r.lon-n.lon,u=e.lat-t.lat+n.lat-r.lat;return i<=o&&s<=u?!0:!1},minPointToLatLng:function(e,t,n){var r=e*256,i=t*256;return Garmin.Map.Utils.fromPointToLatLng(r,i,n)},maxPointToLatLng:function(e,t,n){var r=(e+1)*256-1,i=(t+1)*256-1;return Garmin.Map.Utils.fromPointToLatLng(r,i,n)},fromPointToLatLng:function(e,t,n){var r=Garmin.Map.Utils.mapSize(n),i=Garmin.Map.Utils.clip(e,0,r-1)/r-.5,s=.5-Garmin.Map.Utils.clip(t,0,r-1)/r,o=(90-360*Math.atan(Math.exp(-s*2*Math.PI))/Math.PI).toFixed(3),u=(360*i).toFixed(3);return{lat:o,lon:u}},mapSize:function(e){var t=256<<e>>>0;return t},clip:function(e,t,n){return Math.min(Math.max(e,t),n)}},define("garminmap",["garminmapmodel"],function(){}),!function(e){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?e(require("jquery")):"function"==typeof define&&define.amd?define("jquerytimepicker",["jquery"],e):e(jQuery)}(function(e){function t(e){var t=e[0];return t.offsetWidth>0&&t.offsetHeight>0}function n(t){if(t.minTime&&(t.minTime=b(t.minTime)),t.maxTime&&(t.maxTime=b(t.maxTime)),t.durationTime&&"function"!=typeof t.durationTime&&(t.durationTime=b(t.durationTime)),"now"==t.scrollDefault)t.scrollDefault=function(){return t.roundingFunction(b(new Date),t)};else if(t.scrollDefault&&"function"!=typeof t.scrollDefault){var n=t.scrollDefault;t.scrollDefault=function(){return t.roundingFunction(b(n),t)}}else t.minTime&&(t.scrollDefault=function(){return t.roundingFunction(t.minTime,t)});if("string"===e.type(t.timeFormat)&&t.timeFormat.match(/[gh]/)&&(t._twelveHourTime=!0),t.showOnFocus===!1&&-1!=t.showOn.indexOf("focus")&&t.showOn.splice(t.showOn.indexOf("focus"),1),t.disableTimeRanges.length>0){for(var r in t.disableTimeRanges)t.disableTimeRanges[r]=[b(t.disableTimeRanges[r][0]),b(t.disableTimeRanges[r][1])];t.disableTimeRanges=t.disableTimeRanges.sort(function(e,t){return e[0]-t[0]});for(var r=t.disableTimeRanges.length-1;r>0;r--)t.disableTimeRanges[r][0]<=t.disableTimeRanges[r-1][1]&&(t.disableTimeRanges[r-1]=[Math.min(t.disableTimeRanges[r][0],t.disableTimeRanges[r-1][0]),Math.max(t.disableTimeRanges[r][1],t.disableTimeRanges[r-1][1])],t.disableTimeRanges.splice(r,1))}return t}function r(t){var n=t.data("timepicker-settings"),r=t.data("timepicker-list");if(r&&r.length&&(r.remove(),t.data("timepicker-list",!1)),n.useSelect){r=e("<select />",{"class":"ui-timepicker-select"});var o=r}else{r=e("<ul />",{"class":"ui-timepicker-list"});var o=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});o.css({display:"none",position:"absolute"}).append(r)}if(n.noneOption)if(n.noneOption===!0&&(n.noneOption=n.useSelect?"Time...":"None"),e.isArray(n.noneOption)){for(var a in n.noneOption)if(parseInt(a,10)==a){var l=i(n.noneOption[a],n.useSelect);r.append(l)}}else{var l=i(n.noneOption,n.useSelect);r.append(l)}if(n.className&&o.addClass(n.className),(null!==n.minTime||null!==n.durationTime)&&n.showDuration)"function"==typeof n.step?"function":n.step,o.addClass("ui-timepicker-with-duration"),o.addClass("ui-timepicker-step-"+n.step);var c=n.minTime;"function"==typeof n.durationTime?c=b(n.durationTime()):null!==n.durationTime&&(c=n.durationTime);var p=null!==n.minTime?n.minTime:0,d=null!==n.maxTime?n.maxTime:p+w-1;p>d&&(d+=w),d===w-1&&"string"===e.type(n.timeFormat)&&n.show2400&&(d=w);var v=n.disableTimeRanges,E=0,x=v.length,T=n.step;"function"!=typeof T&&(T=function(){return n.step});for(var a=p,N=0;d>=a;N++,a+=60*T(N)){var C=a,k=y(C,n);if(n.useSelect){var L=e("<option />",{value:k});L.text(k)}else{var L=e("<li />");L.addClass(43200>C%86400?"ui-timepicker-am":"ui-timepicker-pm"),L.data("time",86400>=C?C:C%86400),L.text(k)}if((null!==n.minTime||null!==n.durationTime)&&n.showDuration){var A=g(a-c,n.step);if(n.useSelect)L.text(L.text()+" ("+A+")");else{var O=e("<span />",{"class":"ui-timepicker-duration"});O.text(" ("+A+")"),L.append(O)}}x>E&&(C>=v[E][1]&&(E+=1),v[E]&&C>=v[E][0]&&C<v[E][1]&&(n.useSelect?L.prop("disabled",!0):L.addClass("ui-timepicker-disabled"))),r.append(L)}if(o.data("timepicker-input",t),t.data("timepicker-list",o),n.useSelect)t.val()&&r.val(s(b(t.val()),n)),r.on("focus",function(){e(this).data("timepicker-input").trigger("showTimepicker")}),r.on("blur",function(){e(this).data("timepicker-input").trigger("hideTimepicker")}),r.on("change",function(){h(t,e(this).val(),"select")}),h(t,r.val(),"initial"),t.hide().after(r);else{var M=n.appendTo;"string"==typeof M?M=e(M):"function"==typeof M&&(M=M(t)),M.append(o),f(t,r),r.on("mousedown click","li",function(n){t.off("focus.timepicker"),t.on("focus.timepicker-ie-hack",function(){t.off("focus.timepicker-ie-hack"),t.on("focus.timepicker",S.show)}),u(t)||t[0].focus(),r.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),m(t)&&(t.trigger("hideTimepicker"),r.on("mouseup.timepicker click.timepicker","li",function(e){r.off("mouseup.timepicker click.timepicker"),o.hide()}))})}}function i(t,n){var r,i,s;return"object"==typeof t?(r=t.label,i=t.className,s=t.value):"string"==typeof t?r=t:e.error("Invalid noneOption value"),n?e("<option />",{value:s,"class":i,text:r}):e("<li />",{"class":i,text:r}).data("time",String(s))}function s(e,t){return e=t.roundingFunction(e,t),null!==e?y(e,t):void 0}function o(t){if(t.target!=window){var n=e(t.target);n.closest(".ui-timepicker-input").length||n.closest(".ui-timepicker-wrapper").length||(S.hide(),e(document).unbind(".ui-timepicker"),e(window).unbind(".ui-timepicker"))}}function u(e){var t=e.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&t.disableTouchKeyboard}function a(t,n,r){if(!r&&0!==r)return!1;var i=t.data("timepicker-settings"),s=!1,r=i.roundingFunction(r,i);return n.find("li").each(function(t,n){var i=e(n);if("number"==typeof i.data("time"))return i.data("time")==r?(s=i,!1):void 0}),s}function f(e,t){t.find("li").removeClass("ui-timepicker-selected");var n=b(c(e),e.data("timepicker-settings"));if(null!==n){var r=a(e,t,n);if(r){var i=r.offset().top-t.offset().top;(i+r.outerHeight()>t.outerHeight()||0>i)&&t.scrollTop(t.scrollTop()+r.position().top-r.outerHeight()),r.addClass("ui-timepicker-selected")}}}function l(t,n){if(""!==this.value&&"timepicker"!=n){var r=e(this);if(!r.is(":focus")||t&&"change"==t.type){var i=r.data("timepicker-settings"),s=b(this.value,i);if(null===s)return void r.trigger("timeFormatError");var o=!1;null!==i.minTime&&s<i.minTime&&null!==i.maxTime&&s>i.maxTime&&(o=!0),e.each(i.disableTimeRanges,function(){return s>=this[0]&&s<this[1]?(o=!0,!1):void 0}),i.forceRoundTime&&(s=i.roundingFunction(s,i));var u=y(s,i);o?h(r,u,"error")&&r.trigger("timeRangeError"):h(r,u)}}}function c(e){return e.is("input")?e.val():e.data("ui-timepicker-value")}function h(e,t,n){if(e.is("input")){e.val(t);var r=e.data("timepicker-settings");r.useSelect&&"select"!=n&&"initial"!=n&&e.data("timepicker-list").val(s(b(t),r))}return e.data("ui-timepicker-value")!=t?(e.data("ui-timepicker-value",t),"select"==n?e.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=n&&e.trigger("changeTime"),!0):(e.trigger("selectTime"),!1)}function p(e){switch(e.keyCode){case 13:case 9:return;default:e.preventDefault()}}function d(n){var r=e(this),i=r.data("timepicker-list");if(!i||!t(i)){if(40!=n.keyCode)return!0;S.show.call(r.get(0)),i=r.data("timepicker-list"),u(r)||r.focus()}switch(n.keyCode){case 13:return m(r)&&S.hide.apply(this),n.preventDefault(),!1;case 38:var s=i.find(".ui-timepicker-selected");return s.length?s.is(":first-child")||(s.removeClass("ui-timepicker-selected"),s.prev().addClass("ui-timepicker-selected"),s.prev().position().top<s.outerHeight()&&i.scrollTop(i.scrollTop()-s.outerHeight())):(i.find("li").each(function(t,n){return e(n).position().top>0?(s=e(n),!1):void 0}),s.addClass("ui-timepicker-selected")),!1;case 40:return s=i.find(".ui-timepicker-selected"),0===s.length?(i.find("li").each(function(t,n){return e(n).position().top>0?(s=e(n),!1):void 0}),s.addClass("ui-timepicker-selected")):s.is(":last-child")||(s.removeClass("ui-timepicker-selected"),s.next().addClass("ui-timepicker-selected"),s.next().position().top+2*s.outerHeight()>i.outerHeight()&&i.scrollTop(i.scrollTop()+s.outerHeight())),!1;case 27:i.find("li").removeClass("ui-timepicker-selected"),S.hide();break;case 9:S.hide();break;default:return!0}}function v(n){var r=e(this),i=r.data("timepicker-list"),s=r.data("timepicker-settings");if(!i||!t(i)||s.disableTextInput)return!0;switch(n.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:s.typeaheadHighlight?f(r,i):i.hide()}}function m(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),r=null,i=n.find(".ui-timepicker-selected");return i.hasClass("ui-timepicker-disabled")?!1:(i.length&&(r=i.data("time")),null!==r&&("string"!=typeof r&&(r=y(r,t)),h(e,r,"select")),!0)}function g(e,t){e=Math.abs(e);var n,r,i=Math.round(e/60),s=[];return 60>i?s=[i,E.mins]:(n=Math.floor(i/60),r=i%60,30==t&&30==r&&(n+=E.decimal+5),s.push(n),s.push(1==n?E.hr:E.hrs),30!=t&&r&&(s.push(r),s.push(E.mins))),s.join(" ")}function y(t,n){if("number"!=typeof t)return null;var r=parseInt(t%60),i=parseInt(t/60%60),s=parseInt(t/3600%24),o=new Date(1970,0,2,s,i,r,0);if(isNaN(o.getTime()))return null;if("function"===e.type(n.timeFormat))return n.timeFormat(o);for(var u,a,f="",l=0;l<n.timeFormat.length;l++)switch(a=n.timeFormat.charAt(l)){case"a":f+=o.getHours()>11?E.pm:E.am;break;case"A":f+=o.getHours()>11?E.PM:E.AM;break;case"g":u=o.getHours()%12,f+=0===u?"12":u;break;case"G":u=o.getHours(),t===w&&(u=n.show2400?24:0),f+=u;break;case"h":u=o.getHours()%12,0!==u&&10>u&&(u="0"+u),f+=0===u?"12":u;break;case"H":u=o.getHours(),t===w&&(u=n.show2400?24:0),f+=u>9?u:"0"+u;break;case"i":var i=o.getMinutes();f+=i>9?i:"0"+i;break;case"s":r=o.getSeconds(),f+=r>9?r:"0"+r;break;case"\\":l++,f+=n.timeFormat.charAt(l);break;default:f+=a}return f}function b(e,t){if(""===e||null===e)return null;if("object"==typeof e)return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds();if("string"!=typeof e)return e;e=e.toLowerCase().replace(/[\s\.]/g,""),("a"==e.slice(-1)||"p"==e.slice(-1))&&(e+="m");var n="("+E.am.replace(".","")+"|"+E.pm.replace(".","")+"|"+E.AM.replace(".","")+"|"+E.PM.replace(".","")+")?",r=new RegExp("^"+n+"([0-9]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+n+"$"),i=e.match(r);if(!i)return null;var s=parseInt(1*i[2],10);if(s>24){if(t&&t.wrapHours===!1)return null;s%=24}var o=i[1]||i[5],u=s;if(12>=s&&o){var a=o==E.pm||o==E.PM;u=12==s?a?12:0:s+(a?12:0)}var f=1*i[3]||0,l=1*i[4]||0,c=3600*u+60*f+l;if(12>s&&!o&&t&&t._twelveHourTime&&t.scrollDefault){var h=c-t.scrollDefault();0>h&&h>=w/-2&&(c=(c+w/2)%w)}return c}var w=86400,E={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},S={init:function(t){return this.each(function(){var i=e(this),s=[];for(var o in e.fn.timepicker.defaults)i.data(o)&&(s[o]=i.data(o));var u=e.extend({},e.fn.timepicker.defaults,s,t);if(u.lang&&(E=e.extend(E,u.lang)),u=n(u),i.data("timepicker-settings",u),i.addClass("ui-timepicker-input"),u.useSelect)r(i);else{if(i.prop("autocomplete","off"),u.showOn)for(var a in u.showOn)i.on(u.showOn[a]+".timepicker",S.show);i.on("change.timepicker",l),i.on("keydown.timepicker",d),i.on("keyup.timepicker",v),u.disableTextInput&&i.on("keydown.timepicker",p),l.call(i.get(0))}})},show:function(n){var i=e(this),s=i.data("timepicker-settings");if(n&&n.preventDefault(),s.useSelect)return void i.data("timepicker-list").focus();u(i)&&i.blur();var l=i.data("timepicker-list");if(!i.prop("readonly")&&(l&&0!==l.length&&"function"!=typeof s.durationTime||(r(i),l=i.data("timepicker-list")),!t(l))){i.data("ui-timepicker-value",i.val()),f(i,l),S.hide(),l.show();var h={};s.orientation.match(/r/)?h.left=i.offset().left+i.outerWidth()-l.outerWidth()+parseInt(l.css("marginLeft").replace("px",""),10):h.left=i.offset().left+parseInt(l.css("marginLeft").replace("px",""),10);var p;p=s.orientation.match(/t/)?"t":s.orientation.match(/b/)?"b":i.offset().top+i.outerHeight(!0)+l.outerHeight()>e(window).height()+e(window).scrollTop()?"t":"b","t"==p?(l.addClass("ui-timepicker-positioned-top"),h.top=i.offset().top-l.outerHeight()+parseInt(l.css("marginTop").replace("px",""),10)):(l.removeClass("ui-timepicker-positioned-top"),h.top=i.offset().top+i.outerHeight()+parseInt(l.css("marginTop").replace("px",""),10)),l.offset(h);var d=l.find(".ui-timepicker-selected");if(!d.length){var v=b(c(i));null!==v?d=a(i,l,v):s.scrollDefault&&(d=a(i,l,s.scrollDefault()))}if(d&&d.length){var m=l.scrollTop()+d.position().top-d.outerHeight();l.scrollTop(m)}else l.scrollTop(0);return s.stopScrollPropagation&&e(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(t){t.preventDefault();var n=e(this).scrollTop();e(this).scrollTop(n+t.originalEvent.deltaY)}),e(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",o),e(window).on("resize.ui-timepicker",o),s.closeOnWindowScroll&&e(document).on("scroll.ui-timepicker",o),i.trigger("showTimepicker"),this}},hide:function(n){var r=e(this),i=r.data("timepicker-settings");return i&&i.useSelect&&r.blur(),e(".ui-timepicker-wrapper").each(function(){var n=e(this);if(t(n)){var r=n.data("timepicker-input"),i=r.data("timepicker-settings");i&&i.selectOnBlur&&m(r),n.hide(),r.trigger("hideTimepicker")}}),this},option:function(t,i){return"string"==typeof t&&"undefined"==typeof i?e(this).data("timepicker-settings")[t]:this.each(function(){var s=e(this),o=s.data("timepicker-settings"),u=s.data("timepicker-list");"object"==typeof t?o=e.extend(o,t):"string"==typeof t&&(o[t]=i),o=n(o),s.data("timepicker-settings",o),u&&(u.remove(),s.data("timepicker-list",!1)),o.useSelect&&r(s)})},getSecondsFromMidnight:function(){return b(c(this))},getTime:function(e){var t=this,n=c(t);if(!n)return null;var r=b(n);if(null===r)return null;e||(e=new Date);var i=new Date(e);return i.setHours(r/3600),i.setMinutes(r%3600/60),i.setSeconds(r%60),i.setMilliseconds(0),i},isVisible:function(){var e=this,n=e.data("timepicker-list");return!!n&&!!t(n)},setTime:function(e){var t=this,n=t.data("timepicker-settings");if(n.forceRoundTime)var r=s(b(e),n);else var r=y(b(e),n);return e&&null===r&&n.noneOption&&(r=e),h(t,r),t.data("timepicker-list")&&f(t,t.data("timepicker-list")),this},remove:function(){var e=this;if(e.hasClass("ui-timepicker-input")){var t=e.data("timepicker-settings");return e.removeAttr("autocomplete","off"),e.removeClass("ui-timepicker-input"),e.removeData("timepicker-settings"),e.off(".timepicker"),e.data("timepicker-list")&&e.data("timepicker-list").remove(),t.useSelect&&e.show(),e.removeData("timepicker-list"),this}}};e.fn.timepicker=function(t){return this.length?S[t]?this.hasClass("ui-timepicker-input")?S[t].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.timepicker"):S.init.apply(this,arguments):this},e.fn.timepicker.defaults={appendTo:"body",className:null,closeOnWindowScroll:!1,disableTextInput:!1,disableTimeRanges:[],disableTouchKeyboard:!1,durationTime:null,forceRoundTime:!1,maxTime:null,minTime:null,noneOption:!1,orientation:"l",roundingFunction:function(e,t){if(null===e)return null;if("number"!=typeof t.step)return e;var n=e%(60*t.step);return n>=30*t.step?e+=60*t.step-n:e-=n,e==w&&t.show2400?e:e%w},scrollDefault:null,selectOnBlur:!1,show2400:!1,showDuration:!1,showOn:["click","focus"],showOnFocus:!0,step:30,stopScrollPropagation:!1,timeFormat:"g:ia",typeaheadHighlight:!0,useSelect:!1,wrapHours:!0}}),define("views/main/react/ReactDefaultProps",["require","localizer","personalizer","utils/date/DateFormatter","utils/date/DateUtil","utils/date/DateParser","utils/NavigationUtil","models/user/DefaultProfileImage","utils/BadgeUtil","utils/diving/DiveUtil","utils/PersonalRecordTypeMapper","utils/activity/ActivitiesUtil","utils/ActivityTypeCssClassMapper","utils/ActivitySpeedModelUtil","models/calendar/UserCalendarPreferences","utils/WeightClassMapper","views/map/MapViewUtils","utils/parsers/NumberParser","utils/date/TimeUtil","globalize","utils/CalorieUtil","pages/workouts/util/StepUtil","utils/CalendarUtil","utils/Office365Auth","pages/activity_details_2/views/charts/ChartColorMapper","garminmap","jquerytimepicker"],function(e){var t=e("localizer"),n=e("personalizer"),r=e("utils/date/DateFormatter"),i=e("utils/date/DateUtil"),s=e("utils/date/DateParser"),o=e("utils/NavigationUtil"),u=e("models/user/DefaultProfileImage"),a=e("utils/BadgeUtil"),f=e("utils/diving/DiveUtil"),l=e("utils/PersonalRecordTypeMapper"),c=e("utils/activity/ActivitiesUtil"),h=e("utils/ActivityTypeCssClassMapper"),p=e("utils/ActivitySpeedModelUtil"),d=e("models/calendar/UserCalendarPreferences"),v=e("utils/WeightClassMapper"),m=e("views/map/MapViewUtils"),g=e("utils/parsers/NumberParser"),y=e("utils/date/TimeUtil"),b=e("globalize"),w=e("utils/CalorieUtil"),E=e("pages/workouts/util/StepUtil"),S=e(["addthis"]),x=e("utils/CalendarUtil"),T=e("utils/Office365Auth"),N=e("pages/activity_details_2/views/charts/ChartColorMapper"),C=e("garminmap");timepicker=e("jquerytimepicker");var k={store:ConnectReduxStore,Localizer:t,Personalizer:n,DateFormatter:r,DateUtil:i,DateParser:s,NavigationUtil:o,DefaultProfileImage:u,Globalize:b,NumberParser:g,ChartColorMapper:N,TimeUtil:y,utils:{personalRecords:{PersonalRecordTypeMapper:l},badges:{BadgeUtil:a},activities:{ActivitiesUtil:c,ActivityTypeCssClassMapper:h,ActivitySpeedModelUtil:p},calendar:{UserCalendarPreferences:d,CalendarUtil:x,Office365Auth:T},map:{MapViewUtils:m},weight:{WeightClassMapper:new v(n.getMeasurementSystem())},calories:{CalorieUtil:w},workouts:{StepUtil:E},diving:{DiveUtil:f}}};return k}),define("views/main/react/ReactComponentView",["require","views/main/react/ReactDefaultProps"],function(e){var t=e("views/main/react/ReactDefaultProps"),n=function(){this.element=null};return n.prototype.renderComponent=function(e,n,r){var i=window.React.createElement(e,$.extend(!0,{},t,r,{rootElement:n}));this.element=n,window.ReactDOM.render(i,n)},n.prototype.removeComponent=function(){window.ReactDOM.unmountComponentAtNode(this.element)},n}),function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return typeof n=="number"?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.offsetParentCssPosition==="fixed"&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),this.options.helper==="original"&&!e.contains(this.element[0].ownerDocument,this.element[0])?!1:(this.options.revert==="invalid"&&!r||this.options.revert==="valid"&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo==="parent"?this.element[0].parentNode:n.appendTo),r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;if(!i.containment){this.containment=null;return}if(i.containment==="window"){this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment==="document"){this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment.constructor===Array){this.containment=i.containment;return}i.containment==="parent"&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0];if(!r)return;t=n.css("overflow")!=="hidden",this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:i.scrollTop(),left:i.scrollLeft()}),{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=t.pageX,f=t.pageY;return this.offset.scroll||(this.offset.scroll={top:u.scrollTop(),left:u.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t==="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper==="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&t.scrollParent[0].tagName!=="HTML"&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;if(n.scrollParent[0]!==document&&n.scrollParent[0].tagName!=="HTML"){if(!r.axis||r.axis!=="x")n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed);if(!r.axis||r.axis!=="y")n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed)}else{if(!r.axis||r.axis!=="x")t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed));if(!r.axis||r.axis!=="y")t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed))}i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--){u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height;if(g<u-v||m>a+v||b<f-v||y>l+v||!e.contains(p.snapElements[c].item.ownerDocument,p.snapElements[c].item)){p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1;continue}d.snapMode!=="inner"&&(r=Math.abs(f-b)<=v,i=Math.abs(l-y)<=v,s=Math.abs(u-g)<=v,o=Math.abs(a-m)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,d.snapMode!=="outer"&&(r=Math.abs(f-y)<=v,i=Math.abs(l-b)<=v,s=Math.abs(u-m)<=v,o=Math.abs(a-g)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!r.length)return;t=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+r.length)}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&e<t+n}e.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=0,n=e.ui.ddmanager.droppables[this.options.scope];for(;t<n.length;t++)n[t]===this&&n.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){t==="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return!r||(r.currentItem||r.element)[0]===this.element[0]?!1:(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1)},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,t,r){if(!t.offset)return!1;var i,s,o=(e.positionAbs||e.position.absolute).left,u=o+e.helperProportions.width,a=(e.positionAbs||e.position.absolute).top,f=a+e.helperProportions.height,l=t.offset.left,c=l+t.proportions.width,h=t.offset.top,p=h+t.proportions.height;switch(r){case"fit":return l<=o&&u<=c&&h<=a&&f<=p;case"intersect":return l<o+e.helperProportions.width/2&&u-e.helperProportions.width/2<c&&h<a+e.helperProportions.height/2&&f-e.helperProportions.height/2<p;case"pointer":return i=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,s=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,n(s,h,t.proportions.height)&&n(i,l,t.proportions.width);case"touch":return(a>=h&&a<=p||f>=h&&f<=p||a<h&&f>p)&&(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++){if(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))continue;for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions.height=0;continue e}s[r].visible=s[r].element.css("display")!=="none";if(!s[r].visible)continue;o==="mousedown"&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;if(!u)return;this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===i}),s.length&&(r=e.data(s[0],"ui-droppable"),r.greedyChild=u==="isover")),r&&u==="isover"&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this[u==="isout"?"isover":"isout"]=!1,this[u==="isover"?"_over":"_out"].call(this,n),r&&u==="isout"&&(r.isout=!1,r.isover=!0,r._over.call(r,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){function n(e){return parseInt(e,10)||0}function r(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,r,i,s,o=this,u=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor===String){this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={};for(n=0;n<t.length;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i)}this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles){this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize());if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(u.disabled)return;e(this).removeClass("ui-resizable-autohide"),o._handles.show()}).mouseleave(function(){if(u.disabled)return;o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles){r=e(this.handles[n])[0];if(r===t.target||e.contains(r,t.target))i=!0}return!this.options.disabled&&i},_mouseStart:function(t){var r,i,s,o=this.options,u=this.element.position(),a=this.element;return this.resizing=!0,/absolute/.test(a.css("position"))?a.css({position:"absolute",top:a.css("top"),left:a.css("left")}):a.is(".ui-draggable")&&a.css({position:"absolute",top:u.top,left:u.left}),this._renderProxy(),r=n(this.helper.css("left")),i=n(this.helper.css("top")),o.containment&&(r+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:i},this.size=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:r,top:i},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof o.aspectRatio=="number"?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor",s==="auto"?this.axis+"-resize":s),a.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=this.position.top,a=this.position.left,f=this.size.width,l=this.size.height,c=t.pageX-s.left||0,h=t.pageY-s.top||0,p=this._change[o];if(!p)return!1;n=p.apply(this,[t,c,h]),this._updateVirtualBoundaries(t.shiftKey);if(this._aspectRatio||t.shiftKey)n=this._updateRatio(n,t);return n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==u&&(i.top=this.position.top+"px"),this.position.left!==a&&(i.left=this.position.left+"px"),this.size.width!==f&&(i.width=this.size.width+"px"),this.size.height!==l&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,a,f=this.options,l=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&e.ui.hasScroll(n[0],"left")?0:l.sizeDiff.height,s=r?0:l.sizeDiff.width,o={width:l.helper.width()-s,height:l.helper.height()-i},u=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null,a=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null,f.animate||this.element.css(e.extend(o,{top:a,left:u})),l.helper.height(l.size.height),l.helper.width(l.size.width),this._helper&&!f.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,i,s,o,u=this.options;o={minWidth:r(u.minWidth)?u.minWidth:0,maxWidth:r(u.maxWidth)?u.maxWidth:Infinity,minHeight:r(u.minHeight)?u.minHeight:0,maxHeight:r(u.maxHeight)?u.maxHeight:Infinity};if(this._aspectRatio||e)t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,s=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),s<o.maxHeight&&(o.maxHeight=s);this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),i==="sw"&&(e.left=t.left+(n.width-e.width),e.top=null),i==="nw"&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=r(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=r(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=r(e.width)&&t.minWidth&&t.minWidth>e.width,u=r(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,f=this.position.top+this.size.height,l=/sw|nw|w/.test(n),c=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),u&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),s&&(e.height=t.maxHeight),o&&l&&(e.left=a-t.minWidth),i&&l&&(e.left=a-t.maxWidth),u&&c&&(e.top=f-t.minHeight),s&&c&&(e.top=f-t.maxHeight),!e.width&&!e.height&&!e.left&&e.top?e.top=null:!e.width&&!e.height&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length)return;var e,t,n,r,i,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){i=this._proportionallyResizeElements[e];if(!this.borderDif){this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];for(t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0)}i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!=="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,a={width:n.size.width-u,height:n.size.height-o},f=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,l=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(a,l&&f?{top:l,left:f}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,r,i,s,o,u,a,f=e(this).data("ui-resizable"),l=f.options,c=f.element,h=l.containment,p=h instanceof e?h.get(0):/parent/.test(h)?c.parent().get(0):h;if(!p)return;f.containerElement=e(p),/document/.test(h)||h===document?(f.containerOffset={left:0,top:0},f.containerPosition={left:0,top:0},f.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),r=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){r[e]=n(t.css("padding"+i))}),f.containerOffset=t.offset(),f.containerPosition=t.position(),f.containerSize={height:t.innerHeight()-r[3],width:t.innerWidth()-r[1]},i=f.containerOffset,s=f.containerSize.height,o=f.containerSize.width,u=e.ui.hasScroll(p,"left")?p.scrollWidth:o,a=e.ui.hasScroll(p)?p.scrollHeight:s,f.parentData={element:p,left:i.left,top:i.top,width:u,height:a})},resize:function(t){var n,r,i,s,o=e(this).data("ui-resizable"),u=o.options,a=o.containerOffset,f=o.position,l=o._aspectRatio||t.shiftKey,c={top:0,left:0},h=o.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(c=a),f.left<(o._helper?a.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-c.left),l&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=u.helper?a.left:0),f.top<(o._helper?a.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top),l&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?a.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,n=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),r=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-a.top)+o.sizeDiff.height),i=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),i&&s&&(n-=o.parentData.left),n+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-n,l&&(o.size.height=o.size.width/o.aspectRatio)),r+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-r,l&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,f=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof n.alsoResize=="object"&&!n.alsoResize.parentNode?n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)}):r(n.alsoResize)},resize:function(t,n){var r=e(this).data("ui-resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof n.ghost=="string"?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u=typeof n.grid=="number"?[n.grid,n.grid]:n.grid,a=u[0]||1,f=u[1]||1,l=Math.round((r.width-i.width)/a)*a,c=Math.round((r.height-i.height)/f)*f,h=i.width+l,p=i.height+c,d=n.maxWidth&&n.maxWidth<h,v=n.maxHeight&&n.maxHeight<p,m=n.minWidth&&n.minWidth>h,g=n.minHeight&&n.minHeight>p;n.grid=u,m&&(h+=a),g&&(p+=f),d&&(h-=a),v&&(p-=f),/^(se|s|e)$/.test(o)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.top=s.top-c):/^(sw)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.left=s.left-l):(t.size.width=h,t.size.height=p,t.position.top=s.top-c,t.position.left=s.left-l)}})}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,r=this.options;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,i=e.data(this,"selectable-item");if(i)return r=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),i.unselecting=!r,i.selecting=r,i.selected=r,r?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1})},_mouseDrag:function(t){this.dragged=!0;if(this.options.disabled)return;var n,r=this,i=this.options,s=this.opos[0],o=this.opos[1],u=t.pageX,a=t.pageY;return s>u&&(n=u,u=s,s=n),o>a&&(n=a,a=o,o=n),this.helper.css({left:s,top:o,width:u-s,height:a-o}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),f=!1;if(!n||n.element===r.element[0])return;i.tolerance==="touch"?f=!(n.left>u||n.right<s||n.top>a||n.bottom<o):i.tolerance==="fit"&&(f=n.left>s&&n.right<u&&n.top>o&&n.bottom<a),f?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,r._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),r._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&!t.metaKey&&!t.ctrlKey&&!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,r._trigger("unselecting",t,{unselecting:n.element})))}),!1},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&e<t+n}function r(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||r(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=null,i=!1,s=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type==="static")return!1;this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,s.widgetName+"-item")===s)return r=e(this),!1}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)});if(!i)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i,s,o=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&o.cursor!=="auto"&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";for(n=this.items.length-1;n>=0;n--){r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r);if(!s)continue;if(r.instance!==this.currentContainer)continue;if(i!==this.currentItem[0]&&this.placeholder[s===1?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&(this.options.type==="semi-dynamic"?!e.contains(this.element[0],i):!0)){this.direction=s===1?"down":"up";if(this.options.tolerance!=="pointer"&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};if(!s||s==="x")o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);if(!s||s==="y")o.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper==="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=this.options.axis==="x"||r+f>u&&r+f<a,h=this.options.axis==="y"||t+l>s&&t+l<o,p=c&&h;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t=this.options.axis==="x"||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),r=this.options.axis==="y"||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=t&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o==="right"||s==="down"?2:1:s&&(s==="down"?2:1):!1},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s==="right"&&r||s==="left"&&!r:i&&(i==="down"&&t||i==="up"&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--){i=e(a[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s])}u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(n=u.length-1;n>=0;n--)u[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--){i=e(h[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s))}for(n=c.length-1;n>=0;n--){o=c[n][1],u=c[n][0];for(r=0,f=u.length;r<f;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--){r=this.items[n];if(r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0])continue;i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;if(!r.placeholder||r.placeholder.constructor===String)n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),i=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return r==="tr"?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)}):r==="img"&&i.attr("src",t.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(e,i){if(n&&!r.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}};t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,o,u,a,f,l,c,h,p,d=null,v=null;for(i=this.containers.length-1;i>=0;i--){if(e.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(d&&e.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],v=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!d)return;if(this.containers.length===1)this.containers[v].containerCache.over||(this.containers[v]._trigger("over",t,this._uiHash(this)),this.containers[v].containerCache.over=1);else{o=1e4,u=null,p=d.floating||r(this.currentItem),a=p?"left":"top",f=p?"width":"height",l=this.positionAbs[a]+this.offset.click[a];for(s=this.items.length-1;s>=0;s--){if(!e.contains(this.containers[v].element[0],this.items[s].item[0]))continue;if(this.items[s].item[0]===this.currentItem[0])continue;if(p&&!n(this.positionAbs.top+this.offset.click.top,this.items[s].top,this.items[s].height))continue;c=this.items[s].item.offset()[a],h=!1,Math.abs(c-l)>Math.abs(c+this.items[s][f]-l)&&(h=!0,c+=this.items[s][f]),Math.abs(c-l)<o&&(o=Math.abs(c-l),u=this.items[s],this.direction=h?"up":"down")}if(!u&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[v])return;u?this._rearrange(t,u,null,!0):this._rearrange(t,null,this.containers[v].element,!0),this._trigger("change",t,this._uiHash()),this.containers[v]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[v],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[v]._trigger("over",t,this._uiHash(this)),this.containers[v].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper==="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!=="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);if(i.containment==="document"||i.containment==="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r=e(t).css("overflow")!=="hidden",this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return this.cssPosition==="relative"&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){this.reverting=!1;var n,r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)if(this._storedCSS[n]==="auto"||this._storedCSS[n]==="static")this._storedCSS[n]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(n=this.containers.length-1;n>=0;n--)t||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!t){this._trigger("beforeStop",e,this._uiHash());for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!t){for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function h(e,t,n){var r=u[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function p(t){var n=s(),r=n._rgba=[];return t=t.toLowerCase(),c(i,function(e,i){var s,u=i.re.exec(t),a=u&&i.parse(u),f=i.space||"rgba";if(a)return s=n[f](a),n[o[f].cache]=s[o[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,l.transparent),n):l[t]}function d(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var n="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},a=s.support={},f=e("<p>")[0],l,c=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",a.rgba=f.style.backgroundColor.indexOf("rgba")>-1,c(o,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),s.fn=e.extend(s.prototype,{parse:function(n,r,i,u){if(n===t)return this._rgba=[null,null,null,null],this;if(n.jquery||n.nodeType)n=e(n).css(r),r=t;var a=this,f=e.type(n),d=this._rgba=[];r!==t&&(n=[n,r,i,u],f="array");if(f==="string")return this.parse(p(n)||l._default);if(f==="array")return c(o.rgba.props,function(e,t){d[t.idx]=h(n[t.idx],t)}),this;if(f==="object")return n instanceof s?c(o,function(e,t){n[t.cache]&&(a[t.cache]=n[t.cache].slice())}):c(o,function(t,r){var i=r.cache;c(r.props,function(e,t){if(!a[i]&&r.to){if(e==="alpha"||n[e]==null)return;a[i]=r.to(a._rgba)}a[i][t.idx]=h(n[e],t,!0)}),a[i]&&e.inArray(null,a[i].slice(0,3))<0&&(a[i][3]=1,r.from&&(a._rgba=r.from(a[i])))}),this},is:function(e){var t=s(e),n=!0,r=this;return c(o,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],c(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return c(o,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=s(e),r=n._space(),i=o[r],a=this.alpha()===0?s("transparent"):this,f=a[i.cache]||i.to(a._rgba),l=f.slice();return n=n[i.cache],c(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],a=u[r.type]||{};if(o===null)return;s===null?l[i]=o:(a.mod&&(o-s>a.mod/2?s+=a.mod:s-o>a.mod/2&&(s-=a.mod)),l[i]=h((o-s)*t+s,r))}),this[r](l)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=s(t)._rgba;return s(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),s.fn.parse.prototype=s.fn,o.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},o.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(d(o,s,t+1/3)*255),Math.round(d(o,s,t)*255),Math.round(d(o,s,t-1/3)*255),i]},c(o,function(n,i){var o=i.props,u=i.cache,a=i.to,f=i.from;s.fn[n]=function(n){a&&!this[u]&&(this[u]=a(this._rgba));if(n===t)return this[u].slice();var r,i=e.type(n),l=i==="array"||i==="object"?n:arguments,p=this[u].slice();return c(o,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=p[t.idx]),p[t.idx]=h(n,t)}),f?(r=s(f(p)),r[u]=p,r):s(p)},c(o,function(t,i){if(s.fn[t])return;s.fn[t]=function(s){var o=e.type(s),u=t==="alpha"?this._hsla?"hsla":"rgba":n,a=this[u](),f=a[i.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=e.type(s)),s==null&&i.empty?this:(o==="string"&&(l=r.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[i.idx]=s,this[u](a)))}})}),s.hook=function(t){var n=t.split(" ");c(n,function(t,n){e.cssHooks[n]={set:function(t,r){var i,o,u="";if(r!=="transparent"&&(e.type(r)!=="string"||(i=p(r)))){r=s(i||r);if(!a.rgba&&r._rgba[3]!==1){o=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&o&&o.style)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},s.hook(n),e.cssHooks.borderColor={expand:function(e){var t={};return c(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},l=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]]){r=i.length;while(r--)n=i[r],typeof i[n]=="string"&&(s[e.camelCase(n)]=i[n])}else for(n in i)typeof i[n]=="string"&&(s[n]=i[n]);return s}function s(t,n){var i={},s,o;for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var r=e(this),o=r.attr("class")||"",u,f=a.children?r.find("*").addBack():r;f=f.map(function(){var t=e(this);return{el:t,start:i(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({addClass:function(t){return function(n,r,i,s){return r?e.effects.animateClass.call(this,{add:n},r,i,s):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(n,r,i,s){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},r,i,s):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(n){return function(r,i,s,o,u){return typeof i=="boolean"||i===t?s?e.effects.animateClass.call(this,i?{add:r}:{remove:r},s,o,u):n.apply(this,arguments):e.effects.animateClass.call(this,{toggle:r},i,s,o)}}(e.fn.toggleClass),switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function r(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function i(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]?!0:e.isFunction(t)?!0:typeof t=="object"&&!t.effect?!0:!1}e.extend(e.effects,{version:"1.10.3",save:function(e,t){for(var r=0;r<t.length;r++)t[r]!==null&&e.data(n+t[r],e[0].style[t[r]])},restore:function(e,r){var i,s;for(s=0;s<r.length;s++)r[s]!==null&&(i=e.data(n+r[s]),i===t&&(i=""),e.css(r[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function o(n){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(n)&&n()}var r=e(this),i=t.complete,o=t.mode;(r.is(":hidden")?o==="hide":o==="show")?(r[o](),u()):s.call(r[0],t,u)}var t=r.apply(this,arguments),n=t.mode,i=t.queue,s=e.effects.effect[t.effect];return e.fx.off||!s?n?this[n](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):i===!1?this.each(o):this.queue(i||"fx",o)},show:function(e){return function(t){if(i(t))return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(t){if(i(t))return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(t){if(i(t)||typeof t=="boolean")return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery),function(e,t){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),!t.collapsible&&(t.active===!1||t.active==null)&&(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&e.css("height","")},_setOption:function(e,t){if(e==="active"){this._activate(t);return}e==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),e==="collapsible"&&!t&&this.options.active===!1&&this._activate(0),e==="icons"&&(this._destroyIcons(),t&&this._createIcons()),e==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,r=this.options,i=r.heightStyle,s=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var n=e(this),r=n.attr("id"),i=n.next(),s=i.attr("id");r||(r=o+"-header-"+t,n.attr("id",r)),s||(s=o+"-panel-"+t,i.attr("id",s)),n.attr("aria-controls",s),i.attr("aria-labelledby",r)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(r.event),i==="fill"?(t=s.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");if(r==="absolute"||r==="fixed")return;t-=n.outerHeight(!0)}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):i==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];if(n===this.active[0])return;n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1)return;n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active"))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};typeof h=="number"&&(u=h),typeof h=="string"&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration;if(!t.length)return e.animate(i,u,o,p);if(!e.length)return t.animate(r,u,o,p);s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),n.prop!=="height"?f+=n.now:a.options.heightStyle!=="content"&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r,i=this.element[0].nodeName.toLowerCase(),s=i==="textarea",o=i==="input";this.isMultiLine=s?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly")){t=!0,r=!0,n=!0;return}t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t){t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&r.preventDefault();return}if(n)return;var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}},input:function(e){if(r){r=!1,e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target!==t.element[0]&&r.target!==n&&!e.contains(n,r.target)&&t.close()})})},menufocus:function(t,n){if(this.isNewMenu){this.isNewMenu=!1;if(t.originalEvent&&/^mouse/.test(t.originalEvent.type)){this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});return}}var r=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),e==="source"&&this._initSource(),e==="appendTo"&&this.menu.element.appendTo(this._appendTo()),e==="disabled"&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):typeof this.options.source=="string"?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){e=e!=null?e:this._value(),this.term=this._value();if(e.length<this.options.minLength)return this.close(t);if(this._trigger("search",t)===!1)return;return this._search(e)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){t===n&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return typeof t=="string"?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){this._value(this.term),this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(e,t),t.preventDefault()}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch)return;e&&e.length?t=this.options.messages.results(e.length):t=this.options.messages.noResults,this.liveRegion.text(t)}})}(jQuery),function(e,t){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(n=n.replace(/'/g,"\\'"),r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a=this.type==="checkbox"||this.type==="radio",c=a?"":"ui-state-active",h="ui-state-focus";u.label===null&&(u.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(u.disabled)return;this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(u.disabled)return;e(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change"+this.eventNamespace,function(){if(s)return;t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){if(u.disabled)return;s=!1,r=e.pageX,i=e.pageY}).bind("mouseup"+this.eventNamespace,function(e){if(u.disabled)return;if(r!==e.pageX||i!==e.pageY)s=!0})),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null})}).bind("mouseup"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(u.disabled)return!1;(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if(e==="disabled"){t?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){e==="disabled"&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(r.inline?t.parent()[0]:r.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))})}function o(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var n="datepicker",r;e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,r){var i=e(t);r.append=e([]),r.trigger=e([]);if(i.hasClass(this.markerClassName))return;this._attachments(i,r),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(r),e.data(t,n,r),r.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,r){var i=e(t);if(i.hasClass(this.markerClassName))return;i.addClass(this.markerClassName).append(r.dpDiv),e.data(t,n,r),this._setDate(r,this._getDefaultDate(r),!0),this._updateDatepicker(r),this._updateAlternate(r),r.settings.disabled&&this._disableDatepicker(t),r.dpDiv.css("display","block")},_dialogDatepicker:function(t,r,i,s,u){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],n,p)),o(p.settings,s||{}),r=r&&r.constructor===Date?this._formatDate(p,r):r,this._dialogInput.val(r),this._pos=u?u.length?u:[u.pageX,u.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],n,p),this},_destroyDatepicker:function(t){var r,i=e(t),s=e.data(t,n);if(!i.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase(),e.removeData(t,n),r==="input"?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r==="div"||r==="span")&&i.removeClass(this.markerClassName).empty()},_enableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,n)}catch(r){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,i){var s,u,a,f,l=this._getInst(n);if(arguments.length===2&&typeof r=="string")return r==="defaults"?e.extend({},e.datepicker._defaults):l?r==="all"?e.extend({},l.settings):this._get(l,r):null;s=r||{},typeof r=="string"&&(s={},s[r]=i),l&&(this._curInst===l&&this._hideDatepicker(),u=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),o(l.settings,s),a!==null&&s.dateFormat!==t&&s.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),f!==null&&s.dateFormat!==t&&s.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in s&&(s.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,u),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,i,s,u,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{};if(i===!1)return;o(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|=e(this).css("position")==="fixed",!s}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,r=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,i=this._getNumberOfMonths(t),s=i[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),t.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var r,i,s,o,u=this._curInst;if(!u||t&&u!==e.data(t,n))return;this._datepickerShowing&&(r=this._get(u,"showAnim"),i=this._get(u,"duration"),s=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[r]||e.effects[r])?u.dpDiv.hide(r,e.datepicker._get(u,"showOptions"),i,s):u.dpDiv[r==="slideDown"?"slideUp":r==="fadeIn"?"fadeOut":"hide"](r?i:null,s),r||s(),this._datepickerShowing=!1,o=this._get(u,"onClose"),o&&o.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.3"}(jQuery),function(e,t){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},r={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n=this;if(!this._isOpen||this._trigger("beforeClose",t)===!1)return;this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||e(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var n=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return n&&!t&&this._trigger("focus",e),n},open:function(){var t=this;if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._trigger("open")},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE){t.preventDefault(),this.close(t);return}if(t.keyCode!==e.ui.keyCode.TAB)return;var n=this.uiDialog.find(":tabbable"),r=n.filter(":first"),i=n.filter(":last");t.target!==i[0]&&t.target!==this.uiDialog[0]||!!t.shiftKey?(t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey&&(i.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty();if(e.isEmptyObject(n)||e.isArray(n)&&!n.length){this.uiDialog.removeClass("ui-dialog-buttons");return}e.each(n,function(n,r){var i,s;r=e.isFunction(r)?{click:r,text:n}:r,r=e.extend({type:"button"},r),i=r.click,r.click=function(){i.apply(t.element[0],arguments)},s={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function r(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){e(this).addClass("ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",n,r(i))},drag:function(e,n){t._trigger("drag",e,r(n))},stop:function(i,s){n.position=[s.position.left-t.document.scrollLeft(),s.position.top-t.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",i,r(s))}})},_makeResizable:function(){function o(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var t=this,n=this.options,r=n.resizable,i=this.uiDialog.css("position"),s=typeof r=="string"?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:s,start:function(n,r){e(this).addClass("ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",n,o(r))},resize:function(e,n){t._trigger("resize",e,o(n))},stop:function(r,i){n.height=e(this).height(),n.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",r,o(i))}}).css("position",i)},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in n&&(s=!0),e in r&&(o[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var n,r,i=this.uiDialog;e==="dialogClass"&&i.removeClass(this.options.dialogClass).addClass(t);if(e==="disabled")return;this._super(e,t),e==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),e==="buttons"&&this._createButtons(),e==="closeText"&&this.uiDialogTitlebarClose.button({label:""+t}),e==="draggable"&&(n=i.is(":data(ui-draggable)"),n&&!t&&i.draggable("destroy"),!n&&t&&this._makeDraggable()),e==="position"&&this._position(),e==="resizable"&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&typeof t=="string"&&i.resizable("option","handles",t),!r&&t!==!1&&this._makeResizable()),e==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))},_size:function(){var e,t,n,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),n=typeof r.maxHeight=="number"?Math.max(0,r.maxHeight-e):"none",r.height==="auto"?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal)return;var t=this,n=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(r){t._allowInteraction(r)||(r.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(n)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++},_destroyOverlay:function(){if(!this.options.modal)return;this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t=this.options.position,n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()}})}(jQuery),function(e,t){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d=u==="show",v,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"),u=o==="show",a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[],h,p,d,v,m,g;for(h=0;h<r;h++){v=a.top+h*l,g=h-(r-1)/2;for(p=0;p<i;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||p!=="effect",v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};p==="show"&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},t.mode==="toggle"&&p==="show"?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||(p==="show"?b:r),o.to=t.to||(p==="hide"?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}};if(v==="box"||v==="both")s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to));(v==="content"||v==="both")&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from);if(v==="content"||v==="both")c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})});o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o.to.opacity===0&&o.css("opacity",o.from.opacity),p==="hide"&&o.hide(),e.effects.restore(o,y),d||(g==="static"?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return n==="auto"?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery),function(e,t){e.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),n.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,r,i,s,o,u=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:u=!1,r=this.previousFilter||"",i=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),i===r?s=!0:i=r+i,o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())}),n=s&&n.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):n,n.length||(i=String.fromCharCode(t.keyCode),o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}u&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){e==="icons"&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,r;this.blur(e,e&&e.type==="focus"),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&e.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),i<0?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer);if(!this.active)return;this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active})},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true")return;this.timer=this._delay(function(){this._close(),this._open(e)},this.delay)},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(e==="first"||e==="last"?r=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):r=this.active[e+"All"](".ui-menu-item").eq(0));if(!r||!r.length||!this.active)r=this.activeMenu.children(".ui-menu-item")[t]();this.focus(n,r)},nextPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isLastItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r-i<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isFirstItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){function h(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}function d(t){var n=t[0];return n.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=d(b),b[0].preventDefault&&(t.at="left top"),l=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),x[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),S.length===1&&(S[1]=S[0]),t.at[0]==="right"?g.left+=l:t.at[0]==="center"&&(g.left+=l/2),t.at[1]==="bottom"?g.top+=v:t.at[1]==="center"&&(g.top+=v/2),n=h(x.at,l,v),g.left+=n[0],g.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),d=p(this,"marginLeft"),y=p(this,"marginTop"),T=f+d+p(this,"marginRight")+E.width,N=c+y+p(this,"marginBottom")+E.height,C=e.extend({},g),k=h(x.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:d,marginTop:y},e.each(["left","top"],function(r,i){e.ui.position[S[r]]&&e.ui.position[S[r]][i](C,{targetWidth:l,targetHeight:v,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:w,elem:a})}),t.using&&(u=function(e){var n=m.left-C.left,s=n+l-f,o=m.top-C.top,u=o+v-c,h={target:{element:b,left:m.left,top:m.top,width:l,height:v},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),v<c&&i(o+u)<v&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){if(e===t)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,typeof e!="number"&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){e==="max"&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(n.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n));for(t=i.length;t<n;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&t.values.length!==2?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),!this.range||!this.range.length?(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"):this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}),this.range.addClass(n+(t.range==="min"||t.range==="max"?" ui-slider-range-"+t.range:""))):this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));if(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))i=n,s=e(this),o=t}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;t==="range"&&this.options.range===!0&&(n==="min"?(this.options.value=this._values(0),this.options.values=null):n==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;if(this.options.values&&this.options.values.length){n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);i!==undefined&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){if(!t)return;if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()},"mousedown .ui-spinner-button":function(t){function r(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),r.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,r.call(this)});if(this._start(t)===!1)return;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(!e(t.currentTarget).hasClass("ui-state-active"))return;if(this._start(t)===!1)return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(e.height()*.5)&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return!this.spinning&&this._trigger("start",e)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:n})!==!1)this._value(n),this.counter++},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return this.options.min!==null&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return n===-1?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=r.min!==null?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),r.max!==null&&e>r.max?r.max:r.min!==null&&e<r.min?r.min:e},_stop:function(e){if(!this.spinning)return;clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e)},_setOption:function(e,t){if(e==="culture"||e==="numberFormat"){var n=this._parse(this.element.val());this.options[e]=t,this.element.val(this._format(n));return}(e==="max"||e==="min"||e==="step")&&typeof t=="string"&&(t=this._parse(t)),e==="icons"&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),e==="disabled"&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return typeof e=="string"&&e!==""&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),e===""||isNaN(e)?null:e},_format:function(e){return e===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;e!==""&&(n=this._parse(e),n!==null&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function i(){return++n}function s(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var n=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(n.active):this.active=e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,r=location.hash.substring(1);if(t===null){r&&this.tabs.each(function(n,i){if(e(i).attr("aria-controls")===r)return t=n,!1}),t===null&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active")));if(t===null||t===-1)t=this.tabs.length?0:!1}return t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),t===-1&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(this._handlePageNav(t))return;switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:t.preventDefault(),clearTimeout(this.activating),this._activate(r);return;case e.ui.keyCode.ENTER:t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r);return;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))},_panelKeydown:function(t){if(this._handlePageNav(t))return;t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),t<0&&(t=r),t}var r=this.tabs.length-1;while(e.inArray(i(),this.options.disabled)!==-1)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="disabled"){this._setupDisabled(t);return}this._super(e,t),e==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),e==="event"&&this._setupEvents(t),e==="heightStyle"&&this._setupHeightStyle(t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active===!1||!this.anchors.length?(t.active=!1,this.active=e()):this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var i,o,u,a=e(r).uniqueId().attr("id"),f=e(r).closest("li"),l=f.attr("aria-controls");s(r)?(i=r.hash,o=t.element.find(t._sanitizeSelector(i))):(u=t._tabId(f),i="#"+u,o=t.element.find(i),o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),l&&f.data("ui-tabs-aria-controls",l),f.attr({"aria-controls":i.substring(1),"aria-labelledby":a}),o.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n=0,r;r=this.tabs[n];n++)t===!0||e.inArray(n,t)!==-1?e(r).addClass("ui-state-disabled").attr("aria-disabled","true"):e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r=this.element.parent();t==="fill"?(n=r.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if(r==="absolute"||r==="fixed")return;n-=t.outerHeight(!0)}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):t==="auto"&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault();if(s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1)return;n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),!f.length&&!a.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l)},_toggle:function(t,n){function o(){r.running=!1,r._trigger("activate",t,n)}function u(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),i.length&&r.options.show?r._show(i,r.options.show,o):(i.show(),o())}var r=this,i=n.newPanel,s=n.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),u()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),i.length&&s.length?n.oldTab.attr("tabIndex",-1):i.length&&this.tabs.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);if(r[0]===this.active[0])return;r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return typeof e=="string"&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(n){var r=this.options.disabled;if(r===!1)return;n===t?r=!1:(n=this._getIndex(n),e.isArray(r)?r=e.map(r,function(e){return e!==n?e:null}):r=e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(r)},disable:function(n){var r=this.options.disabled;if(r===!0)return;if(n===t)r=!0;else{n=this._getIndex(n);if(e.inArray(n,r)!==-1)return;e.isArray(r)?r=e.merge([n],r).sort():r=[n]}this._setupDisabled(r)},load:function(t,n){t=this._getIndex(t);var r=this,i=this.tabs.eq(t),o=i.find(".ui-tabs-anchor"),u=this._getPanelForTab(i),a={tab:i,panel:u};if(s(o[0]))return;this.xhr=e.ajax(this._ajaxSettings(o,n,a)),this.xhr&&this.xhr.statusText!=="canceled"&&(i.addClass("ui-tabs-loading"),u.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){u.html(e),r._trigger("load",n,a)},1)}).complete(function(e,t){setTimeout(function(){t==="abort"&&r.panels.stop(!1,!0),i.removeClass("ui-tabs-loading"),u.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)}))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}})}(jQuery),function(e){function n(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))}function r(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);i!==-1&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var t=0;e.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var r=this;if(t==="disabled"){this[n?"_disable":"_enable"](),this.options[t]=n;return}this._super(t,n),t==="content"&&e.each(this.tooltips,function(e,t){r._updateContent(t)})},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,r=e(t?t.target:this.element).closest(this.options.items);if(!r.length||r.data("ui-tooltip-id"))return;r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&t.type==="mouseover"&&r.parents().each(function(){var t=e(this),r;t.data("ui-tooltip-open")&&(r=e.Event("blur"),r.target=r.currentTarget=this,n.close(r,!0)),t.attr("title")&&(t.uniqueId(),n.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(r,t)},_updateContent:function(e,t){var n,r=this.options.content,i=this,s=t?t.type:null;if(typeof r=="string")return this._open(t,e,r);n=r.call(e[0],function(n){if(!e.data("ui-tooltip-open"))return;i._delay(function(){t&&(t.type=s),this._open(t,e,n)})}),n&&this._open(t,e,n)},_open:function(t,r,i){function f(e){a.of=e;if(s.is(":hidden"))return;s.position(a)}var s,o,u,a=e.extend({},this.options.position);if(!i)return;s=this._find(r);if(s.length){s.find(".ui-tooltip-content").html(i);return}r.is("[title]")&&(t&&t.type==="mouseover"?r.attr("title",""):r.removeAttr("title")),s=this._tooltip(r),n(r,s.attr("id")),s.find(".ui-tooltip-content").html(i),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:f}),f(t)):s.position(e.extend({of:r},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(u=this.delayedShow=setInterval(function(){s.is(":visible")&&(f(a.of),clearInterval(u))},e.fx.interval)),this._trigger("open",t,{tooltip:s}),o={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=r[0],this.close(n,!0)}},remove:function(){this._removeTooltip(s)}};if(!t||t.type==="mouseover")o.mouseleave="close";if(!t||t.type==="focusin")o.focusout="close";this._on(!0,r,o)},close:function(t){var n=this,i=e(t?t.currentTarget:this.element),s=this._find(i);if(this.closing)return;clearInterval(this.delayedShow),i.data("ui-tooltip-title")&&i.attr("title",i.data("ui-tooltip-title")),r(i),s.stop(!0),this._hide(s,this.options.hide,function(){n._removeTooltip(e(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),t&&t.type==="mouseleave"&&e.each(this.parents,function(t,r){e(r.element).attr("title",r.title),delete n.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:s}),this.closing=!1},_tooltip:function(n){var r="ui-tooltip-"+t++,i=e("<div>").attr({id:r,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[r]=n,i},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery),define("jqueryui",["jquery"],function(){}),!function(e){e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){s.trigger("closed").remove()}var r=e(this),i=r.attr("data-target"),s;i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),s=e(i),t&&t.preventDefault(),s.length||(s=r.hasClass("alert")?r:r.parent()),s.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.on(e.support.transition.end,n):n()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){function t(){e(".dropdown-backdrop").remove(),e(r).each(function(){n(e(this)).removeClass("open")})}function n(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var r="[data-toggle=dropdown]",i=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(r){var i=e(this),s,o;if(i.is(".disabled, :disabled"))return;return s=n(i),o=s.hasClass("open"),t(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",t),s.toggleClass("open")),i.focus(),!1},keydown:function(t){var i,s,o,u,a,f;if(!/(38|40|27)/.test(t.keyCode))return;i=e(this),t.preventDefault(),t.stopPropagation();if(i.is(".disabled, :disabled"))return;u=n(i),a=u.hasClass("open");if(!a||a&&t.keyCode==27)return t.which==27&&u.find(r).focus(),i.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),t.keyCode==38&&f>0&&f--,t.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("dropdown");r||n.data("dropdown",r=new i(this)),typeof t=="string"&&r[t].call(n)})},e.fn.dropdown.Constructor=i,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",r,i.prototype.toggle).on("keydown.dropdown.data-api",r+", [role=menu]",i.prototype.keydown)}(window.jQuery),!function(e){var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){r.off(e.support.transition.end).detach()},500);r.one(e.support.transition.end,function(){clearTimeout(t),r.detach()})}var n=this,r=this.tip(),i=e.Event("hide");this.$element.trigger(i);if(i.isDefaultPrevented())return;return r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():r.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var s=n.find("> .active"),o=r&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,i):i(),s.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery),define("twitterbootstrap",["jquery","jqueryui"],function(){}),function(e,t){"object"==typeof module&&module.exports?module.exports=e.document?t(e):t:e.Highcharts=t(e)}("undefined"!=typeof window?window:this,function(e){return e=function(){var e=window,t=e.document,n=e.navigator&&e.navigator.userAgent||"",r=t&&t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,i=/(edge|msie|trident)/i.test(n)&&!window.opera,s=!r,o=/Firefox/.test(n),u=o&&4>parseInt(n.split("Firefox/")[1],10);return e.Highcharts?e.Highcharts.error(16,!0):{product:"Highcharts",version:"5.0.0",deg2rad:2*Math.PI/360,doc:t,hasBidiBug:u,isMS:i,isWebKit:/AppleWebKit/.test(n),isFirefox:o,isTouchDevice:/(Mobile|Android|Windows Phone)/.test(n),SVG_NS:"http://www.w3.org/2000/svg",idCounter:0,chartCount:0,seriesTypes:{},svg:r,vml:s,win:e,charts:[],marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){}}}(),function(e){var t=[],n=e.charts,r=e.doc,i=e.win;e.error=function(e,t){var n="Highcharts error #"+e+": www.highcharts.com/errors/"+e;if(t)throw Error(n);i.console&&console.log(n)},e.Fx=function(e,t,n){this.options=t,this.elem=e,this.prop=n},e.Fx.prototype={dSetter:function(){var e=this.paths[0],t=this.paths[1],n=[],r=this.now,i=e.length,s;if(1===r)n=this.toD;else if(i===t.length&&1>r)for(;i--;)s=parseFloat(e[i]),n[i]=isNaN(s)?e[i]:r*parseFloat(t[i]-s)+s;else n=t;this.elem.attr("d",n)},update:function(){var e=this.elem,t=this.prop,n=this.now,r=this.options.step;this[t+"Setter"]?this[t+"Setter"]():e.attr?e.element&&e.attr(t,n):e.style[t]=n+this.unit,r&&r.call(e,n,this)},run:function(e,n,r){var i=this,s=function(e){return s.stopped?!1:i.step(e)},o;this.startTime=+(new Date),this.start=e,this.end=n,this.unit=r,this.now=this.start,this.pos=0,s.elem=this.elem,s()&&1===t.push(s)&&(s.timerId=setInterval(function(){for(o=0;o<t.length;o++)t[o]()||t.splice(o--,1);t.length||clearInterval(s.timerId)},13))},step:function(e){var t=+(new Date),n,r=this.options;n=this.elem;var i=r.complete,s=r.duration,o=r.curAnim,u;if(n.attr&&!n.element)n=!1;else if(e||t>=s+this.startTime){this.now=this.end,this.pos=1,this.update(),e=o[this.prop]=!0;for(u in o)!0!==o[u]&&(e=!1);e&&i&&i.call(n),n=!1}else this.pos=r.easing((t-this.startTime)/s),this.now=this.start+(this.end-this.start)*this.pos,this.update(),n=!0;return n},initPath:function(t,n,r){function i(e){for(v=e.length;v--;)"M"!==e[v]&&"L"!==e[v]||e.splice(v+1,0,e[v+1],e[v+2],e[v+1],e[v+2])}function s(e,t){for(;e.length<p;){e[0]=t[p-e.length];var n=e.slice(0,h);[].splice.apply(e,[0,0].concat(n)),m&&(n=e.slice(e.length-h),[].splice.apply(e,[e.length,0].concat(n)),v--)}e[0]="M"}function o(e,t){for(var n=(p-e.length)/h;0<n&&n--;)d=e.slice().splice(e.length/g-h,h*g),d[0]=t[p-h-n*h],c&&(d[h-6]=d[h-2],d[h-5]=d[h-1]),[].splice.apply(e,[e.length/g,0].concat(d)),m&&n--}n=n||"";var u,f=t.startX,l=t.endX,c=-1<n.indexOf("C"),h=c?7:3,p,d,v;n=n.split(" "),r=r.slice();var m=t.isArea,g=m?2:1,y;c&&(i(n),i(r));if(f&&l){for(v=0;v<f.length;v++){if(f[v]===l[0]){u=v;break}if(f[0]===l[l.length-f.length+v]){u=v,y=!0;break}}void 0===u&&(n=[])}return n.length&&e.isNumber(u)&&(p=r.length+u*g*h,y?(s(n,r),o(r,n)):(s(r,n),o(n,r))),[n,r]}},e.extend=function(e,t){var n;e||(e={});for(n in t)e[n]=t[n];return e},e.merge=function(){var t,n=arguments,r,i={},s=function(t,n){var r,i;"object"!=typeof t&&(t={});for(i in n)n.hasOwnProperty(i)&&(r=n[i],e.isObject(r,!0)&&"renderTo"!==i&&"number"!=typeof r.nodeType?t[i]=s(t[i]||{},r):t[i]=n[i]);return t};!0===n[0]&&(i=n[1],n=Array.prototype.slice.call(n,2)),r=n.length;for(t=0;t<r;t++)i=s(i,n[t]);return i},e.pInt=function(e,t){return parseInt(e,t||10)},e.isString=function(e){return"string"==typeof e},e.isArray=function(e){return e=Object.prototype.toString.call(e),"[object Array]"===e||"[object Array Iterator]"===e},e.isObject=function(t,n){return t&&"object"==typeof t&&(!n||!e.isArray(t))},e.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},e.erase=function(e,t){for(var n=e.length;n--;)if(e[n]===t){e.splice(n,1);break}},e.defined=function(e){return void 0!==e&&null!==e},e.attr=function(t,n,r){var i,s;if(e.isString(n))e.defined(r)?t.setAttribute(n,r):t&&t.getAttribute&&(s=t.getAttribute(n));else if(e.defined(n)&&e.isObject(n))for(i in n)t.setAttribute(i,n[i]);return s},e.splat=function(t){return e.isArray(t)?t:[t]},e.syncTimeout=function(e,t,n){if(t)return setTimeout(e,t,n);e.call(0,n)},e.pick=function(){var e=arguments,t,n,r=e.length;for(t=0;t<r;t++)if(n=e[t],void 0!==n&&null!==n)return n},e.css=function(t,n){e.isMS&&!e.svg&&n&&void 0!==n.opacity&&(n.filter="alpha(opacity="+100*n.opacity+")"),e.extend(t.style,n)},e.createElement=function(t,n,i,s,o){t=r.createElement(t);var u=e.css;return n&&e.extend(t,n),o&&u(t,{padding:0,border:"none",margin:0}),i&&u(t,i),s&&s.appendChild(t),t},e.extendClass=function(t,n){var r=function(){};return r.prototype=new t,e.extend(r.prototype,n),r},e.pad=function(e,t,n){return Array((t||2)+1-String(e).length).join(n||0)+e},e.relativeLength=function(e,t){return/%$/.test(e)?t*parseFloat(e)/100:parseFloat(e)},e.wrap=function(e,t,n){var r=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(r),n.apply(this,e)}},e.getTZOffset=function(t){var n=e.Date;return 6e4*(n.hcGetTimezoneOffset&&n.hcGetTimezoneOffset(t)||n.hcTimezoneOffset||0)},e.dateFormat=function(t,n,r){if(!e.defined(n)||isNaN(n))return e.defaultOptions.lang.invalidDate||"";t=e.pick(t,"%Y-%m-%d %H:%M:%S");var i=e.Date,s=new i(n-e.getTZOffset(n)),o,u=s[i.hcGetHours](),f=s[i.hcGetDay](),l=s[i.hcGetDate](),c=s[i.hcGetMonth](),h=s[i.hcGetFullYear](),p=e.defaultOptions.lang,d=p.weekdays,v=p.shortWeekdays,m=e.pad,i=e.extend({a:v?v[f]:d[f].substr(0,3),A:d[f],d:m(l),e:m(l,2," "),w:f,b:p.shortMonths[c],B:p.months[c],m:m(c+1),y:h.toString().substr(2,2),Y:h,H:m(u),k:u,I:m(u%12||12),l:u%12||12,M:m(s[i.hcGetMinutes]()),p:12>u?"AM":"PM",P:12>u?"am":"pm",S:m(s.getSeconds()),L:m(Math.round(n%1e3),3)},e.dateFormats);for(o in i)for(;-1!==t.indexOf("%"+o);)t=t.replace("%"+o,"function"==typeof i[o]?i[o](n):i[o]);return r?t.substr(0,1).toUpperCase()+t.substr(1):t},e.formatSingle=function(t,n){var r=/\.([0-9])/,i=e.defaultOptions.lang;return/f$/.test(t)?(r=(r=t.match(r))?r[1]:-1,null!==n&&(n=e.numberFormat(n,r,i.decimalPoint,-1<t.indexOf(",")?i.thousandsSep:""))):n=e.dateFormat(t,n),n},e.format=function(t,n){for(var r="{",i=!1,s,o,u,f,l=[],c;t;){r=t.indexOf(r);if(-1===r)break;s=t.slice(0,r);if(i){s=s.split(":"),o=s.shift().split("."),f=o.length,c=n;for(u=0;u<f;u++)c=c[o[u]];s.length&&(c=e.formatSingle(s.join(":"),c)),l.push(c)}else l.push(s);t=t.slice(r+1),r=(i=!i)?"}":"{"}return l.push(t),l.join("")},e.getMagnitude=function(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))},e.normalizeTickInterval=function(t,n,r,i,s){var o,u=t;r=e.pick(r,1),o=t/r,n||(n=[1,2,2.5,5,10],!1===i&&(1===r?n=[1,2,5,10]:.1>=r&&(n=[1/r])));for(i=0;i<n.length&&!(u=n[i],s&&u*r>=t||!s&&o<=(n[i]+(n[i+1]||n[i]))/2);i++);return u*r},e.stableSort=function(e,t){var n=e.length,r,i;for(i=0;i<n;i++)e[i].safeI=i;e.sort(function(e,n){return r=t(e,n),0===r?e.safeI-n.safeI:r});for(i=0;i<n;i++)delete e[i].safeI},e.arrayMin=function(e){for(var t=e.length,n=e[0];t--;)e[t]<n&&(n=e[t]);return n},e.arrayMax=function(e){for(var t=e.length,n=e[0];t--;)e[t]>n&&(n=e[t]);return n},e.destroyObjectProperties=function(e,t){for(var n in e)e[n]&&e[n]!==t&&e[n].destroy&&e[n].destroy(),delete e[n]},e.discardElement=function(t){var n=e.garbageBin;n||(n=e.createElement("div")),t&&n.appendChild(t),n.innerHTML=""},e.correctFloat=function(e,t){return parseFloat(e.toPrecision(t||14))},e.setAnimation=function(t,n){n.renderer.globalAnimation=e.pick(t,n.options.chart.animation,!0)},e.animObject=function(t){return e.isObject(t)?e.merge(t):{duration:t?500:0}},e.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},e.numberFormat=function(t,n,r,i){t=+t||0,n=+n;var s=e.defaultOptions.lang,o=(t.toString().split(".")[1]||"").length,u,f,l=Math.abs(t);return-1===n?n=Math.min(o,20):e.isNumber(n)||(n=2),u=String(e.pInt(l.toFixed(n))),f=3<u.length?u.length%3:0,r=e.pick(r,s.decimalPoint),i=e.pick(i,s.thousandsSep),t=(0>t?"-":"")+(f?u.substr(0,f)+i:""),t+=u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+i),n&&(i=Math.abs(l-u+Math.pow(10,-Math.max(n,o)-1)),t+=r+i.toFixed(n).slice(2)),t},Math.easeInOutSine=function(e){return-0.5*(Math.cos(Math.PI*e)-1)},e.getStyle=function(t,n){var r;return"width"===n?Math.min(t.offsetWidth,t.scrollWidth)-e.getStyle(t,"padding-left")-e.getStyle(t,"padding-right"):"height"===n?Math.min(t.offsetHeight,t.scrollHeight)-e.getStyle(t,"padding-top")-e.getStyle(t,"padding-bottom"):(r=i.getComputedStyle(t,void 0))&&e.pInt(r.getPropertyValue(n))},e.inArray=function(e,t){return t.indexOf?t.indexOf(e):[].indexOf.call(t,e)},e.grep=function(e,t){return[].filter.call(e,t)},e.map=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++)n[r]=t.call(e[r],e[r],r,e);return n},e.offset=function(e){var t=r.documentElement;return e=e.getBoundingClientRect(),{top:e.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}},e.stop=function(e){for(var n=t.length;n--;)t[n].elem===e&&(t[n].stopped=!0)},e.each=function(e,t,n){return Array.prototype.forEach.call(e,t,n)},e.addEvent=function(e,t,n){function r(t){t.target=t.srcElement||i,n.call(e,t)}var s=e.hcEvents=e.hcEvents||{};e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e.hcEventsIE||(e.hcEventsIE={}),e.hcEventsIE[n.toString()]=r,e.attachEvent("on"+t,r)),s[t]||(s[t]=[]),s[t].push(n)},e.removeEvent=function(t,n,r){function i(e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.attachEvent&&(n=t.hcEventsIE[n.toString()],t.detachEvent("on"+e,n))}function s(){var e,r;if(t.nodeName)for(r in n?(e={},e[n]=!0):e=u,e)if(u[r])for(e=u[r].length;e--;)i(r,u[r][e])}var o,u=t.hcEvents,f;u&&(n?(o=u[n]||[],r?(f=e.inArray(r,o),-1<f&&(o.splice(f,1),u[n]=o),i(n,r)):(s(),u[n]=[])):(s(),t.hcEvents={}))},e.fireEvent=function(t,n,i,s){var o;o=t.hcEvents;var u,f;i=i||{};if(r.createEvent&&(t.dispatchEvent||t.fireEvent))o=r.createEvent("Events"),o.initEvent(n,!0,!0),e.extend(o,i),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent(n,o);else if(o)for(o=o[n]||[],u=o.length,i.target||e.extend(i,{preventDefault:function(){i.defaultPrevented=!0},target:t,type:n}),n=0;n<u;n++)(f=o[n])&&!1===f.call(t,i)&&i.preventDefault();s&&!i.defaultPrevented&&s(i)},e.animate=function(t,n,r){var i,s="",o,u,f;e.isObject(r)||(i=arguments,r={duration:i[2],easing:i[3],complete:i[4]}),e.isNumber(r.duration)||(r.duration=400),r.easing="function"==typeof r.easing?r.easing:Math[r.easing]||Math.easeInOutSine,r.curAnim=e.merge(n);for(f in n)u=new e.Fx(t,r,f),o=null,"d"===f?(u.paths=u.initPath(t,t.d,n.d),u.toD=n.d,i=0,o=1):t.attr?i=t.attr(f):(i=parseFloat(e.getStyle(t,f))||0,"opacity"!==f&&(s="px")),o||(o=n[f]),o.match&&o.match("px")&&(o=o.replace(/px/g,"")),u.run(i,o,s)},e.seriesType=function(t,n,r,i,s){var o=e.getOptions(),u=e.seriesTypes;return o.plotOptions[t]=e.merge(o.plotOptions[n],r),u[t]=e.extendClass(u[n]||function(){},i),u[t].prototype.type=t,s&&(u[t].prototype.pointClass=e.extendClass(e.Point,s)),u[t]},i.jQuery&&(i.jQuery.fn.highcharts=function(){var t=[].slice.call(arguments);if(this[0])return t[0]?(new(e[e.isString(t[0])?t.shift():"Chart"])(this[0],t[0],t[1]),this):n[e.attr(this[0],"data-highcharts-chart")]}),r&&!r.defaultView&&(e.getStyle=function(t,n){var r;return r={width:"clientWidth",height:"clientHeight"}[n],t.style[n]?e.pInt(t.style[n]):("opacity"===n&&(n="filter"),r?(t.style.zoom=1,Math.max(t[r]-2*e.getStyle(t,"padding"),0)):(r=t.currentStyle[n.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()})],"filter"===n&&(r=r.replace(/alpha\(opacity=([0-9]+)\)/,function(e,t){return t/100})),""===r?1:e.pInt(r)))}),Array.prototype.forEach||(e.each=function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(!1===t.call(n,e[r],r,e))return r}),Array.prototype.indexOf||(e.inArray=function(e,t){var n,r=0;if(t)for(n=t.length;r<n;r++)if(t[r]===e)return r;return-1}),Array.prototype.filter||(e.grep=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n})}(e),function(e){var t=e.each,n=e.isNumber,r=e.map,i=e.merge,s=e.pInt;e.Color=function(t){if(!(this instanceof e.Color))return new e.Color(t);this.init(t)},e.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(e){return[s(e[1]),s(e[2]),s(e[3]),parseFloat(e[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[s(e[1],16),s(e[2],16),s(e[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(e){return[s(e[1]),s(e[2]),s(e[3]),1]}}],names:{white:"#ffffff",black:"#000000"},init:function(t){var n,i,s,o;if((this.input=t=this.names[t]||t)&&t.stops)this.stops=r(t.stops,function(t){return new e.Color(t[1])});else for(s=this.parsers.length;s--&&!i;)o=this.parsers[s],(n=o.regex.exec(t))&&(i=o.parse(n));this.rgba=i||[]},get:function(e){var r=this.input,s=this.rgba,o;return this.stops?(o=i(r),o.stops=[].concat(o.stops),t(this.stops,function(t,n){o.stops[n]=[o.stops[n][0],t.get(e)]})):o=s&&n(s[0])?"rgb"===e||!e&&1===s[3]?"rgb("+s[0]+","+s[1]+","+s[2]+")":"a"===e?s[3]:"rgba("+s.join(",")+")":r,o},brighten:function(e){var r,i=this.rgba;if(this.stops)t(this.stops,function(t){t.brighten(e)});else if(n(e)&&0!==e)for(r=0;3>r;r++)i[r]+=s(255*e),0>i[r]&&(i[r]=0),255<i[r]&&(i[r]=255);return this},setOpacity:function(e){return this.rgba[3]=e,this}},e.color=function(t){return new e.Color(t)}}(e),function(e){var t,n,r=e.addEvent,i=e.animate,s=e.attr,o=e.charts,u=e.color,a=e.css,f=e.createElement,l=e.defined,c=e.deg2rad,h=e.destroyObjectProperties,p=e.doc,d=e.each,v=e.extend,m=e.erase,g=e.grep,y=e.hasTouch,b=e.isArray,w=e.isFirefox,E=e.isMS,S=e.isObject,x=e.isString,T=e.isWebKit,N=e.merge,C=e.noop,k=e.pick,L=e.pInt,A=e.removeEvent,O=e.stop,M=e.svg,_=e.SVG_NS,D=e.win;t=e.SVGElement=function(){return this},t.prototype={opacity:1,SVG_NS:_,textProps:"direction fontSize fontWeight fontFamily fontStyle color lineHeight width textDecoration textOverflow textShadow".split(" "),init:function(e,t){this.element="span"===t?f(t):p.createElementNS(this.SVG_NS,t),this.renderer=e},animate:function(e,t,n){return t=k(t,this.renderer.globalAnimation,!0),O(this),t?(n&&(t.complete=n),i(this,e,t)):this.attr(e,null,n),this},colorGradient:function(t,n,r){var i=this.renderer,s,o,u,a,f,c,h,p,v,m,g,y=[],w;t.linearGradient?o="linearGradient":t.radialGradient&&(o="radialGradient");if(o){u=t[o],f=i.gradients,h=t.stops,m=r.radialReference,b(u)&&(t[o]=u={x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===o&&m&&!l(u.gradientUnits)&&(a=u,u=N(u,i.getRadialAttr(m,a),{gradientUnits:"userSpaceOnUse"}));for(g in u)"id"!==g&&y.push(g,u[g]);for(g in h)y.push(h[g]);y=y.join(","),f[y]?m=f[y].attr("id"):(u.id=m="highcharts-"+e.idCounter++,f[y]=c=i.createElement(o).attr(u).add(i.defs),c.radAttr=a,c.stops=[],d(h,function(t){0===t[1].indexOf("rgba")?(s=e.color(t[1]),p=s.get("rgb"),v=s.get("a")):(p=t[1],v=1),t=i.createElement("stop").attr({offset:t[0],"stop-color":p,"stop-opacity":v}).add(c),c.stops.push(t)})),w="url("+i.url+"#"+m+")",r.setAttribute(n,w),r.gradient=y,t.toString=function(){return w}}},applyTextShadow:function(e){var t=this.element,n,r=-1!==e.indexOf("contrast"),i={},o=this.renderer.forExport,u=this.renderer.forExport||void 0!==t.style.textShadow&&!E;r&&(i.textShadow=e=e.replace(/contrast/g,this.renderer.getContrast(t.style.fill)));if(T||o)i.textRendering="geometricPrecision";u?this.css(i):(this.fakeTS=!0,this.ySetter=this.xSetter,n=[].slice.call(t.getElementsByTagName("tspan")),d(e.split(/\s?,\s?/g),function(e){var r=t.firstChild,i,o;e=e.split(" "),i=e[e.length-1],(o=e[e.length-2])&&d(n,function(e,n){var u;0===n&&(e.setAttribute("x",t.getAttribute("x")),n=t.getAttribute("y"),e.setAttribute("y",n||0),null===n&&t.setAttribute("y",0)),u=e.cloneNode(1),s(u,{"class":"highcharts-text-shadow",fill:i,stroke:i,"stroke-opacity":1/Math.max(L(o),3),"stroke-width":o,"stroke-linejoin":"round"}),t.insertBefore(u,r)})}))},attr:function(e,t,n){var r,i=this.element,s,o=this,u;"string"==typeof e&&void 0!==t&&(r=e,e={},e[r]=t);if("string"==typeof e)o=(this[e+"Getter"]||this._defaultGetter).call(this,e,i);else{for(r in e)t=e[r],u=!1,this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(r)&&(s||(this.symbolAttr(e),s=!0),u=!0),!this.rotation||"x"!==r&&"y"!==r||(this.doTransform=!0),u||(u=this[r+"Setter"]||this._defaultSetter,u.call(this,t,r,i),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(r)&&this.updateShadows(r,t,u));this.doTransform&&(this.updateTransform(),this.doTransform=!1)}return n&&n(),o},updateShadows:function(e,t,n){for(var r=this.shadows,i=r.length;i--;)n.call(r[i],"height"===e?Math.max(t-(r[i].cutHeight||0),0):"d"===e?this.d:t,e,r[i])},addClass:function(e,t){var n=this.attr("class")||"";return-1===n.indexOf(e)&&(t||(e=(n+(n?" ":"")+e).replace("  "," ")),this.attr("class",e)),this},hasClass:function(e){return-1!==s(this.element,"class").indexOf(e)},removeClass:function(e){return s(this.element,"class",(s(this.element,"class")||"").replace(e,"")),this},symbolAttr:function(e){var t=this;d("x y r start end width height innerR anchorX anchorY".split(" "),function(n){t[n]=k(e[n],t[n])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":"none")},crisp:function(e,t){var n,r={},i;t=t||e.strokeWidth||0,i=Math.round(t)%2/2,e.x=Math.floor(e.x||this.x||0)+i,e.y=Math.floor(e.y||this.y||0)+i,e.width=Math.floor((e.width||this.width||0)-2*i),e.height=Math.floor((e.height||this.height||0)-2*i),l(e.strokeWidth)&&(e.strokeWidth=t);for(n in e)this[n]!==e[n]&&(this[n]=r[n]=e[n]);return r},css:function(e){var t=this.styles,n={},r=this.element,i,o,u="";i=!t,e&&e.color&&(e.fill=e.color);if(t)for(o in e)e[o]!==t[o]&&(n[o]=e[o],i=!0);if(i){i=this.textWidth=e&&e.width&&"text"===r.nodeName.toLowerCase()&&L(e.width)||this.textWidth,t&&(e=v(t,n)),this.styles=e,i&&!M&&this.renderer.forExport&&delete e.width;if(E&&!M)a(this.element,e);else{t=function(e,t){return"-"+t.toLowerCase()};for(o in e)u+=o.replace(/([A-Z])/g,t)+":"+e[o]+";";s(r,"style",u)}this.added&&i&&this.renderer.buildText(this)}return this},strokeWidth:function(){return this["stroke-width"]||0},on:function(e,t){var n=this,r=n.element;return y&&"click"===e?(r.ontouchstart=function(e){n.touchEventFired=Date.now(),e.preventDefault(),t.call(r,e)},r.onclick=function(e){(-1===D.navigator.userAgent.indexOf("Android")||1100<Date.now()-(n.touchEventFired||0))&&t.call(r,e)}):r["on"+e]=t,this},setRadialReference:function(e){var t=this.renderer.gradients[this.element.gradient];return this.element.radialReference=e,t&&t.radAttr&&t.animate(this.renderer.getRadialAttr(e,t.radAttr)),this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(e){return this.inverted=e,this.updateTransform(),this},updateTransform:function(){var e=this.translateX||0,t=this.translateY||0,n=this.scaleX,r=this.scaleY,i=this.inverted,s=this.rotation,o=this.element;i&&(e+=this.attr("width"),t+=this.attr("height")),e=["translate("+e+","+t+")"],i?e.push("rotate(90) scale(-1,1)"):s&&e.push("rotate("+s+" "+(o.getAttribute("x")||0)+" "+(o.getAttribute("y")||0)+")"),(l(n)||l(r))&&e.push("scale("+k(n,1)+" "+k(r,1)+")"),e.length&&o.setAttribute("transform",e.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,n){var r,i,s,o,u={};i=this.renderer,s=i.alignedObjects;var a,f;if(e){if(this.alignOptions=e,this.alignByTranslate=t,!n||x(n))this.alignTo=r=n||"renderer",m(s,this),s.push(this),n=null}else e=this.alignOptions,t=this.alignByTranslate,r=this.alignTo;return n=k(n,i[r],i),r=e.align,i=e.verticalAlign,s=(n.x||0)+(e.x||0),o=(n.y||0)+(e.y||0),"right"===r?a=1:"center"===r&&(a=2),a&&(s+=(n.width-(e.width||0))/a),u[t?"translateX":"x"]=Math.round(s),"bottom"===i?f=1:"middle"===i&&(f=2),f&&(o+=(n.height-(e.height||0))/f),u[t?"translateY":"y"]=Math.round(o),this[this.placed?"animate":"attr"](u),this.placed=!0,this.alignAttr=u,this},getBBox:function(e,t){var n,r=this.renderer,i,s,o,u=this.element,a=this.styles,f=this.textStr,l,h=u.style,p,m=r.cache,g=r.cacheKeys,y;s=k(t,this.rotation),o=s*c,i=a&&a.fontSize,void 0!==f&&(y=f.toString().replace(/[0-9]/g,"0")+["",s||0,i,u.style.width].join()),y&&!e&&(n=m[y]);if(!n){if(u.namespaceURI===this.SVG_NS||r.forExport){try{p=this.fakeTS&&function(e){d(u.querySelectorAll(".highcharts-text-shadow"),function(t){t.style.display=e})},w&&h.textShadow?(l=h.textShadow,h.textShadow=""):p&&p("none"),n=u.getBBox?v({},u.getBBox()):{width:u.offsetWidth,height:u.offsetHeight},l?h.textShadow=l:p&&p("")}catch(b){}if(!n||0>n.width)n={width:0,height:0}}else n=this.htmlGetBBox();r.isSVG&&(r=n.width,i=n.height,E&&a&&"11px"===a.fontSize&&"16.9"===i.toPrecision(3)&&(n.height=i=14),s&&(n.width=Math.abs(i*Math.sin(o))+Math.abs(r*Math.cos(o)),n.height=Math.abs(i*Math.cos(o))+Math.abs(r*Math.sin(o))));if(y&&0<n.height){for(;250<g.length;)delete m[g.shift()];m[y]||g.push(y),m[y]=n}}return n},show:function(e){return this.attr({visibility:e?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(e){var t=this;t.animate({opacity:0},{duration:e||150,complete:function(){t.attr({y:-9999})}})},add:function(e){var t=this.renderer,n=this.element,r;e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,void 0!==this.textStr&&t.buildText(this),this.added=!0;if(!e||e.handleZ||this.zIndex)r=this.zIndexSetter();return r||(e?e.element:t.box).appendChild(n),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e=this.element||{},t=this.renderer.isSVG&&"SPAN"===e.nodeName&&this.parentGroup,n,r;e.onclick=e.onmouseout=e.onmouseover=e.onmousemove=e.point=null,O(this),this.clipPath&&(this.clipPath=this.clipPath.destroy());if(this.stops){for(r=0;r<this.stops.length;r++)this.stops[r]=this.stops[r].destroy();this.stops=null}this.safeRemoveChild(e);for(this.destroyShadows();t&&t.div&&0===t.div.childNodes.length;)e=t.parentGroup,this.safeRemoveChild(t.div),delete t.div,t=e;this.alignTo&&m(this.renderer.alignedObjects,this);for(n in this)delete this[n];return null},shadow:function(e,t,n){var r=[],i,o,u=this.element,a,f,l,c;if(!e)this.destroyShadows();else if(!this.shadows){f=k(e.width,3),l=(e.opacity||.15)/f,c=this.parentInverted?"(-1,-1)":"("+k(e.offsetX,1)+", "+k(e.offsetY,1)+")";for(i=1;i<=f;i++)o=u.cloneNode(0),a=2*f+1-2*i,s(o,{isShadow:"true",stroke:e.color||"#000000","stroke-opacity":l*i,"stroke-width":a,transform:"translate"+c,fill:"none"}),n&&(s(o,"height",Math.max(s(o,"height")-a,0)),o.cutHeight=a),t?t.element.appendChild(o):u.parentNode.insertBefore(o,u),r.push(o);this.shadows=r}return this},destroyShadows:function(){d(this.shadows||[],function(e){this.safeRemoveChild(e)},this),this.shadows=void 0},xGetter:function(e){return"circle"===this.element.nodeName&&("x"===e?e="cx":"y"===e&&(e="cy")),this._defaultGetter(e)},_defaultGetter:function(e){return e=k(this[e],this.element?this.element.getAttribute(e):null,0),/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(e,t,n){e&&e.join&&(e=e.join(" ")),/(NaN| {2}|^$)/.test(e)&&(e="M 0 0"),n.setAttribute(t,e),this[t]=e},dashstyleSetter:function(e){var t,n=this["stroke-width"];"inherit"===n&&(n=1);if(e=e&&e.toLowerCase()){e=e.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(t=e.length;t--;)e[t]=L(e[t])*n;e=e.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",e)}},alignSetter:function(e){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[e])},titleSetter:function(e){var t=this.element.getElementsByTagName("title")[0];t||(t=p.createElementNS(this.SVG_NS,"title"),this.element.appendChild(t)),t.firstChild&&t.removeChild(t.firstChild),t.appendChild(p.createTextNode(String(k(e),"").replace(/<[^>]*>/g,"")))},textSetter:function(e){e!==this.textStr&&(delete this.bBox,this.textStr=e,this.added&&this.renderer.buildText(this))},fillSetter:function(e,t,n){"string"==typeof e?n.setAttribute(t,e):e&&this.colorGradient(e,t,n)},visibilitySetter:function(e,t,n){"inherit"===e?n.removeAttribute(t):n.setAttribute(t,e)},zIndexSetter:function(e,t){var n=this.renderer,r=this.parentGroup,n=(r||n).element||n.box,i,s,o=this.element,u;i=this.added;var a;l(e)&&(o.zIndex=e,e=+e,this[t]===e&&(i=!1),this[t]=e);if(i){(e=this.zIndex)&&r&&(r.handleZ=!0),r=n.childNodes;for(a=0;a<r.length&&!u;a++)i=r[a],s=i.zIndex,i!==o&&(L(s)>e||!l(e)&&l(s))&&(n.insertBefore(o,i),u=!0);u||n.appendChild(o)}return u},_defaultSetter:function(e,t,n){n.setAttribute(t,e)}},t.prototype.yGetter=t.prototype.xGetter,t.prototype.translateXSetter=t.prototype.translateYSetter=t.prototype.rotationSetter=t.prototype.verticalAlignSetter=t.prototype.scaleXSetter=t.prototype.scaleYSetter=function(e,t){this[t]=e,this.doTransform=!0},t.prototype.opacitySetter=t.prototype.displaySetter=function(e,t,n){this[t]=e,n.setAttribute(t,e)},t.prototype["stroke-widthSetter"]=t.prototype.strokeSetter=function(e,n,r){this[n]=e,this.stroke&&this["stroke-width"]?(t.prototype.fillSetter.call(this,this.stroke,"stroke",r),r.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===n&&0===e&&this.hasStroke&&(r.removeAttribute("stroke"),this.hasStroke=!1)},n=e.SVGRenderer=function(){this.init.apply(this,arguments)},n.prototype={Element:t,SVG_NS:_,init:function(e,t,n,i,o,u){var f;i=this.createElement("svg").attr({version:"1.1","class":"highcharts-root"}).css(this.getStyle(i)),f=i.element,e.appendChild(f),-1===e.innerHTML.indexOf("xmlns")&&s(f,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=f,this.boxWrapper=i,this.alignedObjects=[],this.url=(w||T)&&p.getElementsByTagName("base").length?D.location.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(p.createTextNode("Created with Highcharts 5.0.0")),this.defs=this.createElement("defs").add(),this.allowHTML=u,this.forExport=o,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(t,n,!1);var l;w&&e.getBoundingClientRect&&(this.subPixelFix=t=function(){a(e,{left:0,top:0}),l=e.getBoundingClientRect(),a(e,{left:Math.ceil(l.left)-l.left+"px",top:Math.ceil(l.top)-l.top+"px"})},t(),r(D,"resize",t))},getStyle:function(e){return this.style=v({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},e)},setStyle:function(e){this.boxWrapper.css(this.getStyle(e))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var e=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),h(this.gradients||{}),this.gradients=null,e&&(this.defs=e.destroy()),this.subPixelFix&&A(D,"resize",this.subPixelFix),this.alignedObjects=null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:C,getRadialAttr:function(e,t){return{cx:e[0]-e[2]/2+t.cx*e[2],cy:e[1]-e[2]/2+t.cy*e[2],r:t.r*e[2]}},buildText:function(e){for(var t=e.element,n=this,r=n.forExport,i=k(e.textStr,"").toString(),o=-1!==i.indexOf("<"),u=t.childNodes,f,l,c,h,v=s(t,"x"),m=e.styles,y=e.textWidth,b=m&&m.lineHeight,w=m&&m.textShadow,E=m&&"ellipsis"===m.textOverflow,S=u.length,x=y&&!e.added&&this.box,T=function(e){var t;return t=/(px|em)$/.test(e&&e.style.fontSize)?e.style.fontSize:m&&m.fontSize||n.style.fontSize||12,b?L(b):n.fontMetrics(t,e).h};S--;)t.removeChild(u[S]);o||w||E||y||-1!==i.indexOf(" ")?(f=/<.*class="([^"]+)".*>/,l=/<.*style="([^"]+)".*>/,c=/<.*href="(http[^"]+)".*>/,x&&x.appendChild(t),i=o?i.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[i],i=g(i,function(e){return""!==e}),d(i,function(i,o){var u,g=0;i=i.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),u=i.split("|||"),d(u,function(i){if(""!==i||1===u.length){var d={},b=p.createElementNS(n.SVG_NS,"tspan"),w,S;f.test(i)&&(w=i.match(f)[1],s(b,"class",w)),l.test(i)&&(S=i.match(l)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),s(b,"style",S)),c.test(i)&&!r&&(s(b,"onclick",'location.href="'+i.match(c)[1]+'"'),a(b,{cursor:"pointer"})),i=(i.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(" "!==i){b.appendChild(p.createTextNode(i)),g?d.dx=0:o&&null!==v&&(d.x=v),s(b,d),t.appendChild(b),!g&&o&&(!M&&r&&a(b,{display:"block"}),s(b,"dy",T(b)));if(y){d=i.replace(/([^\^])-/g,"$1- ").split(" "),w="nowrap"===m.whiteSpace;for(var x=1<u.length||o||1<d.length&&!w,N,C,k=[],L=T(b),A=e.rotation,O=i,D=O.length;(x||E)&&(d.length||k.length);)e.rotation=0,N=e.getBBox(!0),C=N.width,!M&&n.forExport&&(C=n.measureSpanWidth(b.firstChild.data,e.styles)),N=C>y,void 0===h&&(h=N),E&&h?(D/=2,""===O||!N&&.5>D?d=[]:(O=i.substring(0,O.length+(N?-1:1)*Math.ceil(D)),d=[O+(3<y?"â€¦":"")],b.removeChild(b.firstChild))):N&&1!==d.length?(b.removeChild(b.firstChild),k.unshift(d.pop())):(d=k,k=[],d.length&&!w&&(b=p.createElementNS(_,"tspan"),s(b,{dy:L,x:v}),S&&s(b,"style",S),t.appendChild(b)),C>y&&(y=C)),d.length&&b.appendChild(p.createTextNode(d.join(" ").replace(/- /g,"-")));e.rotation=A}g++}}})}),h&&e.attr("title",e.textStr),x&&x.removeChild(t),w&&e.applyTextShadow&&e.applyTextShadow(w)):t.appendChild(p.createTextNode(i.replace(/&lt;/g,"<").replace(/&gt;/g,">")))},getContrast:function(e){return e=u(e).rgba,510<e[0]+e[1]+e[2]?"#000000":"#FFFFFF"},button:function(e,t,n,i,s,o,u,a,f){var l=this.label(e,t,n,f,null,null,null,null,"button"),c=0;l.attr(N({padding:8,r:2},s));var h,p,d,m;return s=N({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},s),h=s.style,delete s.style,o=N(s,{fill:"#e6e6e6"},o),p=o.style,delete o.style,u=N(s,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},u),d=u.style,delete u.style,a=N(s,{style:{color:"#cccccc"}},a),m=a.style,delete a.style,r(l.element,E?"mouseover":"mouseenter",function(){3!==c&&l.setState(1)}),r(l.element,E?"mouseout":"mouseleave",function(){3!==c&&l.setState(c)}),l.setState=function(e){1!==e&&(l.state=c=e),l.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][e||0]),l.attr([s,o,u,a][e||0]).css([h,p,d,m][e||0])},l.attr(s).css(v({cursor:"default"},h)),l.on("click",function(e){3!==c&&i.call(l,e)})},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=Math.round(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=Math.round(e[2])+t%2/2),e},path:function(e){var t={fill:"none"};return b(e)?t.d=e:S(e)&&v(t,e),this.createElement("path").attr(t)},circle:function(e,t,n){return e=S(e)?e:{x:e,y:t,r:n},t=this.createElement("circle"),t.xSetter=t.ySetter=function(e,t,n){n.setAttribute("c"+t,e)},t.attr(e)},arc:function(e,t,n,r,i,s){return S(e)&&(t=e.y,n=e.r,r=e.innerR,i=e.start,s=e.end,e=e.x),e=this.symbol("arc",e||0,t||0,n||0,n||0,{innerR:r||0,start:i||0,end:s||0}),e.r=n,e},rect:function(e,t,n,r,i,o){i=S(e)?e.r:i;var u=this.createElement("rect");return e=S(e)?e:void 0===e?{}:{x:e,y:t,width:Math.max(n,0),height:Math.max(r,0)},void 0!==o&&(e.strokeWidth=o,e=u.crisp(e)),e.fill="none",i&&(e.r=i),u.rSetter=function(e,t,n){s(n,{rx:e,ry:e})},u.attr(e)},setSize:function(e,t,n){var r=this.alignedObjects,i=r.length;this.width=e,this.height=t;for(this.boxWrapper.animate({width:e,height:t},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:k(n,!0)?void 0:0});i--;)r[i].align()},g:function(e){var t=this.createElement("g");return e?t.attr({"class":"highcharts-"+e}):t},image:function(e,t,n,r,i){var s={preserveAspectRatio:"none"};return 1<arguments.length&&v(s,{x:t,y:n,width:r,height:i}),s=this.createElement("image").attr(s),s.element.setAttributeNS?s.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):s.element.setAttribute("hc-svg-href",e),s},symbol:function(e,t,n,r,i,s){var u=this,c,h=this.symbols[e],m=l(t)&&h&&h(Math.round(t),Math.round(n),r,i,s),g=/^url\((.*?)\)$/,y,b,w={};return h?(c=this.path(m),c.attr("fill","none"),v(c,{symbolName:e,x:t,y:n,width:r,height:i}),s&&v(c,s)):g.test(e)&&(y=e.match(g)[1],c=this.image(y),c.imgwidth=k(w[y]&&w[y].width,s&&s.width),c.imgheight=k(w[y]&&w[y].height,s&&s.height),b=function(){c.attr({width:c.width,height:c.height})},d(["width","height"],function(e){c[e+"Setter"]=function(e,t){var n={},r=this["img"+t];this[t]=e,l(r)&&(this.element&&this.element.setAttribute(t,r),this.alignByTranslate||(n["width"===t?"translateX":"translateY"]=(this[t]-r)/2,this.attr(n)))}}),l(t)&&c.attr({x:t,y:n}),c.isImg=!0,l(c.imgwidth)&&l(c.imgheight)?b():(c.attr({width:0,height:0}),f("img",{onload:function(){var e=o[u.chartIndex];0===this.width&&(a(this,{position:"absolute",top:"-999em"}),p.body.appendChild(this)),w[y]={width:this.width,height:this.height},c.imgwidth=this.width,c.imgheight=this.height,c.element&&b(),this.parentNode&&this.parentNode.removeChild(this),u.imgCount--,!u.imgCount&&e&&e.onload&&e.onload()},src:y}),this.imgCount++)),c},symbols:{circle:function(e,t,n,r){var i=.166*n;return["M",e+n/2,t,"C",e+n+i,t,e+n+i,t+r,e+n/2,t+r,"C",e-i,t+r,e-i,t,e+n/2,t,"Z"]},square:function(e,t,n,r){return["M",e,t,"L",e+n,t,e+n,t+r,e,t+r,"Z"]},triangle:function(e,t,n,r){return["M",e+n/2,t,"L",e+n,t+r,e,t+r,"Z"]},"triangle-down":function(e,t,n,r){return["M",e,t,"L",e+n,t,e+n/2,t+r,"Z"]},diamond:function(e,t,n,r){return["M",e+n/2,t,"L",e+n,t+r/2,e+n/2,t+r,e,t+r/2,"Z"]},arc:function(e,t,n,r,i){var s=i.start;n=i.r||n||r;var o=i.end-.001;r=i.innerR;var u=i.open,a=Math.cos(s),f=Math.sin(s),l=Math.cos(o),o=Math.sin(o);return i=i.end-s<Math.PI?0:1,["M",e+n*a,t+n*f,"A",n,n,0,i,1,e+n*l,t+n*o,u?"M":"L",e+r*l,t+r*o,"A",r,r,0,i,0,e+r*a,t+r*f,u?"":"Z"]},callout:function(e,t,n,r,i){var s=Math.min(i&&i.r||0,n,r),o=s+6,u=i&&i.anchorX;i=i&&i.anchorY;var a;return a=["M",e+s,t,"L",e+n-s,t,"C",e+n,t,e+n,t,e+n,t+s,"L",e+n,t+r-s,"C",e+n,t+r,e+n,t+r,e+n-s,t+r,"L",e+s,t+r,"C",e,t+r,e,t+r,e,t+r-s,"L",e,t+s,"C",e,t,e,t,e+s,t],u&&u>n&&i>t+o&&i<t+r-o?a.splice(13,3,"L",e+n,i-6,e+n+6,i,e+n,i+6,e+n,t+r-s):u&&0>u&&i>t+o&&i<t+r-o?a.splice(33,3,"L",e,i+6,e-6,i,e,i-6,e,t+s):i&&i>r&&u>e+o&&u<e+n-o?a.splice(23,3,"L",u+6,t+r,u,t+r+6,u-6,t+r,e+s,t+r):i&&0>i&&u>e+o&&u<e+n-o&&a.splice(3,3,"L",u-6,t,u,t-6,u+6,t,n-s,t),a}},clipRect:function(t,n,r,i){var s="highcharts-"+e.idCounter++,o=this.createElement("clipPath").attr({id:s}).add(this.defs);return t=this.rect(t,n,r,i,0).add(o),t.id=s,t.clipPath=o,t.count=0,t},text:function(e,t,n,r){var i=!M&&this.forExport,s={};if(r&&(this.allowHTML||!this.forExport))return this.html(e,t,n);s.x=Math.round(t||0),n&&(s.y=Math.round(n));if(e||0===e)s.text=e;return e=this.createElement("text").attr(s),i&&e.css({position:"absolute"}),r||(e.xSetter=function(e,t,n){var r=n.getElementsByTagName("tspan"),i,s=n.getAttribute(t),o;for(o=0;o<r.length;o++)i=r[o],i.getAttribute(t)===s&&i.setAttribute(t,e);n.setAttribute(t,e)}),e},fontMetrics:function(e,t){var n;return e=e||this.style&&this.style.fontSize,e=/px/.test(e)?L(e):/em/.test(e)?12*parseFloat(e):12,n=24>e?e+3:Math.round(1.2*e),{h:n,b:Math.round(.8*n),f:e}},rotCorr:function(e,t,n){var r=e;return t&&n&&(r=Math.max(r*Math.cos(t*c),4)),{x:-e/3*Math.sin(t*c),y:r}},label:function(e,n,r,i,s,o,u,a,f){var c=this,h=c.g("button"!==f&&"label"),p=h.text=c.text("",0,0,u).attr({zIndex:1}),m,g,y=0,b=3,w=0,E,S,x,T,C,k={},L,O,M=/^url\((.*?)\)$/.test(i),_=M,D,P,H,j;f&&h.addClass("highcharts-"+f),_=M,D=function(){return(L||0)%2/2},P=function(){var e=p.element.style,t={};g=(void 0===E||void 0===S||C)&&l(p.textStr)&&p.getBBox(),h.width=(E||g.width||0)+2*b+w,h.height=(S||g.height||0)+2*b,O=b+c.fontMetrics(e&&e.fontSize,p).b,_&&(m||(h.box=m=c.symbols[i]||M?c.symbol(i):c.rect(),m.addClass(("button"===f?"":"highcharts-label-box")+(f?" highcharts-"+f+"-box":"")),m.add(h),e=D(),t.x=e,t.y=(a?-O:0)+e),t.width=Math.round(h.width),t.height=Math.round(h.height),m.attr(v(t,k)),k={})},H=function(){var e=w+b,t;t=a?0:O,l(E)&&g&&("center"===C||"right"===C)&&(e+={center:.5,right:1}[C]*(E-g.width));if(e!==p.x||t!==p.y)p.attr("x",e),void 0!==t&&p.attr("y",t);p.x=e,p.y=t},j=function(e,t){m?m.attr(e,t):k[e]=t},h.onAdd=function(){p.add(h),h.attr({text:e||0===e?e:"",x:n,y:r}),m&&l(s)&&h.attr({anchorX:s,anchorY:o})},h.widthSetter=function(e){E=e},h.heightSetter=function(e){S=e},h["text-alignSetter"]=function(e){C=e},h.paddingSetter=function(e){l(e)&&e!==b&&(b=h.padding=e,H())},h.paddingLeftSetter=function(e){l(e)&&e!==w&&(w=e,H())},h.alignSetter=function(e){e={left:0,center:.5,right:1}[e],e!==y&&(y=e,g&&h.attr({x:x}))},h.textSetter=function(e){void 0!==e&&p.textSetter(e),P(),H()},h["stroke-widthSetter"]=function(e,t){e&&(_=!0),L=this["stroke-width"]=e,j(t,e)},h.strokeSetter=h.fillSetter=h.rSetter=function(e,t){"fill"===t&&e&&(_=!0),j(t,e)},h.anchorXSetter=function(e,t){s=e,j(t,Math.round(e)-D()-x)},h.anchorYSetter=function(e,t){o=e,j(t,e-T)},h.xSetter=function(e){h.x=e,y&&(e-=y*((E||g.width)+2*b)),x=Math.round(e),h.attr("translateX",x)},h.ySetter=function(e){T=h.y=Math.round(e),h.attr("translateY",T)};var I=h.css;return v(h,{css:function(e){if(e){var t={};e=N(e),d(h.textProps,function(n){void 0!==e[n]&&(t[n]=e[n],delete e[n])}),p.css(t)}return I.call(h,e)},getBBox:function(){return{width:g.width+2*b,height:g.height+2*b,x:g.x-b,y:g.y-b}},shadow:function(e){return e&&(P(),m&&m.shadow(e)),h},destroy:function(){A(h.element,"mouseenter"),A(h.element,"mouseleave"),p&&(p=p.destroy()),m&&(m=m.destroy()),t.prototype.destroy.call(h),h=c=P=H=j=null}})}},e.Renderer=n}(e),function(e){var t=e.attr,n=e.createElement,r=e.css,i=e.defined,s=e.each,o=e.extend,u=e.isFirefox,a=e.isMS,f=e.isWebKit,l=e.pInt,c=e.SVGRenderer,h=e.win,p=e.wrap;o(e.SVGElement.prototype,{htmlCss:function(e){var t=this.element;if(t=e&&"SPAN"===t.tagName&&e.width)delete e.width,this.textWidth=t,this.updateTransform();return e&&"ellipsis"===e.textOverflow&&(e.whiteSpace="nowrap",e.overflow="hidden"),this.styles=o(this.styles,e),r(this.element,e),this},htmlGetBBox:function(){var e=this.element;return"text"===e.nodeName&&(e.style.position="absolute"),{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var e=this.renderer,t=this.element,n=this.translateX||0,o=this.translateY||0,u=this.x||0,a=this.y||0,c=this.textAlign||"left",h={left:0,center:.5,right:1}[c],p=this.styles;r(t,{marginLeft:n,marginTop:o}),this.shadows&&s(this.shadows,function(e){r(e,{marginLeft:n+1,marginTop:o+1})}),this.inverted&&s(t.childNodes,function(n){e.invertChild(n,t)});if("SPAN"===t.tagName){var d=this.rotation,v=l(this.textWidth),m=p&&p.whiteSpace,g=[d,c,t.innerHTML,this.textWidth,this.textAlign].join();g!==this.cTT&&(p=e.fontMetrics(t.style.fontSize).b,i(d)&&this.setSpanRotation(d,h,p),r(t,{width:"",whiteSpace:m||"nowrap"}),t.offsetWidth>v&&/[ \-]/.test(t.textContent||t.innerText)&&r(t,{width:v+"px",display:"block",whiteSpace:m||"normal"}),this.getSpanCorrection(t.offsetWidth,p,h,d,c)),r(t,{left:u+(this.xCorr||0)+"px",top:a+(this.yCorr||0)+"px"}),f&&(p=t.offsetHeight),this.cTT=g}}else this.alignOnAdd=!0},setSpanRotation:function(e,t,n){var i={},s=a?"-ms-transform":f?"-webkit-transform":u?"MozTransform":h.opera?"-o-transform":"";i[s]=i.transform="rotate("+e+"deg)",i[s+(u?"Origin":"-origin")]=i.transformOrigin=100*t+"% "+n+"px",r(this.element,i)},getSpanCorrection:function(e,t,n){this.xCorr=-e*n,this.yCorr=-t}}),o(c.prototype,{html:function(e,r,i){var u=this.createElement("span"),a=u.element,f=u.renderer,l=f.isSVG,c=function(e,t){s(["display","opacity","visibility"],function(n){p(e,n+"Setter",function(e,n,r,i){e.call(this,n,r,i),t[r]=n})})};return u.textSetter=function(e){e!==a.innerHTML&&delete this.bBox,a.innerHTML=this.textStr=e,u.htmlUpdateTransform()},l&&c(u,u.element.style),u.xSetter=u.ySetter=u.alignSetter=u.rotationSetter=function(e,t){"align"===t&&(t="textAlign"),u[t]=e,u.htmlUpdateTransform()},u.attr({text:e,x:Math.round(r),y:Math.round(i)}).css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize,position:"absolute"}),a.style.whiteSpace="nowrap",u.css=u.htmlCss,l&&(u.add=function(e){var r,i=f.box.parentNode,l=[];if(this.parentGroup=e){if(r=e.div,!r){for(;e;)l.push(e),e=e.parentGroup;s(l.reverse(),function(e){var s,u=t(e.element,"class");u&&(u={className:u}),r=e.div=e.div||n("div",u,{position:"absolute",left:(e.translateX||0)+"px",top:(e.translateY||0)+"px",display:e.display,opacity:e.opacity,pointerEvents:e.styles&&e.styles.pointerEvents},r||i),s=r.style,o(e,{translateXSetter:function(t,n){s.left=t+"px",e[n]=t,e.doTransform=!0},translateYSetter:function(t,n){s.top=t+"px",e[n]=t,e.doTransform=!0}}),c(e,s)})}}else r=i;return r.appendChild(a),u.added=!0,u.alignOnAdd&&u.htmlUpdateTransform(),u}),u}})}(e),function(e){var t,n,r=e.createElement,i=e.css,s=e.defined,o=e.deg2rad,u=e.discardElement,a=e.doc,f=e.each,l=e.erase,c=e.extend;t=e.extendClass;var h=e.isArray,p=e.isNumber,d=e.isObject,v=e.merge;n=e.noop;var m=e.pick,g=e.pInt,y=e.SVGElement,b=e.SVGRenderer,w=e.win;e.svg||(n={docMode8:a&&8===a.documentMode,init:function(e,t){var n=["<",t,' filled="f" stroked="f"'],i=["position: ","absolute",";"],s="div"===t;("shape"===t||s)&&i.push("left:0;top:0;width:1px;height:1px;"),i.push("visibility: ",s?"hidden":"visible"),n.push(' style="',i.join(""),'"/>'),t&&(n=s||"span"===t||"img"===t?n.join(""):e.prepVML(n),this.element=r(n)),this.renderer=e},add:function(e){var t=this.renderer,n=this.element,r=t.box,i=e&&e.inverted,r=e?e.element||e:r;return e&&(this.parentGroup=e),i&&t.invertChild(n,r),r.appendChild(n),this.added=!0,this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform(),this.onAdd&&this.onAdd(),this.className&&this.attr("class",this.className),this},updateTransform:y.prototype.htmlUpdateTransform,setSpanRotation:function(){var e=this.rotation,t=Math.cos(e*o),n=Math.sin(e*o);i(this.element,{filter:e?["progid:DXImageTransform.Microsoft.Matrix(M11=",t,", M12=",-n,", M21=",n,", M22=",t,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(e,t,n,r,s){var u=r?Math.cos(r*o):1,a=r?Math.sin(r*o):0,f=m(this.elemHeight,this.element.offsetHeight),l;this.xCorr=0>u&&-e,this.yCorr=0>a&&-f,l=0>u*a,this.xCorr+=a*t*(l?1-n:n),this.yCorr-=u*t*(r?l?n:1-n:1),s&&"left"!==s&&(this.xCorr-=e*n*(0>u?-1:1),r&&(this.yCorr-=f*n*(0>a?-1:1)),i(this.element,{textAlign:s}))},pathToVML:function(e){for(var t=e.length,n=[];t--;)p(e[t])?n[t]=Math.round(10*e[t])-5:"Z"===e[t]?n[t]="x":(n[t]=e[t],!e.isArc||"wa"!==e[t]&&"at"!==e[t]||(n[t+5]===n[t+7]&&(n[t+7]+=e[t+7]>e[t+5]?1:-1),n[t+6]===n[t+8]&&(n[t+8]+=e[t+8]>e[t+6]?1:-1)));return n.join(" ")||"x"},clip:function(e){var t=this,n;return e?(n=e.members,l(n,t),n.push(t),t.destroyClip=function(){l(n,t)},e=e.getCSS(t)):(t.destroyClip&&t.destroyClip(),e={clip:t.docMode8?"inherit":"rect(auto)"}),t.css(e)},css:y.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&u(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),y.prototype.destroy.apply(this)},on:function(e,t){return this.element["on"+e]=function(){var e=w.event;e.target=e.srcElement,t(e)},this},cutOffPath:function(e,t){var n;e=e.split(/[ ,]/),n=e.length;if(9===n||11===n)e[n-4]=e[n-2]=g(e[n-2])-10*t;return e.join(" ")},shadow:function(e,t,n){var i=[],s,o=this.element,u=this.renderer,a,f=o.style,l,c=o.path,h,p,d,v;c&&"string"!=typeof c.value&&(c="x"),p=c;if(e){d=m(e.width,3),v=(e.opacity||.15)/d;for(s=1;3>=s;s++)h=2*d+1-2*s,n&&(p=this.cutOffPath(c.value,h+.5)),l=['<shape isShadow="true" strokeweight="',h,'" filled="false" path="',p,'" coordsize="10 10" style="',o.style.cssText,'" />'],a=r(u.prepVML(l),null,{left:g(f.left)+m(e.offsetX,1),top:g(f.top)+m(e.offsetY,1)}),n&&(a.cutOff=h+1),l=['<stroke color="',e.color||"#000000",'" opacity="',v*s,'"/>'],r(u.prepVML(l),null,null,a),t?t.element.appendChild(a):o.parentNode.insertBefore(a,o),i.push(a);this.shadows=i}return this},updateShadows:n,setAttr:function(e,t){this.docMode8?this.element[e]=t:this.element.setAttribute(e,t)},classSetter:function(e){(this.added?this.element:this).className=e},dashstyleSetter:function(e,t,n){(n.getElementsByTagName("stroke")[0]||r(this.renderer.prepVML(["<stroke/>"]),null,null,n))[t]=e||"solid",this[t]=e},dSetter:function(e,t,n){var r=this.shadows;e=e||[],this.d=e.join&&e.join(" "),n.path=e=this.pathToVML(e);if(r)for(n=r.length;n--;)r[n].path=r[n].cutOff?this.cutOffPath(e,r[n].cutOff):e;this.setAttr(t,e)},fillSetter:function(e,t,n){var r=n.nodeName;"SPAN"===r?n.style.color=e:"IMG"!==r&&(n.filled="none"!==e,this.setAttr("fillcolor",this.renderer.color(e,n,t,this)))},"fill-opacitySetter":function(e,t,n){r(this.renderer.prepVML(["<",t.split("-")[0],' opacity="',e,'"/>']),null,null,n)},opacitySetter:n,rotationSetter:function(e,t,n){n=n.style,this[t]=n[t]=e,n.left=-Math.round(Math.sin(e*o)+1)+"px",n.top=Math.round(Math.cos(e*o))+"px"},strokeSetter:function(e,t,n){this.setAttr("strokecolor",this.renderer.color(e,n,t,this))},"stroke-widthSetter":function(e,t,n){n.stroked=!!e,this[t]=e,p(e)&&(e+="px"),this.setAttr("strokeweight",e)},titleSetter:function(e,t){this.setAttr(t,e)},visibilitySetter:function(e,t,n){"inherit"===e&&(e="visible"),this.shadows&&f(this.shadows,function(n){n.style[t]=e}),"DIV"===n.nodeName&&(e="hidden"===e?"-999em":0,this.docMode8||(n.style[t]=e?"visible":"hidden"),t="top"),n.style[t]=e},displaySetter:function(e,t,n){n.style[t]=e},xSetter:function(e,t,n){this[t]=e,"x"===t?t="left":"y"===t&&(t="top"),this.updateClipping?(this[t]=e,this.updateClipping()):n.style[t]=e},zIndexSetter:function(e,t,n){n.style[t]=e}},n["stroke-opacitySetter"]=n["fill-opacitySetter"],e.VMLElement=n=t(y,n),n.prototype.ySetter=n.prototype.widthSetter=n.prototype.heightSetter=n.prototype.xSetter,n={Element:n,isIE8:-1<w.navigator.userAgent.indexOf("MSIE 8.0"),init:function(e,t,n){var r,i;this.alignedObjects=[],r=this.createElement("div").css({position:"relative"}),i=r.element,e.appendChild(r.element),this.isVML=!0,this.box=i,this.boxWrapper=r,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(t,n,!1);if(!a.namespaces.hcv){a.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{a.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(s){a.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,t,n,r){var i=this.createElement(),s=d(e);return c(i,{members:[],count:0,left:(s?e.x:e)+1,top:(s?e.y:t)+1,width:(s?e.width:n)-1,height:(s?e.height:r)-1,getCSS:function(e){var t=e.element,n=t.nodeName,r=e.inverted,i=this.top-("shape"===n?t.offsetTop:0),s=this.left,t=s+this.width,o=i+this.height,i={clip:"rect("+Math.round(r?s:i)+"px,"+Math.round(r?o:t)+"px,"+Math.round(r?t:o)+"px,"+Math.round(r?i:s)+"px)"};return!r&&e.docMode8&&"DIV"===n&&c(i,{width:t+"px",height:o+"px"}),i},updateClipping:function(){f(i.members,function(e){e.element&&e.css(i.getCSS(e))})}})},color:function(t,n,i,s){var o=this,u,a=/^rgba/,l,c,h="none";t&&t.linearGradient?c="gradient":t&&t.radialGradient&&(c="pattern");if(c){var p,d,v=t.linearGradient||t.radialGradient,m,g,y,b,w,S="";t=t.stops;var x,T=[],N=function(){l=['<fill colors="'+T.join(",")+'" opacity="',y,'" o:opacity2="',g,'" type="',c,'" ',S,'focus="100%" method="any" />'],r(o.prepVML(l),null,null,n)};m=t[0],x=t[t.length-1],0<m[0]&&t.unshift([0,m[1]]),1>x[0]&&t.push([1,x[1]]),f(t,function(t,n){a.test(t[1])?(u=e.color(t[1]),p=u.get("rgb"),d=u.get("a")):(p=t[1],d=1),T.push(100*t[0]+"% "+p),n?(y=d,b=p):(g=d,w=p)});if("fill"===i)if("gradient"===c)i=v.x1||v[0]||0,t=v.y1||v[1]||0,m=v.x2||v[2]||0,v=v.y2||v[3]||0,S='angle="'+(90-180*Math.atan((v-t)/(m-i))/Math.PI)+'"',N();else{var h=v.r,C=2*h,k=2*h,L=v.cx,A=v.cy,O=n.radialReference,M,h=function(){O&&(M=s.getBBox(),L+=(O[0]-M.x)/M.width-.5,A+=(O[1]-M.y)/M.height-.5,C*=O[2]/M.width,k*=O[2]/M.height),S='src="'+e.getOptions().global.VMLRadialGradientURL+'" size="'+C+","+k+'" origin="0.5,0.5" position="'+L+","+A+'" color2="'+w+'" ',N()};s.added?h():s.onAdd=h,h=b}else h=p}else a.test(t)&&"IMG"!==n.tagName?(u=e.color(t),s[i+"-opacitySetter"](u.get("a"),i,n),h=u.get("rgb")):(h=n.getElementsByTagName(i),h.length&&(h[0].opacity=1,h[0].type="solid"),h=t);return h},prepVML:function(e){var t=this.isIE8;return e=e.join(""),t?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e=-1===e.indexOf('style="')?e.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):e.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):e=e.replace("<","<hcv:"),e},text:b.prototype.html,path:function(e){var t={coordsize:"10 10"};return h(e)?t.d=e:d(e)&&c(t,e),this.createElement("shape").attr(t)},circle:function(e,t,n){var r=this.symbol("circle");return d(e)&&(n=e.r,t=e.y,e=e.x),r.isCircle=!0,r.r=n,r.attr({x:e,y:t})},g:function(e){var t;return e&&(t={className:"highcharts-"+e,"class":"highcharts-"+e}),this.createElement("div").attr(t)},image:function(e,t,n,r,i){var s=this.createElement("img").attr({src:e});return 1<arguments.length&&s.attr({x:t,y:n,width:r,height:i}),s},createElement:function(e){return"rect"===e?this.symbol(e):b.prototype.createElement.call(this,e)},invertChild:function(e,t){var n=this,r=t.style,s="IMG"===e.tagName&&e.style;i(e,{flip:"x",left:g(r.width)-(s?g(s.top):1),top:g(r.height)-(s?g(s.left):1),rotation:-90}),f(e.childNodes,function(t){n.invertChild(t,e)})},symbols:{arc:function(e,t,n,r,i){var s=i.start,o=i.end,u=i.r||n||r;n=i.innerR,r=Math.cos(s);var a=Math.sin(s),f=Math.cos(o),l=Math.sin(o);return 0===o-s?["x"]:(s=["wa",e-u,t-u,e+u,t+u,e+u*r,t+u*a,e+u*f,t+u*l],i.open&&!n&&s.push("e","M",e,t),s.push("at",e-n,t-n,e+n,t+n,e+n*f,t+n*l,e+n*r,t+n*a,"x","e"),s.isArc=!0,s)},circle:function(e,t,n,r,i){return i&&s(i.r)&&(n=r=2*i.r),i&&i.isCircle&&(e-=n/2,t-=r/2),["wa",e,t,e+n,t+r,e+n,t+r/2,e+n,t+r/2,"e"]},rect:function(e,t,n,r,i){return b.prototype.symbols[s(i)&&i.r?"callout":"square"].call(0,e,t,n,r,i)}}},e.VMLRenderer=t=function(){this.init.apply(this,arguments)},t.prototype=v(b.prototype,n),e.Renderer=t),b.prototype.measureSpanWidth=function(e,t){var n=a.createElement("span"),r;return r=a.createTextNode(e),n.appendChild(r),i(n,t),this.box.appendChild(n),r=n.offsetWidth,u(n),r}}(e),function(e){function t(){var t=e.defaultOptions.global,n,s=t.useUTC,f=s?"getUTC":"get",l=s?"setUTC":"set";e.Date=n=t.Date||u.Date,n.hcTimezoneOffset=s&&t.timezoneOffset,n.hcGetTimezoneOffset=s&&t.getTimezoneOffset,n.hcMakeTime=function(e,t,r,u,a,f){var l;return s?(l=n.UTC.apply(0,arguments),l+=i(l)):l=(new n(e,t,o(r,1),o(u,0),o(a,0),o(f,0))).getTime(),l},r("Minutes Hours Day Date Month FullYear".split(" "),function(e){n["hcGet"+e]=f+e}),r("Milliseconds Seconds Minutes Hours Date Month FullYear".split(" "),function(e){n["hcSet"+e]=l+e})}var n=e.color,r=e.each,i=e.getTZOffset,s=e.merge,o=e.pick,u=e.win;e.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),decimalPoint:".",numericSymbols:"kMGTPE".split(""),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,VMLRadialGradientURL:"http://code.highcharts.com@product.cdnpath@/5.0.0/gfx/vml-radial-gradient.png"},chart:{borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"},widthAdjust:-44},subtitle:{text:"",align:"center",style:{color:"#666666"},widthAdjust:-44},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:e.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:e.isTouchDevice?25:10,backgroundColor:n("#f7f7f7").setOpacity(.85).get(),borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">â—</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}},e.setOptions=function(n){return e.defaultOptions=s(!0,e.defaultOptions,n),t(),e.defaultOptions},e.getOptions=function(){return e.defaultOptions},e.defaultPlotOptions=e.defaultOptions.plotOptions,t()}(e),function(e){var t=e.arrayMax,n=e.arrayMin,r=e.defined,i=e.destroyObjectProperties,s=e.each,o=e.erase,u=e.merge,a=e.pick;e.PlotLineOrBand=function(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)},e.PlotLineOrBand.prototype={render:function(){var e=this,t=e.axis,n=t.horiz,i=e.options,s=i.label,o=e.label,f=i.to,l=i.from,c=i.value,h=r(l)&&r(f),p=r(c),v=e.svgElem,g=!v,y=[],b,w=i.color,S=a(i.zIndex,0),x=i.events,y={"class":"highcharts-plot-"+(h?"band ":"line ")+(i.className||"")},T={},N=t.chart.renderer,C=h?"bands":"lines",k=t.log2lin;t.isLog&&(l=k(l),f=k(f),c=k(c)),p?(y={stroke:w,"stroke-width":i.width},i.dashStyle&&(y.dashstyle=i.dashStyle)):h&&(w&&(y.fill=w),i.borderWidth&&(y.stroke=i.borderColor,y["stroke-width"]=i.borderWidth)),T.zIndex=S,C+="-"+S,(w=t[C])||(t[C]=w=N.g("plot-"+C).attr(T).add()),g&&(e.svgElem=v=N.path().attr(y).add(w));if(p)y=t.getPlotLinePath(c,v.strokeWidth());else{if(!h)return;y=t.getPlotBandPath(l,f,i)}if(g&&y&&y.length){if(v.attr({d:y}),x)for(b in i=function(t){v.on(t,function(n){x[t].apply(e,[n])})},x)i(b)}else v&&(y?(v.show(),v.animate({d:y})):(v.hide(),o&&(e.label=o=o.destroy())));return s&&r(s.text)&&y&&y.length&&0<t.width&&0<t.height&&!y.flat?(s=u({align:n&&h&&"center",x:n?!h&&4:10,verticalAlign:!n&&h&&"middle",y:n?h?16:10:h?6:-4,rotation:n&&!h&&90},s),this.renderLabel(s,y,h,S)):o&&o.hide(),e},renderLabel:function(e,r,i,s){var o=this.label,u=this.axis.chart.renderer;o||(o={align:e.textAlign||e.align,rotation:e.rotation,"class":"highcharts-plot-"+(i?"band":"line")+"-label "+(e.className||"")},o.zIndex=s,this.label=o=u.text(e.text,0,0,e.useHTML).attr(o).add(),o.css(e.style)),s=[r[1],r[4],i?r[6]:r[1]],r=[r[2],r[5],i?r[7]:r[2]],i=n(s),u=n(r),o.align(e,!1,{x:i,y:u,width:t(s)-i,height:t(r)-u}),o.show()},destroy:function(){o(this.axis.plotLinesAndBands,this),delete this.axis,i(this)}},e.AxisPlotLineOrBandExtension={getPlotBandPath:function(e,t){var n=this.getPlotLinePath(t,null,null,!0),r=this.getPlotLinePath(e,null,null,!0);return r&&n?(r.flat=r.toString()===n.toString(),r.push(n[4],n[5],n[1],n[2])):r=null,r},addPlotBand:function(e){return this.addPlotBandOrLine(e,"plotBands")},addPlotLine:function(e){return this.addPlotBandOrLine(e,"plotLines")},addPlotBandOrLine:function(t,n){var r=(new e.PlotLineOrBand(this,t)).render(),i=this.userOptions;return r&&(n&&(i[n]=i[n]||[],i[n].push(t)),this.plotLinesAndBands.push(r)),r},removePlotBandOrLine:function(e){for(var t=this.plotLinesAndBands,n=this.options,r=this.userOptions,i=t.length;i--;)t[i].id===e&&t[i].destroy();s([n.plotLines||[],r.plotLines||[],n.plotBands||[],r.plotBands||[]],function(t){for(i=t.length;i--;)t[i].id===e&&o(t,t[i])})}}}(e),function(e){var t=e.correctFloat,n=e.defined,r=e.destroyObjectProperties,i=e.isNumber,s=e.merge,o=e.pick,u=e.stop,a=e.deg2rad;e.Tick=function(e,t,n,r){this.axis=e,this.pos=t,this.type=n||"",this.isNew=!0,n||r||this.addLabel()},e.Tick.prototype={addLabel:function(){var e=this.axis,r=e.options,i=e.chart,u=e.categories,a=e.names,f=this.pos,l=r.labels,c=e.tickPositions,h=f===c[0],p=f===c[c.length-1],a=u?o(u[f],a[f],f):f,u=this.label,c=c.info,d;e.isDatetimeAxis&&c&&(d=r.dateTimeLabelFormats[c.higherRanks[f]||c.unitName]),this.isFirst=h,this.isLast=p,r=e.labelFormatter.call({axis:e,chart:i,isFirst:h,isLast:p,dateTimeLabelFormat:d,value:e.isLog?t(e.lin2log(a)):a}),n(u)?u&&u.attr({text:r}):(this.labelLength=(this.label=u=n(r)&&l.enabled?i.renderer.text(r,0,0,l.useHTML).css(s(l.style)).add(e.labelGroup):null)&&u.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(e){var t=this.axis,n=e.x,r=t.chart.chartWidth,i=t.chart.spacing,s=o(t.labelLeft,Math.min(t.pos,i[3])),i=o(t.labelRight,Math.max(t.pos+t.len,r-i[1])),u=this.label,f=this.rotation,l={left:0,center:.5,right:1}[t.labelAlign],c=u.getBBox().width,h=t.getSlotWidth(),p=h,d=1,v,y={};if(f)0>f&&n-l*c<s?v=Math.round(n/Math.cos(f*a)-s):0<f&&n+l*c>i&&(v=Math.round((r-n)/Math.cos(f*a)));else if(r=n+(1-l)*c,n-l*c<s?p=e.x+p*(1-l)-s:r>i&&(p=i-e.x+p*l,d=-1),p=Math.min(h,p),p<h&&"center"===t.labelAlign&&(e.x+=d*(h-p-l*(h-Math.min(c,p)))),c>p||t.autoRotation&&(u.styles||{}).width)v=p;v&&(y.width=v,(t.options.labels.style||{}).textOverflow||(y.textOverflow="ellipsis"),u.css(y))},getPosition:function(e,t,n,r){var i=this.axis,s=i.chart,o=r&&s.oldChartHeight||s.chartHeight;return{x:e?i.translate(t+n,null,null,r)+i.transB:i.left+i.offset+(i.opposite?(r&&s.oldChartWidth||s.chartWidth)-i.right-i.left:0),y:e?o-i.bottom+i.offset-(i.opposite?i.height:0):o-i.translate(t+n,null,null,r)-i.transB}},getLabelPosition:function(e,t,r,i,s,o,u,f){var l=this.axis,c=l.transA,h=l.reversed,p=l.staggerLines,d=l.tickRotCorr||{x:0,y:0},v=s.y;return n(v)||(v=0===l.side?r.rotation?-8:-r.getBBox().height:2===l.side?d.y+8:Math.cos(r.rotation*a)*(d.y-r.getBBox(!1,0).height/2)),e=e+s.x+d.x-(o&&i?o*c*(h?-1:1):0),t=t+v-(o&&!i?o*c*(h?1:-1):0),p&&(r=u/(f||1)%p,l.opposite&&(r=p-r-1),t+=l.labelOffset/p*r),{x:e,y:Math.round(t)}},getMarkPath:function(e,t,n,r,i,s){return s.crispLine(["M",e,t,"L",e+(i?0:-n),t+(i?n:0)],r)},render:function(e,t,n){var r=this.axis,s=r.options,a=r.chart.renderer,f=r.horiz,l=this.type,c=this.label,h=this.pos,p=s.labels,v=this.gridLine,m=l?l+"Tick":"tick",y=r.tickSize(m),b=this.mark,w=!b,E=p.step,S={},x=!0,T=r.tickmarkOffset,N=this.getPosition(f,h,T,t),C=N.x,N=N.y,k=f&&C===r.pos+r.len||!f&&N===r.pos?-1:1,L=l?l+"Grid":"grid",A=s[L+"LineWidth"],O=s[L+"LineColor"],M=s[L+"LineDashStyle"],L=o(s[m+"Width"],!l&&r.isXAxis?1:0),m=s[m+"Color"];n=o(n,1),this.isActive=!0,v||(S.stroke=O,S["stroke-width"]=A,M&&(S.dashstyle=M),l||(S.zIndex=1),t&&(S.opacity=0),this.gridLine=v=a.path().attr(S).addClass("highcharts-"+(l?l+"-":"")+"grid-line").add(r.gridGroup)),!t&&v&&(h=r.getPlotLinePath(h+T,v.strokeWidth()*k,t,!0))&&v[this.isNew?"attr":"animate"]({d:h,opacity:n}),y&&(r.opposite&&(y[0]=-y[0]),w&&(this.mark=b=a.path().addClass("highcharts-"+(l?l+"-":"")+"tick").add(r.axisGroup),b.attr({stroke:m,"stroke-width":L})),b[w?"attr":"animate"]({d:this.getMarkPath(C,N,y[0],b.strokeWidth()*k,f,a),opacity:n})),c&&i(C)&&(c.xy=N=this.getLabelPosition(C,N,c,f,p,T,e,E),this.isFirst&&!this.isLast&&!o(s.showFirstLabel,1)||this.isLast&&!this.isFirst&&!o(s.showLastLabel,1)?x=!1:!f||r.isRadial||p.step||p.rotation||t||0===n||this.handleOverflow(N),E&&e%E&&(x=!1),x&&i(N.y)?(N.opacity=n,c[this.isNew?"attr":"animate"](N)):(u(c),c.attr("y",-9999)),this.isNew=!1)},destroy:function(){r(this,this.axis)}}}(e),function(e){var t=e.addEvent,n=e.animObject,r=e.arrayMax,i=e.arrayMin,s=e.AxisPlotLineOrBandExtension,o=e.color,u=e.correctFloat,a=e.defaultOptions,f=e.defined,l=e.deg2rad,c=e.destroyObjectProperties,h=e.each,p=e.error,d=e.extend,v=e.fireEvent,m=e.format,g=e.getMagnitude,y=e.grep,b=e.inArray,w=e.isArray,E=e.isNumber,S=e.isString,x=e.merge,T=e.normalizeTickInterval,N=e.pick,C=e.PlotLineOrBand,k=e.removeEvent,L=e.splat,A=e.syncTimeout,O=e.Tick;e.Axis=function(){this.init.apply(this,arguments)},e.Axis.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,labels:{enabled:!0,style:{color:"#666666",cursor:"default",fontSize:"11px"},x:0},minPadding:.01,maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return e.numberFormat(this.total,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"#000000",textShadow:"1px 1px contrast, -1px -1px contrast, -1px 1px contrast, 1px -1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(e,n){var r=n.isX;this.chart=e,this.horiz=e.inverted?!r:r,this.isXAxis=r,this.coll=this.coll||(r?"xAxis":"yAxis"),this.opposite=n.opposite,this.side=n.side||(this.horiz?this.opposite?0:2:this.opposite?1:3),this.setOptions(n);var i=this.options,s=i.type;this.labelFormatter=i.labels.formatter||this.defaultLabelFormatter,this.userOptions=n,this.minPixelPadding=0,this.reversed=i.reversed,this.visible=!1!==i.visible,this.zoomEnabled=!1!==i.zoomEnabled,this.hasNames="category"===s||!0===i.categories,this.categories=i.categories||this.hasNames,this.names=this.names||[],this.isLog="logarithmic"===s,this.isDatetimeAxis="datetime"===s,this.isLinked=f(i.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=i.minRange||i.maxZoom,this.range=i.range,this.offset=i.offset||0,this.stacks={},this.oldStacks={},this.stacksTouched=0,this.min=this.max=null,this.crosshair=N(i.crosshair,L(e.options.tooltip.crosshairs)[r?0:1],!1);var o,i=this.options.events;-1===b(this,e.axes)&&(r?e.axes.splice(e.xAxis.length,0,this):e.axes.push(this),e[this.coll].push(this)),this.series=this.series||[],e.inverted&&r&&void 0===this.reversed&&(this.reversed=!0),this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(o in i)t(this,o,i[o]);this.isLog&&(this.val2lin=this.log2lin,this.lin2val=this.lin2log)},setOptions:function(e){this.options=x(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],x(a[this.coll],e))},defaultLabelFormatter:function(){var t=this.axis,n=this.value,r=t.categories,i=this.dateTimeLabelFormat,s=a.lang.numericSymbols,o=s&&s.length,u,f=t.options.labels.format,t=t.isLog?n:t.tickInterval;if(f)u=m(f,this);else if(r)u=n;else if(i)u=e.dateFormat(i,n);else if(o&&1e3<=t)for(;o--&&void 0===u;)r=Math.pow(1e3,o+1),t>=r&&0===10*n%r&&null!==s[o]&&0!==n&&(u=e.numberFormat(n/r,-1)+s[o]);return void 0===u&&(u=1e4<=Math.abs(n)?e.numberFormat(n,-1):e.numberFormat(n,-1,void 0,"")),u},getSeriesExtremes:function(){var e=this,t=e.chart;e.hasVisibleSeries=!1,e.dataMin=e.dataMax=e.threshold=null,e.softThreshold=!e.isXAxis,e.buildStacks&&e.buildStacks(),h(e.series,function(n){if(n.visible||!t.options.chart.ignoreHiddenSeries){var s=n.options,o=s.threshold,u;e.hasVisibleSeries=!0,e.isLog&&0>=o&&(o=null);if(e.isXAxis)s=n.xData,s.length&&(n=i(s),E(n)||n instanceof Date||(s=y(s,function(e){return E(e)}),n=i(s)),e.dataMin=Math.min(N(e.dataMin,s[0]),n),e.dataMax=Math.max(N(e.dataMax,s[0]),r(s)));else if(n.getExtremes(),u=n.dataMax,n=n.dataMin,f(n)&&f(u)&&(e.dataMin=Math.min(N(e.dataMin,n),n),e.dataMax=Math.max(N(e.dataMax,u),u)),f(o)&&(e.threshold=o),!s.softThreshold||e.isLog)e.softThreshold=!1}})},translate:function(e,t,n,r,i,s){var o=this.linkedParent||this,u=1,a=0,f=r?o.oldTransA:o.transA;r=r?o.oldMin:o.min;var l=o.minPixelPadding;return i=(o.isOrdinal||o.isBroken||o.isLog&&i)&&o.lin2val,f||(f=o.transA),n&&(u*=-1,a=o.len),o.reversed&&(u*=-1,a-=u*(o.sector||o.len)),t?(e=(e*u+a-l)/f+r,i&&(e=o.lin2val(e))):(i&&(e=o.val2lin(e)),"between"===s&&(s=.5),e=u*(e-r)*f+a+u*l+(E(s)?f*s*o.pointRange:0)),e},toPixels:function(e,t){return this.translate(e,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(e,t,n,r,i){var s=this.chart,o=this.left,u=this.top,a,f,l=n&&s.oldChartHeight||s.chartHeight,c=n&&s.oldChartWidth||s.chartWidth,h;a=this.transB;var p=function(e,t,n){if(e<t||e>n)r?e=Math.min(Math.max(t,e),n):h=!0;return e};return i=N(i,this.translate(e,null,null,n)),e=n=Math.round(i+a),a=f=Math.round(l-i-a),E(i)?this.horiz?(a=u,f=l-this.bottom,e=n=p(e,o,o+this.width)):(e=o,n=c-this.right,a=f=p(a,u,u+this.height)):h=!0,h&&!r?null:s.renderer.crispLine(["M",e,a,"L",n,f],t||1)},getLinearTickPositions:function(e,t,n){var r,i=u(Math.floor(t/e)*e),s=u(Math.ceil(n/e)*e),o=[];if(t===n&&E(t))return[t];for(t=i;t<=s;){o.push(t),t=u(t+e);if(t===r)break;r=t}return o},getMinorTickPositions:function(){var e=this.options,t=this.tickPositions,n=this.minorTickInterval,r=[],i,s=this.pointRangePadding||0;i=this.min-s;var s=this.max+s,o=s-i;if(o&&o/n<this.len/3)if(this.isLog)for(s=t.length,i=1;i<s;i++)r=r.concat(this.getLogTickPositions(n,t[i-1],t[i],!0));else if(this.isDatetimeAxis&&"auto"===e.minorTickInterval)r=r.concat(this.getTimeTicks(this.normalizeTimeTickInterval(n),i,s,e.startOfWeek));else for(t=i+(t[0]-i)%n;t<=s;t+=n)r.push(t);return 0!==r.length&&this.trimTicks(r,e.startOnTick,e.endOnTick),r},adjustForMinRange:function(){var e=this.options,t=this.min,n=this.max,s,o=this.dataMax-this.dataMin>=this.minRange,u,a,l,c,p,d;this.isXAxis&&void 0===this.minRange&&!this.isLog&&(f(e.min)||f(e.max)?this.minRange=null:(h(this.series,function(e){c=e.xData;for(a=p=e.xIncrement?1:c.length-1;0<a;a--)if(l=c[a]-c[a-1],void 0===u||l<u)u=l}),this.minRange=Math.min(5*u,this.dataMax-this.dataMin))),n-t<this.minRange&&(d=this.minRange,s=(d-n+t)/2,s=[t-s,N(e.min,t-s)],o&&(s[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),t=r(s),n=[t+d,N(e.max,t+d)],o&&(n[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),n=i(n),n-t<d&&(s[0]=n-d,s[1]=N(e.min,n-d),t=r(s))),this.min=t,this.max=n},getClosest:function(){var e;return this.categories?e=1:h(this.series,function(t){var n=t.closestPointRange;!t.noSharedTooltip&&f(n)&&(e=f(e)?Math.min(e,n):n)}),e},nameToX:function(e){var t=w(this.categories),n=t?this.categories:this.names,r=e.options.x,i;return e.series.requireSorting=!1,f(r)||(r=!1===this.options.nameToX?e.series.autoIncrement():b(e.name,n)),-1===r?t||(i=n.length):i=r,this.names[i]=e.name,i},updateNames:function(){var e=this;0<this.names.length&&(this.names.length=0,this.minRange=void 0,h(this.series||[],function(t){t.processedXData||(t.processData(),t.generatePoints()),h(t.points,function(n,r){var i;n.options&&void 0===n.options.x&&(i=e.nameToX(n),i!==n.x&&(n.x=i,t.xData[r]=i))})}))},setAxisTranslation:function(e){var t=this,n=t.max-t.min,r=t.axisPointRange||0,i,s=0,o=0,u=t.linkedParent,a=!!t.categories,f=t.transA,l=t.isXAxis;if(l||a||r)u?(s=u.minPointOffset,o=u.pointRangePadding):(i=t.getClosest(),h(t.series,function(e){var n=a?1:l?N(e.options.pointRange,i,0):t.axisPointRange||0;e=e.options.pointPlacement,r=Math.max(r,n),t.single||(s=Math.max(s,S(e)?0:n/2),o=Math.max(o,"on"===e?0:n))})),u=t.ordinalSlope&&i?t.ordinalSlope/i:1,t.minPointOffset=s*=u,t.pointRangePadding=o*=u,t.pointRange=Math.min(r,n),l&&(t.closestPointRange=i);e&&(t.oldTransA=f),t.translationSlope=t.transA=f=t.len/(n+o||1),t.transB=t.horiz?t.left:t.bottom,t.minPixelPadding=f*s},minFromRange:function(){return this.max-this.range},setTickInterval:function(e){var t=this,n=t.chart,r=t.options,i=t.isLog,s=t.log2lin,o=t.isDatetimeAxis,a=t.isXAxis,l=t.isLinked,c=r.maxPadding,d=r.minPadding,m=r.tickInterval,y=r.tickPixelInterval,b=t.categories,w=t.threshold,S=t.softThreshold,x,C,k,L;o||b||l||this.getTickAmount(),k=N(t.userMin,r.min),L=N(t.userMax,r.max),l?(t.linkedParent=n[t.coll][r.linkedTo],n=t.linkedParent.getExtremes(),t.min=N(n.min,n.dataMin),t.max=N(n.max,n.dataMax),r.type!==t.linkedParent.options.type&&p(11,1)):(!S&&f(w)&&(t.dataMin>=w?(x=w,d=0):t.dataMax<=w&&(C=w,c=0)),t.min=N(k,x,t.dataMin),t.max=N(L,C,t.dataMax)),i&&(!e&&0>=Math.min(t.min,N(t.dataMin,t.min))&&p(10,1),t.min=u(s(t.min),15),t.max=u(s(t.max),15)),t.range&&f(t.max)&&(t.userMin=t.min=k=Math.max(t.min,t.minFromRange()),t.userMax=L=t.max,t.range=null),v(t,"foundExtremes"),t.beforePadding&&t.beforePadding(),t.adjustForMinRange(),!(b||t.axisPointRange||t.usePercentage||l)&&f(t.min)&&f(t.max)&&(s=t.max-t.min)&&(!f(k)&&d&&(t.min-=s*d),!f(L)&&c&&(t.max+=s*c)),E(r.floor)&&(t.min=Math.max(t.min,r.floor)),E(r.ceiling)&&(t.max=Math.min(t.max,r.ceiling)),S&&f(t.dataMin)&&(w=w||0,!f(k)&&t.min<w&&t.dataMin>=w?t.min=w:!f(L)&&t.max>w&&t.dataMax<=w&&(t.max=w)),t.tickInterval=t.min===t.max||void 0===t.min||void 0===t.max?1:l&&!m&&y===t.linkedParent.options.tickPixelInterval?m=t.linkedParent.tickInterval:N(m,this.tickAmount?(t.max-t.min)/Math.max(this.tickAmount-1,1):void 0,b?1:(t.max-t.min)*y/Math.max(t.len,y)),a&&!e&&h(t.series,function(e){e.processData(t.min!==t.oldMin||t.max!==t.oldMax)}),t.setAxisTranslation(!0),t.beforeSetTickPositions&&t.beforeSetTickPositions(),t.postProcessTickInterval&&(t.tickInterval=t.postProcessTickInterval(t.tickInterval)),t.pointRange&&!m&&(t.tickInterval=Math.max(t.pointRange,t.tickInterval)),e=N(r.minTickInterval,t.isDatetimeAxis&&t.closestPointRange),!m&&t.tickInterval<e&&(t.tickInterval=e),o||i||m||(t.tickInterval=T(t.tickInterval,null,g(t.tickInterval),N(r.allowDecimals,!(.5<t.tickInterval&&5>t.tickInterval&&1e3<t.max&&9999>t.max)),!!this.tickAmount)),this.tickAmount||(t.tickInterval=t.unsquish()),this.setTickPositions()},setTickPositions:function(){var e=this.options,t,n=e.tickPositions,r=e.tickPositioner,i=e.startOnTick,s=e.endOnTick,o;this.tickmarkOffset=this.categories&&"between"===e.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===e.minorTickInterval&&this.tickInterval?this.tickInterval/5:e.minorTickInterval,this.tickPositions=t=n&&n.slice(),!t&&(t=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,e.units),this.min,this.max,e.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),t.length>this.len&&(t=[t[0],t.pop()]),this.tickPositions=t,r&&(r=r.apply(this,[this.min,this.max])))&&(this.tickPositions=t=r),this.isLinked||(this.trimTicks(t,i,s),this.min===this.max&&f(this.min)&&!this.tickAmount&&(o=!0,this.min-=.5,this.max+=.5),this.single=o,n||r||this.adjustTickAmount())},trimTicks:function(e,t,n){var r=e[0],i=e[e.length-1],s=this.minPointOffset||0;if(t)this.min=r;else for(;this.min-s>e[0];)e.shift();if(n)this.max=i;else for(;this.max+s<e[e.length-1];)e.pop();0===e.length&&f(r)&&e.push((i+r)/2)},alignToOthers:function(){var e={},t,n=this.options;return!1!==this.chart.options.chart.alignTicks&&!1!==n.alignTicks&&h(this.chart[this.coll],function(n){var r=n.options,r=[n.horiz?r.left:r.top,r.width,r.height,r.pane].join();n.series.length&&(e[r]?t=!0:e[r]=1)}),t},getTickAmount:function(){var e=this.options,t=e.tickAmount,n=e.tickPixelInterval;!f(e.tickInterval)&&this.len<n&&!this.isRadial&&!this.isLog&&e.startOnTick&&e.endOnTick&&(t=2),!t&&this.alignToOthers()&&(t=Math.ceil(this.len/n)+1),4>t&&(this.finalTickAmt=t,t=5),this.tickAmount=t},adjustTickAmount:function(){var e=this.tickInterval,t=this.tickPositions,n=this.tickAmount,r=this.finalTickAmt,i=t&&t.length;if(i<n){for(;t.length<n;)t.push(u(t[t.length-1]+e));this.transA*=(i-1)/(n-1),this.max=t[t.length-1]}else i>n&&(this.tickInterval*=2,this.setTickPositions());if(f(r)){for(e=n=t.length;e--;)(3===r&&1===e%2||2>=r&&0<e&&e<n-1)&&t.splice(e,1);this.finalTickAmt=void 0}},setScale:function(){var e,t;this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),t=this.len!==this.oldAxisLength,h(this.series,function(t){if(t.isDirtyData||t.isDirty||t.xAxis.isDirty)e=!0}),t||e||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=t||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks()},setExtremes:function(e,t,n,r,i){var s=this,o=s.chart;n=N(n,!0),h(s.series,function(e){delete e.kdTree}),i=d(i,{min:e,max:t}),v(s,"setExtremes",i,function(){s.userMin=e,s.userMax=t,s.eventArgs=i,n&&o.redraw(r)})},zoom:function(e,t){var n=this.dataMin,r=this.dataMax,i=this.options,s=Math.min(n,N(i.min,n)),i=Math.max(r,N(i.max,r));return this.allowZoomOutside||(f(n)&&e<=s&&(e=s),f(r)&&t>=i&&(t=i)),this.displayBtn=void 0!==e||void 0!==t,this.setExtremes(e,t,!1,void 0,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,n=t.offsetLeft||0,r=this.horiz,i=N(t.width,e.plotWidth-n+(t.offsetRight||0)),s=N(t.height,e.plotHeight),o=N(t.top,e.plotTop),t=N(t.left,e.plotLeft+n),n=/%$/;n.test(s)&&(s=Math.round(parseFloat(s)/100*e.plotHeight)),n.test(o)&&(o=Math.round(parseFloat(o)/100*e.plotHeight+e.plotTop)),this.left=t,this.top=o,this.width=i,this.height=s,this.bottom=e.chartHeight-s-o,this.right=e.chartWidth-i-t,this.len=Math.max(r?i:s,0),this.pos=r?t:o},getExtremes:function(){var e=this.isLog,t=this.lin2log;return{min:e?u(t(this.min)):this.min,max:e?u(t(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(e){var t=this.isLog,n=this.lin2log,r=t?n(this.min):this.min,t=t?n(this.max):this.max;return null===e?e=r:r>e?e=r:t<e&&(e=t),this.translate(e,0,1,0,1)},autoLabelAlign:function(e){return e=(N(e,0)-90*this.side+720)%360,15<e&&165>e?"right":195<e&&345>e?"left":"center"},tickSize:function(e){var t=this.options,n=t[e+"Length"],r=N(t[e+"Width"],"tick"===e&&this.isXAxis?1:0);if(r&&n)return"inside"===t[e+"Position"]&&(n=-n),[n,r]},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var e=this.options.labels,t=this.horiz,n=this.tickInterval,r=n,i=this.len/(((this.categories?1:0)+this.max-this.min)/n),s,o=e.rotation,u=this.labelMetrics(),a,c=Number.MAX_VALUE,p,d=function(e){return e/=i||1,e=1<e?Math.ceil(e):1,e*n};return t?(p=!e.staggerLines&&!e.step&&(f(o)?[o]:i<N(e.autoRotationLimit,80)&&e.autoRotation))&&h(p,function(e){var t;if(e===o||e&&-90<=e&&90>=e)a=d(Math.abs(u.h/Math.sin(l*e))),t=a+Math.abs(e/360),t<c&&(c=t,s=e,r=a)}):e.step||(r=d(u.h)),this.autoRotation=p,this.labelRotation=N(s,o),r},getSlotWidth:function(){var e=this.chart,t=this.horiz,n=this.options.labels,r=Math.max(this.tickPositions.length-(this.categories?0:1),1),i=e.margin[3];return t&&2>(n.step||0)&&!n.rotation&&(this.staggerLines||1)*e.plotWidth/r||!t&&(i&&i-e.spacing[3]||.33*e.chartWidth)},renderUnsquish:function(){var e=this.chart,t=e.renderer,n=this.tickPositions,r=this.ticks,i=this.options.labels,s=this.horiz,o=this.getSlotWidth(),u=Math.max(1,Math.round(o-2*(i.padding||5))),a={},f=this.labelMetrics(),l=i.style&&i.style.textOverflow,c,p=0,d,v;S(i.rotation)||(a.rotation=i.rotation||0),h(n,function(e){(e=r[e])&&e.labelLength>p&&(p=e.labelLength)}),this.maxLabelLength=p;if(this.autoRotation)p>u&&p>f.h?a.rotation=this.labelRotation:this.labelRotation=0;else if(o&&(c={width:u+"px"},!l))for(c.textOverflow="clip",d=n.length;!s&&d--;)if(v=n[d],u=r[v].label)u.styles&&"ellipsis"===u.styles.textOverflow?u.css({textOverflow:"clip"}):r[v].labelLength>o&&u.css({width:o+"px"}),u.getBBox().height>this.len/n.length-(f.h-f.f)&&(u.specCss={textOverflow:"ellipsis"});a.rotation&&(c={width:(p>.5*e.chartHeight?.33*e.chartHeight:e.chartHeight)+"px"},l||(c.textOverflow="ellipsis"));if(this.labelAlign=i.align||this.autoLabelAlign(this.labelRotation))a.align=this.labelAlign;h(n,function(e){var t=(e=r[e])&&e.label;t&&(t.attr(a),c&&t.css(x(c,t.specCss)),delete t.specCss,e.rotation=a.rotation)}),this.tickRotCorr=t.rotCorr(f.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||f(this.min)&&f(this.max)&&!!this.tickPositions},getOffset:function(){var e=this,t=e.chart,n=t.renderer,r=e.options,i=e.tickPositions,s=e.ticks,o=e.horiz,u=e.side,a=t.inverted?[1,0,3,2][u]:u,l,c,p=0,d,v=0,m=r.title,g=r.labels,y=0,b=e.opposite,w=t.axisOffset,t=t.clipOffset,E=[-1,1,1,-1][u],S,x=r.className,T=e.axisParent,C=this.tickSize("tick");l=e.hasData(),e.showAxis=c=l||N(r.showEmpty,!0),e.staggerLines=e.horiz&&g.staggerLines,e.axisGroup||(e.gridGroup=n.g("grid").attr({zIndex:r.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(x||"")).add(T),e.axisGroup=n.g("axis").attr({zIndex:r.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(x||"")).add(T),e.labelGroup=n.g("axis-labels").attr({zIndex:g.zIndex||7}).addClass("highcharts-"+e.coll.toLowerCase()+"-labels "+(x||"")).add(T));if(l||e.isLinked)h(i,function(t){s[t]?s[t].addLabel():s[t]=new O(e,t)}),e.renderUnsquish(),!1===g.reserveSpace||0!==u&&2!==u&&{1:"left",3:"right"}[u]!==e.labelAlign&&"center"!==e.labelAlign||h(i,function(e){y=Math.max(s[e].getLabelSize(),y)}),e.staggerLines&&(y*=e.staggerLines,e.labelOffset=y*(e.opposite?-1:1));else for(S in s)s[S].destroy(),delete s[S];m&&m.text&&!1!==m.enabled&&(e.axisTitle||((S=m.textAlign)||(S=(o?{low:"left",middle:"center",high:"right"}:{low:b?"right":"left",middle:"center",high:b?"left":"right"})[m.align]),e.axisTitle=n.text(m.text,0,0,m.useHTML).attr({zIndex:7,rotation:m.rotation||0,align:S}).addClass("highcharts-axis-title").css(m.style).add(e.axisGroup),e.axisTitle.isNew=!0),c&&(p=e.axisTitle.getBBox()[o?"height":"width"],d=m.offset,v=f(d)?0:N(m.margin,o?5:10)),e.axisTitle[c?"show":"hide"](!0)),e.renderLine(),e.offset=E*N(r.offset,w[u]),e.tickRotCorr=e.tickRotCorr||{x:0,y:0},n=0===u?-e.labelMetrics().h:2===u?e.tickRotCorr.y:0,v=Math.abs(y)+v,y&&(v=v-n+E*(o?N(g.y,e.tickRotCorr.y+8*E):g.x)),e.axisTitleMargin=N(d,v),w[u]=Math.max(w[u],e.axisTitleMargin+p+E*e.offset,v,l&&i.length&&C?C[0]:0),r=r.offset?0:2*Math.floor(e.axisLine.strokeWidth()/2),t[a]=Math.max(t[a],r)},getLinePath:function(e){var t=this.chart,n=this.opposite,r=this.offset,i=this.horiz,s=this.left+(n?this.width:0)+r,r=t.chartHeight-this.bottom-(n?this.height:0)+r;return n&&(e*=-1),t.renderer.crispLine(["M",i?this.left:s,i?r:this.top,"L",i?t.chartWidth-this.right:s,i?r:t.chartHeight-this.bottom],e)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var e=this.horiz,t=this.left,n=this.top,r=this.len,i=this.options.title,s=e?t:n,o=this.opposite,u=this.offset,a=i.x||0,f=i.y||0,l=this.chart.renderer.fontMetrics(i.style&&i.style.fontSize,this.axisTitle).f,r={low:s+(e?0:r),middle:s+r/2,high:s+(e?r:0)}[i.align],t=(e?n+this.height:t)+(e?1:-1)*(o?-1:1)*this.axisTitleMargin+(2===this.side?l:0);return{x:e?r+a:t+(o?this.width:0)+u+a,y:e?t+f-(o?this.height:0)+u:r+f}},render:function(){var e=this,t=e.chart,r=t.renderer,i=e.options,s=e.isLog,o=e.lin2log,u=e.isLinked,a=e.tickPositions,f=e.axisTitle,l=e.ticks,c=e.minorTicks,p=e.alternateBands,d=i.stackLabels,v=i.alternateGridColor,m=e.tickmarkOffset,g=e.axisLine,y=t.hasRendered&&E(e.oldMin),b=e.showAxis,w=n(r.globalAnimation),S,x;e.labelEdge.length=0,e.overlap=!1,h([l,c,p],function(e){for(var t in e)e[t].isActive=!1});if(e.hasData()||u)e.minorTickInterval&&!e.categories&&h(e.getMinorTickPositions(),function(t){c[t]||(c[t]=new O(e,t,"minor")),y&&c[t].isNew&&c[t].render(null,!0),c[t].render(null,!1,1)}),a.length&&(h(a,function(t,n){if(!u||t>=e.min&&t<=e.max)l[t]||(l[t]=new O(e,t)),y&&l[t].isNew&&l[t].render(n,!0,.1),l[t].render(n)}),m&&(0===e.min||e.single)&&(l[-1]||(l[-1]=new O(e,-1,null,!0)),l[-1].render(-1))),v&&h(a,function(n,r){x=void 0!==a[r+1]?a[r+1]+m:e.max-m,0===r%2&&n<e.max&&x<=e.max+(t.polar?-m:m)&&(p[n]||(p[n]=new C(e)),S=n+m,p[n].options={from:s?o(S):S,to:s?o(x):x,color:v},p[n].render(),p[n].isActive=!0)}),e._addedPlotLB||(h((i.plotLines||[]).concat(i.plotBands||[]),function(t){e.addPlotBandOrLine(t)}),e._addedPlotLB=!0);h([l,c,p],function(e){var n,r,i=[],s=w.duration;for(n in e)e[n].isActive||(e[n].render(n,!1,0),e[n].isActive=!1,i.push(n));A(function(){for(r=i.length;r--;)e[i[r]]&&!e[i[r]].isActive&&(e[i[r]].destroy(),delete e[i[r]])},e!==p&&t.hasRendered&&s?s:0)}),g&&(g[g.isPlaced?"animate":"attr"]({d:this.getLinePath(g.strokeWidth())}),g.isPlaced=!0,g[b?"show":"hide"](!0)),f&&b&&(f[f.isNew?"attr":"animate"](e.getTitlePosition()),f.isNew=!1),d&&d.enabled&&e.renderStackTotals(),e.isDirty=!1},redraw:function(){this.visible&&(this.render(),h(this.plotLinesAndBands,function(e){e.render()})),h(this.series,function(e){e.isDirty=!0})},destroy:function(e){var t=this,n=t.stacks,r,i=t.plotLinesAndBands,s;e||k(t);for(r in n)c(n[r]),n[r]=null;h([t.ticks,t.minorTicks,t.alternateBands],function(e){c(e)});if(i)for(e=i.length;e--;)i[e].destroy();h("stackTotalGroup axisLine axisTitle axisGroup gridGroup labelGroup cross".split(" "),function(e){t[e]&&(t[e]=t[e].destroy())}),i=["names","series","userMax","userMin"];for(s in t)t.hasOwnProperty(s)&&-1===b(s,i)&&delete t[s]},drawCrosshair:function(e,t){var n,r=this.crosshair,i,s=this.cross;e||(e=this.cross&&this.cross.e),this.crosshair&&!1!==(f(t)||!N(r.snap,!0))?(N(r.snap,!0)?f(t)&&(n=this.isXAxis?t.plotX:this.len-t.plotY):n=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos,n=this.isRadial?this.getPlotLinePath(this.isXAxis?t.x:N(t.stackY,t.y))||null:this.getPlotLinePath(null,null,null,null,n)||null,null===n?this.hideCrosshair():(i=this.categories&&!this.isRadial,s||(this.cross=s=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(i?"category ":"thin ")+r.className).attr({zIndex:N(r.zIndex,2)}).add(),s.attr({stroke:r.color||(i?o("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":N(r.width,1)}),r.dashStyle&&s.attr({dashstyle:r.dashStyle})),s.show().attr({d:n}),i&&s.attr({"stroke-width":this.transA}),this.cross.e=e)):this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}},d(e.Axis.prototype,s)}(e),function(e){var t=e.Axis,n=e.Date,r=e.defaultOptions,i=e.defined,s=e.each,o=e.extend,u=e.getMagnitude,a=e.getTZOffset,f=e.grep,l=e.normalizeTickInterval,c=e.pick,h=e.timeUnits;t.prototype.getTimeTicks=function(e,t,u,l){var d=[],v={},w=r.global.useUTC,S,x=new n(t-a(t)),T=n.hcMakeTime,N=e.unitRange,C=e.count;if(i(t)){x[n.hcSetMilliseconds](N>=h.second?0:C*Math.floor(x.getMilliseconds()/C)),N>=h.second&&x[n.hcSetSeconds](N>=h.minute?0:C*Math.floor(x.getSeconds()/C)),N>=h.minute&&x[n.hcSetMinutes](N>=h.hour?0:C*Math.floor(x[n.hcGetMinutes]()/C)),N>=h.hour&&x[n.hcSetHours](N>=h.day?0:C*Math.floor(x[n.hcGetHours]()/C)),N>=h.day&&x[n.hcSetDate](N>=h.month?1:C*Math.floor(x[n.hcGetDate]()/C)),N>=h.month&&(x[n.hcSetMonth](N>=h.year?0:C*Math.floor(x[n.hcGetMonth]()/C)),S=x[n.hcGetFullYear]()),N>=h.year&&x[n.hcSetFullYear](S-S%C),N===h.week&&x[n.hcSetDate](x[n.hcGetDate]()-x[n.hcGetDay]()+c(l,1)),t=1;if(n.hcTimezoneOffset||n.hcGetTimezoneOffset)x=x.getTime(),x=new n(x+a(x));S=x[n.hcGetFullYear](),l=x.getTime();for(var k=x[n.hcGetMonth](),L=x[n.hcGetDate](),A=!w||!!n.hcGetTimezoneOffset,O=(h.day+(w?a(x):6e4*x.getTimezoneOffset()))%h.day;l<u;)d.push(l),l=N===h.year?T(S+t*C,0):N===h.month?T(S,k+t*C):!A||N!==h.day&&N!==h.week?l+N*C:T(S,k,L+t*C*(N===h.day?1:7)),t++;d.push(l),s(f(d,function(e){return N<=h.hour&&e%h.day===O}),function(e){v[e]="day"})}return d.info=o(e,{higherRanks:v,totalRange:N*C}),d},t.prototype.normalizeTimeTickInterval=function(e,t){var n=t||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],r=n[n.length-1],i=h[r[0]],s=r[1],o;for(o=0;o<n.length&&!(r=n[o],i=h[r[0]],s=r[1],n[o+1]&&e<=(i*s[s.length-1]+h[n[o+1][0]])/2);o++);return i===h.year&&e<5*i&&(s=[1,2,5]),n=l(e/i,s,"year"===r[0]?Math.max(u(e/i),1):1),{unitRange:i,count:n,unitName:r[0]}}}(e),function(e){var t=e.Axis,n=e.getMagnitude,r=e.map,i=e.normalizeTickInterval,s=e.pick;t.prototype.getLogTickPositions=function(e,t,o,u){var a=this.options,f=this.len,l=this.lin2log,c=this.log2lin,h=[];u||(this._minorAutoInterval=null);if(.5<=e)e=Math.round(e),h=this.getLinearTickPositions(e,t,o);else if(.08<=e)for(var f=Math.floor(t),p,d,v,m,g,a=.3<e?[1,2,4]:.15<e?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<o+1&&!g;f++)for(d=a.length,p=0;p<d&&!g;p++)v=c(l(f)*a[p]),v>t&&(!u||m<=o)&&void 0!==m&&h.push(m),m>o&&(g=!0),m=v;else t=l(t),o=l(o),e=a[u?"minorTickInterval":"tickInterval"],e=s("auto"===e?null:e,this._minorAutoInterval,a.tickPixelInterval/(u?5:1)*(o-t)/((u?f/this.tickPositions.length:f)||1)),e=i(e,null,n(e)),h=r(this.getLinearTickPositions(e,t,o),c),u||(this._minorAutoInterval=e/5);return u||(this.tickInterval=e),h},t.prototype.log2lin=function(e){return Math.log(e)/Math.LN10},t.prototype.lin2log=function(e){return Math.pow(10,e)}}(e),function(e){var t=e.addEvent,n=e.dateFormat,r=e.each,i=e.extend,s=e.format,o=e.isNumber,u=e.map,a=e.merge,f=e.pick,l=e.splat,c=e.stop,h=e.syncTimeout,p=e.timeUnits;e.Tooltip=function(){this.init.apply(this,arguments)},e.Tooltip.prototype={init:function(e,t){this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=t.split&&!e.inverted,this.shared=t.shared||this.split,this.split?this.label=this.chart.renderer.g("tooltip"):(this.label=e.renderer.label("",0,0,t.shape||"callout",null,null,t.useHTML,null,"tooltip").attr({padding:t.padding,r:t.borderRadius,display:"none"}),this.label.attr({fill:t.backgroundColor,"stroke-width":t.borderWidth}).css(t.style).shadow(t.shadow)),this.label.attr({zIndex:8}).add()},update:function(e){this.destroy(),this.init(this.chart,a(!0,this.options,e))},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(e,t,n,r){var s=this,o=s.now,u=!1!==s.options.animation&&!s.isHidden&&(1<Math.abs(e-o.x)||1<Math.abs(t-o.y)),a=s.followPointer||1<s.len;i(o,{x:u?(2*o.x+e)/3:e,y:u?(o.y+t)/2:t,anchorX:a?void 0:u?(2*o.anchorX+n)/3:n,anchorY:a?void 0:u?(o.anchorY+r)/2:r}),s.label.attr(o),u&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){s&&s.move(e,t,n,r)},32))},hide:function(e){var t=this;clearTimeout(this.hideTimer),e=f(e,this.options.hideDelay,500),this.isHidden||(this.hideTimer=h(function(){t.label[e?"fadeOut":"hide"](),t.isHidden=!0},e))},getAnchor:function(e,t){var n,i=this.chart,s=i.inverted,o=i.plotTop,a=i.plotLeft,f=0,c=0,h,p;return e=l(e),n=e[0].tooltipPos,this.followPointer&&t&&(void 0===t.chartX&&(t=i.pointer.normalize(t)),n=[t.chartX-i.plotLeft,t.chartY-o]),n||(r(e,function(e){h=e.series.yAxis,p=e.series.xAxis,f+=e.plotX+(!s&&p?p.left-a:0),c+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!s&&h?h.top-o:0)}),f/=e.length,c/=e.length,n=[s?i.plotWidth-c:f,this.shared&&!s&&1<e.length&&t?t.chartY-o:s?i.plotHeight-f:c]),u(n,Math.round)},getPosition:function(e,t,n){var r=this.chart,i=this.distance,s={},o=n.h||0,u,a=["y",r.chartHeight,t,n.plotY+r.plotTop,r.plotTop,r.plotTop+r.plotHeight],l=["x",r.chartWidth,e,n.plotX+r.plotLeft,r.plotLeft,r.plotLeft+r.plotWidth],c=!this.followPointer&&f(n.ttBelow,!r.inverted==!!n.negative),h=function(e,t,n,r,u,a){var f=n<r-i,l=r+i+n<t,h=r-i-n;r+=i;if(c&&l)s[e]=r;else if(!c&&f)s[e]=h;else if(f)s[e]=Math.min(a-n,0>h-o?h:h-o);else{if(!l)return!1;s[e]=Math.max(u,r+o+n>t?r:r+o)}},p=function(e,t,n,r){var o;return r<i||r>t-i?o=!1:s[e]=r<n/2?1:r>t-n/2?t-n-2:r-n/2,o},d=function(e){var t=a;a=l,l=t,u=e},v=function(){!1!==h.apply(0,a)?!1!==p.apply(0,l)||u||(d(!0),v()):u?s.x=s.y=0:(d(!0),v())};return(r.inverted||1<this.len)&&d(),v(),s},defaultFormatter:function(e){var t=this.points||l(this),n;return n=[e.tooltipFooterHeaderFormatter(t[0])],n=n.concat(e.bodyFormatter(t)),n.push(e.tooltipFooterHeaderFormatter(t[0],!0)),n},refresh:function(e,t){var n=this.chart,i=this.label,s=this.options,o,u,a,h={},p,d=[];p=s.formatter||this.defaultFormatter;var h=n.hoverPoints,v=this.shared;clearTimeout(this.hideTimer),this.followPointer=l(e)[0].series.tooltipOptions.followPointer,a=this.getAnchor(e,t),o=a[0],u=a[1],!v||e.series&&e.series.noSharedTooltip?h=e.getLabelConfig():(n.hoverPoints=e,h&&r(h,function(e){e.setState()}),r(e,function(e){e.setState("hover"),d.push(e.getLabelConfig())}),h={x:e[0].category,y:e[0].y},h.points=d,this.len=d.length,e=e[0]),p=p.call(h,this),h=e.series,this.distance=f(h.tooltipOptions.distance,16),!1===p?this.hide():(this.isHidden&&(c(i),i.attr({opacity:1,display:"block"}).show()),this.split?this.renderSplit(p,n.hoverPoints):(i.attr({text:p.join?p.join(""):p}),i.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+f(e.colorIndex,h.colorIndex)),i.attr({stroke:s.borderColor||e.color||h.color||"#666666"}),this.updatePosition({plotX:o,plotY:u,negative:e.negative,ttBelow:e.ttBelow,h:a[2]||0})),this.isHidden=!1)},renderSplit:function(n,i){var s=this,o=[],u=this.chart,a=u.renderer,l=!0,c=this.options,h;r(n.slice(0,n.length-1),function(e,n){var r=i[n-1]||{isHeader:!0,plotX:i[0].plotX},p=r.series||s,v=p.tt,m=r.series||{},g="highcharts-color-"+f(r.colorIndex,m.colorIndex,"none");v||(p.tt=v=a.label(null,null,null,r.isHeader&&"callout").addClass("highcharts-tooltip-box "+g).attr({padding:c.padding,r:c.borderRadius,fill:c.backgroundColor,stroke:r.color||m.color||"#333333","stroke-width":c.borderWidth}).add(s.label),r.series&&(v.connector=a.path().addClass("highcharts-tooltip-connector "+g).attr({"stroke-width":m.options.lineWidth||2,stroke:r.color||m.color||"#666666"}).add(s.label),t(r.series,"hide",function(){var e=this.tt;e.connector=e.connector.destroy(),e.destroy(),this.tt=void 0}))),v.isActive=!0,v.attr({text:e}),m=v.getBBox(),r.isHeader?(h=m.height,g=r.plotX+u.plotLeft-m.width/2):g=r.plotX+u.plotLeft-f(c.distance,16)-m.width,0>g&&(l=!1),m=(r.series&&r.series.yAxis&&r.series.yAxis.pos)+(r.plotY||0),m-=u.plotTop,o.push({target:r.isHeader?u.plotHeight+h:m,rank:r.isHeader?1:0,size:p.tt.getBBox().height+1,point:r,x:g,tt:v})}),r(u.series,function(e){var t=e.tt;t&&(t.isActive?t.isActive=!1:(t.connector=t.connector.destroy(),t.destroy(),e.tt=void 0))}),e.distribute(o,u.plotHeight+h),r(o,function(e){var t=e.point,n=e.tt,r;r={display:void 0===e.pos?"none":"",x:l||t.isHeader?e.x:t.plotX+u.plotLeft+f(c.distance,16),y:e.pos+u.plotTop},t.isHeader&&(r.anchorX=t.plotX+u.plotLeft,r.anchorY=r.y-100),n.attr(r),t.isHeader||n.connector.attr({d:["M",t.plotX+u.plotLeft,t.plotY+t.series.yAxis.pos,"L",l?t.plotX+u.plotLeft-f(c.distance,16):t.plotX+u.plotLeft+f(c.distance,16),e.pos+u.plotTop+n.getBBox().height/2]})})},updatePosition:function(e){var t=this.chart,n=this.label,n=(this.options.positioner||this.getPosition).call(this,n.width,n.height,e);this.move(Math.round(n.x),Math.round(n.y||0),e.plotX+t.plotLeft,e.plotY+t.plotTop)},getXDateFormat:function(e,t,r){var i;t=t.dateTimeLabelFormats;var s=r&&r.closestPointRange,o,u={millisecond:15,second:12,minute:9,hour:6,day:3},a,f="millisecond";if(s){a=n("%m-%d %H:%M:%S.%L",e.x);for(o in p){if(s===p.week&&+n("%w",e.x)===r.options.startOfWeek&&"00:00:00.000"===a.substr(6)){o="week";break}if(p[o]>s){o=f;break}if(u[o]&&a.substr(u[o])!=="01-01 00:00:00.000".substr(u[o]))break;"week"!==o&&(f=o)}o&&(i=t[o])}else i=t.day;return i||t.year},tooltipFooterHeaderFormatter:function(e,t){var n=t?"footer":"header",r=e.series,i=r.tooltipOptions,u=i.xDateFormat,a=r.xAxis,f=a&&"datetime"===a.options.type&&o(e.key),n=i[n+"Format"];return f&&!u&&(u=this.getXDateFormat(e,i,a)),f&&u&&(n=n.replace("{point.key}","{point.key:"+u+"}")),s(n,{point:e,series:r})},bodyFormatter:function(e){return u(e,function(e){var t=e.series.tooltipOptions;return(t.pointFormatter||e.point.tooltipFormatter).call(e.point,t.pointFormat)})}}}(e),function(e){var t=e.addEvent,n=e.attr,r=e.charts,i=e.color,s=e.css,o=e.defined,u=e.doc,a=e.each,f=e.extend,l=e.fireEvent,c=e.offset,h=e.pick,p=e.removeEvent,d=e.splat,v=e.Tooltip,m=e.win;e.hasTouch=u&&void 0!==u.documentElement.ontouchstart,e.Pointer=function(e,t){this.init(e,t)},e.Pointer.prototype={init:function(e,t){this.options=t,this.chart=e,this.runChartClick=t.chart.events&&!!t.chart.events.click,this.pinchDown=[],this.lastValidTouch={},v&&t.tooltip.enabled&&(e.tooltip=new v(e,t.tooltip),this.followTouchMove=h(t.tooltip.followTouchMove,!0)),this.setDOMEvents()},zoomOption:function(){var e=this.chart,t=e.options.chart.zoomType,n=/x/.test(t),t=/y/.test(t),e=e.inverted;this.zoomX=n,this.zoomY=t,this.zoomHor=n&&!e||t&&e,this.zoomVert=t&&!e||n&&e,this.hasZoom=n||t},normalize:function(e,t){var n,r;return e=e||m.event,e.target||(e.target=e.srcElement),r=e.touches?e.touches.length?e.touches.item(0):e.changedTouches[0]:e,t||(this.chartPosition=t=c(this.chart.container)),void 0===r.pageX?(n=Math.max(e.x,e.clientX-t.left),r=e.y):(n=r.pageX-t.left,r=r.pageY-t.top),f(e,{chartX:Math.round(n),chartY:Math.round(r)})},getCoordinates:function(e){var t={xAxis:[],yAxis:[]};return a(this.chart.axes,function(n){t[n.isXAxis?"xAxis":"yAxis"].push({axis:n,value:n.toValue(e[n.horiz?"chartX":"chartY"])})}),t},runPointActions:function(n){var i=this.chart,s=i.series,o=i.tooltip,f=o?o.shared:!1,l=!0,c=i.hoverPoint,p=i.hoverSeries,d,v,m,g=[],y;if(!f&&!p)for(d=0;d<s.length;d++)if(s[d].directTouch||!s[d].options.stickyTracking)s=[];p&&(f?p.noSharedTooltip:p.directTouch)&&c?g=[c]:(f||!p||p.options.stickyTracking||(s=[p]),a(s,function(e){v=e.noSharedTooltip&&f,m=!f&&e.directTouch,e.visible&&!v&&!m&&h(e.options.enableMouseTracking,!0)&&(y=e.searchPoint(n,!v&&1===e.kdDimensions))&&y.series&&g.push(y)}),g.sort(function(e,t){var n=e.distX-t.distX,r=e.dist-t.dist;return 0!==n?n:0!==r?r:e.series.group.zIndex>t.series.group.zIndex?-1:1}));if(f)for(d=g.length;d--;)(g[d].clientX!==g[0].clientX||g[d].series.noSharedTooltip)&&g.splice(d,1);if(g[0]&&(g[0]!==this.hoverPoint||o&&o.isHidden)){if(f&&!g[0].series.noSharedTooltip){for(d=0;0<=d;d--)g[d].onMouseOver(n,g[d]!==(p&&p.directTouch&&c||g[0]));p&&p.directTouch&&c&&c!==g[0]&&c.onMouseOver(n,!1),g.length&&o&&o.refresh(g.sort(function(e,t){return e.series.index-t.series.index}),n)}else(o&&o.refresh(g[0],n),!p||!p.directTouch)&&g[0].onMouseOver(n);this.prevKDPoint=g[0],l=!1}l&&(s=p&&p.tooltipOptions.followPointer,o&&s&&!o.isHidden&&(s=o.getAnchor([{}],n),o.updatePosition({plotX:s[0],plotY:s[1]}))),this._onDocumentMouseMove||(this._onDocumentMouseMove=function(t){r[e.hoverChartIndex]&&r[e.hoverChartIndex].pointer.onDocumentMouseMove(t)},t(u,"mousemove",this._onDocumentMouseMove)),a(f?g:[h(c,g[0])],function(e){a(i.axes,function(t){(!e||e.series&&e.series[t.coll]===t)&&t.drawCrosshair(n,e)})})},reset:function(e,t){var n=this.chart,r=n.hoverSeries,i=n.hoverPoint,s=n.hoverPoints,o=n.tooltip,f=o&&o.shared?s:i;e&&f&&a(d(f),function(t){t.series.isCartesian&&void 0===t.plotX&&(e=!1)}),e?o&&f&&(o.refresh(f),i&&(i.setState(i.state,!0),a(n.axes,function(e){e.crosshair&&e.drawCrosshair(null,i)}))):(i&&i.onMouseOut(),s&&a(s,function(e){e.setState()}),r&&r.onMouseOut(),o&&o.hide(t),this._onDocumentMouseMove&&(p(u,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null),a(n.axes,function(e){e.hideCrosshair()}),this.hoverX=this.prevKDPoint=n.hoverPoints=n.hoverPoint=null)},scaleGroups:function(e,t){var n=this.chart,r;a(n.series,function(i){r=e||i.getPlotBox(),i.xAxis&&i.xAxis.zoomEnabled&&(i.group.attr(r),i.markerGroup&&(i.markerGroup.attr(r),i.markerGroup.clip(t?n.clipRect:null)),i.dataLabelsGroup&&i.dataLabelsGroup.attr(r))}),n.clipRect.attr(t||n.clipBox)},dragStart:function(e){var t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=this.mouseDownX=e.chartX,t.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var t=this.chart,n=t.options.chart,r=e.chartX,s=e.chartY,o=this.zoomHor,u=this.zoomVert,a=t.plotLeft,f=t.plotTop,l=t.plotWidth,c=t.plotHeight,h,p=this.selectionMarker,d=this.mouseDownX,v=this.mouseDownY,m=n.panKey&&e[n.panKey+"Key"];p&&p.touch||(r<a?r=a:r>a+l&&(r=a+l),s<f?s=f:s>f+c&&(s=f+c),this.hasDragged=Math.sqrt(Math.pow(d-r,2)+Math.pow(v-s,2)),10<this.hasDragged&&(h=t.isInsidePlot(d-a,v-f),t.hasCartesianSeries&&(this.zoomX||this.zoomY)&&h&&!m&&!p&&(this.selectionMarker=p=t.renderer.rect(a,f,o?1:l,u?1:c,0).attr({fill:n.selectionMarkerFill||i("#335cad").setOpacity(.25).get(),"class":"highcharts-selection-marker",zIndex:7}).add()),p&&o&&(r-=d,p.attr({width:Math.abs(r),x:(0<r?0:r)+d})),p&&u&&(r=s-v,p.attr({height:Math.abs(r),y:(0<r?0:r)+v})),h&&!p&&n.panning&&t.pan(e,n.panning)))},drop:function(e){var t=this,n=this.chart,r=this.hasPinched;if(this.selectionMarker){var i={originalEvent:e,xAxis:[],yAxis:[]},u=this.selectionMarker,c=u.attr?u.attr("x"):u.x,h=u.attr?u.attr("y"):u.y,p=u.attr?u.attr("width"):u.width,d=u.attr?u.attr("height"):u.height,v;if(this.hasDragged||r)a(n.axes,function(n){if(n.zoomEnabled&&o(n.min)&&(r||t[{xAxis:"zoomX",yAxis:"zoomY"}[n.coll]])){var s=n.horiz,u="touchend"===e.type?n.minPixelPadding:0,a=n.toValue((s?c:h)+u),s=n.toValue((s?c+p:h+d)-u);i[n.coll].push({axis:n,min:Math.min(a,s),max:Math.max(a,s)}),v=!0}}),v&&l(n,"selection",i,function(e){n.zoom(f(e,r?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy(),r&&this.scaleGroups()}n&&(s(n.container,{cursor:n._cursor}),n.cancelClick=10<this.hasDragged,n.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(e){e=this.normalize(e),this.zoomOption(),e.preventDefault&&e.preventDefault(),this.dragStart(e)},onDocumentMouseUp:function(t){r[e.hoverChartIndex]&&r[e.hoverChartIndex].pointer.drop(t)},onDocumentMouseMove:function(e){var t=this.chart,n=this.chartPosition;e=this.normalize(e,n),!n||this.inClass(e.target,"highcharts-tracker")||t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)||this.reset()},onContainerMouseLeave:function(t){var n=r[e.hoverChartIndex];n&&(t.relatedTarget||t.toElement)&&(n.pointer.reset(),n.pointer.chartPosition=null)},onContainerMouseMove:function(t){var n=this.chart;o(e.hoverChartIndex)&&r[e.hoverChartIndex]&&r[e.hoverChartIndex].mouseIsDown||(e.hoverChartIndex=n.index),t=this.normalize(t),t.returnValue=!1,"mousedown"===n.mouseIsDown&&this.drag(t),!this.inClass(t.target,"highcharts-tracker")&&!n.isInsidePlot(t.chartX-n.plotLeft,t.chartY-n.plotTop)||n.openMenu||this.runPointActions(t)},inClass:function(e,t){for(var r;e;){if(r=n(e,"class")){if(-1!==r.indexOf(t))return!0;if(-1!==r.indexOf("highcharts-container"))return!1}e=e.parentNode}},onTrackerMouseOut:function(e){var t=this.chart.hoverSeries;e=e.relatedTarget||e.toElement,t&&e&&!t.options.stickyTracking&&!this.inClass(e,"highcharts-tooltip")&&!this.inClass(e,"highcharts-series-"+t.index)&&t.onMouseOut()},onContainerClick:function(e){var t=this.chart,n=t.hoverPoint,r=t.plotLeft,i=t.plotTop;e=this.normalize(e),t.cancelClick||(n&&this.inClass(e.target,"highcharts-tracker")?(l(n.series,"click",f(e,{point:n})),t.hoverPoint&&n.firePointEvent("click",e)):(f(e,this.getCoordinates(e)),t.isInsidePlot(e.chartX-r,e.chartY-i)&&l(t,"click",e)))},setDOMEvents:function(){var n=this,r=n.chart.container;r.onmousedown=function(e){n.onContainerMouseDown(e)},r.onmousemove=function(e){n.onContainerMouseMove(e)},r.onclick=function(e){n.onContainerClick(e)},t(r,"mouseleave",n.onContainerMouseLeave),1===e.chartCount&&t(u,"mouseup",n.onDocumentMouseUp),e.hasTouch&&(r.ontouchstart=function(e){n.onContainerTouchStart(e)},r.ontouchmove=function(e){n.onContainerTouchMove(e)},1===e.chartCount&&t(u,"touchend",n.onDocumentTouchEnd))},destroy:function(){var t;p(this.chart.container,"mouseleave",this.onContainerMouseLeave),e.chartCount||(p(u,"mouseup",this.onDocumentMouseUp),p(u,"touchend",this.onDocumentTouchEnd)),clearInterval(this.tooltipTimeout);for(t in this)this[t]=null}}}(e),function(e){var t=e.charts,n=e.each,r=e.extend,i=e.map,s=e.noop,o=e.pick;r(e.Pointer.prototype,{pinchTranslate:function(e,t,n,r,i,s){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,e,t,n,r,i,s),(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,e,t,n,r,i,s)},pinchTranslateDirection:function(e,t,n,r,i,s,o,u){var a=this.chart,f=e?"x":"y",l=e?"X":"Y",c="chart"+l,h=e?"width":"height",p=a["plot"+(e?"Left":"Top")],d,v,m=u||1,g=a.inverted,y=a.bounds[e?"h":"v"],b=1===t.length,w=t[0][c],E=n[0][c],S=!b&&t[1][c],x=!b&&n[1][c],T;n=function(){!b&&20<Math.abs(w-S)&&(m=u||Math.abs(E-x)/Math.abs(w-S)),v=(p-E)/m+w,d=a["plot"+(e?"Width":"Height")]/m},n(),t=v,t<y.min?(t=y.min,T=!0):t+d>y.max&&(t=y.max-d,T=!0),T?(E-=.8*(E-o[f][0]),b||(x-=.8*(x-o[f][1])),n()):o[f]=[E,x],g||(s[f]=v-p,s[h]=d),s=g?1/m:m,i[h]=d,i[f]=t,r[g?e?"scaleY":"scaleX":"scale"+l]=m,r["translate"+l]=s*p+(E-s*w)},pinch:function(e){var t=this,u=t.chart,a=t.pinchDown,f=e.touches,l=f.length,c=t.lastValidTouch,h=t.hasZoom,p=t.selectionMarker,d={},v=1===l&&(t.inClass(e.target,"highcharts-tracker")&&u.runTrackerClick||t.runChartClick),m={};1<l&&(t.initiated=!0),h&&t.initiated&&!v&&e.preventDefault(),i(f,function(e){return t.normalize(e)}),"touchstart"===e.type?(n(f,function(e,t){a[t]={chartX:e.chartX,chartY:e.chartY}}),c.x=[a[0].chartX,a[1]&&a[1].chartX],c.y=[a[0].chartY,a[1]&&a[1].chartY],n(u.axes,function(e){if(e.zoomEnabled){var t=u.bounds[e.horiz?"h":"v"],n=e.minPixelPadding,r=e.toPixels(o(e.options.min,e.dataMin)),i=e.toPixels(o(e.options.max,e.dataMax)),s=Math.max(r,i);t.min=Math.min(e.pos,Math.min(r,i)-n),t.max=Math.max(e.pos+e.len,s+n)}}),t.res=!0):a.length&&(p||(t.selectionMarker=p=r({destroy:s,touch:!0},u.plotBox)),t.pinchTranslate(a,f,d,p,m,c),t.hasPinched=h,t.scaleGroups(d,m),!h&&t.followTouchMove&&1===l?this.runPointActions(t.normalize(e)):t.res&&(t.res=!1,this.reset(!1,0)))},touch:function(t,n){var r=this.chart,i;e.hoverChartIndex=r.index,1===t.touches.length?(t=this.normalize(t),r.isInsidePlot(t.chartX-r.plotLeft,t.chartY-r.plotTop)&&!r.openMenu?(n&&this.runPointActions(t),"touchmove"===t.type&&(r=this.pinchDown,i=r[0]?4<=Math.sqrt(Math.pow(r[0].chartX-t.chartX,2)+Math.pow(r[0].chartY-t.chartY,2)):!1),o(i,!0)&&this.pinch(t)):n&&this.reset()):2===t.touches.length&&this.pinch(t)},onContainerTouchStart:function(e){this.zoomOption(),this.touch(e,!0)},onContainerTouchMove:function(e){this.touch(e)},onDocumentTouchEnd:function(n){t[e.hoverChartIndex]&&t[e.hoverChartIndex].pointer.drop(n)}})}(e),function(e){var t=e.addEvent,n=e.charts,r=e.css,i=e.doc,s=e.extend,o=e.noop,u=e.Pointer,a=e.removeEvent,f=e.win,l=e.wrap;if(f.PointerEvent||f.MSPointerEvent){var c={},h=!!f.PointerEvent,p=function(){var e,t=[];t.item=function(e){return this[e]};for(e in c)c.hasOwnProperty(e)&&t.push({pageX:c[e].pageX,pageY:c[e].pageY,target:c[e].target});return t},d=function(t,r,i,s){"touch"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_TOUCH||!n[e.hoverChartIndex]||(s(t),s=n[e.hoverChartIndex].pointer,s[r]({type:i,target:t.currentTarget,preventDefault:o,touches:p()}))};s(u.prototype,{onContainerPointerDown:function(e){d(e,"onContainerTouchStart","touchstart",function(e){c[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){d(e,"onContainerTouchMove","touchmove",function(e){c[e.pointerId]={pageX:e.pageX,pageY:e.pageY},c[e.pointerId].target||(c[e.pointerId].target=e.currentTarget)})},onDocumentPointerUp:function(e){d(e,"onDocumentTouchEnd","touchend",function(e){delete c[e.pointerId]})},batchMSEvents:function(e){e(this.chart.container,h?"pointerdown":"MSPointerDown",this.onContainerPointerDown),e(this.chart.container,h?"pointermove":"MSPointerMove",this.onContainerPointerMove),e(i,h?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),l(u.prototype,"init",function(e,t,n){e.call(this,t,n),this.hasZoom&&r(t.container,{"-ms-touch-action":"none","touch-action":"none"})}),l(u.prototype,"setDOMEvents",function(e){e.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(t)}),l(u.prototype,"destroy",function(e){this.batchMSEvents(a),e.call(this)})}}(e),function(e){var t,n=e.addEvent,r=e.css,i=e.discardElement,s=e.defined,o=e.each,u=e.extend,a=e.isFirefox,f=e.marginNames,l=e.merge,c=e.pick,h=e.setAnimation,p=e.stableSort,d=e.win,v=e.wrap;t=e.Legend=function(e,t){this.init(e,t)},t.prototype={init:function(e,t){this.chart=e,this.setOptions(t),t.enabled&&(this.render(),n(this.chart,"endResize",function(){this.legend.positionCheckboxes()}))},setOptions:function(e){var t=c(e.padding,8);this.options=e,this.itemStyle=e.itemStyle,this.itemHiddenStyle=l(this.itemStyle,e.itemHiddenStyle),this.itemMarginTop=e.itemMarginTop||0,this.initialItemX=this.padding=t,this.initialItemY=t-5,this.itemHeight=this.maxItemWidth=0,this.symbolWidth=c(e.symbolWidth,16),this.pages=[]},update:function(e,t){var n=this.chart;this.setOptions(l(!0,this.options,e)),this.destroy(),n.isDirtyLegend=n.isDirtyBox=!0,c(t,!0)&&n.redraw()},colorizeItem:function(e,t){e.legendGroup[t?"removeClass":"addClass"]("highcharts-legend-item-hidden");var n=this.options,r=e.legendItem,i=e.legendLine,s=e.legendSymbol,o=this.itemHiddenStyle.color,n=t?n.itemStyle.color:o,u=t?e.color||o:o,a=e.options&&e.options.marker,f={fill:u},l;r&&r.css({fill:n,color:n}),i&&i.attr({stroke:u});if(s){if(a&&s.isMarker&&(f=e.pointAttribs(),!t))for(l in f)f[l]=o;s.attr(f)}},positionItem:function(e){var t=this.options,n=t.symbolPadding,t=!t.rtl,r=e._legendItemPos,i=r[0],r=r[1],s=e.checkbox;(e=e.legendGroup)&&e.element&&e.translate(t?i:this.legendWidth-i-2*n-4,r),s&&(s.x=i,s.y=r)},destroyItem:function(e){var t=e.checkbox;o(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())}),t&&i(e.checkbox)},destroy:function(){var e=this.group,t=this.box;t&&(this.box=t.destroy()),o(this.getAllItems(),function(e){o(["legendItem","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())})}),e&&(this.group=e.destroy())},positionCheckboxes:function(e){var t=this.group.alignAttr,n,i=this.clipHeight||this.legendHeight,s=this.titleHeight;t&&(n=t.translateY,o(this.allItems,function(o){var u=o.checkbox,a;u&&(a=n+s+u.y+(e||0)+3,r(u,{left:t.translateX+o.checkboxOffset+u.x-20+"px",top:a+"px",display:a>n-6&&a<n+i-6?"":"none"}))}))},renderTitle:function(){var e=this.padding,t=this.options.title,n=0;t.text&&(this.title||(this.title=this.chart.renderer.label(t.text,e-3,e-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(t.style).add(this.group)),e=this.title.getBBox(),n=e.height,this.offsetWidth=e.width,this.contentGroup.attr({translateY:n})),this.titleHeight=n},setText:function(t){var n=this.options;t.legendItem.attr({text:n.labelFormat?e.format(n.labelFormat,t):n.labelFormatter.call(t)})},renderItem:function(e){var t=this.chart,n=t.renderer,r=this.options,i="horizontal"===r.layout,s=this.symbolWidth,o=r.symbolPadding,u=this.itemStyle,a=this.itemHiddenStyle,f=this.padding,h=i?c(r.itemDistance,20):0,p=!r.rtl,d=r.width,v=r.itemMarginBottom||0,m=this.itemMarginTop,g=this.initialItemX,y=e.legendItem,b=!e.series,w=!b&&e.series.drawLegendSymbol?e.series:e,E=w.options,E=this.createCheckboxForItem&&E&&E.showCheckbox,S=r.useHTML;y||(e.legendGroup=n.g("legend-item").addClass("highcharts-"+w.type+"-series highcharts-color-"+e.colorIndex+" "+(e.options.className||"")+(b?"highcharts-series-"+e.index:"")).attr({zIndex:1}).add(this.scrollGroup),e.legendItem=y=n.text("",p?s+o:-o,this.baseline||0,S).css(l(e.visible?u:a)).attr({align:p?"left":"right",zIndex:2}).add(e.legendGroup),this.baseline||(u=u.fontSize,this.fontMetrics=n.fontMetrics(u,y),this.baseline=this.fontMetrics.f+3+m,y.attr("y",this.baseline)),w.drawLegendSymbol(this,e),this.setItemEvents&&this.setItemEvents(e,y,S),E&&this.createCheckboxForItem(e)),this.colorizeItem(e,e.visible),this.setText(e),n=y.getBBox(),s=e.checkboxOffset=r.itemWidth||e.legendItemWidth||s+o+n.width+h+(E?20:0),this.itemHeight=o=Math.round(e.legendItemHeight||n.height),i&&this.itemX-g+s>(d||t.chartWidth-2*f-g-r.x)&&(this.itemX=g,this.itemY+=m+this.lastLineHeight+v,this.lastLineHeight=0),this.maxItemWidth=Math.max(this.maxItemWidth,s),this.lastItemY=m+this.itemY+v,this.lastLineHeight=Math.max(o,this.lastLineHeight),e._legendItemPos=[this.itemX,this.itemY],i?this.itemX+=s:(this.itemY+=m+o+v,this.lastLineHeight=o),this.offsetWidth=d||Math.max((i?this.itemX-g-h:s)+f,this.offsetWidth)},getAllItems:function(){var e=[];return o(this.chart.series,function(t){var n=t&&t.options;t&&c(n.showInLegend,s(n.linkedTo)?!1:void 0,!0)&&(e=e.concat(t.legendItems||("point"===n.legendType?t.data:t)))}),e},adjustMargins:function(e,t){var n=this.chart,r=this.options,i=r.align.charAt(0)+r.verticalAlign.charAt(0)+r.layout.charAt(0);r.floating||o([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(o,u){o.test(i)&&!s(e[u])&&(n[f[u]]=Math.max(n[f[u]],n.legend[(u+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][u]*r[u%2?"x":"y"]+c(r.margin,12)+t[u]))})},render:function(){var e=this,t=e.chart,n=t.renderer,r=e.group,i,s,a,f,l=e.box,c=e.options,h=e.padding;e.itemX=e.initialItemX,e.itemY=e.initialItemY,e.offsetWidth=0,e.lastItemY=0,r||(e.group=r=n.g("legend").attr({zIndex:7}).add(),e.contentGroup=n.g().attr({zIndex:1}).add(r),e.scrollGroup=n.g().add(e.contentGroup)),e.renderTitle(),i=e.getAllItems(),p(i,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),c.reversed&&i.reverse(),e.allItems=i,e.display=s=!!i.length,e.lastLineHeight=0,o(i,function(t){e.renderItem(t)}),a=(c.width||e.offsetWidth)+h,f=e.lastItemY+e.lastLineHeight+e.titleHeight,f=e.handleOverflow(f),f+=h,l||(e.box=l=n.rect().addClass("highcharts-legend-box").attr({r:c.borderRadius}).add(r),l.isNew=!0),l.attr({stroke:c.borderColor,"stroke-width":c.borderWidth||0,fill:c.backgroundColor||"none"}).shadow(c.shadow),0<a&&0<f&&(l[l.isNew?"attr":"animate"](l.crisp({x:0,y:0,width:a,height:f},l.strokeWidth())),l.isNew=!1),l[s?"show":"hide"](),e.legendWidth=a,e.legendHeight=f,o(i,function(t){e.positionItem(t)}),s&&r.align(u({width:a,height:f},c),!0,"spacingBox"),t.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t=this,n=this.chart,r=n.renderer,i=this.options,s=i.y,s=n.spacingBox.height+("top"===i.verticalAlign?-s:s)-this.padding,u=i.maxHeight,a,f=this.clipRect,l=i.navigation,h=c(l.animation,!0),p=l.arrowSize||12,d=this.nav,v=this.pages,m=this.padding,y,b=this.allItems,w=function(e){f.attr({height:e}),t.contentGroup.div&&(t.contentGroup.div.style.clip="rect("+m+"px,9999px,"+(m+e)+"px,0)")};return"horizontal"===i.layout&&(s/=2),u&&(s=Math.min(s,u)),v.length=0,e>s&&!1!==l.enabled?(this.clipHeight=a=Math.max(s-20-this.titleHeight-m,0),this.currentPage=c(this.currentPage,1),this.fullHeight=e,o(b,function(e,t){var n=e._legendItemPos[1],r=Math.round(e.legendItem.getBBox().height),i=v.length;if(!i||n-v[i-1]>a&&(y||n)!==v[i-1])v.push(y||n),i++;t===b.length-1&&n+r-v[i-1]>a&&v.push(n),n!==y&&(y=n)}),f||(f=t.clipRect=r.clipRect(0,m,9999,0),t.contentGroup.clip(f)),w(a),d||(this.nav=d=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,p,p).on("click",function(){t.scroll(-1,h)}).add(d),this.pager=r.text("",15,10).addClass("highcharts-legend-navigation").css(l.style).add(d),this.down=r.symbol("triangle-down",0,0,p,p).on("click",function(){t.scroll(1,h)}).add(d)),t.scroll(0),e=s):d&&(w(n.chartHeight),d.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e},scroll:function(e,t){var n=this.pages,r=n.length,i=this.currentPage+e,s=this.clipHeight,o=this.options.navigation,u=this.pager,a=this.padding;i>r&&(i=r),0<i&&(void 0!==t&&h(t,this.chart),this.nav.attr({translateX:a,translateY:s+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({"class":1===i?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),u.attr({text:i+"/"+r}),this.down.attr({x:18+this.pager.getBBox().width,"class":i===r?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),this.up.attr({fill:1===i?o.inactiveColor:o.activeColor}).css({cursor:1===i?"default":"pointer"}),this.down.attr({fill:i===r?o.inactiveColor:o.activeColor}).css({cursor:i===r?"default":"pointer"}),n=-n[i-1]+this.initialItemY,this.scrollGroup.animate({translateY:n}),this.currentPage=i,this.positionCheckboxes(n))}},e.LegendSymbolMixin={drawRectangle:function(e,t){var n=e.options,r=n.symbolHeight||e.fontMetrics.f,n=n.squareSymbol;t.legendSymbol=this.chart.renderer.rect(n?(e.symbolWidth-r)/2:0,e.baseline-r+1,n?r:e.symbolWidth,r,c(e.options.symbolRadius,r/2)).addClass("highcharts-point").attr({zIndex:3}).add(t.legendGroup)},drawLineMarker:function(e){var t=this.options,n=t.marker,r=e.symbolWidth,i=this.chart.renderer,s=this.legendGroup;e=e.baseline-Math.round(.3*e.fontMetrics.b);var o;o={"stroke-width":t.lineWidth||0},t.dashStyle&&(o.dashstyle=t.dashStyle),this.legendLine=i.path(["M",0,e,"L",r,e]).addClass("highcharts-graph").attr(o).add(s),n&&!1!==n.enabled&&(t=n.radius,this.legendSymbol=n=i.symbol(this.symbol,r/2-t,e-t,2*t,2*t,n).addClass("highcharts-point").add(s),n.isMarker=!0)}},(/Trident\/7\.0/.test(d.navigator.userAgent)||a)&&v(t.prototype,"positionItem",function(e,t){var n=this,r=function(){t._legendItemPos&&e.call(n,t)};r(),setTimeout(r)})}(e),function(e){var t=e.addEvent,n=e.animate,r=e.animObject,i=e.attr,s=e.doc,o=e.Axis,u=e.createElement,a=e.defaultOptions,f=e.discardElement,l=e.charts,c=e.css,h=e.defined,p=e.each,d=e.error,v=e.extend,m=e.fireEvent,g=e.getStyle,y=e.grep,b=e.isNumber,w=e.isObject,E=e.isString,S=e.Legend,x=e.marginNames,T=e.merge,N=e.Pointer,C=e.pick,k=e.pInt,L=e.removeEvent,A=e.seriesTypes,O=e.splat,M=e.svg,_=e.syncTimeout,D=e.win,P=e.Renderer,H=e.Chart=function(){this.getArgs.apply(this,arguments)};e.chart=function(e,t,n){return new H(e,t,n)},H.prototype={callbacks:[],getArgs:function(){var e=[].slice.call(arguments);if(E(e[0])||e[0].nodeName)this.renderTo=e.shift();this.init(e[0],e[1])},init:function(n,r){var i,s=n.series;n.series=null,i=T(a,n),i.series=n.series=s,this.userOptions=n,this.respRules=[];var s=i.chart,o=s.events;this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.callback=r,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.hasCartesianSeries=s.showAxes;var u;this.index=l.length,l.push(this),e.chartCount++;if(o)for(u in o)t(this,u,o[u]);this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.firstRender()},initSeries:function(e){var t=this.options.chart;return(t=A[e.type||t.type||t.defaultSeriesType])||d(17,!0),t=new t,t.init(this,e),t},isInsidePlot:function(e,t,n){var r=n?t:e;return e=n?e:t,0<=r&&r<=this.plotWidth&&0<=e&&e<=this.plotHeight},redraw:function(t){var n=this.axes,r=this.series,i=this.pointer,s=this.legend,o=this.isDirtyLegend,u,a,f=this.hasCartesianSeries,l=this.isDirtyBox,c=r.length,h=c,d=this.renderer,g=d.isHidden(),y=[];e.setAnimation(t,this),g&&this.cloneRenderTo();for(this.layOutTitles();h--;)if(t=r[h],t.options.stacking&&(u=!0,t.isDirty)){a=!0;break}if(a)for(h=c;h--;)t=r[h],t.options.stacking&&(t.isDirty=!0);p(r,function(e){e.isDirty&&"point"===e.options.legendType&&(e.updateTotals&&e.updateTotals(),o=!0),e.isDirtyData&&m(e,"updatedData")}),o&&s.options.enabled&&(s.render(),this.isDirtyLegend=!1),u&&this.getStacks(),f&&p(n,function(e){e.updateNames(),e.setScale()}),this.getMargins(),f&&(p(n,function(e){e.isDirty&&(l=!0)}),p(n,function(e){var t=e.min+","+e.max;e.extKey!==t&&(e.extKey=t,y.push(function(){m(e,"afterSetExtremes",v(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(l||u)&&e.redraw()})),l&&this.drawChartBox(),p(r,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),i&&i.reset(!0),d.draw(),m(this,"redraw"),g&&this.cloneRenderTo(!0),p(y,function(e){e.call()})},get:function(e){var t=this.axes,n=this.series,r,i;for(r=0;r<t.length;r++)if(t[r].options.id===e)return t[r];for(r=0;r<n.length;r++)if(n[r].options.id===e)return n[r];for(r=0;r<n.length;r++)for(i=n[r].points||[],t=0;t<i.length;t++)if(i[t].id===e)return i[t];return null},getAxes:function(){var e=this,t=this.options,n=t.xAxis=O(t.xAxis||{}),t=t.yAxis=O(t.yAxis||{});p(n,function(e,t){e.index=t,e.isX=!0}),p(t,function(e,t){e.index=t}),n=n.concat(t),p(n,function(t){new o(e,t)})},getSelectedPoints:function(){var e=[];return p(this.series,function(t){e=e.concat(y(t.points||[],function(e){return e.selected}))}),e},getSelectedSeries:function(){return y(this.series,function(e){return e.selected})},setTitle:function(e,t,n){var r=this,i=r.options,s;s=i.title=T(i.title,e),i=i.subtitle=T(i.subtitle,t),p([["title",e,s],["subtitle",t,i]],function(e,t){var n=e[0],i=r[n],s=e[1],o=e[2];i&&s&&(r[n]=i=i.destroy()),o&&o.text&&!i&&(r[n]=r.renderer.text(o.text,0,0,o.useHTML).attr({align:o.align,"class":"highcharts-"+n,zIndex:o.zIndex||4}).add(),r[n].update=function(e){r.setTitle(!t&&e,t&&e)},r[n].css(o.style))}),r.layOutTitles(n)},layOutTitles:function(e){var t=0,n,r=this.renderer,i=this.spacingBox;p(["title","subtitle"],function(e){var n=this[e],s=this.options[e],o;n&&(o=s.style.fontSize,o=r.fontMetrics(o,n).b,n.css({width:(s.width||i.width+s.widthAdjust)+"px"}).align(v({y:t+o+("title"===e?-3:2)},s),!1,"spacingBox"),s.floating||s.verticalAlign||(t=Math.ceil(t+n.getBBox().height)))},this),n=this.titleOffset!==t,this.titleOffset=t,!this.isDirtyBox&&n&&(this.isDirtyBox=n,this.hasRendered&&C(e,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this.options.chart,t=e.width,e=e.height,n=this.renderToClone||this.renderTo;h(t)||(this.containerWidth=g(n,"width")),h(e)||(this.containerHeight=g(n,"height")),this.chartWidth=Math.max(0,t||this.containerWidth||600),this.chartHeight=Math.max(0,C(e,19<this.containerHeight?this.containerHeight:400))},cloneRenderTo:function(e){var t=this.renderToClone,n=this.container;if(e){if(t){for(;t.childNodes.length;)this.renderTo.appendChild(t.firstChild);f(t),delete this.renderToClone}}else n&&n.parentNode===this.renderTo&&this.renderTo.removeChild(n),this.renderToClone=t=this.renderTo.cloneNode(0),c(t,{position:"absolute",top:"-9999px",display:"block"}),t.style.setProperty&&t.style.setProperty("display","block","important"),s.body.appendChild(t),n&&t.appendChild(n)},setClassName:function(e){this.container.className="highcharts-container "+(e||"")},getContainer:function(){var t,n=this.options,r=n.chart,o,a;t=this.renderTo;var f="highcharts-"+e.idCounter++,c;t||(this.renderTo=t=r.renderTo),E(t)&&(this.renderTo=t=s.getElementById(t)),t||d(13,!0),o=k(i(t,"data-highcharts-chart")),b(o)&&l[o]&&l[o].hasRendered&&l[o].destroy(),i(t,"data-highcharts-chart",this.index),t.innerHTML="",r.skipClone||t.offsetWidth||this.cloneRenderTo(),this.getChartSize(),o=this.chartWidth,a=this.chartHeight,c=v({position:"relative",overflow:"hidden",width:o+"px",height:a+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"}),this.container=t=u("div",{id:f},c,this.renderToClone||t),this._cursor=t.style.cursor,this.renderer=new(e[r.renderer]||P)(t,o,a,null,r.forExport,n.exporting&&n.exporting.allowHTML),this.setClassName(r.className),this.renderer.setStyle(r.style),this.renderer.chartIndex=this.index},getMargins:function(e){var t=this.spacing,n=this.margin,r=this.titleOffset;this.resetMargins(),r&&!h(n[0])&&(this.plotTop=Math.max(this.plotTop,r+this.options.title.margin+t[0])),this.legend.display&&this.legend.adjustMargins(n,t),this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin),this.extraTopMargin&&(this.plotTop+=this.extraTopMargin),e||this.getAxisMargins()},getAxisMargins:function(){var e=this,t=e.axisOffset=[0,0,0,0],n=e.margin;e.hasCartesianSeries&&p(e.axes,function(e){e.visible&&e.getOffset()}),p(x,function(r,i){h(n[i])||(e[r]+=t[i])}),e.setChartSize()},reflow:function(e){var t=this,n=t.options.chart,r=t.renderTo,i=h(n.width),o=n.width||g(r,"width"),n=n.height||g(r,"height"),r=e?e.target:D;if(!i&&!t.isPrinting&&o&&n&&(r===D||r===s)){if(o!==t.containerWidth||n!==t.containerHeight)clearTimeout(t.reflowTimeout),t.reflowTimeout=_(function(){t.container&&t.setSize(void 0,void 0,!1)},e?100:0);t.containerWidth=o,t.containerHeight=n}},initReflow:function(){var e=this,n=function(t){e.reflow(t)};t(D,"resize",n),t(e,"destroy",function(){L(D,"resize",n)})},setSize:function(t,i,s){var o=this,u=o.renderer;o.isResizing+=1,e.setAnimation(s,o),o.oldChartHeight=o.chartHeight,o.oldChartWidth=o.chartWidth,void 0!==t&&(o.options.chart.width=t),void 0!==i&&(o.options.chart.height=i),o.getChartSize(),t=u.globalAnimation,(t?n:c)(o.container,{width:o.chartWidth+"px",height:o.chartHeight+"px"},t),o.setChartSize(!0),u.setSize(o.chartWidth,o.chartHeight,s),p(o.axes,function(e){e.isDirty=!0,e.setScale()}),p(o.series,function(e){e.isDirty=!0}),o.isDirtyLegend=!0,o.isDirtyBox=!0,o.layOutTitles(),o.getMargins(),o.setResponsive&&o.setResponsive(!1),o.redraw(s),o.oldChartHeight=null,m(o,"resize"),_(function(){o&&m(o,"endResize",null,function(){--o.isResizing})},r(t).duration)},setChartSize:function(e){var t=this.inverted,n=this.renderer,r=this.chartWidth,i=this.chartHeight,s=this.options.chart,o=this.spacing,u=this.clipOffset,a,f,l,c;this.plotLeft=a=Math.round(this.plotLeft),this.plotTop=f=Math.round(this.plotTop),this.plotWidth=l=Math.max(0,Math.round(r-a-this.marginRight)),this.plotHeight=c=Math.max(0,Math.round(i-f-this.marginBottom)),this.plotSizeX=t?c:l,this.plotSizeY=t?l:c,this.plotBorderWidth=s.plotBorderWidth||0,this.spacingBox=n.spacingBox={x:o[3],y:o[0],width:r-o[3]-o[1],height:i-o[0]-o[2]},this.plotBox=n.plotBox={x:a,y:f,width:l,height:c},r=2*Math.floor(this.plotBorderWidth/2),t=Math.ceil(Math.max(r,u[3])/2),n=Math.ceil(Math.max(r,u[0])/2),this.clipBox={x:t,y:n,width:Math.floor(this.plotSizeX-Math.max(r,u[1])/2-t),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(r,u[2])/2-n))},e||p(this.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this,t=e.options.chart;p(["margin","spacing"],function(n){var r=t[n],i=w(r)?r:[r,r,r,r];p(["Top","Right","Bottom","Left"],function(r,s){e[n][s]=C(t[n+r],i[s])})}),p(x,function(t,n){e[t]=C(e.margin[n],e.spacing[n])}),e.axisOffset=[0,0,0,0],e.clipOffset=[0,0,0,0]},drawChartBox:function(){var e=this.options.chart,t=this.renderer,n=this.chartWidth,r=this.chartHeight,i=this.chartBackground,s=this.plotBackground,o=this.plotBorder,u,a=this.plotBGImage,f=e.backgroundColor,l=e.plotBackgroundColor,c=e.plotBackgroundImage,h,p=this.plotLeft,d=this.plotTop,v=this.plotWidth,m=this.plotHeight,g=this.plotBox,y=this.clipRect,b=this.clipBox,w="animate";i||(this.chartBackground=i=t.rect().addClass("highcharts-background").add(),w="attr"),u=e.borderWidth||0,h=u+(e.shadow?8:0),f={fill:f||"none"};if(u||i["stroke-width"])f.stroke=e.borderColor,f["stroke-width"]=u;i.attr(f).shadow(e.shadow),i[w]({x:h/2,y:h/2,width:n-h-u%2,height:r-h-u%2,r:e.borderRadius}),w="animate",s||(w="attr",this.plotBackground=s=t.rect().addClass("highcharts-plot-background").add()),s[w](g),s.attr({fill:l||"none"}).shadow(e.plotShadow),c&&(a?a.animate(g):this.plotBGImage=t.image(c,p,d,v,m).add()),y?y.animate({width:b.width,height:b.height}):this.clipRect=t.clipRect(b),w="animate",o||(w="attr",this.plotBorder=o=t.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),o.attr({stroke:e.plotBorderColor,"stroke-width":e.plotBorderWidth||0,fill:"none"}),o[w](o.crisp({x:p,y:d,width:v,height:m},-o.strokeWidth())),this.isDirtyBox=!1},propFromSeries:function(){var e=this,t=e.options.chart,n,r=e.options.series,i,s;p(["inverted","angular","polar"],function(o){n=A[t.type||t.defaultSeriesType],s=t[o]||n&&n.prototype[o];for(i=r&&r.length;!s&&i--;)(n=A[r[i].type])&&n.prototype[o]&&(s=!0);e[o]=s})},linkSeries:function(){var e=this,t=e.series;p(t,function(e){e.linkedSeries.length=0}),p(t,function(t){var n=t.options.linkedTo;E(n)&&(n=":previous"===n?e.series[t.index-1]:e.get(n))&&n.linkedParent!==t&&(n.linkedSeries.push(t),t.linkedParent=n,t.visible=C(t.options.visible,n.options.visible,t.visible))})},renderSeries:function(){p(this.series,function(e){e.translate(),e.render()})},renderLabels:function(){var e=this,t=e.options.labels;t.items&&p(t.items,function(n){var r=v(t.style,n.style),i=k(r.left)+e.plotLeft,s=k(r.top)+e.plotTop+12;delete r.left,delete r.top,e.renderer.text(n.html,i,s).attr({zIndex:2}).css(r).add()})},render:function(){var e=this.axes,t=this.renderer,n=this.options,r,i,s;this.setTitle(),this.legend=new S(this,n.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),n=this.plotWidth,r=this.plotHeight-=21,p(e,function(e){e.setScale()}),this.getAxisMargins(),i=1.1<n/this.plotWidth,s=1.05<r/this.plotHeight;if(i||s)p(e,function(e){(e.horiz&&i||!e.horiz&&s)&&e.setTickInterval(!0)}),this.getMargins();this.drawChartBox(),this.hasCartesianSeries&&p(e,function(e){e.visible&&e.render()}),this.seriesGroup||(this.seriesGroup=t.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0},addCredits:function(e){var t=this;e=T(!0,this.options.credits,e),e.enabled&&!this.credits&&(this.credits=this.renderer.text(e.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){e.href&&(D.location.href=e.href)}).attr({align:e.position.align,zIndex:8}).css(e.style).add().align(e.position),this.credits.update=function(e){t.credits=t.credits.destroy(),t.addCredits(e)})},destroy:function(){var t=this,n=t.axes,r=t.series,i=t.container,s,o=i&&i.parentNode;m(t,"destroy"),l[t.index]=void 0,e.chartCount--,t.renderTo.removeAttribute("data-highcharts-chart"),L(t);for(s=n.length;s--;)n[s]=n[s].destroy();this.scroller&&this.scroller.destroy&&this.scroller.destroy();for(s=r.length;s--;)r[s]=r[s].destroy();p("title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer".split(" "),function(e){var n=t[e];n&&n.destroy&&(t[e]=n.destroy())}),i&&(i.innerHTML="",L(i),o&&f(i));for(s in t)delete t[s]},isReadyToRender:function(){var e=this;return M||D!=D.top||"complete"===s.readyState?!0:(s.attachEvent("onreadystatechange",function(){s.detachEvent("onreadystatechange",e.firstRender),"complete"===s.readyState&&e.firstRender()}),!1)},firstRender:function(){var e=this,t=e.options;e.isReadyToRender()&&(e.getContainer(),m(e,"init"),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),p(t.series||[],function(t){e.initSeries(t)}),e.linkSeries(),m(e,"beforeRender"),N&&(e.pointer=new N(e,t)),e.render(),e.renderer.draw(),!e.renderer.imgCount&&e.onload&&e.onload(),e.cloneRenderTo(!0))},onload:function(){p([this.callback].concat(this.callbacks),function(e){e&&void 0!==this.index&&e.apply(this,[this])},this),m(this,"load"),this.initReflow(),this.onload=null}}}(e),function(e){var t,n=e.each,r=e.extend,i=e.erase,s=e.fireEvent,o=e.format,u=e.isArray,a=e.isNumber,f=e.pick,l=e.removeEvent;t=e.Point=function(){},t.prototype={init:function(e,t,n){return this.series=e,this.color=e.color,this.applyOptions(t,n),e.options.colorByPoint?(t=e.options.colors||e.chart.options.colors,this.color=this.color||t[e.colorCounter],t=t.length,n=e.colorCounter,e.colorCounter++,e.colorCounter===t&&(e.colorCounter=0)):n=e.colorIndex,this.colorIndex=f(this.colorIndex,n),e.chart.pointCount++,this},applyOptions:function(e,n){var i=this.series,s=i.options.pointValKey||i.pointValKey;return e=t.prototype.optionsToObject.call(this,e),r(this,e),this.options=this.options?r(this.options,e):e,e.group&&delete this.group,s&&(this.y=this[s]),this.isNull=f(this.isValid&&!this.isValid(),null===this.x||!a(this.y,!0)),"name"in this&&void 0===n&&i.xAxis&&i.xAxis.hasNames&&(this.x=i.xAxis.nameToX(this)),void 0===this.x&&i&&(this.x=void 0===n?i.autoIncrement(this):n),this},optionsToObject:function(e){var t={},n=this.series,r=n.options.keys,i=r||n.pointArrayMap||["y"],s=i.length,o=0,f=0;if(a(e)||null===e)t[i[0]]=e;else if(u(e))for(!r&&e.length>s&&(n=typeof e[0],"string"===n?t.name=e[0]:"number"===n&&(t.x=e[0]),o++);f<s;)r&&void 0===e[o]||(t[i[f]]=e[o]),o++,f++;else"object"==typeof e&&(t=e,e.dataLabels&&(n._hasPointLabels=!0),e.marker&&(n._hasPointMarkers=!0));return t},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")},getZone:function(){var e=this.series,t=e.zones,e=e.zoneAxis||"y",n=0,r;for(r=t[n];this[e]>=r.value;)r=t[++n];return r&&r.color&&!this.options.color&&(this.color=r.color),r},destroy:function(){var e=this.series.chart,t=e.hoverPoints,n;e.pointCount--,t&&(this.setState(),i(t,this),t.length||(e.hoverPoints=null)),this===e.hoverPoint&&this.onMouseOut();if(this.graphic||this.dataLabel)l(this),this.destroyElements();this.legendItem&&e.legend.destroyItem(this);for(n in this)this[n]=null},destroyElements:function(){for(var e=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],t,n=6;n--;)t=e[n],this[t]&&(this[t]=this[t].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(e){var t=this.series,r=t.tooltipOptions,i=f(r.valueDecimals,""),s=r.valuePrefix||"",u=r.valueSuffix||"";return n(t.pointArrayMap||["y"],function(t){t="{point."+t;if(s||u)e=e.replace(t+"}",s+t+"}"+u);e=e.replace(t+"}",t+":,."+i+"f}")}),o(e,{point:this,series:this.series})},firePointEvent:function(e,t,n){var r=this,i=this.series.options;(i.point.events[e]||r.options&&r.options.events&&r.options.events[e])&&this.importEvents(),"click"===e&&i.allowPointSelect&&(n=function(e){r.select&&r.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),s(this,e,t,n)},visible:!0}}(e),function(e){var t=e.addEvent,n=e.animObject,r=e.arrayMax,i=e.arrayMin,s=e.correctFloat,o=e.Date,u=e.defaultOptions,a=e.defaultPlotOptions,f=e.defined,l=e.each,c=e.erase,h=e.error,p=e.extend,d=e.fireEvent,v=e.grep,m=e.isArray,g=e.isNumber,y=e.isString,b=e.merge,w=e.pick,E=e.removeEvent,S=e.splat,x=e.stableSort,T=e.SVGElement,N=e.syncTimeout,C=e.win;e.Series=e.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{lineWidth:0,lineColor:"#ffffff",radius:4,states:{hover:{enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":e.numberFormat(this.y,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textShadow:"1px 1px contrast, -1px -1px contrast, -1px 1px contrast, 1px -1px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3},{isCartesian:!0,pointClass:e.Point,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],coll:"series",init:function(e,n){var r=this,i,s,o=e.series,u=function(e,t){return w(e.options.index,e._i)-w(t.options.index,t._i)};r.chart=e,r.options=n=r.setOptions(n),r.linkedSeries=[],r.bindAxes(),p(r,{name:n.name,state:"",visible:!1!==n.visible,selected:!0===n.selected}),s=n.events;for(i in s)t(r,i,s[i]);if(s&&s.click||n.point&&n.point.events&&n.point.events.click||n.allowPointSelect)e.runTrackerClick=!0;r.getColor(),r.getSymbol(),l(r.parallelArrays,function(e){r[e+"Data"]=[]}),r.setData(n.data,!1),r.isCartesian&&(e.hasCartesianSeries=!0),o.push(r),r._i=o.length-1,x(o,u),this.yAxis&&x(this.yAxis.series,u),l(o,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var e=this,t=e.options,n=e.chart,r;l(e.axisTypes||[],function(i){l(n[i],function(n){r=n.options;if(t[i]===r.index||void 0!==t[i]&&t[i]===r.id||void 0===t[i]&&0===r.index)n.series.push(e),e[i]=n,n.isDirty=!0}),e[i]||e.optionalAxis===i||h(18,!0)})},updateParallelArrays:function(e,t){var n=e.series,r=arguments,i=g(t)?function(r){var i="y"===r&&n.toYData?n.toYData(e):e[r];n[r+"Data"][t]=i}:function(e){Array.prototype[t].apply(n[e+"Data"],Array.prototype.slice.call(r,2))};l(n.parallelArrays,i)},autoIncrement:function(){var e=this.options,t=this.xIncrement,n,r=e.pointIntervalUnit,t=w(t,e.pointStart,0);return this.pointInterval=n=w(this.pointInterval,e.pointInterval,1),r&&(e=new o(t),"day"===r?e=+e[o.hcSetDate](e[o.hcGetDate]()+n):"month"===r?e=+e[o.hcSetMonth](e[o.hcGetMonth]()+n):"year"===r&&(e=+e[o.hcSetFullYear](e[o.hcGetFullYear]()+n)),n=e-t),this.xIncrement=t+n,t},setOptions:function(e){var t=this.chart,n=t.options.plotOptions,t=t.userOptions||{},r=t.plotOptions||{},i=n[this.type];return this.userOptions=e,n=b(i,n.series,e),this.tooltipOptions=b(u.tooltip,u.plotOptions[this.type].tooltip,t.tooltip,r.series&&r.series.tooltip,r[this.type]&&r[this.type].tooltip,e.tooltip),null===i.marker&&delete n.marker,this.zoneAxis=n.zoneAxis,e=this.zones=(n.zones||[]).slice(),!n.negativeColor&&!n.negativeFillColor||n.zones||e.push({value:n[this.zoneAxis+"Threshold"]||n.threshold||0,className:"highcharts-negative",color:n.negativeColor,fillColor:n.negativeFillColor}),e.length&&f(e[e.length-1].value)&&e.push({color:this.color,fillColor:this.fillColor}),n},getCyclic:function(e,t,n){var r,i=this.userOptions,s=e+"Index",o=e+"Counter",u=n?n.length:w(this.chart.options.chart[e+"Count"],this.chart[e+"Count"]);t||(r=w(i[s],i["_"+s]),f(r)||(i["_"+s]=r=this.chart[o]%u,this.chart[o]+=1),n&&(t=n[r])),void 0!==r&&(this[s]=r),this[e]=t},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||a[this.type].color,this.chart.options.colors)},getSymbol:function(){var e=this.options.marker;this.getCyclic("symbol",e.symbol,this.chart.options.symbols),/^url/.test(this.symbol)&&(e.radius=0)},drawLegendSymbol:e.LegendSymbolMixin.drawLineMarker,setData:function(e,t,n,r){var i=this,s=i.points,o=s&&s.length||0,u,a=i.options,f=i.chart,c=null,p=i.xAxis,d=a.turboThreshold,v=this.xData,b=this.yData,E=(u=i.pointArrayMap)&&u.length;e=e||[],u=e.length,t=w(t,!0);if(!1!==r&&u&&o===u&&!i.cropped&&!i.hasGroupedData&&i.visible)l(e,function(e,t){s[t].update&&e!==a.data[t]&&s[t].update(e,!1,null,!1)});else{i.xIncrement=null,i.colorCounter=0,l(this.parallelArrays,function(e){i[e+"Data"].length=0});if(d&&u>d){for(n=0;null===c&&n<u;)c=e[n],n++;if(g(c))for(n=0;n<u;n++)v[n]=this.autoIncrement(),b[n]=e[n];else if(m(c))if(E)for(n=0;n<u;n++)c=e[n],v[n]=c[0],b[n]=c.slice(1,E+1);else for(n=0;n<u;n++)c=e[n],v[n]=c[0],b[n]=c[1];else h(12)}else for(n=0;n<u;n++)void 0!==e[n]&&(c={series:i},i.pointClass.prototype.applyOptions.apply(c,[e[n]]),i.updateParallelArrays(c,n));y(b[0])&&h(14,!0),i.data=[],i.options.data=i.userOptions.data=e;for(n=o;n--;)s[n]&&s[n].destroy&&s[n].destroy();p&&(p.minRange=p.userMinRange),i.isDirty=f.isDirtyBox=!0,i.isDirtyData=!!s,n=!1}"point"===a.legendType&&(this.processData(),this.generatePoints()),t&&f.redraw(n)},processData:function(e){var t=this.xData,n=this.yData,r=t.length,i;i=0;var s,o,u=this.xAxis,a,f=this.options;a=f.cropThreshold;var l=this.getExtremesFromAll||f.getExtremesFromAll,c=this.isCartesian,f=u&&u.val2lin,p=u&&u.isLog,d,v;if(c&&!this.isDirty&&!u.isDirty&&!this.yAxis.isDirty&&!e)return!1;u&&(e=u.getExtremes(),d=e.min,v=e.max);if(c&&this.sorted&&!l&&(!a||r>a||this.forceCrop))if(t[r-1]<d||t[0]>v)t=[],n=[];else if(t[0]<d||t[r-1]>v)i=this.cropData(this.xData,this.yData,d,v),t=i.xData,n=i.yData,i=i.start,s=!0;for(a=t.length||1;--a;)r=p?f(t[a])-f(t[a-1]):t[a]-t[a-1],0<r&&(void 0===o||r<o)?o=r:0>r&&this.requireSorting&&h(15);this.cropped=s,this.cropStart=i,this.processedXData=t,this.processedYData=n,this.closestPointRange=o},cropData:function(e,t,n,r){var i=e.length,s=0,o=i,u=w(this.cropShoulder,1),a;for(a=0;a<i;a++)if(e[a]>=n){s=Math.max(0,a-u);break}for(n=a;n<i;n++)if(e[n]>r){o=n+u;break}return{xData:e.slice(s,o),yData:t.slice(s,o),start:s,end:o}},generatePoints:function(){var e=this.options.data,t=this.data,n,r=this.processedXData,i=this.processedYData,s=this.pointClass,o=r.length,u=this.cropStart||0,a,f=this.hasGroupedData,l,c=[],h;t||f||(t=[],t.length=e.length,t=this.data=t);for(h=0;h<o;h++)a=u+h,f?(c[h]=(new s).init(this,[r[h]].concat(S(i[h]))),c[h].dataGroup=this.groupMap[h]):(t[a]?l=t[a]:void 0!==e[a]&&(t[a]=l=(new s).init(this,e[a],r[h])),c[h]=l),c[h].index=a;if(t&&(o!==(n=t.length)||f))for(h=0;h<n;h++)h!==u||f||(h+=o),t[h]&&(t[h].destroyElements(),t[h].plotX=void 0);this.data=t,this.points=c},getExtremes:function(e){var t=this.yAxis,n=this.processedXData,s,o=[],u=0;s=this.xAxis.getExtremes();var a=s.min,f=s.max,l,c,h,p;e=e||this.stackedYData||this.processedYData||[],s=e.length;for(p=0;p<s;p++)if(c=n[p],h=e[p],l=(g(h,!0)||m(h))&&(!t.isLog||h.length||0<h),c=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(n[p+1]||c)>=a&&(n[p-1]||c)<=f,l&&c)if(l=h.length)for(;l--;)null!==h[l]&&(o[u++]=h[l]);else o[u++]=h;this.dataMin=i(o),this.dataMax=r(o)},translate:function(){this.processedXData||this.processData(),this.generatePoints();for(var e=this.options,t=e.stacking,n=this.xAxis,r=n.categories,i=this.yAxis,o=this.points,u=o.length,a=!!this.modifyValue,l=e.pointPlacement,c="between"===l||g(l),h=e.threshold,p=e.startFromThreshold?h:0,d,v,m,y,b=Number.MAX_VALUE,e=0;e<u;e++){var E=o[e],S=E.x,x=E.y;v=E.low;var T=t&&i.stacks[(this.negStacks&&x<(p?0:h)?"-":"")+this.stackKey],N;i.isLog&&null!==x&&0>=x&&(E.isNull=!0),E.plotX=d=s(Math.min(Math.max(-1e5,n.translate(S,0,0,0,1,l,"flags"===this.type)),1e5)),t&&this.visible&&!E.isNull&&T&&T[S]&&(y=this.getStackIndicator(y,S,this.index),N=T[S],x=N.points[y.key],v=x[0],x=x[1],v===p&&y.key===T[S].base&&(v=w(h,i.min)),i.isLog&&0>=v&&(v=null),E.total=E.stackTotal=N.total,E.percentage=N.total&&E.y/N.total*100,E.stackY=x,N.setOffset(this.pointXOffset||0,this.barW||0)),E.yBottom=f(v)?i.translate(v,0,1,0,1):null,a&&(x=this.modifyValue(x,E)),E.plotY=v="number"==typeof x&&Infinity!==x?Math.min(Math.max(-1e5,i.translate(x,0,1,0,1)),1e5):void 0,E.isInside=void 0!==v&&0<=v&&v<=i.len&&0<=d&&d<=n.len,E.clientX=c?s(n.translate(S,0,0,0,1,l)):d,E.negative=E.y<(h||0),E.category=r&&void 0!==r[E.x]?r[E.x]:E.x,E.isNull||(void 0!==m&&(b=Math.min(b,Math.abs(d-m))),m=d)}this.closestPointRangePx=b},getValidPoints:function(e,t){var n=this.chart;return v(e||this.points||[],function(e){return t&&!n.isInsidePlot(e.plotX,e.plotY,n.inverted)?!1:!e.isNull})},setClip:function(e){var t=this.chart,n=this.options,r=t.renderer,i=t.inverted,s=this.clipBox,o=s||t.clipBox,u=this.sharedClipKey||["_sharedClip",e&&e.duration,e&&e.easing,o.height,n.xAxis,n.yAxis].join(),a=t[u],f=t[u+"m"];a||(e&&(o.width=0,t[u+"m"]=f=r.clipRect(-99,i?-t.plotLeft:-t.plotTop,99,i?t.chartWidth:t.chartHeight)),t[u]=a=r.clipRect(o),a.count={length:0}),e&&!a.count[this.index]&&(a.count[this.index]=!0,a.count.length+=1),!1!==n.clip&&(this.group.clip(e||s?a:t.clipRect),this.markerGroup.clip(f),this.sharedClipKey=u),e||(a.count[this.index]&&(delete a.count[this.index],--a.count.length),0===a.count.length&&u&&t[u]&&(s||(t[u]=t[u].destroy()),t[u+"m"]&&(t[u+"m"]=t[u+"m"].destroy())))},animate:function(e){var t=this.chart,r=n(this.options.animation),i;e?this.setClip(r):(i=this.sharedClipKey,(e=t[i])&&e.animate({width:t.plotSizeX},r),t[i+"m"]&&t[i+"m"].animate({width:t.plotSizeX+99},r),this.animate=null)},afterAnimate:function(){this.setClip(),d(this,"afterAnimate")},drawPoints:function(){var e=this.points,t=this.chart,n,r,i,s,o,u,a,f,l=this.options.marker,c,h,d,v=this.markerGroup,m=w(l.enabled,this.xAxis.isRadial?!0:null,this.closestPointRangePx>2*l.radius);if(!1!==l.enabled||this._hasPointMarkers)for(i=e.length;i--;)s=e[i],n=Math.floor(s.plotX),r=s.plotY,f=s.graphic,c=s.marker||{},h=!!s.marker,o=m&&void 0===c.enabled||c.enabled,d=s.isInside,o&&g(r)&&null!==s.y?(o=l.radius,u=w(c.symbol,this.symbol),a=0===u.indexOf("url"),f?f[d?"show":"hide"](!0).animate(p({x:n-o,y:r-o},f.symbolName?{width:2*o,height:2*o}:{})):d&&(0<o||a)&&(s.graphic=f=t.renderer.symbol(u,n-o,r-o,2*o,2*o,h?c:l).attr({r:o}).add(v)),f&&f.attr(this.pointAttribs(s,s.selected&&"select")),f&&f.addClass(s.getClassName(),!0)):f&&(s.graphic=f.destroy())},pointAttribs:function(e,t){var n=this.options.marker,r=e&&e.options,i=r&&r.marker||{},s=n.lineWidth,o=this.color,r=r&&r.color,u=e&&e.color,a,f;return e&&this.zones.length&&(f=e.getZone())&&f.color&&(a=f.color),o=r||a||u||o,a=i.fillColor||n.fillColor||o,o=i.lineColor||n.lineColor||o,t&&(n=n.states[t],i=i.states&&i.states[t]||{},s=n.lineWidth||s+n.lineWidthPlus,a=i.fillColor||n.fillColor||a,o=i.lineColor||n.lineColor||o),{stroke:o,"stroke-width":s,fill:a}},destroy:function(){var e=this,t=e.chart,n=/AppleWebKit\/533/.test(C.navigator.userAgent),r,i=e.data||[],s,o,u;d(e,"destroy"),E(e),l(e.axisTypes||[],function(t){(u=e[t])&&u.series&&(c(u.series,e),u.isDirty=u.forceRedraw=!0)}),e.legendItem&&e.chart.legend.destroyItem(e);for(r=i.length;r--;)(s=i[r])&&s.destroy&&s.destroy();e.points=null,clearTimeout(e.animationTimeout);for(o in e)e[o]instanceof T&&!e[o].survive&&(r=n&&"group"===o?"hide":"destroy",e[o][r]());t.hoverSeries===e&&(t.hoverSeries=null),c(t.series,e);for(o in e)delete e[o]},getGraphPath:function(e,t,n){var r=this,i=r.options,s=i.step,o,u=[],a=[],c;return e=e||r.points,(o=e.reversed)&&e.reverse(),(s={right:1,center:2}[s]||s&&3)&&o&&(s=4-s),!i.connectNulls||t||n||(e=this.getValidPoints(e)),l(e,function(o,l){var h=o.plotX,p=o.plotY,d=e[l-1];(o.leftCliff||d&&d.rightCliff)&&!n&&(c=!0),o.isNull&&!f(t)&&0<l?c=!i.connectNulls:o.isNull&&!t?c=!0:(0===l||c?d=["M",o.plotX,o.plotY]:r.getPointSpline?d=r.getPointSpline(e,o,l):s?(d=1===s?["L",d.plotX,p]:2===s?["L",(d.plotX+h)/2,d.plotY,"L",(d.plotX+h)/2,p]:["L",h,d.plotY],d.push("L",h,p)):d=["L",h,p],a.push(o.x),s&&a.push(o.x),u.push.apply(u,d),c=!1)}),u.xMap=a,r.graphPath=u},drawGraph:function(){var e=this,t=this.options,n=(this.gappedPath||this.getGraphPath).call(this),r=[["graph","highcharts-graph",t.lineColor||this.color,t.dashStyle]];l(this.zones,function(n,i){r.push(["zone-graph-"+i,"highcharts-graph highcharts-zone-graph-"+i+" "+(n.className||""),n.color||e.color,n.dashStyle||t.dashStyle])}),l(r,function(r,i){var s=r[0],o=e[s];o?(o.endX=n.xMap,o.animate({d:n})):n.length&&(e[s]=e.chart.renderer.path(n).addClass(r[1]).attr({zIndex:1}).add(e.group),o={stroke:r[2],"stroke-width":t.lineWidth,fill:e.fillGraph&&e.color||"none"},r[3]?o.dashstyle=r[3]:"square"!==t.linecap&&(o["stroke-linecap"]=o["stroke-linejoin"]="round"),o=e[s].attr(o).shadow(2>i&&t.shadow)),o&&(o.startX=n.xMap,o.isArea=n.isArea)})},applyZones:function(){var e=this,t=this.chart,n=t.renderer,r=this.zones,i,s,o=this.clips||[],u,a=this.graph,f=this.area,c=Math.max(t.chartWidth,t.chartHeight),h=this[(this.zoneAxis||"y")+"Axis"],p,d,v=t.inverted,m,g,y,b,E=!1;r.length&&(a||f)&&h&&void 0!==h.min&&(d=h.reversed,m=h.horiz,a&&a.hide(),f&&f.hide(),p=h.getExtremes(),l(r,function(r,l){i=d?m?t.plotWidth:0:m?0:h.toPixels(p.min),i=Math.min(Math.max(w(s,i),0),c),s=Math.min(Math.max(Math.round(h.toPixels(w(r.value,p.max),!0)),0),c),E&&(i=s=h.toPixels(p.max)),g=Math.abs(i-s),y=Math.min(i,s),b=Math.max(i,s),h.isXAxis?(u={x:v?b:y,y:0,width:g,height:c},m||(u.x=t.plotHeight-u.x)):(u={x:0,y:v?b:y,width:c,height:g},m&&(u.y=t.plotWidth-u.y)),v&&n.isVML&&(u=h.isXAxis?{x:0,y:d?y:b,height:u.width,width:t.chartWidth}:{x:u.y-t.plotLeft-t.spacingBox.x,y:0,width:u.height,height:t.chartHeight}),o[l]?o[l].animate(u):(o[l]=n.clipRect(u),a&&e["zone-graph-"+l].clip(o[l]),f&&e["zone-area-"+l].clip(o[l])),E=r.value>p.max}),this.clips=o)},invertGroups:function(e){function n(){var t={width:r.yAxis.len,height:r.xAxis.len};l(["group","markerGroup"],function(n){r[n]&&r[n].attr(t).invert(e)})}var r=this,i=r.chart;r.xAxis&&(t(i,"resize",n),t(r,"destroy",function(){E(i,"resize",n)}),n(e),r.invertGroups=n)},plotGroup:function(e,t,n,r,i){var s=this[e],o=!s;return o&&(this[e]=s=this.chart.renderer.g(t).attr({zIndex:r||.1}).add(i),s.addClass("highcharts-series-"+this.index+" highcharts-"+this.type+"-series highcharts-color-"+this.colorIndex+" "+(this.options.className||""))),s.attr({visibility:n})[o?"attr":"animate"](this.getPlotBox()),s},getPlotBox:function(){var e=this.chart,t=this.xAxis,n=this.yAxis;return e.inverted&&(t=n,n=this.xAxis),{translateX:t?t.left:e.plotLeft,translateY:n?n.top:e.plotTop,scaleX:1,scaleY:1}},render:function(){var e=this,t=e.chart,r,i=e.options,s=!!e.animate&&t.renderer.isSVG&&n(i.animation).duration,o=e.visible?"inherit":"hidden",u=i.zIndex,a=e.hasRendered,f=t.seriesGroup,l=t.inverted;r=e.plotGroup("group","series",o,u,f),e.markerGroup=e.plotGroup("markerGroup","markers",o,u,f),s&&e.animate(!0),r.inverted=e.isCartesian?l:!1,e.drawGraph&&(e.drawGraph(),e.applyZones()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&!1!==e.options.enableMouseTracking&&e.drawTracker(),e.invertGroups(l),!1===i.clip||e.sharedClipKey||a||r.clip(t.clipRect),s&&e.animate(),a||(e.animationTimeout=N(function(){e.afterAnimate()},s)),e.isDirty=e.isDirtyData=!1,e.hasRendered=!0},redraw:function(){var e=this.chart,t=this.isDirty||this.isDirtyData,n=this.group,r=this.xAxis,i=this.yAxis;n&&(e.inverted&&n.attr({width:e.plotWidth,height:e.plotHeight}),n.animate({translateX:w(r&&r.left,e.plotLeft),translateY:w(i&&i.top,e.plotTop)})),this.translate(),this.render(),t&&delete this.kdTree},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(e,t){var n=this.xAxis,r=this.yAxis,i=this.chart.inverted;return this.searchKDTree({clientX:i?n.len-e.chartY+n.pos:e.chartX-n.pos,plotY:i?r.len-e.chartX+r.pos:e.chartY-r.pos},t)},buildKDTree:function(){function e(n,r,i){var s,o;if(o=n&&n.length)return s=t.kdAxisArray[r%i],n.sort(function(e,t){return e[s]-t[s]}),o=Math.floor(o/2),{point:n[o],left:e(n.slice(0,o),r+1,i),right:e(n.slice(o+1),r+1,i)}}var t=this,n=t.kdDimensions;delete t.kdTree,N(function(){t.kdTree=e(t.getValidPoints(null,!t.directTouch),n,n)},t.options.kdNow?0:1)},searchKDTree:function(e,t){function n(e,t,u,a){var l=t.point,c=r.kdAxisArray[u%a],h,p,d=l;return p=f(e[i])&&f(l[i])?Math.pow(e[i]-l[i],2):null,h=f(e[s])&&f(l[s])?Math.pow(e[s]-l[s],2):null,h=(p||0)+(h||0),l.dist=f(h)?Math.sqrt(h):Number.MAX_VALUE,l.distX=f(p)?Math.sqrt(p):Number.MAX_VALUE,c=e[c]-l[c],h=0>c?"left":"right",p=0>c?"right":"left",t[h]&&(h=n(e,t[h],u+1,a),d=h[o]<d[o]?h:l),t[p]&&Math.sqrt(c*c)<d[o]&&(e=n(e,t[p],u+1,a),d=e[o]<d[o]?e:d),d}var r=this,i=this.kdAxisArray[0],s=this.kdAxisArray[1],o=t?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return n(e,this.kdTree,this.kdDimensions,this.kdDimensions)}})}(e),function(e){function t(e,t,n,r,i){var s=e.chart.inverted;this.axis=e,this.isNegative=n,this.options=t,this.x=r,this.total=null,this.points={},this.stack=i,this.rightCliff=this.leftCliff=0,this.alignOptions={align:t.align||(s?n?"left":"right":"center"),verticalAlign:t.verticalAlign||(s?"middle":n?"bottom":"top"),y:f(t.y,s?4:n?14:-6),x:f(t.x,s?n?-6:6:0)},this.textAlign=t.textAlign||(s?n?"right":"left":"center")}var n=e.Axis,r=e.Chart,i=e.correctFloat,s=e.defined,o=e.destroyObjectProperties,u=e.each,a=e.format,f=e.pick;e=e.Series,t.prototype={destroy:function(){o(this,this.axis)},render:function(e){var t=this.options,n=t.format,n=n?a(n,this):t.formatter.call(this);this.label?this.label.attr({text:n,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(n,null,null,t.useHTML).css(t.style).attr({align:this.textAlign,rotation:t.rotation,visibility:"hidden"}).add(e)},setOffset:function(e,t){var n=this.axis,r=n.chart,i=r.inverted,s=n.reversed,s=this.isNegative&&!s||!this.isNegative&&s,o=n.translate(n.usePercentage?100:this.total,0,0,0,1),n=n.translate(0),n=Math.abs(o-n),u=r.xAxis[0].translate(this.x)+e,a=r.plotHeight,s={x:i?s?o:o-n:u,y:i?a-u-t:s?a-o-n:a-o,width:i?n:t,height:i?t:n};if(i=this.label)i.align(this.alignOptions,null,s),s=i.alignAttr,i[!1===this.options.crop||r.isInsidePlot(s.x,s.y)?"show":"hide"](!0)}},r.prototype.getStacks=function(){var e=this;u(e.yAxis,function(e){e.stacks&&e.hasVisibleSeries&&(e.oldStacks=e.stacks)}),u(e.series,function(t){!t.options.stacking||!0!==t.visible&&!1!==e.options.chart.ignoreHiddenSeries||(t.stackKey=t.type+f(t.options.stack,""))})},n.prototype.buildStacks=function(){var e=this.series,t,n=f(this.options.reversedStacks,!0),r=e.length,i;if(!this.isXAxis){this.usePercentage=!1;for(i=r;i--;)e[n?i:r-i-1].setStackedPoints();for(i=r;i--;)t=e[n?i:r-i-1],t.setStackCliffs&&t.setStackCliffs();if(this.usePercentage)for(i=0;i<r;i++)e[i].setPercentStacks()}},n.prototype.renderStackTotals=function(){var e=this.chart,t=e.renderer,n=this.stacks,r,i,s=this.stackTotalGroup;s||(this.stackTotalGroup=s=t.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),s.translate(e.plotLeft,e.plotTop);for(r in n)for(i in e=n[r],e)e[i].render(s)},n.prototype.resetStacks=function(){var e=this.stacks,t,n;if(!this.isXAxis)for(t in e)for(n in e[t])e[t][n].touched<this.stacksTouched?(e[t][n].destroy(),delete e[t][n]):(e[t][n].total=null,e[t][n].cum=0)},n.prototype.cleanStacks=function(){var e,t,n;if(!this.isXAxis)for(t in this.oldStacks&&(e=this.stacks=this.oldStacks),e)for(n in e[t])e[t][n].cum=e[t][n].total},e.prototype.setStackedPoints=function(){if(this.options.stacking&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var e=this.processedXData,n=this.processedYData,r=[],o=n.length,u=this.options,a=u.threshold,l=u.startFromThreshold?a:0,c=u.stack,u=u.stacking,h=this.stackKey,p="-"+h,d=this.negStacks,v=this.yAxis,m=v.stacks,g=v.oldStacks,y,b,w,E,S,x,T;v.stacksTouched+=1;for(S=0;S<o;S++)x=e[S],T=n[S],y=this.getStackIndicator(y,x,this.index),E=y.key,w=(b=d&&T<(l?0:a))?p:h,m[w]||(m[w]={}),m[w][x]||(g[w]&&g[w][x]?(m[w][x]=g[w][x],m[w][x].total=null):m[w][x]=new t(v,v.options.stackLabels,b,x,c)),w=m[w][x],null!==T&&(w.points[E]=w.points[this.index]=[f(w.cum,l)],s(w.cum)||(w.base=E),w.touched=v.stacksTouched,0<y.index&&!1===this.singleStacks&&(w.points[E][0]=w.points[this.index+","+x+",0"][0])),"percent"===u?(b=b?h:p,d&&m[b]&&m[b][x]?(b=m[b][x],w.total=b.total=Math.max(b.total,w.total)+Math.abs(T)||0):w.total=i(w.total+(Math.abs(T)||0))):w.total=i(w.total+(T||0)),w.cum=f(w.cum,l)+(T||0),null!==T&&(w.points[E].push(w.cum),r[S]=w.cum);"percent"===u&&(v.usePercentage=!0),this.stackedYData=r,v.oldStacks={}}},e.prototype.setPercentStacks=function(){var e=this,t=e.stackKey,n=e.yAxis.stacks,r=e.processedXData,s;u([t,"-"+t],function(t){for(var o=r.length,u,a;o--;)if(u=r[o],s=e.getStackIndicator(s,u,e.index),u=(a=n[t]&&n[t][u])&&a.points[s.key])a=a.total?100/a.total:0,u[0]=i(u[0]*a),u[1]=i(u[1]*a),e.stackedYData[o]=u[1]})},e.prototype.getStackIndicator=function(e,t,n){return s(e)&&e.x===t?e.index++:e={x:t,index:0},e.key=[n,t,e.index].join(),e}}(e),function(e){var t=e.addEvent,n=e.animate,r=e.Axis,i=e.createElement,s=e.css,o=e.defined,u=e.each,a=e.erase,f=e.extend,l=e.fireEvent,c=e.inArray,h=e.isObject,p=e.merge,d=e.pick,v=e.Point,m=e.Series,g=e.seriesTypes,y=e.setAnimation,b=e.splat;f(e.Chart.prototype,{addSeries:function(e,t,n){var r,i=this;return e&&(t=d(t,!0),l(i,"addSeries",{options:e},function(){r=i.initSeries(e),i.isDirtyLegend=!0,i.linkSeries(),t&&i.redraw(n)})),r},addAxis:function(e,t,n,i){var s=t?"xAxis":"yAxis",o=this.options;e=p(e,{index:this[s].length,isX:t}),new r(this,e),o[s]=b(o[s]||{}),o[s].push(e),d(n,!0)&&this.redraw(i)},showLoading:function(e){var r=this,o=r.options,u=r.loadingDiv,a=o.loading,l=function(){u&&s(u,{left:r.plotLeft+"px",top:r.plotTop+"px",width:r.plotWidth+"px",height:r.plotHeight+"px"})};u||(r.loadingDiv=u=i("div",{className:"highcharts-loading highcharts-loading-hidden"},null,r.container),r.loadingSpan=i("span",{className:"highcharts-loading-inner"},null,u),t(r,"redraw",l)),setTimeout(function(){u.className="highcharts-loading"}),r.loadingSpan.innerHTML=e||o.lang.loading,s(u,f(a.style,{zIndex:10})),s(r.loadingSpan,a.labelStyle),r.loadingShown||(s(u,{opacity:0,display:""}),n(u,{opacity:a.style.opacity||.5},{duration:a.showDuration||0})),r.loadingShown=!0,l()},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&(t.className="highcharts-loading highcharts-loading-hidden",n(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){s(t,{display:"none"})}})),this.loadingShown=!1},propsRequireDirtyBox:"backgroundColor borderColor borderWidth margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow".split(" "),propsRequireUpdateSeries:["chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions"],update:function(e,t){var n,r={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle"},i=e.chart,s,a;if(i){p(!0,this.options.chart,i),"className"in i&&this.setClassName(i.className);if("inverted"in i||"polar"in i)this.propFromSeries(),s=!0;for(n in i)i.hasOwnProperty(n)&&(-1!==c("chart."+n,this.propsRequireUpdateSeries)&&(a=!0),-1!==c(n,this.propsRequireDirtyBox)&&(this.isDirtyBox=!0));"style"in i&&this.renderer.setStyle(i.style)}for(n in e)this[n]&&"function"==typeof this[n].update?this[n].update(e[n],!1):"function"==typeof this[r[n]]&&this[r[n]](e[n]),"chart"!==n&&-1!==c(n,this.propsRequireUpdateSeries)&&(a=!0);e.colors&&(this.options.colors=e.colors),e.plotOptions&&p(!0,this.options.plotOptions,e.plotOptions),u(["xAxis","yAxis","series"],function(t){e[t]&&u(b(e[t]),function(e){var n=o(e.id)&&this.get(e.id)||this[t][0];n&&n.coll===t&&n.update(e,!1)},this)},this),s&&u(this.axes,function(e){e.update({},!1)}),a&&u(this.series,function(e){e.update({},!1)}),e.loading&&p(!0,this.options.loading,e.loading),i&&("width"in i||"height"in i)?this.setSize(i.width,i.height):d(t,!0)&&this.redraw()},setSubtitle:function(e){this.setTitle(void 0,e)}}),f(v.prototype,{update:function(e,t,n,r){function i(){s.applyOptions(e),null===s.y&&u&&(s.graphic=u.destroy()),h(e,!0)&&(u&&u.element&&e&&e.marker&&e.marker.symbol&&(s.graphic=u.destroy()),e&&e.dataLabels&&s.dataLabel&&(s.dataLabel=s.dataLabel.destroy())),a=s.index,o.updateParallelArrays(s,a),l.data[a]=h(l.data[a],!0)?s.options:e,o.isDirty=o.isDirtyData=!0,!o.fixedBox&&o.hasCartesianSeries&&(f.isDirtyBox=!0),"point"===l.legendType&&(f.isDirtyLegend=!0),t&&f.redraw(n)}var s=this,o=s.series,u=s.graphic,a,f=o.chart,l=o.options;t=d(t,!0),!1===r?i():s.firePointEvent("update",{options:e},i)},remove:function(e,t){this.series.removePoint(c(this,this.series.data),e,t)}}),f(m.prototype,{addPoint:function(e,t,n,r){var i=this.options,s=this.data,o=this.chart,u=this.xAxis&&this.xAxis.names,a=i.data,f,l,c=this.xData,h,p;t=d(t,!0),f={series:this},this.pointClass.prototype.applyOptions.apply(f,[e]),p=f.x,h=c.length;if(this.requireSorting&&p<c[h-1])for(l=!0;h&&c[h-1]>p;)h--;this.updateParallelArrays(f,"splice",h,0,0),this.updateParallelArrays(f,h),u&&f.name&&(u[p]=f.name),a.splice(h,0,e),l&&(this.data.splice(h,0,null),this.processData()),"point"===i.legendType&&this.generatePoints(),n&&(s[0]&&s[0].remove?s[0].remove(!1):(s.shift(),this.updateParallelArrays(f,"shift"),a.shift())),this.isDirtyData=this.isDirty=!0,t&&o.redraw(r)},removePoint:function(e,t,n){var r=this,i=r.data,s=i[e],o=r.points,u=r.chart,a=function(){o&&o.length===i.length&&o.splice(e,1),i.splice(e,1),r.options.data.splice(e,1),r.updateParallelArrays(s||{series:r},"splice",e,1),s&&s.destroy(),r.isDirty=!0,r.isDirtyData=!0,t&&u.redraw()};y(n,u),t=d(t,!0),s?s.firePointEvent("remove",null,a):a()},remove:function(e,t,n){function r(){i.destroy(),s.isDirtyLegend=s.isDirtyBox=!0,s.linkSeries(),d(e,!0)&&s.redraw(t)}var i=this,s=i.chart;!1!==n?l(i,"remove",null,r):r()},update:function(e,t){var n=this,r=this.chart,i=this.userOptions,s=this.type,o=e.type||i.type||r.options.chart.type,a=g[s].prototype,l=["group","markerGroup","dataLabelsGroup"],c;if(o&&o!==s||void 0!==e.zIndex)l.length=0;u(l,function(e){l[e]=n[e],delete n[e]}),e=p(i,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},e),this.remove(!1,null,!1);for(c in a)this[c]=void 0;f(this,g[o||s].prototype),u(l,function(e){n[e]=l[e]}),this.init(r,e),r.linkSeries(),d(t,!0)&&r.redraw(!1)}}),f(r.prototype,{update:function(e,t){var n=this.chart;e=n.options[this.coll][this.options.index]=p(this.userOptions,e),this.destroy(!0),this.init(n,f(e,{events:void 0})),n.isDirtyBox=!0,d(t,!0)&&n.redraw()},remove:function(e){for(var t=this.chart,n=this.coll,r=this.series,i=r.length;i--;)r[i]&&r[i].remove(!1);a(t.axes,this),a(t[n],this),t.options[n].splice(this.options.index,1),u(t[n],function(e,t){e.options.index=t}),this.destroy(),t.isDirtyBox=!0,d(e,!0)&&t.redraw()},setTitle:function(e,t){this.update({title:e},t)},setCategories:function(e,t){this.update({categories:e},t)}})}(e),function(e){var t=e.color,n=e.each,r=e.map,i=e.pick,s=e.Series,o=e.seriesType;o("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(){var e=[],t=[],s=this.xAxis,o=this.yAxis,u=o.stacks[this.stackKey],a={},f=this.points,l=this.index,c=o.series,h=c.length,p,d=i(o.options.reversedStacks,!0)?1:-1,v,m;if(this.options.stacking){for(v=0;v<f.length;v++)a[f[v].x]=f[v];for(m in u)null!==u[m].total&&t.push(m);t.sort(function(e,t){return e-t}),p=r(c,function(){return this.visible}),n(t,function(r,i){var f=0,c,m;if(a[r]&&!a[r].isNull)e.push(a[r]),n([-1,1],function(e){var n=1===e?"rightNull":"leftNull",s=0,o=u[t[i+e]];if(o)for(v=l;0<=v&&v<h;)c=o.points[v],c||(v===l?a[r][n]=!0:p[v]&&(m=u[r].points[v])&&(s-=m[1]-m[0])),v+=d;a[r][1===e?"rightCliff":"leftCliff"]=s});else{for(v=l;0<=v&&v<h;){if(c=u[r].points[v]){f=c[1];break}v+=d}f=o.toPixels(f,!0),e.push({isNull:!0,plotX:s.toPixels(r,!0),plotY:f,yBottom:f})}})}return e},getGraphPath:function(e){var t=s.prototype.getGraphPath,n=this.options,r=n.stacking,o=this.yAxis,u,a,f=[],l=[],c=this.index,h,p=o.stacks[this.stackKey],d=n.threshold,v=o.getThreshold(n.threshold),m,n=n.connectNulls||"percent"===r,g=function(t,n,i){var s=e[t];t=r&&p[s.x].points[c];var u=s[i+"Null"]||0;i=s[i+"Cliff"]||0;var a,m,s=!0;i||u?(a=(u?t[0]:t[1])+i,m=t[0]+i,s=!!u):!r&&e[n]&&e[n].isNull&&(a=m=d),void 0!==a&&(l.push({plotX:h,plotY:null===a?v:o.getThreshold(a),isNull:s}),f.push({plotX:h,plotY:null===m?v:o.getThreshold(m),doCurve:!1}))};e=e||this.points,r&&(e=this.getStackPoints());for(u=0;u<e.length;u++)if(a=e[u].isNull,h=i(e[u].rectPlotX,e[u].plotX),m=i(e[u].yBottom,v),!a||n)n||g(u,u-1,"left"),a&&!r&&n||(l.push(e[u]),f.push({x:u,plotX:h,plotY:m})),n||g(u,u+1,"right");return u=t.call(this,l,!0,!0),f.reversed=!0,a=t.call(this,f,!0,!0),a.length&&(a[0]="L"),a=u.concat(a),t=t.call(this,l,!1,n),a.xMap=u.xMap,this.areaPath=a,t},drawGraph:function(){this.areaPath=[],s.prototype.drawGraph.apply(this);var e=this,r=this.areaPath,o=this.options,u=[["area","highcharts-area",this.color,o.fillColor]];n(this.zones,function(t,n){u.push(["zone-area-"+n,"highcharts-area highcharts-zone-area-"+n+" "+t.className,t.color||e.color,t.fillColor||o.fillColor])}),n(u,function(n){var s=n[0],u=e[s];u?(u.endX=r.xMap,u.animate({d:r})):(u=e[s]=e.chart.renderer.path(r).addClass(n[1]).attr({fill:i(n[3],t(n[2]).setOpacity(i(o.fillOpacity,.75)).get()),zIndex:0}).add(e.group),u.isArea=!0),u.startX=r.xMap,u.shiftUnit=o.step?2:1})},drawLegendSymbol:e.LegendSymbolMixin.drawRectangle})}(e),function(e){var t=e.extendClass,n=e.merge,r=e.pick,i=e.Series,s=e.seriesTypes;e.defaultPlotOptions.spline=n(e.defaultPlotOptions.line),s.spline=t(i,{type:"spline",getPointSpline:function(e,t,n){var i=t.plotX,s=t.plotY,o=e[n-1];n=e[n+1];var u,a,f,l;if(o&&!o.isNull&&!1!==o.doCurve&&n&&!n.isNull&&!1!==n.doCurve){e=o.plotY,f=n.plotX,n=n.plotY;var c=0;u=(1.5*i+o.plotX)/2.5,a=(1.5*s+e)/2.5,f=(1.5*i+f)/2.5,l=(1.5*s+n)/2.5,f!==u&&(c=(l-a)*(f-i)/(f-u)+s-l),a+=c,l+=c,a>e&&a>s?(a=Math.max(e,s),l=2*s-a):a<e&&a<s&&(a=Math.min(e,s),l=2*s-a),l>n&&l>s?(l=Math.max(n,s),a=2*s-l):l<n&&l<s&&(l=Math.min(n,s),a=2*s-l),t.rightContX=f,t.rightContY=l}return t=["C",r(o.rightContX,o.plotX),r(o.rightContY,o.plotY),r(u,i),r(a,s),i,s],o.rightContX=o.rightContY=null,t}})}(e),function(e){var t=e.seriesTypes.area.prototype,n=e.seriesType;n("areaspline","spline",e.defaultPlotOptions.area,{getStackPoints:t.getStackPoints,getGraphPath:t.getGraphPath,setStackCliffs:t.setStackCliffs,drawGraph:t.drawGraph,drawLegendSymbol:e.LegendSymbolMixin.drawRectangle})}(e),function(e){var t=e.animObject,n=e.color,r=e.each,i=e.extend,s=e.isNumber,o=e.merge,u=e.pick,a=e.Series,f=e.seriesType,l=e.stop,c=e.svg;f("column","line",{borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1,shadow:!1},select:{color:"#cccccc",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){a.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&r(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},getColumnMetrics:function(){var e=this,t=e.options,n=e.xAxis,i=e.yAxis,s=n.reversed,o,a={},f=0;!1===t.grouping?f=1:r(e.chart.series,function(t){var n=t.options,r=t.yAxis,s;t.type===e.type&&t.visible&&i.len===r.len&&i.pos===r.pos&&(n.stacking?(o=t.stackKey,void 0===a[o]&&(a[o]=f++),s=a[o]):!1!==n.grouping&&(s=f++),t.columnIndex=s)});var l=Math.min(Math.abs(n.transA)*(n.ordinalSlope||t.pointRange||n.closestPointRange||n.tickInterval||1),n.len),c=l*t.groupPadding,h=(l-2*c)/f,t=Math.min(t.maxPointWidth||n.len,u(t.pointWidth,h*(1-2*t.pointPadding)));return e.columnMetrics={width:t,offset:(h-t)/2+(c+((e.columnIndex||0)+(s?1:0))*h-l/2)*(s?-1:1)},e.columnMetrics},crispCol:function(e,t,n,r){var i=this.chart,s=this.borderWidth,o=-(s%2?.5:0),s=s%2?.5:1;return i.inverted&&i.renderer.isVML&&(s+=1),n=Math.round(e+n)+o,e=Math.round(e)+o,r=Math.round(t+r)+s,o=.5>=Math.abs(t)&&.5<r,t=Math.round(t)+s,r-=t,o&&r&&(--t,r+=1),{x:e,y:t,width:n-e,height:r}},translate:function(){var e=this,t=e.chart,n=e.options,i=e.dense=2>e.closestPointRange*e.xAxis.transA,i=e.borderWidth=u(n.borderWidth,i?0:1),s=e.yAxis,o=e.translatedThreshold=s.getThreshold(n.threshold),f=u(n.minPointLength,5),l=e.getColumnMetrics(),c=l.width,h=e.barW=Math.max(c,1+2*i),p=e.pointXOffset=l.offset;t.inverted&&(o-=.5),n.pointPadding&&(h=Math.ceil(h)),a.prototype.translate.apply(e),r(e.points,function(n){var r=u(n.yBottom,o),i=999+Math.abs(r),i=Math.min(Math.max(-i,n.plotY),s.len+i),a=n.plotX+p,l=h,v=Math.min(i,r),m,y=Math.max(i,r)-v;Math.abs(y)<f&&f&&(y=f,m=!s.reversed&&!n.negative||s.reversed&&n.negative,v=Math.abs(v-o)>f?r-f:o-(m?f:0)),n.barX=a,n.pointWidth=c,n.tooltipPos=t.inverted?[s.len+s.pos-t.plotLeft-i,e.xAxis.len-a-l/2,y]:[a+l/2,i+s.pos-t.plotTop,y],n.shapeType="rect",n.shapeArgs=e.crispCol.apply(e,n.isNull?[n.plotX,s.len/2,0,0]:[a,v,l,y])})},getSymbol:e.noop,drawLegendSymbol:e.LegendSymbolMixin.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(e,t){var r=this.options,i,s,o=this.pointAttrToOptions||{};s=o.stroke||"borderColor";var u=o["stroke-width"]||"borderWidth",a=e&&e.color||this.color,f=r[s]||this.color||a,o=r.dashStyle,l;return e&&this.zones.length&&(a=(i=e.getZone())&&i.color||e.options.color||this.color),t&&(i=r.states[t],l=i.brightness,a=i.color||void 0!==l&&n(a).brighten(i.brightness).get()||a,f=i[s]||f,o=i.dashStyle||o),s={fill:a,stroke:f,"stroke-width":e[u]||r[u]||this[u]||0},r.borderRadius&&(s.r=r.borderRadius),o&&(s.dashstyle=o),s},drawPoints:function(){var e=this,t=this.chart,n=e.options,i=t.renderer,u=n.animationLimit||250,a;r(e.points,function(r){var f=r.graphic;s(r.plotY)&&null!==r.y?(a=r.shapeArgs,f?(l(f),f[t.pointCount<u?"animate":"attr"](o(a))):r.graphic=f=i[r.shapeType](a).attr({"class":r.getClassName()}).add(r.group||e.group),f.attr(e.pointAttribs(r,r.selected&&"select")).shadow(n.shadow,null,n.stacking&&!n.borderRadius)):f&&(r.graphic=f.destroy())})},animate:function(e){var n=this,r=this.yAxis,s=n.options,o=this.chart.inverted,u={};c&&(e?(u.scaleY=.001,e=Math.min(r.pos+r.len,Math.max(r.pos,r.toPixels(s.threshold))),o?u.translateX=e-r.len:u.translateY=e,n.group.attr(u)):(u[o?"translateX":"translateY"]=r.pos,n.group.animate(u,i(t(n.options.animation),{step:function(e,t){n.group.attr({scaleY:Math.max(.001,t.pos)})}})),n.animate=null))},remove:function(){var e=this,t=e.chart;t.hasRendered&&r(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),a.prototype.remove.apply(e,arguments)}})}(e),function(e){e=e.seriesType,e("bar","column",null,{inverted:!0})}(e),function(e){var t=e.Series;e=e.seriesType,e("scatter","line",{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">â—</span> <span style="font-size: 0.85em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&t.prototype.drawGraph.call(this)}})}(e),function(e){var t=e.pick,n=e.relativeLength;e.CenteredSeriesMixin={getCenter:function(){var e=this.options,r=this.chart,i=2*(e.slicedOffset||0),s=r.plotWidth-2*i,r=r.plotHeight-2*i,o=e.center,o=[t(o[0],"50%"),t(o[1],"50%"),e.size||"100%",e.innerSize||0],u=Math.min(s,r),a,f;for(a=0;4>a;++a)f=o[a],e=2>a||2===a&&/%$/.test(f),o[a]=n(f,[s,r,u,o[2]][a])+(e?i:0);return o[3]>o[2]&&(o[3]=o[2]),o}}}(e),function(e){var t=e.addEvent,n=e.defined,r=e.each,i=e.extend,s=e.inArray,o=e.noop,u=e.pick,a=e.Point,f=e.Series,l=e.seriesType,c=e.setAnimation;l("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return null===this.y?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,states:{hover:{brightness:.1,shadow:!1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:e.seriesTypes.column.prototype.pointAttribs,animate:function(e){var t=this,n=t.points,i=t.startAngleRad;e||(r(n,function(e){var n=e.graphic,r=e.shapeArgs;n&&(n.attr({r:e.startR||t.center[3]/2,start:i,end:i}),n.animate({r:r.r,start:r.start,end:r.end},t.options.animation))}),t.animate=null)},updateTotals:function(){var e,t=0,n=this.points,r=n.length,i,s=this.options.ignoreHiddenPoint;for(e=0;e<r;e++)i=n[e],0>i.y&&(i.y=null),t+=s&&!i.visible?0:i.y;this.total=t;for(e=0;e<r;e++)i=n[e],i.percentage=0<t&&(i.visible||!s)?i.y/t*100:0,i.total=t},generatePoints:function(){f.prototype.generatePoints.call(this),this.updateTotals()},translate:function(e){this.generatePoints();var t=0,n=this.options,r=n.slicedOffset,i=r+(n.borderWidth||0),s,o,a,f=n.startAngle||0,l=this.startAngleRad=Math.PI/180*(f-90),f=(this.endAngleRad=Math.PI/180*(u(n.endAngle,f+360)-90))-l,c=this.points,h=n.dataLabels.distance,n=n.ignoreHiddenPoint,p,v=c.length,m;e||(this.center=e=this.getCenter()),this.getX=function(t,n){return a=Math.asin(Math.min((t-e[1])/(e[2]/2+h),1)),e[0]+(n?-1:1)*Math.cos(a)*(e[2]/2+h)};for(p=0;p<v;p++){m=c[p],s=l+t*f;if(!n||m.visible)t+=m.percentage/100;o=l+t*f,m.shapeType="arc",m.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:Math.round(1e3*s)/1e3,end:Math.round(1e3*o)/1e3},a=(o+s)/2,a>1.5*Math.PI?a-=2*Math.PI:a<-Math.PI/2&&(a+=2*Math.PI),m.slicedTranslation={translateX:Math.round(Math.cos(a)*r),translateY:Math.round(Math.sin(a)*r)},s=Math.cos(a)*e[2]/2,o=Math.sin(a)*e[2]/2,m.tooltipPos=[e[0]+.7*s,e[1]+.7*o],m.half=a<-Math.PI/2||a>Math.PI/2?1:0,m.angle=a,i=Math.min(i,h/5),m.labelPos=[e[0]+s+Math.cos(a)*h,e[1]+o+Math.sin(a)*h,e[0]+s+Math.cos(a)*i,e[1]+o+Math.sin(a)*i,e[0]+s,e[1]+o,0>h?"center":m.half?"right":"left",a]}},drawGraph:null,drawPoints:function(){var e=this,t=e.chart.renderer,n,s,o,u,a=e.options.shadow;a&&!e.shadowGroup&&(e.shadowGroup=t.g("shadow").add(e.group)),r(e.points,function(r){if(null!==r.y){s=r.graphic,u=r.shapeArgs,n=r.sliced?r.slicedTranslation:{};var f=r.shadowGroup;a&&!f&&(f=r.shadowGroup=t.g("shadow").add(e.shadowGroup)),f&&f.attr(n),o=e.pointAttribs(r,r.selected&&"select"),s?s.setRadialReference(e.center).attr(o).animate(i(u,n)):(r.graphic=s=t[r.shapeType](u).addClass(r.getClassName()).setRadialReference(e.center).attr(n).add(e.group),r.visible||s.attr({visibility:"hidden"}),s.attr(o).attr({"stroke-linejoin":"round"}).shadow(a,f))}})},searchPoint:o,sortByAngle:function(e,t){e.sort(function(e,n){return void 0!==e.angle&&(n.angle-e.angle)*t})},drawLegendSymbol:e.LegendSymbolMixin.drawRectangle,getCenter:e.CenteredSeriesMixin.getCenter,getSymbol:o},{init:function(){a.prototype.init.apply(this,arguments);var e=this,n;return e.name=u(e.name,"Slice"),n=function(t){e.slice("select"===t.type)},t(e,"select",n),t(e,"unselect",n),e},setVisible:function(e,t){var n=this,i=n.series,o=i.chart,a=i.options.ignoreHiddenPoint;t=u(t,a),e!==n.visible&&(n.visible=n.options.visible=e=void 0===e?!n.visible:e,i.options.data[s(n,i.data)]=n.options,r(["graphic","dataLabel","connector","shadowGroup"],function(t){n[t]&&n[t][e?"show":"hide"](!0)}),n.legendItem&&o.legend.colorizeItem(n,e),e||"hover"!==n.state||n.setState(""),a&&(i.isDirty=!0),t&&o.redraw())},slice:function(e,t,r){var i=this.series;c(r,i.chart),u(t,!0),this.sliced=this.options.sliced=e=n(e)?e:!this.sliced,i.options.data[s(this,i.data)]=this.options,e=e?this.slicedTranslation:{translateX:0,translateY:0},this.graphic.animate(e),this.shadowGroup&&this.shadowGroup.animate(e)},haloPath:function(e){var t=this.shapeArgs,n=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(n.plotLeft+t.x,n.plotTop+t.y,t.r+e,t.r+e,{innerR:this.shapeArgs.r,start:t.start,end:t.end})}})}(e),function(e){var t=e.addEvent,n=e.arrayMax,r=e.defined,i=e.each,s=e.extend,o=e.format,u=e.map,a=e.merge,f=e.noop,l=e.pick,c=e.relativeLength,h=e.Series,p=e.seriesTypes,d=e.stableSort,v=e.stop;e.distribute=function(e,t){function n(e,t){return e.target-t.target}var r,s=!0,o=e,a=[],f;f=0;for(r=e.length;r--;)f+=e[r].size;if(f>t){d(e,function(e,t){return(t.rank||0)-(e.rank||0)});for(f=r=0;f<=t;)f+=e[r].size,r++;a=e.splice(r-1,e.length)}d(e,n);for(e=u(e,function(e){return{size:e.size,targets:[e.target]}});s;){for(r=e.length;r--;)s=e[r],f=(Math.min.apply(0,s.targets)+Math.max.apply(0,s.targets))/2,s.pos=Math.min(Math.max(0,f-s.size/2),t-s.size);r=e.length;for(s=!1;r--;)0<r&&e[r-1].pos+e[r-1].size>e[r].pos&&(e[r-1].size+=e[r].size,e[r-1].targets=e[r-1].targets.concat(e[r].targets),e[r-1].pos+e[r-1].size>t&&(e[r-1].pos=t-e[r-1].size),e.splice(r,1),s=!0)}r=0,i(e,function(e){var t=0;i(e.targets,function(){o[r].pos=e.pos+t,t+=o[r].size,r++})}),o.push.apply(o,a),d(o,n)},h.prototype.drawDataLabels=function(){var e=this,n=e.options,u=n.dataLabels,f=e.points,c,h,p=e.hasRendered||0,d,v,y=l(u.defer,!0),b=e.chart.renderer;if(u.enabled||e._hasPointLabels)e.dlProcessOptions&&e.dlProcessOptions(u),v=e.plotGroup("dataLabelsGroup","data-labels",y&&!p?"hidden":"visible",u.zIndex||6),y&&(v.attr({opacity:+p}),p||t(e,"afterAnimate",function(){e.visible&&v.show(!0),v[n.animation?"animate":"attr"]({opacity:1},{duration:200})})),h=u,i(f,function(t){var i,f=t.dataLabel,p,y,w=t.connector,S=!0,x,T={};c=t.dlOptions||t.options&&t.options.dataLabels,i=l(c&&c.enabled,h.enabled)&&null!==t.y;if(f&&!i)t.dataLabel=f.destroy();else if(i){u=a(h,c),x=u.style,i=u.rotation,p=t.getLabelConfig(),d=u.format?o(u.format,p):u.formatter.call(p,u),x.color=l(u.color,x.color,e.color,"#000000");if(f)r(d)?(f.attr({text:d}),S=!1):(t.dataLabel=f=f.destroy(),w&&(t.connector=w.destroy()));else if(r(d)){f={fill:u.backgroundColor,stroke:u.borderColor,"stroke-width":u.borderWidth,r:u.borderRadius||0,rotation:i,padding:u.padding,zIndex:1},"contrast"===x.color&&(T.color=u.inside||0>u.distance||n.stacking?b.getContrast(t.color||e.color):"#000000"),n.cursor&&(T.cursor=n.cursor);for(y in f)void 0===f[y]&&delete f[y];f=t.dataLabel=b[i?"text":"label"](d,0,-9999,u.shape,null,null,u.useHTML,null,"data-label").attr(f),f.addClass("highcharts-data-label-color-"+t.colorIndex+" "+(u.className||"")),f.css(s(x,T)),f.add(v),f.shadow(u.shadow)}f&&e.alignDataLabel(t,f,u,null,S)}})},h.prototype.alignDataLabel=function(e,t,n,r,i){var o=this.chart,u=o.inverted,a=l(e.plotX,-9999),f=l(e.plotY,-9999),c=t.getBBox(),h,p=n.rotation,d=n.align,m=this.visible&&(e.series.forceDL||o.isInsidePlot(a,Math.round(f),u)||r&&o.isInsidePlot(a,u?r.x+1:r.y+r.height-1,u)),g="justify"===l(n.overflow,"justify");m&&(h=n.style.fontSize,h=o.renderer.fontMetrics(h,t).b,r=s({x:u?o.plotWidth-f:a,y:Math.round(u?o.plotHeight-a:f),width:0,height:0},r),s(n,{width:c.width,height:c.height}),p?(g=!1,u=o.renderer.rotCorr(h,p),u={x:r.x+n.x+r.width/2+u.x,y:r.y+n.y+{top:0,middle:.5,bottom:1}[n.verticalAlign]*r.height},t[i?"attr":"animate"](u).attr({align:d}),a=(p+720)%360,a=180<a&&360>a,"left"===d?u.y-=a?c.height:0:"center"===d?(u.x-=c.width/2,u.y-=c.height/2):"right"===d&&(u.x-=c.width,u.y-=a?0:c.height)):(t.align(n,null,r),u=t.alignAttr),g?this.justifyDataLabel(t,n,u,c,r,i):l(n.crop,!0)&&(m=o.isInsidePlot(u.x,u.y)&&o.isInsidePlot(u.x+c.width,u.y+c.height)),n.shape&&!p&&t.attr({anchorX:e.plotX,anchorY:e.plotY})),m||(v(t),t.attr({y:-9999}),t.placed=!1)},h.prototype.justifyDataLabel=function(e,t,n,r,i,s){var o=this.chart,u=t.align,a=t.verticalAlign,f,l,c=e.box?0:e.padding||0;f=n.x+c,0>f&&("right"===u?t.align="left":t.x=-f,l=!0),f=n.x+r.width-c,f>o.plotWidth&&("left"===u?t.align="right":t.x=o.plotWidth-f,l=!0),f=n.y+c,0>f&&("bottom"===a?t.verticalAlign="top":t.y=-f,l=!0),f=n.y+r.height-c,f>o.plotHeight&&("top"===a?t.verticalAlign="bottom":t.y=o.plotHeight-f,l=!0),l&&(e.placed=!s,e.align(t,null,i))},p.pie&&(p.pie.prototype.drawDataLabels=function(){var t=this,r=t.data,s,o=t.chart,a=t.options.dataLabels,f=l(a.connectorPadding,10),c=l(a.connectorWidth,1),p=o.plotWidth,d=o.plotHeight,v,m=a.distance,g=t.center,w=g[2]/2,E=g[1],S=0<m,x,T,N,C,k=[[],[]],L,A,O,M,_=[0,0,0,0];t.visible&&(a.enabled||t._hasPointLabels)&&(h.prototype.drawDataLabels.apply(t),i(r,function(e){e.dataLabel&&e.visible&&(k[e.half].push(e),e.dataLabel._pos=null)}),i(k,function(n,r){var i,l,c=n.length,h,v,y;if(c)for(t.sortByAngle(n,r-.5),0<m&&(i=Math.max(0,E-w-m),l=Math.min(E+w+m,o.plotHeight),h=u(n,function(e){if(e.dataLabel)return y=e.dataLabel.getBBox().height||21,{target:e.labelPos[1]-i+y/2,size:y,rank:e.y}}),e.distribute(h,l+y-i)),M=0;M<c;M++)s=n[M],N=s.labelPos,x=s.dataLabel,O=!1===s.visible?"hidden":"inherit",v=N[1],h?void 0===h[M].pos?O="hidden":(C=h[M].size,A=i+h[M].pos):A=v,L=a.justify?g[0]+(r?-1:1)*(w+m):t.getX(A<i+2||A>l-2?v:A,r),x._attr={visibility:O,align:N[6]},x._pos={x:L+a.x+({left:f,right:-f}[N[6]]||0),y:A+a.y-10},N.x=L,N.y=A,null===t.options.size&&(T=x.width,L-T<f?_[3]=Math.max(Math.round(T-L+f),_[3]):L+T>p-f&&(_[1]=Math.max(Math.round(L+T-p+f),_[1])),0>A-C/2?_[0]=Math.max(Math.round(-A+C/2),_[0]):A+C/2>d&&(_[2]=Math.max(Math.round(A+C/2-d),_[2])))}),0===n(_)||this.verifyDataLabelOverflow(_))&&(this.placeDataLabels(),S&&c&&i(this.points,function(e){var n;v=e.connector;if((x=e.dataLabel)&&x._pos&&e.visible){O=x._attr.visibility;if(n=!v)e.connector=v=o.renderer.path().addClass("highcharts-data-label-connector highcharts-color-"+e.colorIndex).add(t.dataLabelsGroup),v.attr({"stroke-width":c,stroke:a.connectorColor||e.color||"#666666"});v[n?"attr":"animate"]({d:t.connectorPath(e.labelPos)}),v.attr("visibility",O)}else v&&(e.connector=v.destroy())}))},p.pie.prototype.connectorPath=function(e){var t=e.x,n=e.y;return l(this.options.softConnector,!0)?["M",t+("left"===e[6]?5:-5),n,"C",t,n,2*e[2]-e[4],2*e[3]-e[5],e[2],e[3],"L",e[4],e[5]]:["M",t+("left"===e[6]?5:-5),n,"L",e[2],e[3],"L",e[4],e[5]]},p.pie.prototype.placeDataLabels=function(){i(this.points,function(e){var t=e.dataLabel;t&&e.visible&&((e=t._pos)?(t.attr(t._attr),t[t.moved?"animate":"attr"](e),t.moved=!0):t&&t.attr({y:-9999}))})},p.pie.prototype.alignDataLabel=f,p.pie.prototype.verifyDataLabelOverflow=function(e){var t=this.center,n=this.options,r=n.center,i=n.minSize||80,s,o;return null!==r[0]?s=Math.max(t[2]-Math.max(e[1],e[3]),i):(s=Math.max(t[2]-e[1]-e[3],i),t[0]+=(e[3]-e[1])/2),null!==r[1]?s=Math.max(Math.min(s,t[2]-Math.max(e[0],e[2])),i):(s=Math.max(Math.min(s,t[2]-e[0]-e[2]),i),t[1]+=(e[0]-e[2])/2),s<t[2]?(t[2]=s,t[3]=Math.min(c(n.innerSize||0,s),s),this.translate(t),this.drawDataLabels&&this.drawDataLabels()):o=!0,o}),p.column&&(p.column.prototype.alignDataLabel=function(e,t,n,r,i){var s=this.chart.inverted,o=e.series,u=e.dlBox||e.shapeArgs,f=l(e.below,e.plotY>l(this.translatedThreshold,o.yAxis.len)),c=l(n.inside,!!this.options.stacking);u&&(r=a(u),0>r.y&&(r.height+=r.y,r.y=0),u=r.y+r.height-o.yAxis.len,0<u&&(r.height-=u),s&&(r={x:o.yAxis.len-r.y-r.height,y:o.xAxis.len-r.x-r.width,width:r.height,height:r.width}),c||(s?(r.x+=f?0:r.width,r.width=0):(r.y+=f?r.height:0,r.height=0))),n.align=l(n.align,!s||c?"center":f?"right":"left"),n.verticalAlign=l(n.verticalAlign,s||c?"middle":f?"top":"bottom"),h.prototype.alignDataLabel.call(this,e,t,n,r,i)})}(e),function(e){var t=e.Chart,n=e.each,r=e.pick,i=e.addEvent;t.prototype.callbacks.push(function(e){function t(){var t=[];n(e.series,function(e){var i=e.options.dataLabels,s=e.dataLabelCollections||["dataLabel"];(i.enabled||e._hasPointLabels)&&!i.allowOverlap&&e.visible&&n(s,function(i){n(e.points,function(e){e[i]&&(e[i].labelrank=r(e.labelrank,e.shapeArgs&&e.shapeArgs.height),t.push(e[i]))})})}),e.hideOverlappingLabels(t)}t(),i(e,"redraw",t)}),t.prototype.hideOverlappingLabels=function(e){var t=e.length,r,i,s,o,u,a,f,l,c,h=function(e,t,n,r,i,s,o,u){return!(i>e+n||i+o<e||s>t+r||s+u<t)};for(i=0;i<t;i++)if(r=e[i])r.oldOpacity=r.opacity,r.newOpacity=1;e.sort(function(e,t){return(t.labelrank||0)-(e.labelrank||0)});for(i=0;i<t;i++)for(s=e[i],r=i+1;r<t;++r)if(o=e[r],s&&o&&s.placed&&o.placed&&0!==s.newOpacity&&0!==o.newOpacity&&(u=s.alignAttr,a=o.alignAttr,f=s.parentGroup,l=o.parentGroup,c=2*(s.box?0:s.padding),u=h(u.x+f.translateX,u.y+f.translateY,s.width-c,s.height-c,a.x+l.translateX,a.y+l.translateY,o.width-c,o.height-c)))(s.labelrank<o.labelrank?s:o).newOpacity=0;n(e,function(e){var t,n;e&&(n=e.newOpacity,e.oldOpacity!==n&&e.placed&&(n?e.show(!0):t=function(){e.hide()},e.alignAttr.opacity=n,e[e.isOld?"animate":"attr"](e.alignAttr,null,t)),e.isOld=!0)})}}(e),function(e){var t=e.addEvent,n=e.Chart,r=e.createElement,i=e.css,s=e.defaultOptions,o=e.defaultPlotOptions,u=e.each,a=e.extend,f=e.fireEvent,l=e.hasTouch,c=e.inArray,h=e.isObject,p=e.Legend,d=e.merge,v=e.pick,m=e.Point,g=e.Series,y=e.seriesTypes,b=e.svg;e=e.TrackerMixin={drawTrackerPoint:function(){var e=this,t=e.chart,n=t.pointer,r=function(e){for(var n=e.target,r;n&&!r;)r=n.point,n=n.parentNode;void 0!==r&&r!==t.hoverPoint&&r.onMouseOver(e)};u(e.points,function(e){e.graphic&&(e.graphic.element.point=e),e.dataLabel&&(e.dataLabel.element.point=e)}),e._hasTracking||(u(e.trackerGroups,function(t){e[t]&&(e[t].addClass("highcharts-tracker").on("mouseover",r).on("mouseout",function(e){n.onTrackerMouseOut(e)}),l&&e[t].on("touchstart",r),e.options.cursor&&e[t].css(i).css({cursor:e.options.cursor}))}),e._hasTracking=!0)},drawTrackerGraph:function(){var e=this,t=e.options,n=t.trackByArea,r=[].concat(n?e.areaPath:e.graphPath),i=r.length,s=e.chart,o=s.pointer,a=s.renderer,f=s.options.tooltip.snap,c=e.tracker,h,p=function(){s.hoverSeries!==e&&e.onMouseOver()},d="rgba(192,192,192,"+(b?1e-4:.002)+")";if(i&&!n)for(h=i+1;h--;)"M"===r[h]&&r.splice(h+1,0,r[h+1]-f,r[h+2],"L"),(h&&"M"===r[h]||h===i)&&r.splice(h,0,"L",r[h-2]+f,r[h-1]);c?c.attr({d:r}):e.graph&&(e.tracker=a.path(r).attr({"stroke-linejoin":"round",visibility:e.visible?"visible":"hidden",stroke:d,fill:n?d:"none","stroke-width":e.graph.strokeWidth()+(n?0:2*f),zIndex:2}).add(e.group),u([e.tracker,e.markerGroup],function(e){e.addClass("highcharts-tracker").on("mouseover",p).on("mouseout",function(e){o.onTrackerMouseOut(e)}),t.cursor&&e.css({cursor:t.cursor}),l&&e.on("touchstart",p)}))}},y.column&&(y.column.prototype.drawTracker=e.drawTrackerPoint),y.pie&&(y.pie.prototype.drawTracker=e.drawTrackerPoint),y.scatter&&(y.scatter.prototype.drawTracker=e.drawTrackerPoint),a(p.prototype,{setItemEvents:function(e,t,n){var r=this,i=r.chart,s="highcharts-legend-"+(e.series?"point":"series")+"-active";(n?t:e.legendGroup).on("mouseover",function(){e.setState("hover"),i.seriesGroup.addClass(s),t.css(r.options.itemHoverStyle)}).on("mouseout",function(){t.css(e.visible?r.itemStyle:r.itemHiddenStyle),i.seriesGroup.removeClass(s),e.setState()}).on("click",function(t){var n=function(){e.setVisible&&e.setVisible()};t={browserEvent:t},e.firePointEvent?e.firePointEvent("legendItemClick",t,n):f(e,"legendItemClick",t,n)})},createCheckboxForItem:function(e){e.checkbox=r("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},this.options.itemCheckboxStyle,this.chart.container),t(e.checkbox,"click",function(t){f(e.series||e,"checkboxClick",{checked:t.target.checked,item:e},function(){e.select()})})}}),s.legend.itemStyle.cursor="pointer",a(n.prototype,{showResetZoom:function(){var e=this,t=s.lang,n=e.options.chart.resetZoomButton,r=n.theme,i=r.states,o="chart"===n.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},r,i&&i.hover).attr({align:n.position.align,title:t.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(n.position,!1,o)},zoomOut:function(){var e=this;f(e,"selection",{resetSelection:!0},function(){e.zoom()})},zoom:function(e){var t,n=this.pointer,r=!1,i;!e||e.resetSelection?u(this.axes,function(e){t=e.zoom()}):u(e.xAxis.concat(e.yAxis),function(e){var i=e.axis,s=i.isXAxis;if(n[s?"zoomX":"zoomY"]||n[s?"pinchX":"pinchY"])t=i.zoom(e.min,e.max),i.displayBtn&&(r=!0)}),i=this.resetZoomButton,r&&!i?this.showResetZoom():!r&&h(i)&&(this.resetZoomButton=i.destroy()),t&&this.redraw(v(this.options.chart.animation,e&&e.animation,100>this.pointCount))},pan:function(e,t){var n=this,r=n.hoverPoints,s;r&&u(r,function(e){e.setState()}),u("xy"===t?[1,0]:[1],function(t){t=n[t?"xAxis":"yAxis"][0];var r=t.horiz,i=e[r?"chartX":"chartY"],r=r?"mouseDownX":"mouseDownY",o=n[r],u=(t.pointRange||0)/2,a=t.getExtremes(),f=t.toValue(o-i,!0)+u,u=t.toValue(o+t.len-i,!0)-u,o=o>i;t.series.length&&(o||f>Math.min(a.dataMin,a.min))&&(!o||u<Math.max(a.dataMax,a.max))&&(t.setExtremes(f,u,!1,!1,{trigger:"pan"}),s=!0),n[r]=i}),s&&n.redraw(!1),i(n.container,{cursor:"move"})}}),a(m.prototype,{select:function(e,t){var n=this,r=n.series,i=r.chart;e=v(e,!n.selected),n.firePointEvent(e?"select":"unselect",{accumulate:t},function(){n.selected=n.options.selected=e,r.options.data[c(n,r.data)]=n.options,n.setState(e&&"select"),t||u(i.getSelectedPoints(),function(e){e.selected&&e!==n&&(e.selected=e.options.selected=!1,r.options.data[c(e,r.data)]=e.options,e.setState(""),e.firePointEvent("unselect"))})})},onMouseOver:function(e,t){var n=this.series,r=n.chart,i=r.tooltip,s=r.hoverPoint;r.hoverSeries!==n&&n.onMouseOver(),s&&s!==this&&s.onMouseOut(),this.series&&(this.firePointEvent("mouseOver"),!i||i.shared&&!n.noSharedTooltip||i.refresh(this,e),this.setState("hover"),t||(r.hoverPoint=this))},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;this.firePointEvent("mouseOut"),t&&-1!==c(this,t)||(this.setState(),e.hoverPoint=null)},importEvents:function(){if(!this.hasImportedEvents){var e=d(this.series.options.point,this.options).events,n;this.events=e;for(n in e)t(this,n,e[n]);this.hasImportedEvents=!0}},setState:function(e,t){var n=Math.floor(this.plotX),r=this.plotY,i=this.series,s=i.options.states[e]||{},u=o[i.type].marker&&i.options.marker||{},f=!1===u.enabled,l=u.states&&u.states[e]||{},c=!1===l.enabled,h=i.stateMarkerGraphic,p=this.marker||{},m=i.chart,g=i.halo;e=e||"",e===this.state&&!t||this.selected&&"select"!==e||!1===s.enabled||e&&(c||f&&!1===l.enabled)||e&&p.states&&p.states[e]&&!1===p.states[e].enabled||(u=l.radius||u.radius+(l.radiusPlus||0),this.graphic?(this.state&&this.graphic.removeClass("highcharts-point-"+this.state),e&&this.graphic.addClass("highcharts-point-"+e),n=u?{x:n-u,y:r-u,width:2*u,height:2*u}:{},n=d(i.pointAttribs(this,e),n),this.graphic.attr(n),h&&h.hide()):(e&&l&&(l=p.symbol||i.symbol,h&&h.currentSymbol!==l&&(h=h.destroy()),h?h[t?"animate":"attr"]({x:n-u,y:r-u}):l&&(i.stateMarkerGraphic=h=m.renderer.symbol(l,n-u,r-u,2*u,2*u).add(i.markerGroup),h.currentSymbol=l),h&&h.attr(i.pointAttribs(this,e))),h&&(h[e&&m.isInsidePlot(n,r,m.inverted)?"show":"hide"](),h.element.point=this)),(s=s.halo)&&s.size?(g||(i.halo=g=m.renderer.path().add(m.seriesGroup)),g[t?"animate":"attr"]({d:this.haloPath(s.size)}),g.attr({"class":"highcharts-halo highcharts-color-"+v(this.colorIndex,i.colorIndex)}),g.attr(a({fill:this.color||i.color,"fill-opacity":s.opacity,zIndex:-1},s.attributes))[t?"animate":"attr"]({d:this.haloPath(s.size)})):g&&g.attr({d:[]}),this.state=e)},haloPath:function(e){var t=this.series,n=t.chart,r=t.getPlotBox(),i=n.inverted,s=Math.floor(this.plotX);return n.renderer.symbols.circle(r.translateX+(i?t.yAxis.len-this.plotY:s)-e,r.translateY+(i?t.xAxis.len-s:this.plotY)-e,2*e,2*e)}}),a(g.prototype,{onMouseOver:function(){var e=this.chart,t=e.hoverSeries;t&&t!==this&&t.onMouseOut(),this.options.events.mouseOver&&f(this,"mouseOver"),this.setState("hover"),e.hoverSeries=this},onMouseOut:function(){var e=this.options,t=this.chart,n=t.tooltip,r=t.hoverPoint;t.hoverSeries=null,r&&r.onMouseOut(),this&&e.events.mouseOut&&f(this,"mouseOut"),!n||e.stickyTracking||n.shared&&!this.noSharedTooltip||n.hide(),this.setState()},setState:function(e){var t=this,n=t.options,r=t.graph,i=n.states,s=n.lineWidth,n=0;e=e||"";if(t.state!==e&&(u([t.group,t.markerGroup],function(n){n&&(t.state&&n.removeClass("highcharts-series-"+t.state),e&&n.addClass("highcharts-series-"+e))}),t.state=e,!i[e]||!1!==i[e].enabled)&&(e&&(s=i[e].lineWidth||s+(i[e].lineWidthPlus||0)),r&&!r.dashstyle))for(i={"stroke-width":s},r.attr(i);t["zone-graph-"+n];)t["zone-graph-"+n].attr(i),n+=1},setVisible:function(e,t){var n=this,r=n.chart,i=n.legendItem,s,o=r.options.chart.ignoreHiddenSeries,a=n.visible;s=(n.visible=e=n.options.visible=n.userOptions.visible=void 0===e?!a:e)?"show":"hide",u(["group","dataLabelsGroup","markerGroup","tracker"],function(e){n[e]&&n[e][s]()}),(r.hoverSeries===n||(r.hoverPoint&&r.hoverPoint.series)===n)&&n.onMouseOut(),i&&r.legend.colorizeItem(n,e),n.isDirty=!0,n.options.stacking&&u(r.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),u(n.linkedSeries,function(t){t.setVisible(e,!1)}),o&&(r.isDirtyBox=!0),!1!==t&&r.redraw(),f(n,s)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(e){this.selected=e=void 0===e?!this.selected:e,this.checkbox&&(this.checkbox.checked=e),f(this,e?"select":"unselect")},drawTracker:e.drawTrackerGraph})}(e),function(e){var t=e.Chart,n=e.each,r=e.inArray,i=e.isObject,s=e.pick,o=e.splat;t.prototype.setResponsive=function(e){var t=this.options.responsive;t&&t.rules&&n(t.rules,function(t){this.matchResponsiveRule(t,e)},this)},t.prototype.matchResponsiveRule=function(t,n){var r=this.respRules,i=t.condition,o;o=t.callback||function(){return this.chartWidth<=s(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=s(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=s(i.minWidth,0)&&this.chartHeight>=s(i.minHeight,0)},void 0===t._id&&(t._id=e.idCounter++),o=o.call(this),!r[t._id]&&o?t.chartOptions&&(r[t._id]=this.currentOptions(t.chartOptions),this.update(t.chartOptions,n)):r[t._id]&&!o&&(this.update(r[t._id],n),delete r[t._id])},t.prototype.currentOptions=function(e){function t(e,n,s){var u,a;for(u in e)if(-1<r(u,["series","xAxis","yAxis"]))for(e[u]=o(e[u]),s[u]=[],a=0;a<e[u].length;a++)s[u][a]={},t(e[u][a],n[u][a],s[u][a]);else i(e[u])?(s[u]={},t(e[u],n[u]||{},s[u])):s[u]=n[u]||null}var n={};return t(e,this.options,n),n}}(e),e}),define("highcharts",function(){}),function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){(function(e){function t(e,t,n){this.init(e,t,n)}var n=e.each,r=e.extend,i=e.merge,s=e.splat;r(t.prototype,{init:function(e,t,r){var o=this,u=o.defaultOptions;o.chart=t,o.options=e=i(u,t.angular?{background:{}}:void 0,e),(e=e.background)&&n([].concat(s(e)).reverse(),function(e){var t,n=r.userOptions;t=i(o.defaultBackgroundOptions,e),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),t.color=t.backgroundColor,r.options.plotBands.unshift(t),n.plotBands=n.plotBands||[],n.plotBands!==r.options.plotBands&&n.plotBands.unshift(t)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{className:"highcharts-pane",shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}}),e.Pane=t})(e),function(e){var t=e.CenteredSeriesMixin,n=e.each,r=e.extend,i=e.map,s=e.merge,o=e.noop,u=e.Pane,a=e.pick,f=e.pInt,l=e.splat,c=e.wrap,h,p,d=e.Axis.prototype;e=e.Tick.prototype,h={getOffset:o,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:o,setCategories:o,setTitle:o},p={defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(e){e=this.options=s(this.defaultOptions,this.defaultRadialOptions,e),e.plotBands||(e.plotBands=[])},getOffset:function(){d.getOffset.call(this),this.chart.axisOffset[this.side]=0,this.center=this.pane.center=t.getCenter.call(this.pane)},getLinePath:function(e,t){var n=this.center,r,i=this.chart;return r=a(t,n[2]/2-this.offset),this.isCircular||void 0!==t?n=this.chart.renderer.symbols.arc(this.left+n[0],this.top+n[1],r,r,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0}):(r=this.postTranslate(this.angleRad,r),n=["M",n[0]+i.plotLeft,n[1]+i.plotTop,"L",r.x,r.y]),n},setAxisTranslation:function(){d.setAxisTranslation.call(this),this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){if(this.autoConnect=this.isCircular&&void 0===a(this.userMax,this.options.max)&&this.endAngleRad-this.startAngleRad===2*Math.PI)this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0},setAxisSize:function(){d.setAxisSize.call(this),this.isRadial&&(this.center=this.pane.center=t.getCenter.call(this.pane),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*a(this.sector,1)/2)},getPosition:function(e,t){return this.postTranslate(this.isCircular?this.translate(e):this.angleRad,a(this.isCircular?t:this.translate(e),this.center[2]/2)-this.offset)},postTranslate:function(e,t){var n=this.chart,r=this.center;return e=this.startAngleRad+e,{x:n.plotLeft+r[0]+Math.cos(e)*t,y:n.plotTop+r[1]+Math.sin(e)*t}},getPlotBandPath:function(e,t,n){var r=this.center,s=this.startAngleRad,o=r[2]/2,u=[a(n.outerRadius,"100%"),n.innerRadius,a(n.thickness,10)],l=Math.min(this.offset,0),c=/%$/,h,p=this.isCircular;return"polygon"===this.options.gridLineInterpolation?r=this.getPlotLinePath(e).concat(this.getPlotLinePath(t,!0)):(e=Math.max(e,this.min),t=Math.min(t,this.max),p||(u[0]=this.translate(e),u[1]=this.translate(t)),u=i(u,function(e){return c.test(e)&&(e=f(e,10)*o/100),e}),"circle"!==n.shape&&p?(e=s+this.translate(e),t=s+this.translate(t)):(e=-Math.PI/2,t=1.5*Math.PI,h=!0),u[0]-=l,u[2]-=l,r=this.chart.renderer.symbols.arc(this.left+r[0],this.top+r[1],u[0],u[0],{start:Math.min(e,t),end:Math.max(e,t),innerR:a(u[1],u[0]-u[2]),open:h})),r},getPlotLinePath:function(e,t){var r=this,i=r.center,s=r.chart,o=r.getPosition(e),u,a,f;return r.isCircular?f=["M",i[0]+s.plotLeft,i[1]+s.plotTop,"L",o.x,o.y]:"circle"===r.options.gridLineInterpolation?(e=r.translate(e))&&(f=r.getLinePath(0,e)):(n(s.xAxis,function(e){e.pane===r.pane&&(u=e)}),f=[],e=r.translate(e),i=u.tickPositions,u.autoConnect&&(i=i.concat([i[0]])),t&&(i=[].concat(i).reverse()),n(i,function(t,n){a=u.getPosition(t,e),f.push(n?"L":"M",a.x,a.y)})),f},getTitlePosition:function(){var e=this.center,t=this.chart,n=this.options.title;return{x:t.plotLeft+e[0]+(n.x||0),y:t.plotTop+e[1]-{high:.5,middle:.25,low:0}[n.align]*e[2]+(n.y||0)}}},c(d,"init",function(e,t,n){var i=t.angular,o=t.polar,f=n.isX,c=i&&f,d,v=t.options,m=n.pane||0;if(i){if(r(this,c?h:p),d=!f)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else o&&(r(this,p),this.defaultRadialOptions=(d=f)?this.defaultRadialXOptions:s(this.defaultYAxisOptions,this.defaultRadialYOptions));i||o?(this.isRadial=!0,t.inverted=!1,v.chart.zoomType=null):this.isRadial=!1,e.call(this,t,n),c||!i&&!o||(e=this.options,t.panes||(t.panes=[]),this.pane=t=t.panes[m]=t.panes[m]||new u(l(v.pane)[m],t,this),t=t.options,this.angleRad=(e.angle||0)*Math.PI/180,this.startAngleRad=(t.startAngle-90)*Math.PI/180,this.endAngleRad=(a(t.endAngle,t.startAngle+360)-90)*Math.PI/180,this.offset=e.offset||0,this.isCircular=d)}),c(d,"autoLabelAlign",function(e){if(!this.isRadial)return e.apply(this,[].slice.call(arguments,1))}),c(e,"getPosition",function(e,t,n,r,i){var s=this.axis;return s.getPosition?s.getPosition(n):e.call(this,t,n,r,i)}),c(e,"getLabelPosition",function(e,t,n,r,i,s,o,u,f){var l=this.axis,c=s.y,h=20,p=s.align,d=(l.translate(this.pos)+l.startAngleRad+Math.PI/2)/Math.PI*180%360;return l.isRadial?(e=l.getPosition(this.pos,l.center[2]/2+a(s.distance,-25)),"auto"===s.rotation?r.attr({rotation:d}):null===c&&(c=l.chart.renderer.fontMetrics(r.styles.fontSize).b-r.getBBox().height/2),null===p&&(l.isCircular?(this.label.getBBox().width>l.len*l.tickInterval/(l.max-l.min)&&(h=0),p=d>h&&d<180-h?"left":d>180+h&&d<360-h?"right":"center"):p="center",r.attr({align:p})),e.x+=s.x,e.y+=c):e=e.call(this,t,n,r,i,s,o,u,f),e}),c(e,"getMarkPath",function(e,t,n,r,i,s,o){var u=this.axis;return u.isRadial?(e=u.getPosition(this.pos,u.center[2]/2+r),t=["M",t,n,"L",e.x,e.y]):t=e.call(this,t,n,r,i,s,o),t})}(e),function(e){var t=e.each,n=e.noop,r=e.pick,i=e.Series,s=e.seriesType,o=e.seriesTypes;s("arearange","area",{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">â—</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}},{pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(e){return[e.low,e.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(e){var t=this.chart,n=this.xAxis.postTranslate(e.rectPlotX,this.yAxis.len-e.plotHigh);e.plotHighX=n.x-t.plotLeft,e.plotHigh=n.y-t.plotTop},translate:function(){var e=this,n=e.yAxis;o.area.prototype.translate.apply(e),t(e.points,function(e){var t=e.low,r=e.high,i=e.plotY;null===r||null===t?e.isNull=!0:(e.plotLow=i,e.plotHigh=n.translate(r,0,1,0,1))}),this.chart.polar&&t(this.points,function(t){e.highToXY(t)})},getGraphPath:function(e){var t=[],n=[],i,s=o.area.prototype.getGraphPath,a,f,l;l=this.options;var c=l.step;e=e||this.points;for(i=e.length;i--;)a=e[i],a.isNull||l.connectEnds||e[i+1]&&!e[i+1].isNull||n.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1}),f={polarPlotY:a.polarPlotY,rectPlotX:a.rectPlotX,yBottom:a.yBottom,plotX:r(a.plotHighX,a.plotX),plotY:a.plotHigh,isNull:a.isNull},n.push(f),t.push(f),a.isNull||l.connectEnds||e[i-1]&&!e[i-1].isNull||n.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1});return e=s.call(this,e),c&&(!0===c&&(c="left"),l.step={left:"right",center:"center",right:"left"}[c]),t=s.call(this,t),n=s.call(this,n),l.step=c,l=[].concat(e,t),this.chart.polar||"M"!==n[0]||(n[0]="L"),this.graphPath=l,this.areaPath=this.areaPath.concat(e,n),l.isArea=!0,l.xMap=e.xMap,this.areaPath.xMap=e.xMap,l},drawDataLabels:function(){var e=this.data,t=e.length,n,r=[],s=i.prototype,o=this.options.dataLabels,u=o.align,a=o.verticalAlign,f=o.inside,c,h,p=this.chart.inverted;if(o.enabled||this._hasPointLabels){for(n=t;n--;)if(c=e[n])h=f?c.plotHigh<c.plotLow:c.plotHigh>c.plotLow,c.y=c.high,c._plotY=c.plotY,c.plotY=c.plotHigh,r[n]=c.dataLabel,c.dataLabel=c.dataLabelUpper,c.below=h,p?u||(o.align=h?"right":"left"):a||(o.verticalAlign=h?"top":"bottom"),o.x=o.xHigh,o.y=o.yHigh;s.drawDataLabels&&s.drawDataLabels.apply(this,arguments);for(n=t;n--;)if(c=e[n])h=f?c.plotHigh<c.plotLow:c.plotHigh>c.plotLow,c.dataLabelUpper=c.dataLabel,c.dataLabel=r[n],c.y=c.low,c.plotY=c._plotY,c.below=!h,p?u||(o.align=h?"left":"right"):a||(o.verticalAlign=h?"bottom":"top"),o.x=o.xLow,o.y=o.yLow;s.drawDataLabels&&s.drawDataLabels.apply(this,arguments)}o.align=u,o.verticalAlign=a},alignDataLabel:function(){o.column.prototype.alignDataLabel.apply(this,arguments)},setStackedPoints:n,getSymbol:n,drawPoints:n})}(e),function(e){var t=e.seriesType;t("areasplinerange","arearange",null,{getPointSpline:e.seriesTypes.spline.prototype.getPointSpline})}(e),function(e){var t=e.defaultPlotOptions,n=e.each,r=e.merge,i=e.noop,s=e.pick,o=e.seriesType,u=e.seriesTypes.column.prototype;o("columnrange","arearange",r(t.column,t.arearange,{lineWidth:1,pointRange:null}),{translate:function(){var e=this,t=e.yAxis,r=e.xAxis,i=r.startAngleRad,o,a=e.chart,f=e.xAxis.isRadial,l;u.translate.apply(e),n(e.points,function(n){var u=n.shapeArgs,m=e.options.minPointLength,g,y;n.plotHigh=l=t.translate(n.high,0,1,0,1),n.plotLow=n.plotY,y=l,g=s(n.rectPlotY,n.plotY)-l,Math.abs(g)<m?(m-=g,g+=m,y-=m/2):0>g&&(g*=-1,y-=g),f?(o=n.barX+i,n.shapeType="path",n.shapeArgs={d:e.polarArc(y+g,y,o,o+n.pointWidth)}):(u.height=g,u.y=y,n.tooltipPos=a.inverted?[t.len+t.pos-a.plotLeft-y-g/2,r.len+r.pos-a.plotTop-u.x-u.width/2,g]:[r.left-a.plotLeft+u.x+u.width/2,t.pos-a.plotTop+y+g/2,g])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:i,crispCol:u.crispCol,drawPoints:u.drawPoints,drawTracker:u.drawTracker,getColumnMetrics:u.getColumnMetrics,animate:function(){return u.animate.apply(this,arguments)},polarArc:function(){return u.polarArc.apply(this,arguments)},pointAttribs:u.pointAttribs})}(e),function(e){var t=e.each,n=e.isNumber,r=e.merge,i=e.pick,s=e.pInt,o=e.Series,u=e.seriesType,a=e.TrackerMixin;u("gauge","line",{dataLabels:{enabled:!0,defer:!1,y:15,borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2,borderWidth:1,borderColor:"#cccccc"},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:e.noop,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var e=this.yAxis,o=this.options,u=e.center;this.generatePoints(),t(this.points,function(t){var a=r(o.dial,t.dial),f=s(i(a.radius,80))*u[2]/200,c=s(i(a.baseLength,70))*f/100,h=s(i(a.rearLength,10))*f/100,d=a.baseWidth||3,v=a.topWidth||1,m=o.overshoot,y=e.startAngleRad+e.translate(t.y,null,null,null,!0);n(m)?(m=m/180*Math.PI,y=Math.max(e.startAngleRad-m,Math.min(e.endAngleRad+m,y))):!1===o.wrap&&(y=Math.max(e.startAngleRad,Math.min(e.endAngleRad,y))),y=180*y/Math.PI,t.shapeType="path",t.shapeArgs={d:a.path||["M",-h,-d/2,"L",c,-d/2,f,-v/2,f,v/2,c,d/2,-h,d/2,"z"],translateX:u[0],translateY:u[1],rotation:y},t.plotX=u[0],t.plotY=u[1]})},drawPoints:function(){var e=this,n=e.yAxis.center,s=e.pivot,o=e.options,u=o.pivot,a=e.chart.renderer;t(e.points,function(t){var n=t.graphic,i=t.shapeArgs,s=i.d,u=r(o.dial,t.dial);n?(n.animate(i),i.d=s):(t.graphic=a[t.shapeType](i).attr({rotation:i.rotation,zIndex:1}).addClass("highcharts-dial").add(e.group),t.graphic.attr({stroke:u.borderColor||"none","stroke-width":u.borderWidth||0,fill:u.backgroundColor||"#000000"}))}),s?s.animate({translateX:n[0],translateY:n[1]}):(e.pivot=a.circle(0,0,i(u.radius,5)).attr({zIndex:2}).addClass("highcharts-pivot").translate(n[0],n[1]).add(e.group),e.pivot.attr({"stroke-width":u.borderWidth||0,stroke:u.borderColor||"#cccccc",fill:u.backgroundColor||"#000000"}))},animate:function(e){var n=this;e||(t(n.points,function(e){var t=e.graphic;t&&(t.attr({rotation:180*n.yAxis.startAngleRad/Math.PI}),t.animate({rotation:e.shapeArgs.rotation},n.options.animation))}),n.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup),o.prototype.render.call(this),this.group.clip(this.chart.clipRect)},setData:function(e,t){o.prototype.setData.call(this,e,!1),this.processData(),this.generatePoints(),i(t,!0)&&this.chart.redraw()},drawTracker:a&&a.drawTrackerPoint},{setState:function(e){this.state=e}})}(e),function(e){var t=e.each,n=e.noop,r=e.pick,i=e.seriesType,s=e.seriesTypes;i("boxplot","column",{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">â—</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,states:{hover:{brightness:-0.3}},whiskerWidth:2},{pointArrayMap:["low","q1","median","q3","high"],toYData:function(e){return[e.low,e.q1,e.median,e.q3,e.high]},pointValKey:"high",pointAttribs:function(e){var t=this.options;return e=e&&e.color||this.color,{fill:t.fillColor||e,stroke:t.lineColor||e,"stroke-width":t.lineWidth||0}},drawDataLabels:n,translate:function(){var e=this.yAxis,n=this.pointArrayMap;s.column.prototype.translate.apply(this),t(this.points,function(r){t(n,function(t){null!==r[t]&&(r[t+"Plot"]=e.translate(r[t],0,1,0,1))})})},drawPoints:function(){var e=this,n=e.options,i=e.chart.renderer,s,o,a,l,c,h,p=0,d,v,m,g,y=!1!==e.doQuartiles,b,w=e.options.whiskerLength;t(e.points,function(t){var f=t.graphic,E=f?"animate":"attr",S=t.shapeArgs,T={},N={},C={},L=t.color||e.color;void 0!==t.plotY&&(d=S.width,v=Math.floor(S.x),m=v+d,g=Math.round(d/2),s=Math.floor(y?t.q1Plot:t.lowPlot),o=Math.floor(y?t.q3Plot:t.lowPlot),a=Math.floor(t.highPlot),l=Math.floor(t.lowPlot),f||(t.graphic=f=i.g("point").add(e.group),t.stem=i.path().addClass("highcharts-boxplot-stem").add(f),w&&(t.whiskers=i.path().addClass("highcharts-boxplot-whisker").add(f)),y&&(t.box=i.path(void 0).addClass("highcharts-boxplot-box").add(f)),t.medianShape=i.path(void 0).addClass("highcharts-boxplot-median").add(f),T.stroke=t.stemColor||n.stemColor||L,T["stroke-width"]=r(t.stemWidth,n.stemWidth,n.lineWidth),T.dashstyle=t.stemDashStyle||n.stemDashStyle,t.stem.attr(T),w&&(N.stroke=t.whiskerColor||n.whiskerColor||L,N["stroke-width"]=r(t.whiskerWidth,n.whiskerWidth,n.lineWidth),t.whiskers.attr(N)),y&&(f=e.pointAttribs(t),t.box.attr(f)),C.stroke=t.medianColor||n.medianColor||L,C["stroke-width"]=r(t.medianWidth,n.medianWidth,n.lineWidth),t.medianShape.attr(C)),h=t.stem.strokeWidth()%2/2,p=v+g+h,t.stem[E]({d:["M",p,o,"L",p,a,"M",p,s,"L",p,l]}),y&&(h=t.box.strokeWidth()%2/2,s=Math.floor(s)+h,o=Math.floor(o)+h,v+=h,m+=h,t.box[E]({d:["M",v,o,"L",v,s,"L",m,s,"L",m,o,"L",v,o,"z"]})),w&&(h=t.whiskers.strokeWidth()%2/2,a+=h,l+=h,b=/%$/.test(w)?g*parseFloat(w)/100:w/2,t.whiskers[E]({d:["M",p-b,a,"L",p+b,a,"M",p-b,l,"L",p+b,l]})),c=Math.round(t.medianPlot),h=t.medianShape.strokeWidth()%2/2,c+=h,t.medianShape[E]({d:["M",v,c,"L",m,c]}))})},setStackedPoints:n})}(e),function(e){var t=e.each,n=e.noop,r=e.seriesType,i=e.seriesTypes;r("errorbar","boxplot",{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">â—</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null},{type:"errorbar",pointArrayMap:["low","high"],toYData:function(e){return[e.low,e.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:i.arearange?function(){var e=this.pointValKey;i.arearange.prototype.drawDataLabels.call(this),t(this.data,function(t){t.y=t[e]})}:n,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||i.column.prototype.getColumnMetrics.call(this)}})}(e),function(e){var t=e.correctFloat,n=e.isNumber,r=e.pick,i=e.Point,s=e.Series,o=e.seriesType,u=e.seriesTypes;o("waterfall","column",{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}},{pointValKey:"y",translate:function(){var e=this.options,n=this.yAxis,i,s,o,a,l,c,h,p,d,v=r(e.minPointLength,5),m=e.threshold,g=e.stacking;u.column.prototype.translate.apply(this),this.minPointLengthOffset=0,h=p=m,s=this.points,i=0;for(e=s.length;i<e;i++)o=s[i],c=this.processedYData[i],a=o.shapeArgs,d=(l=g&&n.stacks[(this.negStacks&&c<m?"-":"")+this.stackKey])?l[o.x].points[this.index+","+i]:[0,c],o.isSum?o.y=t(c):o.isIntermediateSum&&(o.y=t(c-p)),l=Math.max(h,h+o.y)+d[0],a.y=n.toPixels(l,!0),o.isSum?(a.y=n.toPixels(d[1],!0),a.height=Math.min(n.toPixels(d[0],!0),n.len)-a.y+this.minPointLengthOffset):o.isIntermediateSum?(a.y=n.toPixels(d[1],!0),a.height=Math.min(n.toPixels(p,!0),n.len)-a.y+this.minPointLengthOffset,p=d[1]):(a.height=0<c?n.toPixels(h,!0)-a.y:n.toPixels(h,!0)-n.toPixels(h-c,!0),h+=c),0>a.height&&(a.y+=a.height,a.height*=-1),o.plotY=a.y=Math.round(a.y)-this.borderWidth%2/2,a.height=Math.max(Math.round(a.height),.001),o.yBottom=a.y+a.height,a.height<=v&&(a.height=v,this.minPointLengthOffset+=v),a.y-=this.minPointLengthOffset,a=o.plotY+(o.negative?a.height:0)-this.minPointLengthOffset,this.chart.inverted?o.tooltipPos[0]=n.len-a:o.tooltipPos[1]=a},processData:function(e){var n=this.yData,r=this.options.data,i,o=n.length,u,a,l,c,h,d;a=u=l=c=this.options.threshold||0;for(d=0;d<o;d++)h=n[d],i=r&&r[d]?r[d]:{},"sum"===h||i.isSum?n[d]=t(a):"intermediateSum"===h||i.isIntermediateSum?n[d]=t(u):(a+=h,u+=h),l=Math.min(a,l),c=Math.max(a,c);s.prototype.processData.call(this,e),this.dataMin=l,this.dataMax=c},toYData:function(e){return e.isSum?0===e.x?null:"sum":e.isIntermediateSum?0===e.x?null:"intermediateSum":e.y},pointAttribs:function(e,t){var n=this.options.upColor;return n&&!e.options.color&&(e.color=0<e.y?n:null),n=u.column.prototype.pointAttribs.call(this,e,t),delete n.dashstyle,n},getGraphPath:function(){return["M",0,0]},getCrispPath:function(){var e=this.data,t=e.length,n=this.graph.strokeWidth()+this.borderWidth,n=Math.round(n)%2/2,r=[],i,s,o;for(o=1;o<t;o++)s=e[o].shapeArgs,i=e[o-1].shapeArgs,s=["M",i.x+i.width,i.y+n,"L",s.x,i.y+n],0>e[o-1].y&&(s[2]+=i.height,s[5]+=i.height),r=r.concat(s);return r},drawGraph:function(){s.prototype.drawGraph.call(this),this.graph.attr({d:this.getCrispPath()})},getExtremes:e.noop},{getClassName:function(){var e=i.prototype.getClassName.call(this);return this.isSum?e+=" highcharts-sum":this.isIntermediateSum&&(e+=" highcharts-intermediate-sum"),e},isValid:function(){return n(this.y,!0)||this.isSum||this.isIntermediateSum}})}(e),function(e){var t=e.Series,n=e.seriesType,r=e.seriesTypes;n("polygon","scatter",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0},{type:"polygon",getGraphPath:function(){for(var e=t.prototype.getGraphPath.call(this),n=e.length+1;n--;)(n===e.length||"M"===e[n])&&0<n&&e.splice(n,0,"z");return this.areaPath=e},drawGraph:function(){this.options.fillColor=this.color,r.area.prototype.drawGraph.call(this)},drawLegendSymbol:e.LegendSymbolMixin.drawRectangle,drawTracker:t.prototype.drawTracker,setStackedPoints:e.noop})}(e),function(e){var t=e.arrayMax,n=e.arrayMin,r=e.Axis,i=e.color,s=e.each,o=e.isNumber,u=e.noop,a=e.pick,f=e.pInt,l=e.Point,c=e.Series,h=e.seriesType,p=e.seriesTypes;h("bubble","scatter",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1,radius:null,states:{hover:{radiusPlus:0}}},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,zoneAxis:"z",pointAttribs:function(e,t){var n=a(this.options.marker.fillOpacity,.5),r=c.prototype.pointAttribs.call(this,e,t);return 1!==n&&(r.fill=i(r.fill).setOpacity(n).get("rgba")),r},getRadii:function(e,t,n,r){var i,s,o,u=this.zData,a=[],f=this.options,l="width"!==f.sizeBy,c=f.zThreshold,h=t-e;s=0;for(i=u.length;s<i;s++)o=u[s],f.sizeByAbsoluteValue&&null!==o&&(o=Math.abs(o-c),t=Math.max(t-c,Math.abs(e-c)),e=0),null===o?o=null:o<e?o=n/2-1:(o=0<h?(o-e)/h:.5,l&&0<=o&&(o=Math.sqrt(o)),o=Math.ceil(n+o*(r-n))/2),a.push(o);this.radii=a},animate:function(e){var t=this.options.animation;e||(s(this.points,function(e){var n=e.graphic;e=e.shapeArgs,n&&e&&(n.attr("r",1),n.animate({r:e.r},t))}),this.animate=null)},translate:function(){var e,t=this.data,n,r,i=this.radii;p.scatter.prototype.translate.call(this);for(e=t.length;e--;)n=t[e],r=i?i[e]:0,o(r)&&r>=this.minPxSize/2?(n.shapeType="circle",n.shapeArgs={x:n.plotX,y:n.plotY,r:r},n.dlBox={x:n.plotX-r,y:n.plotY-r,width:2*r,height:2*r}):n.shapeArgs=n.plotY=n.dlBox=void 0},drawLegendSymbol:function(e,t){var n=this.chart.renderer,r=n.fontMetrics(e.itemStyle.fontSize).f/2;t.legendSymbol=n.circle(r,e.baseline-r,r).attr({zIndex:3}).add(t.legendGroup),t.legendSymbol.isMarker=!0},drawPoints:p.column.prototype.drawPoints,alignDataLabel:p.column.prototype.alignDataLabel,buildKDTree:u,applyZones:u},{haloPath:function(){return l.prototype.haloPath.call(this,this.shapeArgs.r+this.series.options.states.hover.halo.size)},ttBelow:!1}),r.prototype.beforePadding=function(){var e=this,r=this.len,i=this.chart,u=0,l=r,c=this.isXAxis,h=c?"xData":"yData",p=this.min,v={},m=Math.min(i.plotWidth,i.plotHeight),y=Number.MAX_VALUE,b=-Number.MAX_VALUE,w=this.max-p,E=r/w,S=[];s(this.series,function(r){var o=r.options;!r.bubblePadding||!r.visible&&i.options.chart.ignoreHiddenSeries||(e.allowZoomOutside=!0,S.push(r),c&&(s(["minSize","maxSize"],function(e){var t=o[e],n=/%$/.test(t),t=f(t);v[e]=n?m*t/100:t}),r.minPxSize=v.minSize,r.maxPxSize=v.maxSize,r=r.zData,r.length&&(y=a(o.zMin,Math.min(y,Math.max(n(r),!1===o.displayNegative?o.zThreshold:-Number.MAX_VALUE))),b=a(o.zMax,Math.max(b,t(r))))))}),s(S,function(t){var n=t[h],r=n.length,i;c&&t.getRadii(y,b,t.minPxSize,t.maxPxSize);if(0<w)for(;r--;)o(n[r])&&e.dataMin<=n[r]&&n[r]<=e.dataMax&&(i=t.radii[r],u=Math.min((n[r]-p)*E-i,u),l=Math.max((n[r]-p)*E+i,l))}),S.length&&0<w&&!this.isLog&&(l-=r,E*=(r+u-l)/r,s([["min","userMin",u],["max","userMax",l]],function(t){void 0===a(e.options[t[0]],e[t[1]])&&(e[t[0]]+=t[2]/E)}))}}(e),function(e){function t(e,t){var n=this.chart,r=this.options.animation,i=this.group,s=this.markerGroup,o=this.xAxis.center,u=n.plotLeft,a=n.plotTop;n.polar?n.renderer.isSVG&&(!0===r&&(r={}),t?(n={translateX:o[0]+u,translateY:o[1]+a,scaleX:.001,scaleY:.001},i.attr(n),s&&s.attr(n)):(n={translateX:u,translateY:a,scaleX:1,scaleY:1},i.animate(n,r),s&&s.animate(n,r),this.animate=null)):e.call(this,t)}var n=e.each,r=e.pick,i=e.seriesTypes,s=e.wrap,o=e.Series.prototype;e=e.Pointer.prototype,o.searchPointByAngle=function(e){var t=this.chart,n=this.xAxis.pane.center;return this.searchKDTree({clientX:180+ -180/Math.PI*Math.atan2(e.chartX-n[0]-t.plotLeft,e.chartY-n[1]-t.plotTop)})},s(o,"buildKDTree",function(e){this.chart.polar&&(this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.kdDimensions=2),e.apply(this)}),o.toXY=function(e){var t,n=this.chart,r=e.plotX;t=e.plotY,e.rectPlotX=r,e.rectPlotY=t,t=this.xAxis.postTranslate(e.plotX,this.yAxis.len-t),e.plotX=e.polarPlotX=t.x-n.plotLeft,e.plotY=e.polarPlotY=t.y-n.plotTop,this.kdByAngle?(n=(r/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>n&&(n+=360),e.clientX=n):e.clientX=e.plotX},i.spline&&s(i.spline.prototype,"getPointSpline",function(e,t,n,r){var i,s,o,u,a,f,l;return this.chart.polar?(i=n.plotX,s=n.plotY,e=t[r-1],o=t[r+1],this.connectEnds&&(e||(e=t[t.length-2]),o||(o=t[1])),e&&o&&(u=e.plotX,a=e.plotY,t=o.plotX,f=o.plotY,u=(1.5*i+u)/2.5,a=(1.5*s+a)/2.5,o=(1.5*i+t)/2.5,l=(1.5*s+f)/2.5,t=Math.sqrt(Math.pow(u-i,2)+Math.pow(a-s,2)),f=Math.sqrt(Math.pow(o-i,2)+Math.pow(l-s,2)),u=Math.atan2(a-s,u-i),a=Math.atan2(l-s,o-i),l=Math.PI/2+(u+a)/2,Math.abs(u-l)>Math.PI/2&&(l-=Math.PI),u=i+Math.cos(l)*t,a=s+Math.sin(l)*t,o=i+Math.cos(Math.PI+l)*f,l=s+Math.sin(Math.PI+l)*f,n.rightContX=o,n.rightContY=l),r?(n=["C",e.rightContX||e.plotX,e.rightContY||e.plotY,u||i,a||s,i,s],e.rightContX=e.rightContY=null):n=["M",i,s]):n=e.call(this,t,n,r),n}),s(o,"translate",function(e){var t=this.chart;e.call(this);if(t.polar&&(this.kdByAngle=t.tooltip&&t.tooltip.shared,!this.preventPostTranslate))for(e=this.points,t=e.length;t--;)this.toXY(e[t])}),s(o,"getGraphPath",function(e,t){var r=this,i,s;if(this.chart.polar){t=t||this.points;for(i=0;i<t.length;i++)if(!t[i].isNull){s=i;break}!1!==this.options.connectEnds&&void 0!==s&&(this.connectEnds=!0,t.splice(t.length,0,t[s])),n(t,function(e){void 0===e.polarPlotY&&r.toXY(e)})}return e.apply(this,[].slice.call(arguments,1))}),s(o,"animate",t),i.column&&(i=i.column.prototype,i.polarArc=function(e,t,n,i){var s=this.xAxis.center,o=this.yAxis.len;return this.chart.renderer.symbols.arc(s[0],s[1],o-t,null,{start:n,end:i,innerR:o-r(e,o)})},s(i,"animate",t),s(i,"translate",function(e){var t=this.xAxis,n=t.startAngleRad,r,i,s;this.preventPostTranslate=!0,e.call(this);if(t.isRadial)for(r=this.points,s=r.length;s--;)i=r[s],e=i.barX+n,i.shapeType="path",i.shapeArgs={d:this.polarArc(i.yBottom,i.plotY,e,e+i.pointWidth)},this.toXY(i),i.tooltipPos=[i.plotX,i.plotY],i.ttBelow=i.plotY>t.center[1]}),s(i,"alignDataLabel",function(e,t,n,r,i,s){this.chart.polar?(e=t.rectPlotX/Math.PI*180,null===r.align&&(r.align=20<e&&160>e?"left":200<e&&340>e?"right":"center"),null===r.verticalAlign&&(r.verticalAlign=45>e||315<e?"bottom":135<e&&225>e?"top":"middle"),o.alignDataLabel.call(this,t,n,r,i,s)):e.call(this,t,n,r,i,s)})),s(e,"getCoordinates",function(e,t){var r=this.chart,i={xAxis:[],yAxis:[]};return r.polar?n(r.axes,function(e){var n=e.isXAxis,s=e.center,o=t.chartX-s[0]-r.plotLeft,s=t.chartY-s[1]-r.plotTop;i[n?"xAxis":"yAxis"].push({axis:e,value:e.translate(n?Math.PI-Math.atan2(o,s):Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),!0)})}):i=e.call(this,t),i})}(e)}),define("highchartsmore",["highcharts"],function(){}),define("views/main/MainContainer/MainContainerView",["require","underscore","backbone","localizer","personalizer","collections/dashboard/WidgetDefinitions","collections/connections/ViewerUserConnections","collections/activity/TimeZones","models/user/UserPreference","models/user/UserPreferences","models/system/ServiceHost","models/user/ViewerSocialProfile","models/user/ViewerUserBiometrics","utils/ModelSynchronizer","models/user/ViewerUserPreferences","models/system/SystemPreferences","utils/extensions/Loadable","utils/sync/LocalCache","views/main/BetaTestersSurveyBanner","utils/tour/TourController","utils/tour/tours/WhatsNewUserTour","views/main/MainContainer/MainSidebarView","views/main/MainContainer/TopHeaderBarView","views/main/MainContainer/WidgetListNavView","views/main/react/ReactComponentView","garminhost","garminlib","navhelper","highchartsmore"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("collections/dashboard/WidgetDefinitions"),o=e("collections/connections/ViewerUserConnections"),u=e("collections/activity/TimeZones"),a=e("models/user/UserPreference"),f=e("models/user/UserPreferences"),l=e("models/system/ServiceHost"),c=e("models/user/ViewerSocialProfile"),h=e("models/user/ViewerUserBiometrics"),p=e("utils/ModelSynchronizer"),d=e("models/user/ViewerUserPreferences"),v=e("models/system/SystemPreferences"),m=e("utils/extensions/Loadable"),g=e("utils/sync/LocalCache"),y=e("views/main/BetaTestersSurveyBanner"),b=e("utils/tour/TourController"),w=e("utils/tour/tours/WhatsNewUserTour"),E=e("views/main/MainContainer/MainSidebarView"),S=e("views/main/MainContainer/TopHeaderBarView"),x=e("views/main/MainContainer/WidgetListNavView"),T=e("views/main/react/ReactComponentView"),N=e("garminhost"),C=e("garminlib"),k=e("navhelper"),L=e("highchartsmore");n.View=n.View.extend({getUrlVars:function(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,r){e[n]=r}),e}});var A=6e4,O={ON_ADD_WIDGET_CLICKED:"ON_ADD_WIDGET_CLICKED",ON_WIDGET_LIST_HIDDEN:x.Events.ON_WIDGET_LIST_HIDDEN,UNAUTHENTICATED_RENDER_COMPLETE:"UNAUTHENTICATED_RENDER_COMPLETE"},M=n.View.extend(m),_=M.extend({propertyFiles:["/main/js/properties/common/common","/main/js/properties/validation/validation","/main/js/properties/userprofile/userprofile","/main/js/properties/send_to_device/send_to_device","/main/js/properties/activity-sync/activity-sync","/main/js/properties/group/group","/main/js/properties/challengewidget/challengewidget","/main/js/properties/connections/connections","/main/js/properties/activity_types/activity_types","/main/js/properties/units/units","/main/js/properties/weightwidget/weightwidget","/main/js/properties/widgets/widgets","/main/js/properties/course/course","/main/js/properties/map/map","/main/js/properties/trophy_case/trophy_case","/main/js/properties/training_plans/training_plans","/main/js/properties/goals/goals","/main/js/properties/device/device","/main/js/properties/personal-record-api/personal-record-api","/main/js/properties/daily_summary/daily_summary","/main/js/properties/golf_main/golf_main","/main/js/properties/event_types/event_types","/main/js/properties/workout/workout","/main/js/properties/gear_tracking/gear_tracking","/properties/diving/diving","/main/js/properties/gear_tracking/gear_tracking","/main/js/properties/notification/notification"],events:{"click [id^=btnAddToDashboard-]":"onBtnAddWidgetToDashboard","click .connect-header-link":"onConnectHeaderClicked"},initialize:function(e){this.dashboards=e.dashboards,this.widgetDefinitions=new s([],{displayName:this.model.get("displayName")}),this.contextPath=e.contextPath,this.viewerIsAuthenticated=e.viewerIsAuthenticated,this.userProfile=e.userProfile,this.userPreferences=e.userPreferences,this.serviceHost=new l,this.menuItems=[],this.navCollapsedPref=new a({key:"MainNavigation.collapsed"}),this.leafletEnabledPref=new a({key:"Web.MapView.LeafletEnabled"}),e.viewerIsAuthenticated||(this.viewerIsAuthenticated=!1),this.contextPath||(this.contextPath="/"),t.each(e.propertyFiles,function(e){this.propertyFiles.push(e)},this);var n=this;window.garminEvent.on("api:locale-selector:select",function(e){e.originalEvent.preventDefault(),n.onLanguageSelected(e.locale)}),c.isOutdoorUser()&&(this.golfMeasurementSystem=new a({key:"golf.measurement.system"})),this.golfLeaderboardsPref=new a({key:"golf.liveleaderboards.enabled"})},onSessionReauthenticateStart:function(){this.showWaitCursor()},onSessionReathenticateFinish:function(){this.hideWaitCursor()},showWaitCursor:function(){jQuery("body").addClass("wait")},hideWaitCursor:function(){jQuery("body").removeClass("wait")},onLanguageSelected:function(e){f.writeLegacyLocaleCookie(e),f.updateLegacySessionLocale(e),window.location.reload()},provideDependencies:function(e){if(!this.viewerIsAuthenticated)return;e.addModel({model:u,required:!0,countError:!0}),e.addModel({model:this.widgetDefinitions,required:!0}),e.addEvent({model:r,event:r.Events.ON_LOCAL_LOADED,required:!0}),e.addModel({model:this.serviceHost,required:!0}),e.addModel({model:o,required:!0}),e.addModel({model:h,required:!0}),e.addModel({model:this.navCollapsedPref,required:!0}),e.addModel({model:this.leafletEnabledPref,required:!0}),e.addEvent({model:e,event:p.Events.ON_DOCUMENT_READY,required:!0}),c.isOutdoorUser()&&e.addModel({model:this.golfMeasurementSystem,required:!0}),e.addModel({model:this.golfLeaderboardsPref,required:!0})},loadDependencies:function(){r.setContextPath(this.contextPath),r.setLocale(this.model.getLocale())},onDependenciesLoaded:function(){c.isOutdoorUser()&&i.setGolfMeasurementSystem(this.golfMeasurementSystem.get("value")),v.leafletEnabled=this.leafletEnabledPref.get("value"),this.render()},render:function(){if(!this.viewerIsAuthenticated){this.trigger(O.UNAUTHENTICATED_RENDER_COMPLETE);return}c.hasUserExperience()&&this.renderBetaTestersSurveyBanner(),this.setupMenus(),this.setupReactModal(),$(".main-body").on("scroll.main",function(){$(".has-date-picker").datepicker("hide").blur().datepicker("widget").hide();var e=$(".has-time-picker");e.length>0&&e.timepicker("hide").blur()})},renderBetaTestersSurveyBanner:function(){this.betaTestersSurveyBanner||(this.betaTestersSurveyBanner=new y({el:jQuery(".beta-testers-survey-banner")}),this.betaTestersSurveyBanner.load())},onBtnAddWidgetToDashboard:function(e){this.trigger(O.ON_ADD_WIDGET_CLICKED,e)},onConnectHeaderClicked:function(e){this.viewerIsAuthenticated&&(e.preventDefault(),n.history.navigate("/",{trigger:!0}))},setupMenus:function(){jQuery(".no-script").removeClass("no-script"),jQuery('a[href="#"]').click(function(e){e.preventDefault()}),this.menusSetup?console.log("SetupMenus: Menu has already been setup."):(this.menusSetup=!0,this.renderSidebar(),this.renderHeaderBar(),this.renderWidgetsNav())},renderSidebar:function(){if(!this.sidebar){var e={};e[this.golfLeaderboardsPref.get("key")]=this.golfLeaderboardsPref.get("value"),this.sidebar=new E({el:jQuery(".main-nav"),dashboards:this.dashboards,serviceHost:this.serviceHost.get("value"),navCollapsedPref:this.navCollapsedPref,preferences:e})}this.navCollapsedPref.get("value")==="true"&&!$("body").hasClass("mobile")&&$("body").addClass("minimize-main-nav"),this.sidebar.render(),this.sidebar.$el.removeClass("hide")},renderHeaderBar:function(){this.topHeader=new S({el:jQuery(".main-body .header"),pollRate:A,userProfile:this.userProfile,userPreferences:this.userPreferences}),this.listenTo(this.topHeader,E.Events.EXPAND_COLLAPSE,function(){this.sidebar.expandCollapse(),this.sidebar.$el.trigger("MAIN_NAV_EXPAND_COLLAPSE")}),this.topHeader.render(),this.topHeader.$el.removeClass("hide")},renderWidgetsNav:function(){this.widgetNav=new x({widgetDefinitions:this.widgetDefinitions,displayName:this.model.get("displayName")}),this.listenTo(this.widgetNav,x.Events.ON_ADD_WIDGET_CLICKED,this.onBtnAddWidgetToDashboard),this.listenTo(this.widgetNav,x.Events.ON_WIDGET_LIST_HIDDEN,function(){this.trigger(O.ON_WIDGET_LIST_HIDDEN)}),this.widgetNav.load(),this.sidebar.$el.after(this.widgetNav.el)},highlightDashboard:function(e){this.sidebar.highlightDashboard(e)},setupReactModal:function(){this.modal=new T,this.modal.renderComponent(window.GlobalModal,jQuery(".react-global-modal")[0])}});return _.Events=O,_.QUEUE_POLL_RATE=A,_}),define("utils/Logger",[],function(){var e={logText:function(e){console.log(e)},logErr:function(e){console.log(e.name+": "+e.message)}};return e}),define("text!templates/main/Widget/WidgetSheet.html",[],function(){return'<div class="widget-sheet-header clearfix">\n    <button class="widget-sheet-close close close-js"><i class="icon-arrow-down"></i></button>\n</div>\n\n<div class="widget-sheet-content">\n\n</div>\n\n\n'}),define("views/main/Widget/WidgetSheet",["underscore","backbone","localizer","text!templates/main/Widget/WidgetSheet.html"],function(e,t,n,r){var i={CLOSE:"CLOSE"},s=t.View.extend({sheetTemplate:e.template(r),events:{"click .close":"onSheetClosedClicked"},initialize:function(e){if(!e.view)throw"view is required for WidgetSheet";if(typeof e.customClasses=="undefined")throw"customClasses is required for WidgetSheet";this.sheetTitle=e.sheetTitle,this.customClasses=e.customClasses,this.view=e.view,this.view.once("ON_VIEW_CLOSED",this.onUserClosedSheet,this)},render:function(){var e=this.sheetTemplate({sheetTitle:this.sheetTitle});this.$el.addClass(this.customClasses),this.$el.addClass("widget-sheet"),this.$el.html(e),this.$(".widget-sheet-content").append(this.view.$el),this.view.render(),this.$el.slideToggle("500","easeOutCubic")},close:function(){this.view.onViewClosed&&this.view.onViewClosed();var e=this;this.$el.slideToggle("500","easeOutCubic",function(){e.view.remove(),e.view=null,e.remove()}),this.trigger(i.CLOSE)},onUserClosedSheet:function(){this.close()},onSheetClosedClicked:function(){this.close()}});return s.Events=i,s}),define("text!templates/main/Widget/WidgetTakeover.html",[],function(){return'<button type="button" class="widget-takeover-close close" data-dismiss="alert">Ã—</button>\n<div class="widget-takeover-content">\n\n</div>\n\n\n\n'}),define("views/main/Widget/WidgetTakeover",["underscore","backbone","localizer","text!templates/main/Widget/WidgetTakeover.html"],function(e,t,n,r){var i={CLOSE:"CLOSE"},s=t.View.extend({sheetTemplate:e.template(r),events:{"click .close":"onTakeoverClosedClicked"},initialize:function(e){if(!e.view)throw"view is required for WidgetTakeover";this.customClasses=e.customClasses,this.view=e.view,this.view.once("ON_VIEW_CLOSED",this.onUserClosedTakeover,this)},render:function(){var e=this.sheetTemplate({sheetTitle:this.sheetTitle});this.$el.addClass("widget-takeover fade in"),this.$el.addClass(this.customClasses),this.$el.html(e),this.$(".widget-takeover-content").append(this.view.$el),this.view.render()},close:function(){this.view.onViewClosed&&this.view.onViewClosed(),this.trigger(i.CLOSE)},onUserClosedTakeover:function(){this.close()},onTakeoverClosedClicked:function(){this.close()}});return s.Events=i,s}),define("models/conversations/Like",["backbone"],function(e){var t=e.Model.extend({urlRoot:function(){return"/proxy/conversation-service/conversation/like/"+this.conversationUuid},idAttribute:"conversationLikePk",initialize:function(e){this.conversationUuid=e.conversationUuid}});return t}),define("models/conversations/CommentLike",["backbone"],function(e){var t=e.Model.extend({urlRoot:function(){return"/proxy/conversation-service/conversation/comment/like/"+this.conversationCommentUuid},idAttribute:"conversationCommentLikePk",initialize:function(e){this.conversationCommentUuid=e.conversationCommentUuid}});return t}),define("views/conversations/LikeToolTipView",["localizer","models/user/ViewerSocialProfile","views/utils/ToolTipView"],function(e,t,n){var r=n.extend({namesToDisplay:8,initialize:function(e){this.likesFetched=!1,n.prototype.initialize.apply(this,arguments),this.collection.bind("sync",this.onLikesFetched,this)},show:function(){this.likesFetched?n.prototype.show.apply(this,arguments):this.collection.fetch()},onLikesFetched:function(){this.content=this.formatLikes(this.collection),this.render(),this.likesFetched=!0,this.show()},createLikeDisplayValue:function(e){var n=e.get("displayName");return e.get("displayName")==t.get("displayName")?n=t.get("fullName")||t.get("displayName"):n=e.get("fullName")||e.get("displayName"),_.escape(n)},formatLikes:function(t){if(t.length===0)return"";var n='<i class="icon-heart"></i> ';n+=t.length===1?e.localize("x_likes_this",this.createLikeDisplayValue(t.at(0))):e.localize("x_many_like_this",t.length);var r=this;return t.length>1&&_.each(t.models,function(i,s){s<r.namesToDisplay-1?n+="<br/>"+r.createLikeDisplayValue(t.at(s)):s===r.namesToDisplay-1&&(t.length===r.namesToDisplay&&(n+="<br/>"+r.createLikeDisplayValue(t.at(s))),t.length>r.namesToDisplay&&(n+="<br/>"+e.localize("and_x_others",t.length-r.namesToDisplay+1)))}),n}});return r}),define("collections/conversations/CommentLikes",["backbone","models/conversations/CommentLike"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return"/proxy/conversation-service/conversation/comment/likes/"+this.conversationCommentUuid},initialize:function(e,t){this.conversationCommentUuid=t.conversationCommentUuid}});return n}),define("collections/conversations/Likes",["backbone","models/conversations/Like"],function(e,t){var n=e.Collection.extend({model:t,url:function(){return typeof this.userGroupPk=="undefined"||this.userGroupPk==null?"/proxy/conversation-service/conversation/likes/"+this.resourceType+"/"+this.resourceId:"/proxy/conversation-service/conversation/likes/"+this.userGroupPk+"/"+this.resourceType+"/"+this.resourceId},initialize:function(e,t){this.resourceType=t.resourceType,this.resourceId=t.resourceId,this.userGroupPk=t.userGroupPk}});return n}),define("models/conversations/Conversation",["backbone"],function(e){var t=e.Model.extend({model:this,defaults:{numberOfLikes:0,numberOfComments:0,likedByUser:!1},idAttribute:"conversationUuid",url:function(){return this.userGroupPk?"/proxy/conversation-service/conversation/"+this.userGroupPk+"/"+this.resourceType+"/"+this.resourceId:"/proxy/conversation-service/conversation/"+this.resourceType+"/"+this.resourceId},initialize:function(e){this.resourceType=e.resourceType,this.resourceId=e.resourceId,this.userGroupPk=e.userGroupPk}});return t}),define("text!templates/conversations/LikeView.html",[],function(){return'<span class="like">\r\n    <button class="like-link">   \r\n        <div class="like-icon animated <%= likedByUser ? \'tada\' : \'fadeIn\' %>">\r\n            <i class="has-tooltip <%= likedByUser ? "icon-heart" : "icon-heart-inverted" %>" title="<%= Localizer.localize(likedByUser ? "unlike" : "like") %>"></i>\r\n        </div>                 \r\n    </button>\r\n    <span class="like js-like-count" data-rel="tooltip" data-html="true" title="">\r\n        <%= numberOfLikes %>\r\n    </span>\r\n</span>'}),define("views/conversations/LikeView",["require","underscore","backbone","localizer","models/conversations/Like","models/conversations/CommentLike","views/conversations/LikeToolTipView","collections/conversations/CommentLikes","collections/conversations/Likes","models/conversations/Conversation","text!templates/conversations/LikeView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("models/conversations/Like"),s=e("models/conversations/CommentLike"),o=e("views/conversations/LikeToolTipView"),u=e("collections/conversations/CommentLikes"),a=e("collections/conversations/Likes"),f=e("models/conversations/Conversation"),l=e("text!templates/conversations/LikeView.html");return n.View.extend({template:t.template(l),events:{"click .like-link":"onClick"},initialize:function(e){this.liked=e.liked||!1,this.numberOfLikes=e.numberOfLikes||0,this.likedList=e.likedList,this.conversationUuid=e.conversationUuid,this.connections=e.connections,this.isComment=e.isComment,this.resourceType=e.resourceType,this.resourceId=e.resourceId,this.userGroupPk=e.userGroupPk,this.tooltipPlacement=e.tooltipPlacement},render:function(){var e=this.template({likedByUser:this.liked,Localizer:r,numberOfLikes:this.numberOfLikes});return this.$el.html(e),this.numberOfLikes>0&&this.createTooltipView(),this},createTooltipView:function(){this.likedList||(this.isComment?this.likedList=new u([],{conversationCommentUuid:this.conversationUuid}):this.likedList=new a([],{resourceType:this.resourceType,resourceId:this.resourceId,userGroupPk:this.userGroupPk})),this.likeToolTip=new o({el:this.$(".js-like-count"),collection:this.likedList,connections:this.connections,placement:this.tooltipPlacement})},startConversation:function(){delete this.conversation,this.conversation=new f({resourceType:this.resourceType,resourceId:this.resourceId,userGroupPk:this.userGroupPk}),this.conversation.save([],{success:t.bind(this.conversationStarted,this)})},onClick:function(e){e.preventDefault(),this.conversationUuid?this.likeUnlike():this.startConversation()},conversationStarted:function(){var e=this.conversation.get("conversationUuid");t.isUndefined(e)||(this.conversationUuid=e,this.likeUnlike())},likeUnlike:function(){var e,t=this.$(".like-link");if(t.attr("disabled")===!0)return;this.isComment?(e=new s({conversationCommentUuid:this.conversationUuid}),this.liked&&e.set("conversationCommentLikePk",0)):(e=new i({conversationUuid:this.conversationUuid}),this.liked&&e.set("conversationLikePk",0));var n=this;t.attr("disabled",!0),this.liked?e.destroy({success:function(){n.numberOfLikes--,n.liked=!n.liked,n.render(),t.attr("disabled",!1)},error:function(){t.attr("disabled",!1)}}):e.save([],{success:function(){n.numberOfLikes++,n.liked=!n.liked,n.render(),t.attr("disabled",!1)},error:function(){t.attr("disabled",!1)}})}})}),define("text!templates/sharing/SharingView.html",[],function(){return'<button class="dropdown-trigger" data-toggle="dropdown"><i class="icon-share" /> <%= sharingLabel %></button>\n<ul class="dropdown-menu <%= pullClass %> <%= directionClass %>">\n<% if (showIcon) {          %>\n    <li class="clearfix"><i class="icon-share pull-right"></i></li>\n<% }                        %>\n<% if (\'zh_CN\' == locale) { %>\n    <li><a class="addthis_button_baidu" data-social-platform="baidu"><%= Localizer.localize(\'share_baidu\') %></a></li>\n    <li><a class="addthis_button_sinaweibo" data-social-platform="sinaweibo"><%= Localizer.localize(\'share_sinaweibo\') %></a></li>\n    <li><a class="addthis_button_qzone" data-social-platform="qzone"><%= Localizer.localize(\'share_qzone\') %></a></li>\n    <li><a class="addthis_button_twitter" data-social-platform="twitter"><%= Localizer.localize(\'share_twitter\') %></a></li>\n    <li><a class="addthis_button_facebook" data-social-platform="facebook"><%= Localizer.localize(\'share_facebook\') %></a></li>\n    <li><a class="addthis_button_email" data-social-platform="email"><%= Localizer.localize(\'share_email\') %></a></li>\n    <li><a class="addthis_button_compact"><%= Localizer.localize(\'share_more\') %></a></li>\n<% } else { %>\n    <li><a class="addthis_button_facebook" data-social-platform="facebook"><%= Localizer.localize(\'share_facebook\') %></a></li>\n    <li><a class="addthis_button_twitter" data-social-platform="twitter"><%= Localizer.localize(\'share_twitter\') %></a></li>\n    <li><a class="addthis_button_email" data-social-platform="email"><%= Localizer.localize(\'share_email\') %></a></li>\n    <li><a class="addthis_button_expanded"><%= Localizer.localize(\'share_more\') %></a></li>\n<% } %>\n</ul>\n'}),define("views/sharing/SharingView",["require","underscore","backbone","localizer","text!templates/sharing/SharingView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("text!templates/sharing/SharingView.html"),s={SOCIAL_SHARE_CLICKED:"SOCIAL_SHARE_CLICKED"},o={Up:"up",Down:"down"},u={Right:"right",Left:"left"},a=n.View.extend({events:{"click [data-social-platform]":"onShareButtonClicked"},initialize:function(e){this.privacy=e.privacy,this.url=e.url,this.locale=e.locale,this.customClasses=e.customClasses,this.sharingLabel=e.sharingLabel||"",this.customClasses||(this.customClasses=""),this.slideDirection=e.slideDirection||o.Down,this.pullDirection=e.pullDirection||u.Right,this.template=t.template(i)},render:function(){var t=this.template({Localizer:r,privacy:this.privacy,url:this.url,locale:this.locale,customClasses:this.customClasses,directionClass:this.slideDirection==o.Up?"bottom-up":"",pullClass:this.pullDirection==u.Left?"pull-left":"pull-right",showIcon:this.slideDirection!=o.Up,sharingLabel:this.sharingLabel});this.$el.html(t),this.$el.addClass("dropdown share addthis_toolbox"),this.$el.addClass(this.customClasses),this.$el.attr("addthis:url",this.url);var n=this.$(".dropdown-trigger");n.attr("disabled","disabled"),n.addClass("disabled");var i=this;e(["addthis"],function(e){i.setPrivacy(i.privacy),e.init(),e.toolbox(".addthis_toolbox")})},setPrivacy:function(e){this.privacy=e;var t=this.$(".dropdown-trigger");e=="public"?(t.removeAttr("disabled"),t.removeClass("disabled")):(t.attr("disabled","disabled"),t.addClass("disabled"))},setUrl:function(e){this.url=e},onShareButtonClicked:function(e){this.trigger(s.SOCIAL_SHARE_CLICKED,e.target.dataset.socialPlatform)}});return a.SlideDirection=o,a.PullDirection=u,a.Events=s,a}),define("models/conversations/Comment",["backbone"],function(e){var t=e.Model.extend({urlRoot:function(){return"/proxy/conversation-service/conversation/comment/"+this.get("conversationUuid")+"/"+this.get("conversationCommentUuid")},idAttribute:"conversationCommentPk",initialize:function(e){}});return t}),define("collections/conversations/Comments",["backbone","models/conversations/Comment","collections/utils/PagedCollection"],function(e,t,n){var r=n.extend({model:t,comparator:"createDate",url:function(){return this.userGroupPk?"/proxy/conversation-service/conversation/comments/"+this.userGroupPk+"/"+this.resourceType+"/"+this.resourceId+"?start="+this.startIndex+"&limit="+this.limit:"/proxy/conversation-service/conversation/comments/"+this.resourceType+"/"+this.resourceId+"?start="+this.startIndex+"&limit="+this.limit},initialize:function(e,t){t.verb="GET",this.initializePagedCollection(t),this.resourceType=t.resourceType,this.resourceId=t.resourceId,this.userGroupPk=t.userGroupPk}});return r}),define("text!templates/conversations/WidgetCommentView.html",[],function(){return'<%\n    var commentPicUrl = comment.authorImageUrl || \'//static.garmincdn.com/apps/connect/image/profile-pic-default_60.gif\';\n    var likeTextKey = comment.likedByUser ? \'unlike\' : \'like\';\n%>\n\n<!--avatar-->\n<div class="object-img pull-left">\n    <a class="profile-link" href="/profile/<%= comment.authorDisplayName %>">\n        <img class="media-object avatar" data-src="holder.js/64x64" title="<%= comment.nameDisplayValue %>" alt="<%= comment.nameDisplayValue %>" src="<%= commentPicUrl %>">\n    </a>\n</div>\n\n<!--comment content-->\n<div class="media-body">\n\n    <p class="">\n        <% if (comment.authorPro) { %>\n            <!-- per UX, PRO is not translated -->\n            <span class="label-pro"><i class="icon-checkmark"></i>PRO</span>\n        <% } %>\n        <a class="colored profile-link" href="/profile/<%= comment.authorDisplayName %>"><%= comment.nameDisplayValue %></a>\n    </p>\n\n    <p class="comment-body-text"><%= comment.body %></p>\n\n    <!-- Delete Comment -->\n    <% if (comment.userProfilePk == viewerProfilePk || conversationOwnerPk == viewerProfilePk) { %>\n    <button class="delete delete-js" title="<%= Localizer.localize(\'button_delete\') %>">\n        <i class="icon-close"></i>\n    </button>\n    <% }                                                                                    %>\n\n    <div class="comment-actions">\n\n        <!--date stamp-->\n        <span class="date-stamp pull-left"><%= dayDisplay %></span>\n\n        <!--Likes-->\n        <span class="entry-like"></span>\n\n    </div>\n\n</div>\n<!--end comment content-->\n\n\n\n\n\n\n\n\n\n'}),define("views/conversations/WidgetCommentView",["underscore","backbone","localizer","utils/ModelSynchronizer","utils/date/DateUtil","views/conversations/LikeView","collections/connections/ViewerUserConnections","models/conversations/Comment","models/user/ViewerSocialProfile","models/user/ViewerUserPreferences","views/main/Modal/ModalConfirmationView","text!templates/conversations/WidgetCommentView.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={COMMENT_DELETED:"COMMENT_DELETED"},p=t.View.extend({events:{"click .like-link":"onLikeOrUnlikeCommentClicked","click .delete":"onDeleteCommentClicked","click .profile-link":"onProfileLinkClicked"},initialize:function(t){this.template=e.template(c),this.conversation=t.conversation,this.connection=t.connection;if(!this.conversation)throw"Conversation required in WidgetCommentView"},render:function(){var e=this.model.toJSON();e.nameDisplayValue=e.authorFullName?e.authorFullName:authorDisplayName,this.$el.addClass("media comment"),this.$el.html(this.template({comment:e,dayDisplay:i.howLongAgo(this.model.get("createDate")),Localizer:n,viewerProfilePk:a.get("profileId"),conversationOwnerPk:this.conversation.get("ownerProfilePk")})),this.likeView=new s({el:this.$(".entry-like"),conversationUuid:this.model.get("conversationCommentUuid"),liked:e.likedByUser,numberOfLikes:e.numberOfLikes,connections:this.connections,resourceType:"DAILY_SUMMARY",resourceId:this.model.get("uuid"),isComment:!0}),this.likeView.render()},onLikeOrUnlikeCommentClicked:function(e){e.preventDefault();var t=this.model.get("likedByUser");t?this.removeCommentLike():this.addCommentLike(),this.render()},removeCommentLike:function(){this.model.set("likedByUser",!1);var e=this.model.get("numberOfLikes");e--,this.model.set("numberOfLikes",e);var t=new CommentLike({conversationCommentUuid:this.model.get("conversationCommentUuid")});t.once("sync",this.deleteCommentLike,this),t.fetch()},deleteCommentLike:function(e){e.destroy()},addCommentLike:function(){this.model.set("likedByUser",!0);var e=this.model.get("numberOfLikes");e++,this.model.set("numberOfLikes",e);var t=new CommentLike({conversationCommentUuid:this.model.get("conversationCommentUuid"),displayName:f.get("displayName")});t.save()},onProfileLinkClicked:function(e){e.preventDefault(),t.history.navigate("/profile/"+this.model.get("authorDisplayName"),{trigger:!0})},onDeleteCommentClicked:function(e){e.preventDefault();var t=this,r=new l({modalTitle:n.localize("delete_comment"),message:n.localize("delete_comment_confirmation"),confirmationTextKey:"button_delete",cancelTextKey:"button_cancel",onSaveButtonClicked:function(){t.model.destroy(),t.remove();var e=t.conversation.get("numberOfComments");return t.conversation.set("numberOfComments",--e||0),!0}});r.render()}});return p.Events=h,p}),define("utils/validators/MaxLengthValidator",["utils/validators/Validator"],function(e){var t={NotEnoughCharacters:"not_enough_chars"},n=e.extend({defaults:{remainingCharCount:0},initialize:function(e){this.initializeMaxLengthValidator(e);var t=this;this.$inputField.bind("input propertychange",function(e){t.validateMaxLength(e.currentTarget.value)}),e.validateOnInput&&this.$inputField.bind("keydown",function(e){t.handleKeyDownEvent(e)})},initializeMaxLengthValidator:function(e){this.maxLength=e.maxLength,this.minLength=e.minLength;if(!this.maxLength)throw"maxLength must be specified for MaxLengthValidator";this.set("remainingCharCount",this.maxLength),this.initializeValidator(e)},onValueChanged:function(e){var t=this.validateMinLength(e);return t?this.triggerFailureEvent(e,t):this.triggerSuccessEvent(e),t},validateMinLength:function(e){if(e.length<this.minLength)return t.NotEnoughCharacters},validateMaxLength:function(e){var t="";e&&e.length>this.maxLength?(t=e.substring(0,this.maxLength),this.$inputField.val(t)):t=e||"",this.set("remainingCharCount",this.maxLength-t.length)},handleKeyDownEvent:function(e){var t=e.originalEvent,n=typeof t.which=="number"?t.which:t.keyCode,r=this.getTargetValue();if(r&&r.length>this.maxLength-1&&(n>=33||n==32)&&!this.isCharAlwaysValid(n))return e.preventDefault(),!1},isCharAlwaysValid:function(e){if(e==8||e==13||e>32&&e<47)return!0}});return n.Errors=t,n}),define("text!templates/conversations/WidgetAddCommentView.html",[],function(){return'<%  var imageUrl = socialProfile.profileImageUrlSmall || \'//static.garmincdn.com/apps/connect/image/profile-pic-default_60.gif\' %>\n<!--avatar-->\n<div class="object-img pull-left">\n    <a class="" href="#">\n        <img class="media-object avatar" data-src="holder.js/64x64" title="" alt="" src="<%= imageUrl %>">\n    </a>\n</div>\n\n<!--comment content-->\n<div class="media-body">\n\n    <textarea placeholder="<%= Localizer.localize(\'enter_your_comment\') %>" class="add-comment-textarea" maxlength="1000"></textarea>\n    <div class="add-comment-button-wrapper text-right bottom-xs ">\n        <button class="btn btn-small add-comment-button" type="submit"><%= Localizer.localize(\'save\') %></button>\n    </div>\n\n</div>\n<!--end comment content-->\n\n'}),define("views/conversations/WidgetAddCommentView",["underscore","backbone","localizer","models/conversations/Comment","models/user/ViewerSocialProfile","utils/validators/MaxLengthValidator","text!templates/conversations/WidgetAddCommentView.html"],function(e,t,n,r,i,s,o){var u={COMMENT_ADDED:"COMMENT_ADDED"},a=t.View.extend({template:e.template(o),events:{"click .add-comment-button":"onAddCommentClicked","focus .add-comment-textarea":"onTextareaFocus","blur .add-comment-textarea":"onTextareaBlur"},initialize:function(e){this.resourceType=e.resourceType,this.resourceId=e.resourceId,this.conversation=e.conversation},onAddCommentClicked:function(){this.conversation.isNew()?(this.conversation.once("sync",this.addComment,this),this.conversation.save()):this.addComment()},addComment:function(){var e=this.$(".add-comment-textarea"),t=jQuery.trim(e.val());if(t.length==0)return;var n=new r({conversationUuid:this.conversation.get("conversationUuid"),conversationCommentUuid:null,body:t,numberOfLikes:0}),i=this.conversation.get("numberOfComments");this.conversation.set("numberOfComments",++i),n.once("sync",this.onCommentSaved,this),n.save(),e.val(""),e.removeClass("active"),this.$(".add-comment-button-wrapper").hide()},onCommentSaved:function(e){this.trigger(u.COMMENT_ADDED,e)},render:function(){var e=(new Date).getMilliseconds();this.$el.addClass("media add comment widget-sheet-footer"),this.$el.html(this.template({Localizer:n,socialProfile:i.toJSON(),elementId:e})),new s({minLength:1,maxLength:1e3,element:this.$(".add-comment-textarea")})},onTextareaFocus:function(e){jQuery(e.currentTarget).addClass("active"),this.$(".add-comment-button-wrapper").show()},onTextareaBlur:function(e){var t=jQuery(e.currentTarget);t.val().length||(t.removeClass("active"),this.$(".add-comment-button-wrapper").hide())}});return a.Events=u,a}),define("text!templates/conversations/WidgetCommentsView.html",[],function(){return'<div class="comment-container">\n\n    <h6 class=""><%= Localizer.localize(\'comments\') %></h6>\n    <div class="show-previous-comments" style="display:none">\n        <a href="#"><%= Localizer.localize(\'show_previous_comments\') %><a/>\n    </div>\n\n    <!--comment set-->\n    <div class="comment-item">\n\n\n    </div>\n\n</div>\n\n\n\n\n\n\n\n\n\n'}),define("views/conversations/WidgetCommentsView",["underscore","backbone","localizer","collections/conversations/Comments","collections/utils/PagedCollection","views/conversations/WidgetCommentView","views/conversations/WidgetAddCommentView","text!templates/conversations/WidgetCommentsView.html"],function(e,t,n,r,i,s,o,u){var a={ON_RENDERED:"ON_RENDERED",ON_NEW_COMMENT:"ON_NEW_COMMENT",ON_DELETE_COMMENT:"ON_DELETE_COMMENT",ON_CLOSE:"ON_CLOSE"},f=t.View.extend({events:{"click .show-previous-comments":"onShowMoreButtonClicked"},initialize:function(t){if(!t.resourceType)throw"Resource type required for WidgetCommentsView";if(!t.resourceId)throw"Resource id required for WidgetCommentsView";this.resourceType=t.resourceType,this.resourceId=t.resourceId,this.conversation=t.conversation,this.viewerConnections=t.viewerConnections,this.$commentContainer=null,this.$commentSet=null,this.template=e.template(u)},loadContent:function(){this.model.fetchMore()},render:function(){var e=this.template({Localizer:n});this.$el.html(e),this.$commentContainer=this.$(".comment-container"),this.$commentSet=this.$(".comment-item"),this.addCommentView=new o({conversation:this.conversation,resourceType:this.resourceType,resourceId:this.resourceId}),this.addCommentView.bind(o.Events.COMMENT_ADDED,this.onCommentAdded,this),this.addCommentView.render(),this.$el.append(this.addCommentView.$el),this.collection.each(function(e){this.createCommentView(e)},this),this.collection.length>0&&this.collection.hasMoreMembers()&&this.$(".show-previous-comments").show()},createCommentView:function(e){var t=e.get("authorDisplayName");if(this.viewerConnections)var n=this.viewerConnections.findConnection(t);var r=new s({model:e,conversation:this.conversation,connection:n});e.once("destroy",this.onCommentDeleted,this),r.render(),this.$commentSet.append(r.el)},onCommentAdded:function(e){this.collection.add(e),this.createCommentView(e),this.scrollToBottom(),this.trigger(a.ON_NEW_COMMENT,this.conversation,e)},onCommentDeleted:function(){this.trigger(a.ON_DELETE_COMMENT,this.conversation)},onViewClosed:function(){this.trigger(a.ON_CLOSE,this.model),this.$el.remove()},onCloseButtonClicked:function(){this.$el.remove()},scrollToBottom:function(){this.$commentContainer.scrollTop(this.$commentSet.height())},onShowMoreButtonClicked:function(){this.collection.once(i.Events.ON_MORE_MEMBERS_FETCHED,this.onFetchMoreSuccess,this),this.collection.fetchNext()},onFetchMoreSuccess:function(){this.render()}});return f.Events=a,f}),define("models/groups/GroupPost",["backbone"],function(e){var t=e.Model.extend({idAttribute:"uuid",initialize:function(e){},url:function(){var e="/proxy/conversation-service/newspost/"+this.get("userGroupPk")+"/"+this.get("newsPostType");return typeof this.id!="undefined"&&(e+="/"+this.id),e}});return t}),define("text!templates/groups/WidgetAddPostView.html",[],function(){return'\n<div class="alert alert-error" style="display: none;">\n    <p><%= Localizer.localize(errorMessage) %></p>\n</div>\n<h6 class="bottom-xs"><%= Localizer.localize(addNoteMessage) %></h6>\n<textarea rows="5" class="input-block-level add-post-textarea"><%= postValue%></textarea>\n<div class="pull-right">\n    <% if(showCancelBtn) { %>\n    <button class="add-note-cancel-btn btn btn-small top-xs btn-mini btn-secondary bottom-s cancel-post-button"><%= Localizer.localize(cancelMessage) %></button>\n    <% } %>\n    <button class="btn top-xs btn-small bottom-s add-group-button"><%= Localizer.localize(saveMessage) %></button>\n</div>'}),define("views/groups/WidgetAddPostView",["underscore","backbone","localizer","models/groups/GroupPost","models/user/ViewerSocialProfile","utils/validators/MaxLengthValidator","text!templates/groups/WidgetAddPostView.html"],function(e,t,n,r,i,s,o){var u={POST_ADDED:"POST_ADDED",CLOSE:"CLOSE"},a=t.View.extend({template:e.template(o),events:{"click .add-group-button":"onAddPostClicked","click .cancel-post-button":"onCancelClicked"},initialize:function(e){this.addNoteMessage=e.addNoteMessage,this.errorMessage=e.errorMessage,this.saveMessage=e.saveMessage,this.postValue=e.postValue,this.handleSave=e.handleSave,this.objectId=e.objectId,this.objectType=e.objectType,this.postType=e.postType,this.showCancelBtn=e.showCancelBtn,this.cancelMessage=e.cancelMessage,this.allowEmptyText=e.allowEmptyText},onAddPostClicked:function(){var e=this.$(".add-post-textarea"),t=jQuery.trim(e.val());if(t.length===0&&!this.allowEmptyText)return;if(this.handleSave){this.handleSave(t,this.objectId);return}var n=new this.objectType({userGroupPk:this.objectId,newsPostType:this.postType,body:t,rulePk:4});n.bind("error",this.onSavePostError,this),n.bind("change",this.onSavePostSuccess,this),n.save()},onSavePostSuccess:function(e,t){this.$(".alert-error").hide(),this.trigger(u.POST_ADDED,e),this.trigger(u.CLOSE)},onSavePostError:function(e,t){this.$(".alert-error").show()},onCancelClicked:function(e){this.trigger(u.CLOSE)},render:function(){var e=(new Date).getMilliseconds();this.$el.html(this.template({Localizer:n,addNoteMessage:this.addNoteMessage||"",errorMessage:this.errorMessage||"",saveMessage:this.saveMessage||"",postValue:this.postValue||"",showCancelBtn:this.showCancelBtn,cancelMessage:this.cancelMessage})),new s({minLength:1,maxLength:1e3,element:this.$(".add-post-textarea")})}});return a.Events=u,a}),define("text!templates/main/Widget/WidgetFrame.html",[],function(){return'<div class="widget-header clearfix" />\n\n<div class="widget-content">\n</div>\n\n<% if (showFooter) { %>\n<div class="widget-footer clearfix" />\n<% } %>\n\n'}),define("text!templates/main/Widget/WidgetHeader.html",[],function(){return'<h2 class="widget-title pull-left">\n<% if(showHeaderTitle) { %>\n\n    <% if (headerUrl) {     %>\n        <a href="<%= headerUrl %>"><%= Localizer.localize(header_title_key) %> </a>\n    <% } else {             %>\n        <span><%= Localizer.localize(header_title_key) %> </span>\n    <% }                    %>\n<% } %>\n</h2>\n<% if (widgetIsLoaded) { %>\n<div class="dropdown widget-dropdown pull-right">\n    <button class="dropdown-trigger widget-header-action" data-toggle="dropdown"><i class="icon-gear"></i></button>\n    <ul class="dropdown-menu">\n        <li class="clearfix"><i class="icon-gear pull-right"></i></li>\n<%      for (var i = 0; i < menuGroups.length; i++) {\n            var menuGroup = menuGroups[i];\n            var displayDivider = true;\n            if (menuGroup.menuItems.length === 0) {\n                displayDivider = false;\n            }\n            for (var j = 0; j < menuGroup.menuItems.length; j++) {\n                var menuItem = menuGroup.menuItems[j];\n                var childMenuItems = menuItem.childMenuItems;\n                if (typeof (childMenuItems) == \'undefined\' || childMenuItems.length == 0) {\n                %>\n                    <li class="<%= \'js-\' + menuGroup.groupName + \' js-\' + menuItem.key + (menuItem.handlerName == \'\' ? \' dropdown-submenu pull-left\' : \'\') %>"><a href="#"><%= Localizer.localize(menuItem.key) %></a>\n                    </li>\n                <%\n                } else {\n                    displayDivider = false;\n                }\n            }\n            if (displayDivider) { // only add divider between menu items\n            %>\n                <li class="divider js-menu_item_divider" ></li>\n<%\n            }\n        }                                                           %>\n\n        <%  for (var j = 0; j < viewStates.length; j++) {                   %>\n        <%      var _state = viewStates[j];                                 %>\n        <%  for (var i = 0; i <  _state.views.length; i++) {                %>\n        <%      var _view = _state.views[i];                                %>\n        <%      var text = Localizer.localize(_view.menuKeyName);           %>\n        <%      var activityClass = \'\';                                     %>\n        <%      if (_state.name == state.name && _view.name == view.name) { %>\n        <%          activityClass=\'active\';                                 %>\n        <%      }                                                           %>\n\n            <li class="<%= activityClass %>"><a href="#" class=\'<%= _state.name %>*<%= _view.name %> menuStateSelection\'><%= text %></a></li>\n\n        <%  }                                                               %>\n        <%  }                                                               %>\n\n        <li class="divider js-menu_item_divider" ></li>\n        <%      if (headerUrl) { %>\n            <li><a href="<%= headerUrl %>" class="menu-fullpage"><%= Localizer.localize(\'full_page\') %></a></li>\n        <%  }                                                               %>\n        <li><a href="#" class="remove-widget"><%= Localizer.localize(\'remove\') %></a></li>\n    </ul>\n</div>\n<% } %>\n<%      for (var i = menuGroups.length - 1; i >= 0 ; i--) {\n            var menuGroup = menuGroups[i];\n\n            for (var j = menuGroup.menuItems.length - 1; j >= 0 ; j--) {\n                var menuItem = menuGroup.menuItems[j];\n                var childMenuItems = menuItem.childMenuItems;\n\n                if (childMenuItems && childMenuItems.length > 0) {\n                    %>\n                    <div class="dropdown widget-dropdown pull-right">\n                    <button data-toggle="dropdown" class="widget-header-action pull-right js-<%= menuItem.key %>">\n                        <i class="<%= menuItem.icon %>"></i>\n                    </button>\n\n                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n                        <li class="clearfix"><i class="icon-add pull-right"></i></li>\n                        <li><a class="disabled" href="#"><%= Localizer.localize(menuItem.key) %></a></li>\n<%\n                    for (var ch = 0; ch < childMenuItems.length; ch++) {\n                        var childMenuItem = childMenuItems[ch];\n%>\n                        <li class="<%= \'js-\'+ childMenuItem.key %>"><a href="#"><%= Localizer.localize(childMenuItem.key) %></a></li>\n<%\n                    }\n%>\n                    </ul>\n                    </div>\n<%\n                } else {\n%>\n                    <button class="widget-header-action pull-right js-<%= menuItem.key %>">\n                        <i class="<%= menuItem.icon %>"></i>\n                    </button>\n<%\n                }\n%>\n\n<%          }\n        }                                                                %>\n'}),define("text!templates/main/Widget/WidgetFooter.html",[],function(){return'<div class="pull-left">\n\n    <%\n        var showLeft = false;\n        var showRight = false;\n        if (navigationDirection == \'left\') {\n            var leftArrowClass = \'widget-next\';\n            var rightArrowClass = \'widget-previous\';\n\n            showLeft = showNext;\n            showRight = showPrevious;\n\n        } else if (navigationDirection == \'right\') {\n            var leftArrowClass = \'widget-previous\';\n            var rightArrowClass = \'widget-next\';\n\n            showLeft = showPrevious;\n            showRight = showNext;\n        } else if (navigationDirection == \'both\') {\n            var leftArrowClass = \'widget-previous\';\n            var rightArrowClass = \'widget-next\';\n\n            showLeft = true;\n            showRight = true;\n        }\n\n    %>\n\n\n    <button class="<%= leftArrowClass %> widget-footer-action <%= showLeft ? \'\' : \'disabled\' %>">\n        <i class="icon-arrow-left"></i>\n    </button>\n\n    <button class="<%= rightArrowClass %> widget-footer-action <%= showRight ? \'\' : \'disabled\' %>">\n        <i class="icon-arrow-right"></i>\n    </button>\n\n\n    <span class="widget-scope widget-footer-action"><%~ footerMarkup || \' \' %></span>\n</div>\n<div class="pull-right">\n\n    <!-- Comments -->\n    <% if (showLikesAndComments) {                  %>\n        <button class="btn-comment comments-trigger-js widget-footer-action"\n                data-convtype="<%= conversation.resourceType %>"\n                data-convresid="<%= conversation.resourceId || \'\' %>">\n            <i class="icon-speech-bubble">\n                <span class="btn-comment-value"><%= conversation.numberOfComments || 0 %></span>\n            </i>\n        </button>\n        <!--Likes-->\n        <span class="like"></span>\n        <!--End Likes-->\n    <% }                                    %>\n\n    <% if (shareUrl) {                      %>\n        <div class="share-placeholder"></div>\n    <% }                                    %>\n\n    <% if (showHelpIcon) { %>\n        <a href="#" class="icon-help <% if (showHelpIconCss) { print(showHelpIconCss); } %>" title="<%= Localizer.localize(\'more_information\') %>"></a>\n    <% } %>\n\n    <% for (var i = footerActionGroups.length - 1; i >= 0 ; i--) {\n    var actionGroup = footerActionGroups[i];\n\n    for (var j = actionGroup.actions.length - 1; j >= 0 ; j--) {\n    var action = actionGroup.actions[j];\n    if(typeof(actionGroup.actions[j].show) === "undefined" || actionGroup.actions[j].show(view))\n    {\n    %>\n    <button class="widget-footer-action js-<%= action.key %>" title="<%= (action.title) ? Localizer.localize(action.title) : \'\' %>">\n        <i class="<%= action.icon %>"></i>\n    </button>\n    <%\n    }\n    }\n    %>\n\n    <%          }\n                                                               %>\n\n</div>\n'}),define("text!templates/main/Widget/WidgetError.html",[],function(){return'<div class="widget-header clearfix" />\n\n<div class="widget-content">\n	<% if (!isSmallState) { %>\n        <i class="icon-face-sad"></i>\n    <% } %>\n        <div class="h5 font-thin"><%= errorMessage %></div>\n</div>\n\n'}),define("text!templates/main/Widget/WidgetLoading.html",[],function(){return'<div class="text-center bottom-s">\n    <div class="large spinner" title="">\n    	<div></div>\n 	</div>\n</div>\n<div class="h5 text-center font-thin"><%= loadingMessage %></div>'}),define("views/main/WidgetView",["require","underscore","backbone","localizer","personalizer","utils/extensions/Loadable","utils/ModelSynchronizer","utils/NavigationUtil","utils/Logger","utils/AnalyticsUtil","views/main/Widget/WidgetSheet","views/main/Widget/WidgetTakeover","views/conversations/LikeView","views/sharing/SharingView","models/conversations/Conversation","collections/conversations/Comments","collections/connections/ViewerUserConnections","models/user/ViewerSocialProfile","views/conversations/WidgetCommentsView","views/groups/WidgetAddPostView","text!templates/main/Widget/WidgetFrame.html","text!templates/main/Widget/WidgetHeader.html","text!templates/main/Widget/WidgetFooter.html","text!templates/main/Widget/WidgetError.html","text!templates/main/Widget/WidgetLoading.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("personalizer"),s=e("utils/extensions/Loadable"),o=e("utils/ModelSynchronizer"),u=e("utils/NavigationUtil"),a=e("utils/Logger"),f=e("utils/AnalyticsUtil"),l=e("views/main/Widget/WidgetSheet"),c=e("views/main/Widget/WidgetTakeover"),h=e("views/conversations/LikeView"),p=e("views/sharing/SharingView"),d=e("models/conversations/Conversation"),v=e("collections/conversations/Comments"),m=e("collections/connections/ViewerUserConnections"),g=e("models/user/ViewerSocialProfile"),y=e("views/conversations/WidgetCommentsView"),b=e("views/groups/WidgetAddPostView"),w=e("text!templates/main/Widget/WidgetFrame.html"),E=e("text!templates/main/Widget/WidgetHeader.html"),S=e("text!templates/main/Widget/WidgetFooter.html"),x=e("text!templates/main/Widget/WidgetError.html"),T=e("text!templates/main/Widget/WidgetLoading.html"),N=n.View.extend(s);N.prototype.Loadable.Events.ON_WIDGET_STATE_CHANGED="ON_WIDGET_STATE_CHANGED";var C={ON_APPLICATION_EVENT_TRIGGERED:"ON_APPLICATION_EVENT_TRIGGERED",WIDGET_RENDERED:"WIDGET_RENDERED"},k={IS_BEING_DRAGGED:"IS_BEING_DRAGGED",STATIONARY:"STATIONARY"},L={PAGE_PREVIOUS:"PAGE_PREVIOUS",PAGE_NEXT:"PAGE_NEXT"},A={LOAD:"load-status",ERROR:"load-error"},O=N.extend({frameTemplate:t.template(w),headerTemplate:t.template(E),footerTemplate:t.template(S),errorTemplate:t.template(x),events:{"click .widget-previous":"onBtnPreviousClicked","click .widget-next":"onBtnNextClicked","click .menuStateSelection":"onStateMenuSelected","click .remove-widget":"onRemoveMenuSelected","click .icon-add":"onAddButtonClicked","click .btn-comment":"onCommentsClicked","click a":"onAnchorTagClicked","click .icon-help":"onHelpIconClicked"},navigationDirection:"left",shareUrl:null,sharePrivacy:"private",initialize:function(e){if(!e.userPreferences)throw"WidgetView: User Preferences object missing.";if(!e.widgetDefinition)throw"WidgetView: WidgetDefinition object missing.";if(!e.widgetState)throw"WidgetView: Widget state object missing.";this.userPreferences=e.userPreferences,this.userProfile=e.userProfile,this.loadStartTime=null,this.elapsedLoadTime=null,this.template=null,this.widgetDefinition=e.widgetDefinition,this.widgetState=e.widgetState,this.pageIndex=0,this.currentWidgetStateView=null,this.selectedMenuKeys=[],this.instanceMenuGroups=[],this.instanceFooterActionGroups=[],this.dragStatus=k.STATIONARY,this.applicationEventInstances=[],this.isFetchingMore=!1,this.nextButtonEnabled=!0,this.widgetLoaded=!1,this.allEvents={},this.menuGroups||(this.menuGroups=[]),this.footerActionGroups||(this.footerActionGroups=[]);if(!this.userPreferences)throw"UserPreferences required for widget.";this.removeWidgetViewsNotInDatabase(),this.convertChildViewsToWidgetWidgetStateViews();var n=this.getCurrentWidgetView();if(!n){var i=r.localize(this.widgetDefinition.get("title_key")),s=r.localize(this.widgetState.get("viewName")),o="View "+i+"-"+s+" artifact not found.";throw o}n.navigationDirection=n.navigationDirection||"left",this.widgetEvents?this.allEvents=t.extend(this.events,this.widgetEvents):this.allEvents=this.events,this.delegateEvents(this.allEvents),this.setupMenuHandling(),this.setupFooterActions(),this.setupApplicationEvents(),typeof this.initializeWidget!="undefined"&&this.initializeWidget.call(this,e),this.once(this.Loadable.Events.ON_DEPENDENCIES_LOADED,this.onWidgetViewDependenciesLoaded,this),this.compileTemplate(),this.widgetState.once("sync",this.updateWidgetStateIdInDom,this)},removeWidgetViewsNotInDatabase:function(){var e=[];t.each(this.viewStates,function(n){t.each(n.views,function(e){var r=[],i=this.widgetDefinition.findView(n.name,e.name);i||r.push(e),t.each(r,function(e){n.views=t.without(n.views,e)},this)},this),n.views.length==0&&e.push(n)},this),t.each(e,function(e){this.viewStates=t.without(this.viewStates,e)},this)},setupApplicationEvents:function(){var e=this.getCurrentWidgetView();for(var t in e.applicationEvents)if(e.applicationEvents.hasOwnProperty(t)){var n=e.applicationEvents[t];this.applicationEventInstances.push({eventName:t,handlerName:n,context:e})}for(t in this.applicationEvents)this.applicationEvents.hasOwnProperty(t)&&(n=this.applicationEvents[t],this.applicationEventInstances.push({eventName:t,handlerName:n,context:this}))},setupMenuHandling:function(){var e=this.getCurrentWidgetView();t.each(this.menuGroups,function(e){var n=this.cloneMenuGroup(e);this.instanceMenuGroups.push(n),t.each(n.menuItems,function(e){this.allEvents["click .js-"+e.key]=e.handlerName},this)},this),this.delegateEvents(this.allEvents);var n=[];e.menuGroups&&(t.each(e.menuGroups,function(e){var r=this.cloneMenuGroup(e);this.instanceMenuGroups.push(r),n.push(r),t.each(r.menuItems,function(e){typeof e.handlerName!="undefined"&&jQuery.trim(e.handlerName).length>0&&(this.allEvents["click .js-"+e.key]="onChildWidgetStateViewHandlerClicked"),t.each(e.childMenuItems,function(e){this.allEvents["click .js-"+this.escapeKey(e.key)]="onChildWidgetStateViewHandlerClicked"},this)},this)},this),this.delegateEvents(this.allEvents))},setupFooterActions:function(){var e=this.getCurrentWidgetView();t.each(this.footerActionGroups,function(e){var n=this.cloneFooterActionGroup(e);this.instanceFooterActionGroups.push(e),t.each(e.actions,function(e){this.allEvents["click .js-"+e.key]=e.handlerName},this)},this),this.delegateEvents(this.allEvents);var n=[];e.footerActionGroups&&(t.each(e.footerActionGroups,function(e){var r=this.cloneFooterActionGroup(e);this.instanceFooterActionGroups.push(r),n.push(r),t.each(r.actions,function(e){typeof e.handlerName!="undefined"&&jQuery.trim(e.handlerName).length>0&&(this.allEvents["click .js-"+e.key]="footerActionHandler")},this)},this),this.delegateEvents(this.allEvents))},escapeKey:function(e){return e.indexOf(".")>-1&&(e=e.replace(/\./g,"\\.")),e},cloneMenuGroup:function(e){var n={groupName:e.groupName,menuItems:[]};for(var r=0;r<e.menuItems.length;r++){var i=this.cloneMenuItem(e.menuItems[r]);i.childMenuItems=[],n.menuItems.push(i),e.menuItems[r].childMenuItems&&(t.each(e.menuItems[r].childMenuItems,function(e){n.menuItems[r].childMenuItems.push(this.cloneMenuItem(e))},this),n.menuItems[r].childMenuItems=t.sortBy(n.menuItems[r].childMenuItems,function(e){return e.index}))}return n.menuItems=t.sortBy(n.menuItems,function(e){return e.index}),n},cloneMenuItem:function(e){return{key:e.key,handlerName:e.handlerName,index:e.index,icon:e.icon}},cloneFooterActionGroup:function(e){var n={groupName:e.groupName,actions:[]};for(var r=0;r<e.actions.length;r++){var i=this.cloneFooterAction(e.actions[r]);n.actions.push(i)}return n.actions=t.sortBy(n.actions,function(e){return e.index}),n},cloneFooterAction:function(e){return{key:e.key,handlerName:e.handlerName,index:e.index,icon:e.icon,show:e.show,title:e.title}},onChildWidgetStateViewHandlerClicked:function(e){e.preventDefault();var n=this.getCurrentWidgetView(),r=jQuery(e.currentTarget),i=!1,s=null;t.each(this.instanceMenuGroups,function(e){for(var t=0;t<e.menuItems.length;++t){var o=e.menuItems[t];if(r.is(".js-"+o.key))n[o.handlerName]?(n[o.handlerName].apply(n,arguments),i=!0):s=o.handlerName;else{var u=o.childMenuItems;if(u)for(var a=0;a<u.length;a++){var f=u[a];r.is(".js-"+this.escapeKey(f.key))&&(n[f.handlerName]?(n[f.handlerName].apply(n,arguments),i=!0):s=f.handlerName)}}}},this),!i&&this[s]?this[s].apply(this,arguments):n.subView&&typeof n.subView[s]=="function"&&n.subView[s].apply(n.subView,arguments)},footerActionHandler:function(e){e.preventDefault();var n=this.getCurrentWidgetView(),r=jQuery(e.currentTarget),i=!1,s=null;t.each(this.instanceFooterActionGroups,function(e){for(var t=0;t<e.actions.length;++t){var o=e.actions[t];r.is(".js-"+o.key)&&(n[o.handlerName]?(n[o.handlerName].apply(n,arguments),i=!0):s=o.handlerName)}},this),!i&&this[s]&&this[s].apply(this,arguments)},convertChildViewsToWidgetWidgetStateViews:function(){var e=this.widgetState.get("stateName"),n=this.widgetState.get("viewName");t.each(this.viewStates,function(r){t.each(r.views,function(t){var i=t.widgetStateView;if(typeof i!="undefined"){if(!t.processed){for(var s in t.widgetStateView.prototype){var o=t.widgetStateView.prototype[s];typeof o!="function"&&(t[s]=o)}t.shareUrl=t.widgetStateView.prototype.shareUrl,t.sharePrivacy=t.widgetStateView.prototype.sharePrivacy}t.processed=!0,r.name==e&&t.name==n&&(this.currentWidgetStateView=new i({widgetState:this.widgetState,widgetView:this,userPreferences:this.userPreferences,userProfile:this.userProfile}))}},this)},this)},getDisplayName:function(){return this.userPreferences.get("displayName")},render:function(){var e=this.widgetState.get("stateName"),n=this.widgetState.get("viewName"),s=this.findState(e),o=this.getCurrentWidgetView(),a=this.numLoadedPages(e,n),f=this.maxPage(e,n);this.widgetState.id||this.$el.hide();var l=t.result(o,"showFooter")!=0;this.$el.empty(),this.$el.append(this.frameTemplate({showFooter:l})),this.$el.addClass("widget"),this.$el.data("widgetstateid",this.widgetState.id);var c=this.$(".widget-content");o.stateClassName&&this.$el.addClass(o.stateClassName);var h={Localizer:r,url:u.url,Personalizer:i,state:s,view:o,pageIndex:this.pageIndex},p=null;if(!this.isLoaded())this.$el.addClass(A.LOAD),p=this.loadingTemplate;else{this.$el.removeClass(A.LOAD),t.extend(h,this.provideModels(e,n,this.pageIndex));try{this.$el.removeClass(A.ERROR),this.widgetLoaded=!0,a>0?p=this.template(h):p=this.noDataTemplate(h)}catch(d){console.log(d.message),this.renderError(d.message);return}}c.append(p),typeof o.el!="undefined"&&o.setElement(c),this.widgetLoaded&&(this.renderHeader(),this.renderFooter()),typeof this.postRender!="undefined"&&this.postRender.call(this,e,n,this.pageIndex),this.trigger(C.WIDGET_RENDERED,this),a>0&&this.pageIndex>=a-2&&this.pageIndex<f&&a-1<f&&!this.isFetchingMore&&(this.isFetchingMore=!0,this.fetchMore(),this.fetchMoreTimer=setTimeout(t.bind(this.onFetchMoreTimeout,this),5e3)),this.isLoaded()&&e==="small-state"&&this.setSmallStateLinkClickEvent()},setSmallStateLinkClickEvent:function(){this.$el.find(".widget-content a").on("click",function(){f.push({event:"track_event",category:"Navigation Event",action:"Navigate From Small Widget"})})},renderHeader:function(){var e=this.widgetState.get("stateName"),t=this.widgetState.get("viewName"),n=this.findState(e),i=this.getCurrentWidgetView(),s=this.getHeaderUrl();this.$(".widget-header").append(this.headerTemplate({Localizer:r,header_title_key:i.titleKeyName,headerUrl:s,view:i,state:n,viewStates:this.viewStates,widgetState:this.widgetState.toJSON(),showHeaderTitle:i.showHeaderTitle!=0,widgetIsLoaded:this.widgetLoaded,menuGroups:this.instanceMenuGroups}));for(var o in this.selectedMenuKeys)this.selectedMenuKeys.hasOwnProperty(o)&&this.setMenuSelected(o,this.selectedMenuKeys[o])},renderFooter:function(){var e=this.widgetState.get("stateName"),n=this.widgetState.get("viewName"),i=this.numLoadedPages(e,n),s=this.getCurrentWidgetView(),o=i>0||this.instanceFooterActionGroups.length>0;if(!o)return;var u="",a="private";typeof s.shareUrl=="function"?this.currentWidgetStateView?(u=s.shareUrl.call(this.currentWidgetStateView),a=s.sharePrivacy.call(this.currentWidgetStateView)):(u=s.shareUrl.call(this),a=s.sharePrivacy.call(this)):(u=s.shareUrl,a=s.sharePrivacy);var f=s.enableConversation&&this.conversation,l={};f&&(l=this.conversation.toJSON()),this.nextButtonEnabled=this.pageIndex<i-1,o&&((typeof s.showFooter=="undefined"||t.result(s,"showFooter")==1)&&this.$(".widget-footer").html(this.footerTemplate({Localizer:r,showPrevious:this.pageIndex>0,showNext:this.nextButtonEnabled,showLikesAndComments:f,conversation:l,navigationDirection:s.navigationDirection,footerMarkup:this.formatFooter(e,n,this.pageIndex),shareUrl:u,showHelpIcon:s.showHelpIcon,showHelpIconCss:s.showHelpIconCss,footerActionGroups:this.instanceFooterActionGroups,view:s})),f&&(this.likeView=new h({el:this.$(".like"),conversationUuid:this.conversation.get("conversationUuid"),liked:this.conversation.get("likedByUser"),numberOfLikes:this.conversation.get("numberOfLikes"),connections:m,resourceType:s.conversationResourceType,resourceId:this.getConversationResourceId(e,n,this.pageIndex),isComment:!1}),this.likeView.render()),u&&(u=window.location.protocol+"//"+window.location.host+"/modern"+u,this.currentWidgetStateView?this.sharingView=s.createShareView.call(this.currentWidgetStateView,a,u):this.sharingView=this.createShareView.call(this,a,u),this.sharingView.setElement(this.$(".share-placeholder")),this.sharingView.render()))},getHeaderUrl:function(){var e="",t=this.getCurrentWidgetView();return typeof t.headerUrl=="function"?this.currentWidgetStateView?e=t.headerUrl.call(this.currentWidgetStateView):e=t.headerUrl.call(this):e=t.headerUrl,e&&(e=u.url(e)),e},renderError:function(e){var t=this.getCurrentWidgetView();this.$el.empty(),this.$el.append(this.errorTemplate({errorMessage:r.localize("feature_failed_to_load"),isSmallState:this.widgetState.get("stateName")==="small-state"})),this.$el.addClass("widget "+A.ERROR),this.$el.data("widgetstateid",this.widgetState.id),this.renderHeader(),t.stateClassName&&this.$el.addClass(t.stateClassName)},onWidgetViewDependenciesLoaded:function(){this.loadPageConversation()},loadPageConversation:function(){var e=this.widgetState.get("stateName"),t=this.widgetState.get("viewName"),n=this.getCurrentWidgetView(),r=this.getConversationResourceId(e,t,this.pageIndex);if(n.enableConversation&&r){this.conversation=new d({resourceType:n.conversationResourceType,resourceId:this.getConversationResourceId(e,t,this.pageIndex),ownerProfilePk:this.getConversationResourceIdOwner(e,t,this.pageIndex),userGroupPk:this.getConversationResourceGroupId(e,t,this.pageIndex),numberOfLikes:0,numberOfComments:0});var i=new o;i.addModel({model:this.conversation,required:!0}),i.bind(o.Events.SYNCHRONIZED,this.onPageConversationLoaded,this),i.fetchModels()}},onPageConversationLoaded:function(){this.renderFooter()},onCommentsClicked:function(e){e.preventDefault();var t=this.getCurrentWidgetView(),n=jQuery(e.currentTarget),r=n.data("conversationresourcetype"),i=n.data("conversationresourceid"),s=n.data("conversationgroupid");r?this.loadConversation(r,i,s,this.displayComments):t.enableConversation&&this.displayComments(this.conversation)},onHelpIconClicked:function(){var e=this.getCurrentWidgetView();e&&typeof e.onHelpIconClicked=="function"&&e.onHelpIconClicked()},onAddPostClicked:function(e){e.preventDefault(),this.displayAddPostView()},loadConversation:function(e,t,n,r){this.conversation=new d({resourceType:e,resourceId:t,userGroupPk:n}),this.conversation.once("sync",r,this),this.conversation.fetch()},displayComments:function(e){var t=new v([],{resourceType:e.resourceType,resourceId:e.resourceId,userGroupPk:e.userGroupPk,conversation:e,startRowNum:0,limit:10}),n=new y({resourceType:e.resourceType,resourceId:e.resourceId,conversation:e,collection:t,viewerConnections:m});n.bind(y.Events.ON_NEW_COMMENT,this.onNewComment,this),n.bind(y.Events.ON_DELETE_COMMENT,this.onDeleteComment,this),n.bind(y.Events.ON_CLOSE,this.renderFooter,this),this.displaySheet(n,null,"widget-sheet-bottom widget-sheet-comments");var r=new o;r.addModel({model:t,required:!0}),r.bind(o.Events.SYNCHRONIZED,function(){n.render()},this),r.fetchModels()},displayAddPostView:function(){var e=this.getCurrentWidgetView(),t=e.groupId,n=new b({userGroupId:t});n.bind(b.Events.POST_ADDED,this.onNewPost,this),n.bind(b.Events.CLOSE,this.onWidgetSheetClosed,this),this.displaySheet(n,null,"widget-sheet widget-sheet-bottom widget-sheet-posts")},reload:function(){this.trigger(this.Loadable.Events.ON_WIDGET_STATE_CHANGED,this)},setMenuSelected:function(e,t){this.clearSelectedMenus(e),this.$(".js-"+e+".js-"+t).addClass("active"),this.selectedMenuKeys[e]=t},clearSelectedMenus:function(e){this.$(".js-"+e).removeClass("active"),delete this.selectedMenuKeys[e]},moveToPage:function(e,t){this.pageIndex=e,this.conversation=null,this.loadPageConversation();var n=this.getCurrentWidgetView();typeof n.processNavigationDirection!="undefined"&&n.processNavigationDirection(e,t),this.render()},displaySheet:function(e,t,n){if(this.currentSheetView)return;this.currentSheetView=new l({sheetTitle:t,customClasses:n,view:e}),this.currentSheetView.on(l.Events.CLOSE,this.onWidgetSheetClosed,this),this.$el.append(this.currentSheetView.$el),this.currentSheetView.render()},displayTakeover:function(e,t){if(this.currentTakeoverView)return;this.currentTakeoverView=new c({customClasses:t,view:e}),this.currentTakeoverView.on(c.Events.CLOSE,this.onWidgetTakeoverClosed,this),this.$el.append(this.currentTakeoverView.$el),this.currentTakeoverView.render()},closeWidgetSheet:function(){this.currentSheetView&&this.currentSheetView.close()},closeWidgetTakeover:function(){this.currentTakeoverView&&this.currentTakeoverView.close()},onWidgetSheetClosed:function(){this.currentSheetView.off(),this.currentSheetView=null;var e=this.getCurrentWidgetView();e.onWidgetSheetClosed&&e.onWidgetSheetClosed()},onWidgetTakeoverClosed:function(){this.currentTakeoverView.off(),this.currentTakeoverView=null;var e=this.getCurrentWidgetView();e.onWidgetTakeoverClosed&&e.onWidgetTakeoverClosed()},compileTemplate:function(){var e=this.getCurrentWidgetView();this.template=t.template(e.templateHtml),this.noDataTemplate=t.template(e.noDataTemplateHtml),this.loadingTemplate=t.template(T)({loadingMessage:r.localize("loading")})},findState:function(e){return t.find(this.viewStates,function(t){return t.name==e})},findView:function(e,n){var r=this.findState(e);return r?t.find(r.views,function(e){return e.name==n},this):null},getCurrentWidgetView:function(){if(this.currentWidgetStateView)return this.currentWidgetStateView;var e=this.widgetState.get("stateName"),t=this.widgetState.get("viewName");return this.findView(e,t)},onPropertyFileLoaded:function(e){this.trigger(e)},setApplicationCss:function(e){$("<style type='text/css'>"+e+"</style>").appendTo("head")},onBtnPreviousClicked:function(e){e.preventDefault();var t=this.getCurrentWidgetView();if(this.pageIndex>0||t.navigationDirection=="both")this.pageIndex--,this.moveToPage(this.pageIndex,L.PAGE_PREVIOUS)},onBtnNextClicked:function(e){e.preventDefault();if(!this.nextButtonEnabled)return;var t=this.getCurrentWidgetView(),n=this.widgetState.get("stateName"),r=this.widgetState.get("viewName"),i=this.maxPage(n,r);if(this.pageIndex<i||t.navigationDirection=="both")this.pageIndex++,this.moveToPage(this.pageIndex,L.PAGE_NEXT)},onStateMenuSelected:function(e){e.preventDefault();var t=e.currentTarget.className.split(/\s+/)[0],n=t.split("*"),r=this.widgetState.clone();this.widgetState.set("stateName",n[0]),this.widgetState.set("viewName",n[1]),this.widgetState.save(),this.trigger(this.Loadable.Events.ON_WIDGET_STATE_CHANGED,this,r)},onRemoveMenuSelected:function(e){e.preventDefault(),this.widgetState.destroy({wait:!0}),this.remove()},updateWidgetStateIdInDom:function(){this.$el.data("widgetstateid",this.widgetState.id)},raiseApplicationEvent:function(e){var t=[];t.push(this);for(var n=0;n<arguments.length;n++)t.push(arguments[n]);this.trigger(C.ON_APPLICATION_EVENT_TRIGGERED,t)},delegateToWidgetStateView:function(e,t,n){var r=this.getCurrentWidgetView();if(r&&r[e])return r[e].apply(r,n);if(t)throw e+" not implemented"},maxPage:function(e,t){return this.delegateToWidgetStateView("maxPage",!0)},numLoadedPages:function(e,t){return this.delegateToWidgetStateView("numLoadedPages",!0)},fetchMore:function(){return this.delegateToWidgetStateView("fetchMore",!0)},fetchMoreComplete:function(){this.isFetchingMore=!1,this.fetchMoreTimer&&clearInterval(this.fetchMoreTimer),this.fetchMoreTimer=null,this.renderFooter()},onFetchMoreTimeout:function(){var e=this.widgetState.get("stateName"),t=this.widgetState.get("viewName");console.log("Widget "+e+"-"+t+" failed to execute fetchMoreComplete() within allotted time!!!"),this.fetchMoreComplete()},provideDependencies:function(e,t){return this.delegateToWidgetStateView("provideDependencies",!1,arguments)},provideModels:function(e,t,n){var r=[];return r.push(n),this.delegateToWidgetStateView("provideModels",!0,r)},loadDependencies:function(e){return this.delegateToWidgetStateView("loadDependencies",!1,arguments)},onDependenciesLoaded:function(e){return this.delegateToWidgetStateView("onDependenciesLoaded",!1,arguments)},onDependenciesLoadFailed:function(e){this.renderError(e)},postRender:function(e,t,n){var r=[n];return this.delegateToWidgetStateView("postRender",!1,r)},formatFooter:function(e,t,n){var r=[n];return this.delegateToWidgetStateView("formatFooter",!1,r)},getConversationResourceId:function(e,t,n){var r=[n];return this.delegateToWidgetStateView("getConversationResourceId",!1,r)},getConversationResourceIdOwner:function(e,t,n){var r=[n];return this.delegateToWidgetStateView("getConversationResourceIdOwner",!1,r)},getConversationResourceGroupId:function(e,t,n){var r=[n];return this.delegateToWidgetStateView("getConversationResourceGroupId",!1,r)},removeMenuItem:function(e,n){var r=t.find(this.instanceMenuGroups,function(t){return t.groupName==e});if(r){var i=[],s;for(s=0;s<r.menuItems.length;s++)r.menuItems[s].key===n?this.allEvents["click .js-"+n]&&(this.allEvents=t.omit(this.allEvents,"click .js-"+n),this.undelegate("click",".js-"+n)):i.push(r.menuItems[s]);r.menuItems=i,this.$(".widget-header").empty().off(),this.renderHeader()}},removeWidgetMenuItemViewForAState:function(e,n){var r=this.findView(e,n);r&&t.each(this.viewStates,function(e){t.each(e.views,function(t,r){t.name===n&&e.views.splice(r,1)},this)},this)},addCustomMenuItem:function(e,n,r){var i=t.find(this.instanceMenuGroups,function(t){return t.groupName==e});if(!i&&!r)return;!i&&r&&(i={groupName:e,menuItems:[]},this.instanceMenuGroups.push(i)),i.menuItems.push(n),i.menuItems=t.sortBy(i.menuItems,function(e){return e.index}),this.currentWidgetStateView?this.allEvents["click .js-"+n.key]="onChildWidgetStateViewHandlerClicked":this.allEvents["click .js-"+n.key]=n.handlerName,this.delegateEvents(this.allEvents),this.$(".widget-header").empty().off(),this.renderHeader()},createShareView:function(e,t){return new p({privacy:e,url:t,locale:this.userPreferences.get("preferredLocale"),customClasses:"widget-dropdown widget-footer-action",slideDirection:p.SlideDirection.Up})},onNewPost:function(e){this.delegateToWidgetStateView("onNewPost",!1,arguments)},onNewComment:function(e,t){this.delegateToWidgetStateView("onNewComment",!1,arguments)},onDeleteComment:function(e){this.delegateToWidgetStateView("onDeleteComment",!1,arguments)},setDragStatus:function(e){this.dragStatus=e},onAnchorTagClicked:function(e){u.anchorTagHandler(e)},updateTemplate:function(e,n){this[e]=t.template(n)}});return O.Events=C,O.DragStatus=k,O}),define("text!templates/main/Widget/WidgetManager.html",[],function(){return'<div class="nav-widgets-add icon-add"></div>\n<div class="nav-widgets-cancel"><%= Localizer.localize(\'cancel\') %></div>\n<div class="nav-widgets-loading spinner"><div></div></div>\n'}),define("views/main/Widget/WidgetManager",["require","underscore","backbone","localizer","text!templates/main/Widget/WidgetManager.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("text!templates/main/Widget/WidgetManager.html"),s={ON_MANAGE_WIDGETS_CLICKED:"ON_MANAGE_WIDGETS_CLICKED"},o=n.View.extend({template:t.template(i),className:"widget widget-medium manage-widgets",events:{click:"onManageButtonClicked"},render:function(){return this.$el.html(this.template({Localizer:r})),this},onManageButtonClicked:function(e){e.preventDefault(),this.$el.hasClass("loading")||this.trigger(s.ON_MANAGE_WIDGETS_CLICKED)},showLoadingSpinner:function(){this.$el.addClass("loading")},hideLoadingSpinner:function(){this.$el.removeClass("loading")}});return o.Events=s,o}),define("views/main/WidgetContainerView",["require","underscore","backbone","models/dashboard/WidgetDefinition","models/dashboard/WidgetState","views/main/WidgetView","utils/extensions/Loadable","views/main/Widget/WidgetManager","utils/Logger"],function(e){var t=e("underscore"),n=e("backbone"),r=e("models/dashboard/WidgetDefinition"),i=e("models/dashboard/WidgetState"),s=e("views/main/WidgetView"),o=e("utils/extensions/Loadable"),u=e("views/main/Widget/WidgetManager"),a=e("utils/Logger"),f=n.View.extend(o),l={WIDGET_CONTAINER_LOADED:"WIDGET_CONTAINER_LOADED",ON_MANAGE_WIDGETS_CLICKED:u.Events.ON_MANAGE_WIDGETS_CLICKED},c=f.extend({events:{"click .show-more":"onShowMoreClicked"},initialize:function(e){if(typeof this.insertWidgetView=="undefined")throw"ContainerView must implement insertWidgetView";if(!e.userPreferences)throw"ContainerView must have UserPreferences model.";if(!e.widgetDefinitions)throw"ContainerView must have widget definitions.";this.userProfile=e.userProfile,this.userPreferences=e.userPreferences,this.widgetDefinitions=e.widgetDefinitions,this.registeredApplicationEvents={},this.widgetViews=[],this.widgetContainerLoaded=!1,this.overlayEl=null,typeof this.initializeContainer!="undefined"&&this.initializeContainer.call(this,e),this.bind(this.Loadable.Events.ON_DEPENDENCIES_LOADED,this.onWidgetStatesLoaded)},provideCommonDependencies:function(e){this.widgetDefinitions.length===0&&e.addEvent({model:this.widgetDefinitions,event:"sync",required:!0}),e.addModel({model:this.collection,required:!0})},setWidgetStates:function(e){this.empty(),this.hideWidgetManager(),this.collection=e,this.collection.once("sync",this.onWidgetStatesLoaded,this),t.isFunction(this.onWidgetRemoved)&&this.collection.on("destroy",this.onWidgetRemoved,this),this.collection.fetch()},empty:function(){this.collection.off(),t.each(this.widgetViews,function(e){this.removeWidgetView(e)},this)},createWidgetInstance:function(e,t,n){var r=this.widgetDefinitions.get(t),s=r.getDefaultState(),o=r.getDefaultView();this.widgetManager.showLoadingSpinner();if(!o){alert("Default widget not found.");return}var u=0;this.collection.length&&(u=this.collection.last().get("order")+1);var a=new i({dashboardId:e,stateName:s.name,viewName:o.name,order:u,widgetDefinitionId:t});this.collection.add(a),this.addWidgetState(a,function(){a.once("sync",n),a.save()})},onWidgetStatesLoaded:function(){this.registeredApplicationEvents={},this.render(),this.widgetContainerLoaded=!1,this.widgetViewLoadedCount=0,this.collection.length===0?this.renderWidgetManager():this.collection.each(function(e){this.addWidgetState(e)},this)},countWidgetViewLoaded:function(){if(this.widgetContainerLoaded)return;this.widgetViewLoadedCount++,this.widgetViewLoadedCount===this.collection.length&&this.onWidgetContainerLoaded()},addWidgetState:function(t,n){var r=this.widgetDefinitions.get(t.get("widgetDefinitionId"));if(!r){console.log("WidgetDefinition not found for widget with id: "+t.get("widgetDefinitionId"));return}var i=this,s=setTimeout(function(){console.log("Issue loading widget: "+r.get("url")),i.widgetManager&&i.widgetManager.hideLoadingSpinner(),i.countWidgetViewLoaded()},1e4);e([r.get("url")],function(e){clearTimeout(s),i.loadWidgetView(e,r,t),n&&n.call(i)})},loadWidgetView:function(e,n,r){var i={userProfile:this.userProfile,userPreferences:this.userPreferences,widgetDefinition:n,widgetState:r};t.extend(i,n.get("args")),t.extend(i,r.get("args"));var s=new e(i);this.listenTo(s,e.Events.WIDGET_RENDERED,function(e){e.isLoaded()&&(this.widgetStateChange=!1)}),this.widgetViews.push(s),s.bind(s.Loadable.Events.ON_DEPENDENCIES_LOADED,this.onWidgetViewLoaded,this),s.bind(s.Loadable.Events.ON_DEPENDENCIES_LOAD_FAILED,this.onWidgetViewLoadFailed,this),s.bind(s.Loadable.Events.ON_WIDGET_STATE_CHANGED,this.onWidgetStateChanged,this),this.registerApplicationEvents(s),this.insertWidgetView(s),s.load()},onWidgetViewLoaded:function(e){e.render(),this.countWidgetViewLoaded()},onWidgetViewLoadFailed:function(e){this.countWidgetViewLoaded(),this.widgetManager&&this.widgetManager.hideLoadingSpinner()},onWidgetStateChanged:function(e,t){this.widgetStateChange=!0,this.onWidgetRemoved(e.widgetState,t,!0),this.addWidgetState(e.widgetState)},removeWidgetView:function(e){e.off(),e.remove(),this.widgetViews=t.reject(this.widgetViews,function(t){return e==t})},animateWidget:function(e){},registerApplicationEvents:function(e){t.each(e.applicationEventInstances,function(e){var t=e.context[e.handlerName];this.registeredApplicationEvents[e.eventName]||(this.registeredApplicationEvents[e.eventName]=[]),this.registeredApplicationEvents[e.eventName].push({callback:t,context:e.context})},this),e.bind(s.Events.ON_APPLICATION_EVENT_TRIGGERED,this.handleApplicationEvent,this)},unregisterApplicationEvents:function(e){e.unbind(s.Events.ON_APPLICATION_EVENT_TRIGGERED),t.each(e.applicationEventInstances,function(e){this.registeredApplicationEvents[e.eventName]&&(this.registeredApplicationEvents[e.eventName]=t.reject(this.registeredApplicationEvents[e.eventName],function(t){return t.context===e.context}),this.registeredApplicationEvents[e.eventName].length===0&&delete this.registeredApplicationEvents[e.eventName])},this)},raiseApplicationEvent:function(e,t){this.handleApplicationEvent(arguments)},handleApplicationEvent:function(e){var n=this.registeredApplicationEvents[e[1]],r=[];r.push(e[0]);for(var i=2;i<e.length;i++)r.push(e[i]);t.each(n,function(e){e.callback.apply(e.context,r)})},findWidgetView:function(e){var n=t.find(this.widgetViews,function(t){return t.widgetState.id===e});return n?n:null},getWidgetViewByElement:function(e){var t=jQuery(e).data("widgetstateid");return typeof t!="undefined"&&t!==null?this.findWidgetView(t):null},onWidgetContainerLoaded:function(){this.widgetContainerLoaded=!0,this.trigger(l.WIDGET_CONTAINER_LOADED),this.renderWidgetManager()},onDependenciesLoaded:function(){},onContainerUnloaded:function(){this.off(),this.stopListening()},renderWidgetManager:function(){var e=this.widgetManager;e||(e=new u,this.listenTo(e,l.ON_MANAGE_WIDGETS_CLICKED,function(){this.trigger(l.ON_MANAGE_WIDGETS_CLICKED),this.toggleOverlay()}),e.render(),this.widgetManager=e),e.delegateEvents(),this.$("#column-"+this.findShortestColumn().index).append(e.el),this.widgetManager.$el.removeAttr("style"),this.widgetManager.hideLoadingSpinner()},hideWidgetManager:function(){this.widgetManager&&this.widgetManager.$el.hide()},toggleOverlay:function(){this.overlayEl?this.removeOverlay():this.overlayEl=$('<div class="widget-content-overlay"></div>').appendTo(this.$el)},removeOverlay:function(){this.overlayEl=null,this.$(".widget-content-overlay").remove()}});return c.Events=l,c}),define("models/system/SystemMessage",["backbone"],function(e){var t=e.Model.extend({idAttribute:"value",urlRoot:function(){return"/modern/system-service/preference/SystemPreferenceDisplay.systemMessage"},parse:function(e){return e}});return t}),define("text!templates/main/SystemMessagePageView.html",[],function(){return'<% for (var i = 0; i < systemMessages.length; i++ ) { %>\n    <div class="system-message alert" style=""><%~ systemMessages[i] %></div>\n<% }                                                  %>'}),define("views/main/SystemMessagePageView",["underscore","backbone","localizer","personalizer","utils/extensions/Loadable","utils/ModelSynchronizer","models/user/ViewerUserPreferences","models/system/SystemMessage","text!templates/main/SystemMessagePageView.html"],function(e,t,n,r,i,s,o,u,a){var f={SYSTEM_MESSAGE_RENDERED:"SYSTEM_MESSAGE_RENDERED"},l=t.View.extend(i),c=l.extend({propertyFiles:["/main/js/properties/system-messages/system-messages"],initialize:function(t){this.template=e.template(a),this.systemMessage=new u,this.systemMessageText=t.systemMessageText,this.shouldDisplayMessages=t.shouldDisplayMessages,this.viewerUserPreferences=o},render:function(){var e=[],t=this.systemMessage.get("value");this.shouldDisplayMessages&&(jQuery.trim(t).length>0&&e.push(this.getMessage(t)),jQuery.trim(this.systemMessageText).length>0&&e.push(this.systemMessageText)),this.$el.html(this.template({Localizer:n,Personalizer:r,systemMessages:e})),this.$el.attr("id","system-message")},getMessage:function(e){var t=n.localize("translateThis"),r=this.viewerUserPreferences.get("preferredLocale"),i=r=="en";if(!i){var s="http://translate.google.com/?hl="+r+"#en|"+r+"|"+encodeURIComponent(e),o='<a href="'+s+'" target="_blank"><span style="font-size: 10px;">'+t+"</span></a>";e+=" "+o+"."}return e},onDependenciesLoaded:function(){var e=this.systemMessage.get("value");(jQuery.trim(e).length>0||jQuery.trim(this.systemMessageText).length>0)&&this.render(),this.trigger(f.SYSTEM_MESSAGE_RENDERED)},onModelsFailed:function(){typeof console!="undefined"&&typeof console.log!="undefined"&&console.log(arguments)},provideDependencies:function(e){e.addModel({model:this.systemMessage,required:!0}),e.bind(s.Events.SYNCHRONIZED,this.onDependenciesLoaded,this),e.bind(s.Events.SYNCHRONIZE_FAILED,this.onModelsFailed,this)}});return c.Events=f,c}),define("text!containers/connectwidget/ConnectWidgetContainer.html",[],function(){return'<style type="text/css">\n    body.wait, body.wait *{\n        cursor: wait !important;\n    }\n</style>\n\n<div class="system-message-container">\n\n</div>\n\n<% for (var i = 0; i < numColumns; i++) {     %>\n<div class="widget-column ui-sortable" id="column-<%= i %>">\n\n</div>\n<% }                                        %>\n\n\n'}),!function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,r=e.ui.mouse.prototype,i=r._mouseInit,s=r._mouseDestroy;r._touchStart=function(e){var r=this;!n&&r._mouseCapture(e.originalEvent.changedTouches[0])&&(n=!0,r._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},r._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},r._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),n=!1)},r._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),i.call(t)},r._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),s.call(t)}}}(jQuery),define("touchpunch",["jqueryui"],function(){}),define("containers/connectwidget/ConnectWidgetContainer",["require","underscore","backbone","jquery","utils/Logger","views/main/WidgetContainerView","views/main/WidgetView","views/main/SystemMessagePageView","text!containers/connectwidget/ConnectWidgetContainer.html","utils/MainNavUtil","touchpunch"],function(e){var t=e("underscore"),n=e("backbone"),r=e("jquery"),i=e("utils/Logger"),s=e("views/main/WidgetContainerView"),o=e("views/main/WidgetView"),u=e("views/main/SystemMessagePageView"),a=e("text!containers/connectwidget/ConnectWidgetContainer.html"),f=e("utils/MainNavUtil"),l=e("touchpunch"),c={Sort:"SORT",Explicit:"EXPLICIT"};return s.extend({columnWidth:340,propertyFiles:[],initializeContainer:function(e){this.template=t.template(a),this.rendered=!1,this.placementMethod=c.Sort,this.collection.on("destroy",this.onWidgetRemoved,this);var n=this;r(window).on("resize.widgetContainer",this.resizeHandler.bind(this)),f.setExpandCollapseHandler(this.resizeHandler.bind(this),20)},determinePlacementMethod:function(){if(this.collection.length==0)return c.Sort;var e=this.getCurrentLayoutName(),t=this.collection.at(0);return t.getPosition(e)?c.Explicit:c.Sort},getDefaultColumnInfo:function(){var e=[];for(var t=0;t<this.columnsVisible;t++)e.push({index:t,count:0,height:0});return e},provideDependencies:function(e){},loadDependencies:function(){},render:function(){if(this.$el.parent().length==0)return;this.$el.empty(),this.$el.removeClass(),this.$el.addClass("content clearfix"),this.columnsVisible=this.calculateColumnsVisible();var e=this.template({numColumns:this.columnsVisible});this.$el.html(e),this.columns=this.getDefaultColumnInfo(),this.placementMethod=this.determinePlacementMethod(),this.placementMethod==c.Sort&&this.calculateWidgetPlacement(),this.systemMessagePageView=new u({el:this.$(".system-message-container"),shouldDisplayMessages:!0}),this.systemMessagePageView.load();var t=this;this.$(".widget-column").sortable({handle:".widget-header",connectWith:".widget-column, .connect-nav li",revert:200,delay:150,items:".widget",opacity:.4,scrollSensitivity:100,tolerance:"pointer",placeholder:"drop-point-indicator",forcePlaceholderSize:!0,start:function(e,n){r(n.placeholder).slideUp(300);var i=t.getWidgetViewByElement(n.item),s=n.item.closest(".widget-column").attr("id").slice(-1);i.oldColumnIndex=s,i&&i.setDragStatus(o.DragStatus.IS_BEING_DRAGGED)},change:function(e,t){r(t.placeholder).hide().slideDown(300)},stop:function(e,n){t.onWidgetOrderChanged(e,n);var r=t.getWidgetViewByElement(n.item),i=parseInt(r.oldColumnIndex,10),s=r.widgetState.getPosition(t.getCurrentLayoutName()),u=s.column,a=t.calculateWidgetHeight(r.widgetState),f=null;i!==u&&(f=t.columns[i],f.count--,f.height-=a,delete r.oldColumnIndex,f=t.columns[u],f.count++,f.height+=a),r&&r.setDragStatus(o.DragStatus.STATIONARY),n.item.removeAttr("style"),t.renderWidgetManager()}}),$(".main-body").addClass("dashboard").scrollTop(0)},calculateColumnsVisible:function(){var e=Math.min(Math.floor(this.$el.width()/this.columnWidth),4);return e<1&&(e=1),e},onWidgetOrderChanged:function(e,t){this.persistCurrentPositions()},persistCurrentPositions:function(){this.placementMethod=c.Explicit;var e=this;this.$("[id^='column-']").each(function(t,n){var s=r(n),o=s.children().not(".manage-widgets"),u=+s.attr("id").substring(7),a=0;o.each(function(t,n){var s=r(n),o=s.data("widgetstateid");if(o!=null&&typeof o!="undefined"){s.data("rowindex",a);var f=e.collection.get(o),l={column:u,row:a};f.setPosition(e.getCurrentLayoutName(),l)}else i.log("widgetStateId doesn't exist in dom!");a++})})},onNumberOfColumnsChanged:function(){this.render(),this.widgetViews=t.sortBy(this.widgetViews,function(e){return e.widgetState.get("order")}),t.each(this.widgetViews,function(e){this.insertWidgetView(e),e.delegateEvents()},this)},insertWidgetView:function(e){this.placementMethod==c.Explicit?this.insertWidgetViewExplicit(e):this.insertWidgetViewSortOrder(e)},insertWidgetViewSortOrder:function(e){var t=e.widgetState.column,n=e.widgetState.row;typeof t=="undefined"&&(this.addSortOrderPositionToWidgetState(e.widgetState),t=e.widgetState.column,n=e.widgetState.row);var i=this.$("#column-"+t),s=i.children();if(s.length==0)i.append(e.$el);else{var o=!1;i.children().each(function(t,i){var s=r(i).data("rowindex");!o&&s>=n&&(e.$el.insertBefore(i),o=!0)}),o||i.append(e.$el)}e.render(),e.$el.data("rowindex",n),this.widgetStateChange&&this.renderWidgetManager()},insertWidgetViewExplicit:function(e){var t=e.widgetState.getPosition(this.getCurrentLayoutName());t||(this.addColumnAndRowIndexToWidgetState(e.widgetState),t=e.widgetState.getPosition(this.getCurrentLayoutName()));var n=t.column,i=t.row,s=this.$("#column-"+n),o=s.children();if(o.length==0)s.append(e.$el);else{var u=!1;s.children().each(function(t,n){var s=r(n).data("rowindex");!u&&s>=i&&(r(n).before(e.$el),u=!0)}),u||s.append(e.$el)}e.render(),e.$el.data("rowindex",i);var a=this.columns[n];a.count++,a.height+=this.calculateWidgetHeight(e.widgetState),e.widgetState.isNew()&&e.widgetState.once("sync",e.render,e),this.widgetStateChange&&this.renderWidgetManager()},onWidgetRemoved:function(e,r,i){var s=t.find(this.widgetViews,function(t){return t.widgetState==e});this.removeWidgetView(s),this.unregisterApplicationEvents(s);var o=0,u=0;if(typeof e.column!="undefined")o=e.column;else{var a=s.widgetState.getPosition(this.getCurrentLayoutName());o=a.column}var f=this.columns[o];f.count--,f.height-=this.calculateWidgetHeight(r instanceof n.Model?r:e),i!==!0&&this.renderWidgetManager(),this.persistCurrentPositions()},calculateWidgetPlacement:function(){this.collection.sort(),this.collection.each(function(e){this.addSortOrderPositionToWidgetState(e)},this)},addSortOrderPositionToWidgetState:function(e){var t=this.determineNextAvailablePosition(),n=this.columns[t.column];e.column=n.index,e.row=n.count,n.count++,n.height+=this.calculateWidgetHeight(e)},addColumnAndRowIndexToWidgetState:function(e){var t=this.findShortestColumn();e.setPosition(this.getCurrentLayoutName(),{column:t.index,row:t.count})},determineNextAvailablePosition:function(){var e=this.findShortestColumn();return{column:e.index,row:e.count}},getCurrentLayoutName:function(){return"layout-"+this.columnsVisible},findShortestColumn:function(){return t.min(this.columns,function(e){return e.height})},calculateWidgetHeight:function(e){var n=this.widgetDefinitions.get(e.get("widgetDefinitionId"));if(n){var r=n.findState(e.get("stateName"));if(r){var i=e.get("viewName"),s=t.find(r.views,function(e){return e.name==i});if(s)return s.height}}return 0},animateWidget:function(e){var n=t.find(this.widgetViews,function(t){return t.widgetState.id==e});if(n){var r=n.$el;this.renderWidgetManager(),r.show(),this._animateCss(r,"bounceIn")}},_animateCss:function(e,t){var n="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";e.addClass("animated "+t).one(n,function(){$(this).removeClass("animated "+t)})},onWindowResized:function(){var e=this.calculateColumnsVisible();e!=this.columnsVisible&&(this.columnsVisible=e,this.onNumberOfColumnsChanged())},off:function(){r(window).off("resize.widgetContainer"),n.View.prototype.off.call(this)},resizeHandler:function(){window.doNotResize||this.onWindowResized(),this.renderWidgetManager()}})}),define("utils/ToolTipUtil",["require","views/utils/ToolTipView"],function(e){var t=e("views/utils/ToolTipView");return{renderTooltips:function(){var e=this;this.tooltipCollection=[],this.$(".has-tooltip").each(function(){e.tooltipCollection.push(new t({el:$(this)}))})},hideTooltips:function(){if(this.tooltipCollection)for(var e=0,t=this.tooltipCollection.length;e<t;e+=1)this.tooltipCollection[e]&&typeof this.tooltipCollection[e].hide=="function"&&this.tooltipCollection[e].hide()}}}),define("utils/parsers/UrlParser",[],function(){var e=function(){};return e.prototype.parse=function(e){if(!e||e.length==0)return"";var t=e.toLowerCase();return t.substring(0,4)!="http"&&t.substring(0,5)!="https"?window.location.protocol+"//"+e:e},e.prototype.parseQueryString=function(e){var t={},n,r,i,s;e.indexOf("?")!==-1&&(e=e.substring(e.indexOf("?")+1)),n=e.split("&");for(i=0,s=n.length;i<s;i++)r=n[i].split("="),t[r[0]]=r[1];return t},e.prototype.convertObjectToQueryString=function(e){var t="?";if(e)for(var n in e)n&&e[n]&&(t+=n+"="+e[n]+"&");return t==="?"?"":t.substring(0,parseInt(t.length,10)-1)},e}),define("views/main/PageView",["require","underscore","backbone","utils/NavigationUtil","utils/extensions/Loadable","utils/ToolTipUtil","utils/MainNavUtil","utils/parsers/UrlParser"],function(e){var t=e("underscore"),n=e("backbone"),r=e("utils/NavigationUtil"),i=e("utils/extensions/Loadable"),s=e("utils/ToolTipUtil"),o=e("utils/MainNavUtil"),u=e("utils/parsers/UrlParser"),a=null,f={ON_APPLICATION_EVENT_TRIGGERED:"ON_APPLICATION_EVENT_TRIGGERED",HIDE_PAGE_VIEW_SUCCESS_MESSAGE:"HIDE_PAGE_VIEW_SUCCESS_MESSAGE",SHOW_PAGE_VIEW_SUCCESS_MESSAGE:"SHOW_PAGE_VIEW_SUCCESS_MESSAGE",HIDE_PAGE_VIEW_FAILURE_MESSAGE:"HIDE_PAGE_VIEW_FAILURE_MESSAGE",SHOW_PAGE_VIEW_FAILURE_MESSAGE:"SHOW_PAGE_VIEW_FAILURE_MESSAGE",HIDE_ALL_PAGE_VIEW_MESSAGES:"HIDE_ALL_PAGE_VIEW_MESSAGES"},l=n.View.extend(i).extend({pageClassName:"",enableGridCss:!0,enableContainerCss:!1,enableSystemMessage:!0,events:{},currentInstanceId:function(){return a},initialize:function(e){this.pageId=(new Date).getTime(),a=this.pageId;if(!e.userPreferences)throw"PageView: UserPreferences object required";e.pageClassName&&(this.pageClassName=e.pageClassName),this._systemMessage=null,this._successMessage=null,this._failureMessage=null,this.userPreferences=e.userPreferences,this.initializePage(e),this.delegateEvents(t.extend({"click a":r.anchorTagHandler},this.events));var n=this;this.onDependenciesLoaded=t.wrap(this.onDependenciesLoaded,function(e,t){if(n.currentInstanceId()===n.pageId)return e.call(this,t);console.log("Discarding data, new page has been loaded")}),this.render=t.wrap(this.render,function(e){if(n.currentInstanceId()===n.pageId){var t=e.call(this);return n.postRenderSetup(),t}console.log("Discarding data, render ignored.")})},postRenderSetup:function(){this.renderTooltips(),this.setupSmoothScroll(),jQuery(".main-body").removeClass("dashboard").scrollTop(0)},setupSmoothScroll:function(){this.$('a[data-scroll="smooth"]').click(function(e){e.preventDefault();var t=$(this).attr("href"),n=$(t).offset().top-50;$("html, body").stop().animate({scrollTop:n},500)})},getBaseUrl:function(){return"/modern"},onPageUnloaded:function(){this.unbind(null,null,this),o.removeExpandCollapseHandlers();if(this.pageClassName){var e=this.pageClassName.trim().split(" ");e=t.map(e,function(e){return"body-"+e}),jQuery("body").removeClass(e.join(" "))}},addPageClass:function(e){this.$el.addClass(e)},removePageClass:function(e){this.$el.removeClass(e)},raiseApplicationEvent:function(e){var t=[];t.push(this);for(var n=0;n<arguments.length;n++)t.push(arguments[n]);this.trigger(f.ON_APPLICATION_EVENT_TRIGGERED,t)},viewerIsAuthenticated:function(){return this.userPreferences.viewerIsAuthenticated},getQueryStringValue:function(e){var n=document.URL,r=n.indexOf("?"),i=null;if(r!==-1){var s=new u,o=s.parseQueryString(n.substring(r+1));t.has(o,e)&&(i=o[e])}return i},setSystemMessage:function(e){this._systemMessage=e},getSystemMessage:function(){return this._systemMessage},setSuccessMessage:function(e){this._successMessage=e},getSuccessMessage:function(){return this._successMessage},setFailureMessage:function(e){this._failureMessage=e},getFailureMessage:function(){return this._failureMessage},hideSuccessMessage:function(e){this.trigger(f.HIDE_PAGE_VIEW_SUCCESS_MESSAGE,e)},hideFailureMessage:function(e){this.trigger(f.HIDE_PAGE_VIEW_FAILURE_MESSAGE,e)},hideAllMessages:function(e){this.trigger(f.HIDE_ALL_PAGE_VIEW_MESSAGES,e)},showSuccessMessage:function(e){e&&this.setSuccessMessage(e),this.trigger(f.SHOW_PAGE_VIEW_SUCCESS_MESSAGE,this.getSuccessMessage())},showFailureMessage:function(e){e&&this.setFailureMessage(e),this.trigger(f.SHOW_PAGE_VIEW_FAILURE_MESSAGE,this.getFailureMessage())},showWaitCursor:function(){this.raiseApplicationEvent("SHOW_WAIT_CURSOR")},hideWaitCursor:function(){this.raiseApplicationEvent("HIDE_WAIT_CURSOR")},renderTooltips:function(){s.renderTooltips.call(this)}});return l.Events=f,l}),define("text!templates/main/AlertMessagesView.html",[],function(){return'<div class="alert alert-error" style="<% if (!pageViewFailureMessage) { print(\'display:none;\'); } %>">\n    <span class="alert-text"><%= pageViewFailureMessage %></span>\n\n    <% if(growl) { %>\n    <a class="notification-dismiss" href="#"><%= Localizer.localize(\'dismiss\') %></a>\n    <% } %>\n</div>\n\n<div class="alert alert-success" style="<% if (!pageViewSuccessMessage) { print(\'display:none;\'); } %>">\n    <span class="alert-text"><%= pageViewSuccessMessage %></span>\n\n    <% if(growl) { %>\n    <a class="notification-dismiss" href="#"><%= Localizer.localize(\'dismiss\') %></a>\n    <% } %>\n</div>\n'}),define("views/main/AlertMessagesView",["require","underscore","backbone","localizer","text!templates/main/AlertMessagesView.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("text!templates/main/AlertMessagesView.html");return n.View.extend({template:t.template(i),attributes:function(){return{"class":"page-message-container"}},events:{"click .notification-dismiss":"onGrowlNotificationDismissed"},initialize:function(e){return this.pageViewSuccessMessage=e.pageViewSuccessMessage,this.pageViewFailureMessage=e.pageViewFailureMessage,this.growl=e.growl,this.growl&&this.$el.addClass("growl-alert alert-growl-bottom-right"),this},render:function(){return this.$el.html(this.template({Localizer:r,pageViewSuccessMessage:this.pageViewSuccessMessage,pageViewFailureMessage:this.pageViewFailureMessage,growl:this.growl})),this.$errorElement=this.$(".alert-error"),this.$errorElementText=this.$errorElement.find(".alert-text"),this.$successElement=this.$(".alert-success"),this.$successElementText=this.$successElement.find(".alert-text"),this},updateSuccessMessage:function(e){if(e||e==="")this.pageViewSuccessMessage=e;this.$successElementText.text(this.pageViewSuccessMessage)},showSuccessMessage:function(e){this.updateSuccessMessage(e),this.$successElement.show()},hideSuccessMessage:function(e){e&&this.$successElementText.empty(),this.$successElement.hide()},updateFailureMessage:function(e){if(e||e==="")this.pageViewFailureMessage=e;this.$errorElementText.text(e)},showFailureMessage:function(e){this.updateFailureMessage(e),this.$errorElement.show()},hideFailureMessage:function(e){e&&this.$errorElementText.empty(),this.$errorElement.hide()},onGrowlNotificationDismissed:function(e){e.preventDefault();var t=$(e.currentTarget).closest(".alert");t.addClass("animated fadeOutRight"),setTimeout(function(){this.hideFailureMessage(),this.hideSuccessMessage(),t.removeClass("animated fadeOutRight")}.bind(this),600)}})}),define("text!containers/fullpage/PageContainer.html",[],function(){return'<div class="system-message-container"></div>\n<div id="pageContainer">\n    <style type="text/css">\n        body.wait, body.wait *{\n            cursor: wait !important;\n        }\n    </style>\n</div>\n'}),define("containers/fullpage/PageContainer",["require","underscore","backbone","views/main/PageView","utils/extensions/Loadable","views/main/SystemMessagePageView","views/main/AlertMessagesView","text!containers/fullpage/PageContainer.html"],function(e){var t=e("underscore"),n=e("backbone"),r=e("views/main/PageView"),i=e("utils/extensions/Loadable"),s=e("views/main/SystemMessagePageView"),o=e("views/main/AlertMessagesView"),u=e("text!containers/fullpage/PageContainer.html"),a=n.View.extend(i);return a.extend({initialize:function(e){this.userPreferences=e.userPreferences,this.pageView=null,this.registeredApplicationEvents={},this.template=t.template(u)},render:function(){if(this.pageView&&this.pageView.isLoaded()){this.$el.empty(),this.$el.removeClass(),this.$el.addClass("content page"),this.$el.addClass(this.pageView.pageClassName),this.$el.html(this.template({}));var e=this.$("#pageContainer");e.append(this.pageView.el),this.isFluid()&&e.addClass("page-inner-fluid"),this.isNewGrid()&&(this.$el.addClass("new-grid"),e.addClass("page-inner")),this.pageView.enableContainerCss&&e.addClass("container"),window.scrollTo(0,0),this.setupPageMessages(),this.pageView.render(),this.addBodyLevelClass(),jQuery("body").removeClass("wait")}},addBodyLevelClass:function(){if(this.pageView.pageClassName){var e=this.pageView.pageClassName.trim().split(" ");e=t.map(e,function(e){return"body-"+e}),jQuery("body").addClass(e.join(" "))}},setupPageMessages:function(){this.systemMessagePageView=new s({el:this.$(".system-message-container"),systemMessageText:this.pageView.getSystemMessage(),shouldDisplayMessages:this.pageView.enableSystemMessage}),this.listenTo(this.systemMessagePageView,s.Events.SYSTEM_MESSAGE_RENDERED,function(){this.pageView&&t.isFunction(this.pageView.handleListPadding)&&this.pageView.handleListPadding()}),this.systemMessagePageView.load(),this.alertMessagesView=new o({pageViewSuccessMessage:this.pageView.getSuccessMessage(),pageViewFailureMessage:this.pageView.getFailureMessage(),growl:this.pageView.growlMessages}),this.$(".system-message-container").after(this.alertMessagesView.render().el),this.bindPageViewEvents()},setPageView:function(e){this.pageView&&this.pageView.onPageUnloaded(),this.pageView=e,this.registerApplicationEvents(this.pageView),this.pageView&&(this.pageView.isLoaded()?this.render():this.pageView.once(e.Loadable.Events.ON_DEPENDENCIES_LOADED,this.onPageDependenciesLoaded,this))},onPageDependenciesLoaded:function(){this.render()},setApplicationCss:function(e){$("<style type='text/css'>"+e+"</style>").appendTo("head")},onContainerUnloaded:function(){this.pageView&&(this.pageView.onPageUnloaded(),this.off(),this.stopListening())},bindPageViewEvents:function(){this.pageView&&(this.pageView.on(r.Events.HIDE_PAGE_VIEW_SUCCESS_MESSAGE,this.hideSuccessMessage,this),this.pageView.on(r.Events.SHOW_PAGE_VIEW_SUCCESS_MESSAGE,this.showSuccessMessage,this),this.pageView.on(r.Events.HIDE_PAGE_VIEW_FAILURE_MESSAGE,this.hideFailureMessage,this),this.pageView.on(r.Events.SHOW_PAGE_VIEW_FAILURE_MESSAGE,this.showFailureMessage,this),this.pageView.on(r.Events.HIDE_ALL_PAGE_VIEW_MESSAGES,this.hideAllMessages,this))},registerApplicationEvents:function(e){for(var t in e.applicationEvents)if(e.applicationEvents.hasOwnProperty(t)){var n=e.applicationEvents[t],i=e[n];if(!i){console.log("Handler not found for event: "+t);return}this.registeredApplicationEvents[t]||(this.registeredApplicationEvents[t]=[]),this.registeredApplicationEvents[t].push({callback:i,context:e})}e.bind(r.Events.ON_APPLICATION_EVENT_TRIGGERED,this.handleApplicationEvent,this)},registerApplicationEvent:function(e,t,n){this.registeredApplicationEvents[e]||(this.registeredApplicationEvents[e]=[]),this.registeredApplicationEvents[e].push({callback:n,context:t})},raiseApplicationEvent:function(e,t){this.handleApplicationEvent(arguments)},handleApplicationEvent:function(e){var n=this.registeredApplicationEvents[e[1]],r=[];r.push(e[0]);for(var i=2;i<e.length;i++)r.push(e[i]);t.each(n,function(e){e.callback.apply(e.context,r)})},isFluid:function(){var e=this.pageView.fluid;return typeof e=="function"&&(e=e.call(this.pageView)),e},isNewGrid:function(){var e=this.pageView.enableGridCss;return typeof e=="function"&&(e=e.call(this.pageView)),e},hideSuccessMessage:function(e){this.alertMessagesView&&typeof this.alertMessagesView.hideSuccessMessage=="function"&&this.alertMessagesView.hideSuccessMessage(e)},showSuccessMessage:function(e){this.alertMessagesView&&typeof this.alertMessagesView.showSuccessMessage=="function"&&this.alertMessagesView.showSuccessMessage(e)},hideFailureMessage:function(e){this.alertMessagesView&&typeof this.alertMessagesView.hideFailureMessage=="function"&&this.alertMessagesView.hideFailureMessage(e)},showFailureMessage:function(e){this.alertMessagesView&&typeof this.alertMessagesView.showFailureMessage=="function"&&this.alertMessagesView.showFailureMessage(e)},hideAllMessages:function(e){this.hideSuccessMessage(e),this.hideFailureMessage(e)}})}),define("utils/session/SessionManager",["underscore","backbone","jquery","gauth"],function(e,t,n){var r=72e5,i={SESSION_EXPIRED:"SESSION_EXPIRED",SESSION_REESTABLISHED:"SESSION_REESTABLISHED",SESSION_REAUTHENTICATING:"SESSION_REAUTHENTICATING"},s=function(e,t,i){if(!e)throw"gAuthHost required for SessionManager";if(!t)throw"sessionLength required for SessionManager";this.connectSessionLength=t,this.ssoSessionLength=r,this.authenticationPending=!1,this.authenticateToLegacy(null,null,i),this.updateSessionExpiration(!0),GAUTH.init({gauthHost:e,clientId:"GarminConnect",locale:"en",consumeServiceTicket:!1});var s=this;n(document).bind("mousemove keyup mousewheel",function(e){s.onUserInteraction(e)}),setInterval(function(){!s.authenticationPending&&s.isSSOSessionPossiblyExpired()&&s.onSSOSessionPossiblyExpired()},1e3)};return s.prototype.reAuthenticate=function(e,t,n,r){this.authenticationPending=!0;var i=!1,s=null,o=null,u=this,a=!1;GAUTH_Events.addListener("AUTHENTICATED",function(n,f){a||(a=!0,i=!0,s=f.serviceTicket,o=f.serviceUrl,e?u.reAuthenticateToConnect(s,o,t,r):t())}),GAUTH_Events.addListener("NOT_AUTHENTICATED",function(e,t){a||(a=!0,n())}),GAUTH_Events.addListener("ERROR",function(e,t){a||(a=!0,n())}),GAUTH.checkAuthentication()},s.prototype.onUserInteraction=function(t){!this.authenticationPending&&this.isConnectSessionPossiblyExpired()&&(this.trigger(i.SESSION_REAUTHENTICATING),this.reAuthenticate(!0,e.bind(this.authenticationSucceeded,this,!0),e.bind(this.ssoAuthenticationFailed,this,!0),e.bind(this.connectAuthenticationFailed,this)))},s.prototype.authenticationSucceeded=function(e){this.trigger(i.SESSION_REESTABLISHED),this.authenticationPending=!1,this.updateSessionExpiration(e)},s.prototype.ssoAuthenticationFailed=function(e){this.trigger(i.SESSION_EXPIRED,e),console.log("SSO SESSION HAS EXPIRED")},s.prototype.connectAuthenticationFailed=function(){console.log("CONNECT AUTHENTICATION FAILED"),this.authenticationPending=!1,this.updateSessionExpiration(!0)},s.prototype.isConnectSessionPossiblyExpired=function(){return(new Date).getTime()>this.connectSessionExpiration},s.prototype.isSSOSessionPossiblyExpired=function(){return(new Date).getTime()>this.ssoSessionExpiration},s.prototype.onSSOSessionPossiblyExpired=function(){!this.authenticationPending&&this.isSSOSessionPossiblyExpired()&&(this.trigger(i.SESSION_REAUTHENTICATING),this.reAuthenticate(!1,e.bind(this.authenticationSucceeded,this,!1),e.bind(this.ssoAuthenticationFailed,this,!1),e.bind(this.connectAuthenticationFailed,this)))},s.prototype.reAuthenticateToConnect=function(t,r,i,s){var o=document.location.href+"?ticket="+t;n.get(o,null,e.bind(this.reAuthenticateToLegacy,this,i))},s.prototype.reAuthenticateToLegacy=function(e,t){this.authenticateToLegacy(e,t)},s.prototype.authenticateToLegacy=function(t,n,r){var i="/legacy/session"+(r?"?web_token="+r:""),s=document.createElement("iframe");s.style.display="none",s.onload=function(){s.parentNode.removeChild(s),e.isFunction(t)&&t()},s.src=location.href.substr(0,location.href.indexOf("/",9))+i,document.body.appendChild(s)},s.prototype.updateSessionExpiration=function(e){this.sessionStartTime=(new Date).getTime(),this.ssoSessionExpiration=this.sessionStartTime+this.ssoSessionLength,console.log("SSO expiration updated."),e&&(this.connectSessionExpiration=this.sessionStartTime+this.connectSessionLength,console.log("CONNECT expiration updated."))},s.Events=i,e.extend(s.prototype,t.Events),s}),define("models/whatsnew/WhatsNewExpirationInfo",["backbone"],function(e){var t=e.Model.extend({url:function(){return"/proxy/content-service/content/whats-new/en"}});return t}),define("utils/validators/MultiFieldValidator",["backbone","utils/validators/Validator"],function(e,t){var n=t.extend({initialize:function(e){this.initializeMultifieldValidator(e)},initializeMultifieldValidator:function(e){if(!e.elements)throw"Validator missing elements";this.$inputField=jQuery(e.elements),this.parser=e.parser,this.formatter=e.formatter,this.reporter=e.reporter;var t=this;_.each(this.$inputField,function(e){jQuery(e).bind("change",function(e){t.onValueChanged(t.getTargetValue())}).bind("keydown",function(e){e.keyCode==9?t.onValueChanged(t.getTargetValue()):t.onInputChanged(t.getTargetValue())})})},getTargetValue:function(){return""},validateInputNow:function(){return this.onValueChanged(this.getTargetValue())}});return n}),define("utils/validators/ElapsedTimeValidator",["utils/validators/MultiFieldValidator","utils/parsers/NumberParser"],function(e,t){var n={MaxTimeExceeded:"max_time_exceeded"};return e.extend({initialize:function(e){if(!e.maxTime)throw"ElapedTimeValidator requires maxTime.";this.maxTime=e.maxTime,this.initializeMultifieldValidator(e);var n=this;this.$inputField.each(function(e,t){jQuery(t).bind("keydown",function(e){n.validCharacterKeydownHandler(e)})}),this.parser||(this.parser=new t),typeof e.typeFormat!="undefined"&&e.typeFormat=="integer"?(this.typeFormat=e.typeFormat,this.validChars=[8,9,37,38,39,40,46,35,36]):(this.typeFormat="decimal",this.validChars=[8,9,37,38,39,40,46,110,188,190,35,36])},getTargetValue:function(){try{var e=this.parser.parse(this.$inputField[0].val())||0}catch(t){e=0}try{var n=this.parser.parse(this.$inputField[1].val())||0}catch(t){n=0}try{var r=this.parser.parse(this.$inputField[2].val())||0}catch(t){r=0}return(r+60*n+3600*e).toString()},validateInput:function(e){return e>this.maxTime?n.MaxTimeExceeded:(this.populateFields(+e),"")},populateFields:function(e){this.$inputField[0].val(Math.floor(e/3600)),this.$inputField[1].val(Math.floor(e%3600/60)),this.$inputField[2].val(Math.round(e%3600%60))},validCharacterKeydownHandler:function(e){var t=e.originalEvent,n=typeof t.which=="number"?t.which:t.keyCode,r=!1;this.isNumberKeyCode(n)?r=!0:this.validChars.indexOf(n)>-1&&(r=!0);if(!r)return e.preventDefault(),!1},isNumberKeyCode:function(e){return!this.isNotANumberKeyCode(e)},isNotANumberKeyCode:function(e){return e<48||e>57&&e<96||e>105}})}),define("text!templates/utils/ElapsedTimeView.html",[],function(){return'<input type="text" id="<%= model.idPrefix %>-time-hour" class="input-mini" value="<%= model.timeHours == null ? \'\' : model.timeHours %>" maxlength="<%= hourInputMaxLength %>"> :\n<input type="text" id="<%= model.idPrefix %>-time-minute" class="input-mini" value="<%= model.timeMinutes == null ? \'\' : model.timeMinutes %>" maxlength="2">\n<% if (!hideSeconds) { %>\n:\n<input type="text" id="<%= model.idPrefix %>-time-second" class="input-mini" value="<%= model.timeSeconds == null ? \'\' : model.timeSeconds %>" maxlength="2">\n<% } %>\n'}),define("views/utils/ElapsedTimeView",["underscore","backbone","localizer","personalizer","utils/validators/ElapsedTimeValidator","utils/reporters/ToolTipErrorReporter","views/utils/ErrorToolTipView","text!templates/utils/ElapsedTimeView.html"],function(e,t,n,r,i,s,o,u){var a={CHANGE:"CHANGE"},f=t.View.extend({initialize:function(e){if(!e.idPrefix)throw"A DOM ID Prefix is required for ElapsedTimeView.";if(!e.maxExceededErrorKey)throw"An error key is required for ElapsedTimeView.";this.scrollableElement=e.scrollableElement,this.hideSeconds=e.hideSeconds||!1,this.idPrefix=e.idPrefix,this.maxExceededErrorKey=e.maxExceededErrorKey,e.value?this.setHoursMinutesSeconds(e.value):(this.hours=0,this.minutes=0,this.seconds=0),this.maxTime=e.maxTime?e.maxTime:144e3,this.hourInputMaxLength=e.hourInputMaxLength?e.hourInputMaxLength:2},setHoursMinutesSeconds:function(e){var t=Math.floor(e/3600),n=Math.floor(e/60-t*60),r=e-t*3600-n*60,i=Math.floor(r),s=Math.round((r-i)*1e4)/1e4,o=s>0,u=o&&e<599.95;if(u&&s>=.95||!u&&s>=.5)i++,s=0;i>59&&(i=0,n++,n>59&&(n=0,t++)),u&&(i=Math.round(i+s)),this.hours=t,this.minutes=n,this.seconds=i},hourField:function(){return this.$("#"+this.idPrefix+"-time-hour")},minuteField:function(){return this.$("#"+this.idPrefix+"-time-minute")},secondField:function(){return this.$("#"+this.idPrefix+"-time-second")},render:function(){var t=e.template(u),r={idPrefix:this.idPrefix,maxExceededErrorKey:this.maxExceededErrorKey,timeHours:this.hours,timeMinutes:this.minutes,timeSeconds:this.seconds};this.html=t({model:r,Localizer:n,hideSeconds:this.hideSeconds,hourInputMaxLength:this.hourInputMaxLength}),this.$el.html(this.html+this.$el.html());var o=this;return this.validator=new i({maxTime:this.maxTime,elements:[this.hourField(),this.minuteField(),this.secondField()],reporter:new s({message:function(e,t){return typeof o.maxExceededErrorKey=="function"?o.maxExceededErrorKey():n.localize(o.maxExceededErrorKey,e)},scrollableElement:this.scrollableElement,position:"top",element:this.hourField()[0]})}),this.validator.on(i.Events.ValidationSuccess,this.onDurationInputValidationSucceeded,this),this.el},onDurationInputValidationSucceeded:function(e){this.setHoursMinutesSeconds(e.parsedValue),this.trigger(a.CHANGE,this.calculateTime())},calculateTime:function(){var e=this.hours,t=this.minutes,n=this.seconds,r=1*n+60*t+3600*e;return r}});return f.Events=a,f}),define("models/device/PartialModel",["require","underscore","backbone","utils/NavigationUtil"],function(e){var t=e("underscore"),n=e("backbone"),r=e("utils/NavigationUtil"),i=n.Model.extend({required:null,isReady:!1,changedProps:null,constructor:function(e){this._reset(),this.on("sync",function(){this.isReady=!0}.bind(this)),n.Model.apply(this,arguments)},setRequired:function(e){this.required=e},set:function(e,r){if(this.isReady)if(typeof e=="object"){jQuery.extend(!0,this.changedProps,e);for(var i in e)e.hasOwnProperty(i)&&t.isArray(e[i])&&(this.changedProps[i]=e[i]);this._mergeChanges(e)}else this.changedProps[e]=r;return n.Model.prototype.set.call(this,e,r)},save:function(e,t){if(!this.hasChangedProps())return!0;var n=jQuery.extend(!0,{},this.changedProps,this.required),i=t||{};return i.url=r.url(this.url()),i.type="POST",i.data=JSON.stringify(n),i.contentType="application/json",i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override","PUT")},jQuery.ajax(i).done(function(e){this._updateModel(e),this.trigger("sync",this,e),this._reset()}.bind(this))},hasChangedProps:function(){return!t.isEmpty(this.changedProps)},_reset:function(){this.changedProps={}},_updateModel:function(e){if(!e)return;for(var t in this.changedProps)this.changedProps.hasOwnProperty(t)&&(this.attributes[t]=e[t])},_mergeChanges:function(e){var n=jQuery.extend(!0,{},this.attributes,e);for(var r in e)e.hasOwnProperty(r)&&!t.isArray(e[r])&&(e[r]=n[r])}});return i}),define("models/user/UserSettings",["require","underscore","backbone","utils/date/DateFormatter","utils/date/DateParser","models/device/PartialModel"],function(e){var t=e("underscore"),n=e("backbone"),r=e("utils/date/DateFormatter"),i=e("utils/date/DateParser"),s=e("models/device/PartialModel");return s.extend({url:function(){return"/proxy/userprofile-service/userprofile/user-settings/"},getGender:function(){return this.get("userData").gender},setGender:function(e){this.updateUserDataItem("gender",e)},getWeight:function(){return this.get("userData").weight},setWeight:function(e){this.updateUserDataItem("weight",e)},getHeight:function(){return this.get("userData").height},setHeight:function(e){this.updateUserDataItem("height",e)},getBirthDate:function(){return this.get("userData").birthDate},setBirthDate:function(e){this.updateUserDataItem("birthDate",r.formatISODate(i.parseISO(e)))},getActivityLevel:function(){return this.get("userData").activityLevel},setActivityLevel:function(e){this.updateUserDataItem("activityLevel",e)},getVO2MaxRunning:function(){return this.get("userData").vo2MaxRunning},setVO2MaxRunning:function(e){this.updateUserDataItem("vo2MaxRunning",e)},getVO2MaxCycling:function(){return this.get("userData").vo2MaxCycling},setVO2MaxCycling:function(e){this.updateUserDataItem("vo2MaxCycling",e)},getMeasurementSystem:function(){return this.get("userData").measurementSystem},setMeasurementSystem:function(e){this.updateUserDataItem("measurementSystem",e)},getHandedness:function(){return this.get("userData").handedness},setHandedness:function(e){return this.updateUserDataItem("handedness",e)},getSleepTime:function(){var e=this.getUserSleep().sleepTime;return e||e===0?e:79200},setSleepTime:function(e){this.set({userSleep:{sleepTime:e}})},getWakeTime:function(){return this.getUserSleep().wakeTime||this.setWakeTime(21600),this.getUserSleep().wakeTime},setWakeTime:function(e){this.set({userSleep:{wakeTime:e}})},getUserSleep:function(){if(this.get("userSleep"))return this.get("userSleep");this.userSleep={}},hasExternalBottomTime:function(){return this.get("userData")&&typeof this.get("userData").externalBottomTime!="undefined"?this.get("userData").externalBottomTime!==null:!1},getExternalBottomTime:function(){return this.get("userData")&&typeof this.get("userData").externalBottomTime!="undefined"?this.get("userData").externalBottomTime:0},setExternalBottomTime:function(e){this.updateUserDataItem("externalBottomTime",e)},updateUserDataItem:function(e,t){var n={};n[e]=t,this.set({userData:n})}})}),define("text!templates/user/UserExperienceSetupView.html",[],function(){return'<div class="row">\n    <!-- OPTION 1 -->\n    <div class="span12 experience-container wellness-experience-container">\n        <div class="experience-type-identifier">\n            <label for="button-experience-wellness">\n                <div class="icon-container">\n                    <i class="icon-steps-1"></i>\n                </div>\n            </label>\n        </div>\n        <div class="experience-type-body">\n            <label for="button-experience-wellness">\n                <h5><%= Localizer.localize(\'wellness_dashboard\') %></h5>\n                <p class="muted"><%= Localizer.localize(\'wellness_description\') %></p>\n            </label>\n        </div>\n\n        <div class="connect-checkbox pull-right top-m">\n            <input type="checkbox" id="button-experience-wellness" name="check"/>\n            <label for="button-experience-wellness"></label>\n        </div>\n    </div>\n\n    <!-- OPTION 2 -->\n    <div class="span12 experience-container fitness-experience-container disabled">\n        <div class="experience-type-identifier">\n            <label for="button-experience-fitness">\n                <div class="icon-container">\n                    <i class="icon-activities"></i>\n                </div>\n            </label>\n        </div>\n\n        <div class="experience-type-body">\n            <label for="button-experience-fitness">\n                <h5><%= Localizer.localize(\'fitness_dashboard\') %></h5>\n                <p class="muted"><%= Localizer.localize(\'fitness_description\') %></p>\n            </label>\n        </div>\n\n        <div class="connect-checkbox pull-right top-m">\n            <input class="connect-checkbox-input" type="checkbox" id="button-experience-fitness" name="check">\n            <label for="button-experience-fitness"></label>\n        </div>\n    </div>\n\n    <!-- OPTION 3 -->\n    <div class="span12 experience-container golf-experience-container disabled">\n        <div class="experience-type-identifier">\n            <label for="button-experience-golf">\n                <div class="icon-container">\n                    <i class="icon-activity-golf"></i>\n                </div>\n            </label>\n        </div>\n        <div class="experience-type-body">\n            <label for="button-experience-golf">\n                <h5><%= Localizer.localize(\'golf_dashboard\') %></h5>\n                <p class="muted"><%= Localizer.localize(\'golf_description\') %></p>\n            </label>\n        </div>\n\n        <div class="connect-checkbox pull-right top-m">\n            <input type="checkbox" id="button-experience-golf" name="check"/>\n            <label for="button-experience-golf"></label>\n        </div>\n    </div>\n\n    <!-- OPTION 4 -->\n    <div class="span12 experience-container dive-experience-container disabled">\n        <div class="experience-type-identifier">\n            <label for="button-experience-dive">\n                <div class="icon-container">\n                    <i class="icon-activity-diving"></i>\n                </div>\n            </label>\n        </div>\n        <div class="experience-type-body">\n            <label for="button-experience-dive">\n                <h5><%= Localizer.localize(\'dive_dashboard\') %></h5>\n                <p class="muted"><%= Localizer.localize(\'dive_description\') %></p>\n            </label>\n        </div>\n\n        <div class="connect-checkbox pull-right top-m">\n            <input type="checkbox" id="button-experience-dive" name="check"/>\n            <label for="button-experience-dive"></label>\n        </div>\n    </div>\n    <div id="externalBottomTime" class="span12 user-experience-external-bottom-time" style="display: none">\n        <div class="experience-type-identifier"></div>\n        <label class="user-experience-external-bottom-time-label muted"><%= Localizer.localize(\'total_bottom_time_short\') + \' \' %><span class="colored has-tooltip help-icon" data-placement="top" title="<%= Localizer.localize(\'enter_any_previous_dives\') %>"><i class="icon-help"></i></span></label>\n        <div id="externalBottomTimePlaceholder">\n            <span class="format-example muted"><%= Localizer.localize(\'user.experience.manualActivity.formatExample.withoutSeconds\') %></span>\n        </div>\n    </div>\n\n    <% if(isMarineExperienceAvailable) { %>\n    <!-- OPTION 5 -->\n    <div class="span12 experience-container marine-experience-container disabled">\n        <div class="experience-type-identifier">\n            <label for="button-experience-marine">\n                <div class="icon-container">\n                    <i class="icon-activity-marine"></i>\n                </div>\n            </label>\n        </div>\n\n        <div class="experience-type-body">\n            <label for="button-experience-marine">\n                <h5><%= Localizer.localize(\'marine_dashboard\') %></h5>\n                <p class="muted"><%~ Localizer.localize(\'marine_description\') %></p>\n            </label>\n        </div>\n\n        <div class="connect-checkbox pull-right top-m">\n            <input type="checkbox" id="button-experience-marine" name="check"/>\n            <label for="button-experience-marine"></label>\n        </div>\n    </div>\n    <% } %>\n</div>\n\n<div class="marine-terms fine-print active js-marine-terms" style="display:none">\n    <%~ Localizer.localize("upload_terms_and_conditions") %>\n</div>\n'}),define("views/user/UserExperienceSetupView",["require","underscore","backbone","localizer","views/utils/ErrorToolTipView","views/utils/ElapsedTimeView","models/user/ViewerSocialProfile","models/user/UserSettings","text!templates/user/UserExperienceSetupView.html","models/user/ViewerUserPreferences","utils/LocaleMapper","utils/ToolTipUtil","utils/diving/DiveUtil"],function(e){var t=e("underscore"),n=e("backbone"),r=e("localizer"),i=e("views/utils/ErrorToolTipView"),s=e("views/utils/ElapsedTimeView"),o=e("models/user/ViewerSocialProfile"),u=e("models/user/UserSettings"),a=e("text!templates/user/UserExperienceSetupView.html"),f=e("models/user/ViewerUserPreferences"),l=e("utils/LocaleMapper"),c=e("utils/ToolTipUtil"),h=e("utils/diving/DiveUtil"),p={ON_EXPERIENCES_SAVED:"ON_EXPERIENCES_SAVED",ON_SWITCHES_CHANGE:"ON_SWITCHES_CHANGE"},d=n.View.extend({template:t.template(a),propertyFiles:["/main/js/properties/common/common","/main/js/properties/main_container/main_container"],initialize:function(e){var t=e.saveEvent;this.marinePref=e.marinePref,this.userSettings=new u,this.userSettings.isReady=!0,t&&this.on(t,this.onCreateDashboardClicked)},render:function(){var e=l.getFullLocale(f.getLocale());this.$el.html(this.template({Localizer:r,locale:e,isMarineExperienceAvailable:this.isMarineExperienceAvailable()})),this.fitnessSwitch=this.$("#button-experience-fitness"),this.fitnessSwitch.on("change",this.onSwitchToggled.bind(this)),this.wellnessSwitch=this.$("#button-experience-wellness"),this.wellnessSwitch.on("change",this.onSwitchToggled.bind(this)),this.golfSwitch=this.$("#button-experience-golf"),this.golfSwitch.on("change",this.onSwitchToggled.bind(this)),this.diveSwitch=this.$("#button-experience-dive"),this.diveSwitch.on("change",this.onDiveSwitchToggled.bind(this)),this.marineSwitch=this.$("#button-experience-marine"),this.marineSwitch.on("change",this.onMarineSwitchToggled.bind(this)),this.updateSelections(),this.setupExternalBottomTimeView(),c.renderTooltips.call(this)},onCreateDashboardClicked:function(e){var n=this.getSelectedExperiences();this.userSetupIsValid()&&($(e).attr("disabled","disabled"),t.contains(n,"ROLE_DIVE_USER")&&(this.userSettings.setExternalBottomTime(this.externalBottomTimeView.calculateTime()),this.userSettings.save({})),this.saveExperiences(n))},userSetupIsValid:function(){var e=this.getSelectedExperiences(),t=this.$(".error-tooltip-active");return t.length===0&&e.length>0},getSelectedExperiences:function(){var e=[];return this.fitnessSwitch.is(":checked")&&e.push("ROLE_FITNESS_USER"),this.wellnessSwitch.is(":checked")&&e.push("ROLE_WELLNESS_USER"),this.golfSwitch.is(":checked")&&e.push("ROLE_OUTDOOR_USER"),this.diveSwitch.is(":checked")&&e.push("ROLE_DIVE_USER"),this.marineSwitch.is(":checked")&&e.push("ROLE_MARINE_USER"),e},saveExperiences:function(e){var t=this;jQuery.ajax({url:"/modern/proxy/dashboard-service/userExperience",type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",success:function(){t.refreshUserSession(e)}})},refreshUserSession:function(e){jQuery.post("/modern/refreshUserSession").always(function(){var n=o.get("userRoles");o.set("userRoles",t.union(n,e)),this.handleSideBarComponents(),this.trigger(p.ON_EXPERIENCES_SAVED),this.trigger("ON_CLOSE")}.bind(this))},onSwitchToggled:function(e){!this.golfSwitch.is(":checked")&&!this.fitnessSwitch.is(":checked")&&!this.wellnessSwitch.is(":checked")&&!this.marineSwitch.is(":checked")&&!this.diveSwitch.is(":checked")?(this.errorToolTipView=new i({el:jQuery(e.target).closest(".connect-checkbox"),content:r.localize("userexperience.dialog.no.activity.selected")}),this.errorToolTipView.render(),this.errorToolTipView.show()):this.errorToolTipView&&(this.errorToolTipView.hide(),this.errorToolTipView=null),this.trigger(p.ON_SWITCHES_CHANGE,this.getSelectedExperiences().length),this.updateSelections()},onMarineSwitchToggled:function(e){this.marineSwitch.is(":checked")?this.displayMarineTerms():this.hideMarineTerms(),this.onSwitchToggled(e)},onDiveSwitchToggled:function(e){this.diveSwitch.is(":checked")?(this.$("#externalBottomTime").show(),this.externalBottomTimeView.validator.validateInputNow()):(this.$("#externalBottomTime").hide(),this.externalBottomTimeView.validator.clearReport()),this.onSwitchToggled(e)},setupExternalBottomTimeView:function(){this.externalBottomTimeView=new s({el:this.$("#externalBottomTimePlaceholder"),idPrefix:"externalBottomTime_"+(new Date).getTime(),hideSeconds:!0,hourInputMaxLength:3,maxTime:h.maxSecondsOfBottomTime,maxExceededErrorKey:this.getExternalBottomTimeErrorKey}),this.externalBottomTimeView.render()},getExternalBottomTimeErrorKey:function(){return r.localize("user_experience_enter_a_time_less_than",h.maxHoursOfBottomTime)},updateSelections:function(){this.fitnessSwitch.is(":checked")?this.$(".fitness-experience-container").removeClass("disabled"):this.$(".fitness-experience-container").addClass("disabled"),this.wellnessSwitch.is(":checked")?this.$(".wellness-experience-container").removeClass("disabled"):this.$(".wellness-experience-container").addClass("disabled"),this.golfSwitch.is(":checked")?this.$(".golf-experience-container").removeClass("disabled"):this.$(".golf-experience-container").addClass("disabled"),this.diveSwitch.is(":checked")?this.$(".dive-experience-container").removeClass("disabled"):this.$(".dive-experience-container").addClass("disabled"),this.marineSwitch.is(":checked")?this.$(".marine-experience-container").removeClass("disabled"):this.$(".marine-experience-container").addClass("disabled")},handleSideBarComponents:function(){var e=o.get("userRoles");if(e.length===1&&e.indexOf("ROLE_MARINE_USER")!==-1)return;if(e.length===3&&e.indexOf("ROLE_CONNECTUSER")!==-1&&e.indexOf("ROLE_CONNECT_2_USER")!==-1&&e.indexOf("ROLE_MARINE_USER")!==-1)return;jQuery(".new-user").show()},isMarineExperienceAvailable:function(){return o.get("userRoles").indexOf("ROLE_MBTESTER")>-1||this.marinePref.get("value")==="true"},displayMarineTerms:function(){var e=this.$(".js-marine-terms");e.is(":visible")||e.css("display","block")},hideMarineTerms:function(){var e=this.$(".js-marine-terms");e.is(":visible")&&e.css("display","none")}});return d.Events=p,d}),define("text!templates/user/UserExperienceModalFooter.html",[],function(){return'<button class="btn" id="select-experience-save" disabled><%=\n    Localizer.localize(\'userexperience.dialog.create.dashboard\') %>\n</button>'}),define("views/user/UserExperienceModalPopupView",["require","underscore","localizer","views/main/Modal/ModalPopupView","views/user/UserExperienceSetupView","text!templates/user/UserExperienceModalFooter.html"],function(e){var t=e("underscore"),n=e("localizer"),r=e("views/main/Modal/ModalPopupView"),i=e("views/user/UserExperienceSetupView"),s=e("text!templates/user/UserExperienceModalFooter.html"),o={CREATE_DASHBOARD_CLICK:"CREATE_DASHBOARD_CLICK",ON_EXPERIENCES_SAVED:i.Events.ON_EXPERIENCES_SAVED,ON_SWITCHES_CHANGE:i.Events.ON_SWITCHES_CHANGE},u=r.extend({showFooter:!0,showCloseButton:!1,customClasses:"select-your-experience",options:{backdrop:"static",keyboard:!1},events:{"click #select-experience-save":"onCreateDashboardClick"},initialize:function(e){this.marinePref=e.marinePref,this.view=new i({saveEvent:o.CREATE_DASHBOARD_CLICK,marinePref:this.marinePref}),this.modalTitle=n.localize("userexperience.dialog.title"),this.footerTemplate=t.template(s),this.listenTo(this.view,o.ON_EXPERIENCES_SAVED,this.onExperiencesSaved),this.listenTo(this.view,o.ON_SWITCHES_CHANGE,this.onSwitchesChange),this.listenTo(this.view,"ON_CLOSE",this.close)},onCreateDashboardClick:function(e){e.preventDefault(),this.view.trigger(o.CREATE_DASHBOARD_CLICK,e.currentTarget)},onExperiencesSaved:function(){this.trigger(o.ON_EXPERIENCES_SAVED)},onSwitchesChange:function(e){var t=this.$("#select-experience-save");e===0?t.attr("disabled","disabled"):t.removeAttr("disabled")}});return u.Events=o,u}),function(e,t){typeof exports=="object"&&e.require?module.exports=t(require("underscore"),require("backbone")):typeof define=="function"&&define.amd?define("backbonetrackit",["underscore","backbone"],function(n,r){return t(n||e._,r||e.Backbone)}):t(_,Backbone)}(this,function(e,t){if(!t)throw new Error("backbone.trackit requires Backbone.");if(!e)throw new Error("backbone.trackit requires Underscore.");var n=[],r=function(t){e.isEmpty(t._unsavedChanges)?n=e.filter(n,function(e){return t.cid!=e.cid}):e.findWhere(n,{cid:t.cid})||n.push(t)},i=function(t){var r,i=e.rest(arguments),s=function(t,n){return e.isBoolean(n)?n:(e.isString(n)?t[n]:n).apply(t,i)};return e.each(n,function(e){!r&&s(e,e._unsavedConfig[t])&&(r=e._unsavedConfig.prompt)}),r};t.History.prototype.navigate=e.wrap(t.History.prototype.navigate,function(e,t,n){var r=i("unloadRouterPrompt",t,n);r?confirm(r+" \n\nAre you sure you want to leave this page?")&&e.call(this,t,n):e.call(this,t,n)}),window.onbeforeunload=function(e){return i("unloadWindowPrompt",e)},e.extend(t.Model.prototype,{unsaved:{},_trackingChanges:!1,_originalAttrs:{},_unsavedChanges:{},startTracking:function(){return this._unsavedConfig=e.extend({},{prompt:"You have unsaved changes!",unloadRouterPrompt:!1,unloadWindowPrompt:!1},this.unsaved||{}),this._trackingChanges=!0,this._resetTracking(),this._triggerUnsavedChanges(),this},stopTracking:function(){return this._trackingChanges=!1,this._originalAttrs={},this._unsavedChanges={},this._triggerUnsavedChanges(),this},restartTracking:function(){return this._resetTracking(),this._triggerUnsavedChanges(),this},resetAttributes:function(){if(!this._trackingChanges)return;return this.attributes=this._originalAttrs,this._resetTracking(),this._triggerUnsavedChanges(),this},unsavedAttributes:function(t){if(!t)return e.isEmpty(this._unsavedChanges)?!1:e.clone(this._unsavedChanges);var n,r=!1,i=this._unsavedChanges;for(var s in t){if(e.isEqual(i[s],n=t[s]))continue;(r||(r={}))[s]=n}return r},_resetTracking:function(){this._originalAttrs=e.clone(this.attributes),this._unsavedChanges={}},_triggerUnsavedChanges:function(){this.trigger("unsavedChanges",!e.isEmpty(this._unsavedChanges),e.clone(this._unsavedChanges),this),this.unsaved&&r(this)}}),t.Model.prototype.set=e.wrap(t.Model.prototype.set,function(t,n,r,i){var s,o;return n==null?this:(typeof n=="object"?(s=n,i=r):(s={})[n]=r,i||(i={}),o=t.call(this,s,i),this._trackingChanges&&!i.silent&&!i.trackit_silent&&(e.each(s,e.bind(function(t,n){e.isEqual(this._originalAttrs[n],t)?delete this._unsavedChanges[n]:this._unsavedChanges[n]=t},this)),this._triggerUnsavedChanges()),o)}),t.sync=e.wrap(t.sync,function(t,n,r,i){i||(i={});if(n=="update"||n=="create"||n=="patch")i.success=e.wrap(i.success,e.bind(function(e,t,n,i){var s;return e&&(s=e.call(this,t,n,i)),r._trackingChanges&&(r._resetTracking(),r._triggerUnsavedChanges()),s},this));return t(n,r,i)})}),define("routers/MainRouter",["require","underscore","jquery","backbone","localizer","models/user/ViewerSocialProfile","models/device/MyLastUsedDevice","collections/dashboard/WidgetStates","collections/dashboard/Dashboards","views/main/MainContainer/MainContainerView","views/main/Modal/ModalPopupView","views/utils/ToolTipView","views/utils/ErrorToolTipView","containers/connectwidget/ConnectWidgetContainer","containers/fullpage/PageContainer","utils/extensions/Loadable","utils/session/SessionManager","utils/NavigationUtil","models/whatsnew/WhatsNewExpirationInfo","models/user/UserPreference","views/user/UserExperienceModalPopupView","utils/AnalyticsUtil","utils/MainNavUtil","backbonetrackit"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("localizer"),s=e("models/user/ViewerSocialProfile"),o=e("models/device/MyLastUsedDevice"),u=e("collections/dashboard/WidgetStates"),a=e("collections/dashboard/Dashboards"),f=e("views/main/MainContainer/MainContainerView"),l=e("views/main/Modal/ModalPopupView"),c=e("views/utils/ToolTipView"),h=e("views/utils/ErrorToolTipView"),p=e("containers/connectwidget/ConnectWidgetContainer"),d=e("containers/fullpage/PageContainer"),v=e("utils/extensions/Loadable"),m=e("utils/session/SessionManager"),g=e("utils/NavigationUtil"),y=e("models/whatsnew/WhatsNewExpirationInfo"),b=e("models/user/UserPreference"),w=e("views/user/UserExperienceModalPopupView"),E=e("utils/AnalyticsUtil"),S=e("utils/MainNavUtil"),x=e("backbonetrackit");r.emulateHTTP=!0;var T=[],N,C=r.Router.extend({initialize:function(e){if(!e.userPreferences)throw"MainRouter: userPreferences required.";this.userPreferences=e.userPreferences,this.displayName=this.userPreferences.get("displayName"),this.dashboards=e.dashboards,this.urlBustValue=e.urlBustValue,this.viewerIsAuthenticated=!1,e.viewerIsAuthenticated?(this.viewerIsAuthenticated=!0,this.userPreferences.setPreferenceKey(s.get("profileId")),this.userPreferences.viewerIsAuthenticated=!0,this.sessionManager=new m(e.gAuthHost,e.sessionLength,e.webToken),this.sessionManager.bind(m.Events.SESSION_EXPIRED,this.onSessionExpired,this),this.sessionManager.bind(m.Events.SESSION_REAUTHENTICATING,this.onSessionReauthenticateStart,this),this.sessionManager.bind(m.Events.SESSION_REESTABLISHED,this.onSessionReathenticateFinish,this)):this.userPreferences.getLocaleFromCookie=!0,i.setUrlBustingParam(this.urlBustValue);var t=n("body");this.mainContainerView=new f({model:this.userPreferences,el:t,dashboards:this.dashboards,propertyFiles:e.propertyFiles,contextPath:e.contextPath,viewerIsAuthenticated:e.viewerIsAuthenticated,userProfile:e.userProfile,userPreferences:this.userPreferences,gAuthHost:e.gAuthHost,sessionLength:e.sessionLength}),this.mainContainerView.bind(f.Events.ON_ADD_WIDGET_CLICKED,this.onAddWidgetClicked,this),this.mainContainerView.bind(f.Events.ON_WIDGET_LIST_HIDDEN,function(){this.widgetContainerView&&this.widgetContainerView.removeOverlay()},this),this.mainContainerView.bind(f.Events.UNAUTHENTICATED_RENDER_COMPLETE,function(){t.find("#light_box_fade").remove()},this),this.mainContainerView.load(),this.bind("route",function(e,t){var n=g.getHostUrl()+g.url("/"+[e].concat(t).join("/"));E.push({event:"track_pageview",category:window.location.href,action:document.title}),typeof ENABLE_ADRUM!="undefined"&&ENABLE_ADRUM&&(N=new ADRUM.events.VPageView({url:window.location.href}),N.start())}),r.history.on("route",function(){this.mainContainerView.sidebar&&this.mainContainerView.sidebar.clearActiveNavItems()}.bind(this)),this.setLastUsedDeviceAplicationKeyGlobalVariable()},routes:{"dashboard/:dashboardId":"dashboard","":"dashboard","*notFound":"getResourceNotFoundRoute"},onSessionExpired:function(e){this.hideWaitCursor(),e?(this.on("route",function(){location.reload()},this),XMLHttpRequest.prototype.send=function(){location.reload()}):location.reload()},isErrorPage:function(){return ERROR_VIEW!=null},loadErrorPageView:function(){switch(ERROR_VIEW){case"resourceNotFoundRoute":this.getResourceNotFoundRoute();break;case"NoPrivilegesPageView":this.getNoPrivilegesPageView();break;case"RegistrationExceptions":this.getRegistrationExceptionPageView();break;case"FailedDependencies":this.getFailedDependenciesPageView()}},getFailedDependenciesPageView:function(){var t=this;e(["pages/dependencies/FailedDependenciesPageView"],function(e){var n=new e({userPreferences:t.userPreferences});t.displayPage(n)})},getRegistrationExceptionPageView:function(){var t=this;e(["models/user/ViewerUserPreferences","pages/registration_exceptions/RegistrationExceptionsPageView"],function(e,n){var r=new n({id:(new Date).getTime(),userPreferences:e});t.displayPage(r,!0)})},getNoPrivilegesPageView:function(){var t=this;e(["models/user/ViewerUserPreferences","pages/privileges/NoPrivilegesPageView"],function(e,n){var r="";window.location.href.indexOf("/activity/")>-1?r="privileges.activity":window.location.href.indexOf("/daily-summary")>-1?r="privileges.daily.summary":window.location.href.indexOf("/course/")>-1?r="privileges.course":window.location.href.indexOf("/newspost/")>-1?r="privileges.post":window.location.href.indexOf("/swing-analysis/")>-1&&(r="privileges.swing.analysis");var i=new n({userPreferences:e,id:(new Date).getTime(),authTypeKey:r,viewerIsAuthenticated:t.viewerIsAuthenticated});ERROR_VIEW=null,t.displayPage(i,!0)})},getResourceNotFoundRoute:function(){var t=this;e(["pages/resource_not_found/ResourceNotFound"],function(e){var n=new e({userPreferences:t.userPreferences,displayName:t.displayName});ERROR_VIEW=null,t.displayPage(n,!0)})},displayPage:function(e,t){this.closeModals(),c.hideAll(),h.hideAll(),typeof ENABLE_ADRUM!="undefined"&&ENABLE_ADRUM&&N&&e.once(v.Loadable.Events.ON_DEPENDENCIES_LOADED,function(){N.end(),ADRUM.report(N)});var r=typeof t=="undefined"&&this.isErrorPage();r?this.loadErrorPageView():this.pageContainerView?this.pageContainerView.setPageView(e):e.once(v.Loadable.Events.ON_DEPENDENCIES_LOADED,function(){this.removeExistingView(),this.pageContainerView=new d({model:this.userPreferences,el:n(".content")}),this.pageContainerView.setPageView(e),this.pageContainerView.registerApplicationEvent("DASHBOARDS:CREATED",this,this.onDashboardCreated),this.pageContainerView.registerApplicationEvent("RELOAD_DEVICES_POPUP_MENU",this,function(){this.mainContainerView.topHeader.devicePopupMenuView.load()}),this.pageContainerView.registerApplicationEvent("SHOW_WAIT_CURSOR",this,this.showWaitCursor),this.pageContainerView.registerApplicationEvent("HIDE_WAIT_CURSOR",this,this.hideWaitCursor)},this),r?this.pageContainerView.setPageView(e):e.once(v.Loadable.Events.ON_DEPENDENCIES_LOAD_FAILED,function(e){this.isForbidden(e)&&this.getNoPrivilegesPageView(),(this.isBadRequest(e)||this.isNotFound(e)||this.isServerError(e))&&this.getFailedDependenciesPageView()},this),r||(this.showWaitCursor(),e.load())},isBadRequest:function(e){return e.status===400},isServerError:function(e){return e.status===500},isNotFound:function(e){return e.status===404},isForbidden:function(e){return e.status===403},showWaitCursor:function(){n("body").addClass("wait")},hideWaitCursor:function(){n("body").removeClass("wait")},dashboard:function(e){parseInt(e,10)||(e=null),this.closeModals(),c.hideAll(),h.hideAll(),this.viewerIsAuthenticated==0&&this.isErrorPage()?this.loadErrorPageView():!this.dashboards.length||!s.hasUserExperience()?this.setupInitialUserExperience():this.displayDashboard(e)},displayDashboard:function(e){var t=null;if(!e){t=this.userPreferences.getLastDashboard();if(t!=null){var r=this.dashboards.get(t);r||(t=null)}t==null&&(t=this.dashboards.at(0).id)}else t=+e;if(t==S.activeDashboardId)return;S.activeDashboardId=t,this.userPreferences.setLastDashboard(S.activeDashboardId);var i=new u([],{dashboardId:S.activeDashboardId});this.widgetContainerView?this.widgetContainerView.setWidgetStates(i):(this.removeExistingView(),S.activeDashboardId=t,this.widgetContainerView=new p({collection:i,userPreferences:this.userPreferences,userProfile:this.mainContainerView.userProfile,widgetDefinitions:this.mainContainerView.widgetDefinitions,el:n(".content")}),this.widgetContainerView.bind(v.Loadable.Events.ON_DEPENDENCIES_LOADED,this.onWidgetContainerDependenciesLoaded,this),this.widgetContainerView.bind(p.Events.WIDGET_CONTAINER_LOADED,this.onWidgetContainerLoaded,this),this.listenTo(this.widgetContainerView,p.Events.ON_MANAGE_WIDGETS_CLICKED,function(){this.mainContainerView.widgetNav.toggleWidgetsList()}),this.widgetContainerView.load()),window.scrollTo(0,0)},setupInitialUserExperience:function(){var e=this,t=function(t){var n=new w({marinePref:t});n.render(),e.listenTo(n,w.Events.ON_EXPERIENCES_SAVED,e.onUserExperiencesSetup)},n=new b({key:"Marine.EnableInUxDialog"});n.fetch({success:t})},onUserExperiencesSetup:function(e){this.dashboards.fetch({async:!1}),this.mainContainerView.widgetDefinitions.fetch(),e||this.dashboard(),this.mainContainerView.renderSidebar()},removeExistingView:function(){n(".content").replaceWith('<div class="content clearfix"></div>'),S.activeDashboardId=null,this.widgetContainerView&&(this.widgetContainerView.onContainerUnloaded(),this.widgetContainerView=null),this.pageContainerView&&(this.pageContainerView.onContainerUnloaded(),this.pageContainerView=null)},index:function(){alert("default")},onWidgetContainerDependenciesLoaded:function(){},onWidgetContainerLoaded:function(){},onPageContainerDependenciesLoaded:function(){},onAddWidgetClicked:function(e){this.widgetContainerView||alert(i.localize("no_dashboard_to_add_widget")),this.widgetContainerView.createWidgetInstance(S.activeDashboardId,e,t.bind(this.onWidgetInstanceCreated,this))},onWidgetInstanceCreated:function(e){this.widgetContainerView.animateWidget(e.id)},raiseApplicationEvent:function(e,t){this.widgetContainerView&&this.widgetContainerView.raiseApplicationEvent.apply(this.widgetContainerView,arguments),this.pageContainerView&&this.pageContainerView.raiseApplicationEvent.apply(this.pageContainerView,arguments)},setLastUsedDeviceAplicationKeyGlobalVariable:function(){if(this.viewerIsAuthenticated&&t.isUndefined(window.lastUsedDeviceApplicationKey))var e=(new o).fetch({success:function(e){window.lastUsedDeviceApplicationKey=e.get("lastUsedDeviceApplicationKey")}})},registerModal:function(e){T.push(e)},closeModals:function(){t.each(T,function(e){e&&typeof e.close=="function"&&e.close()})},displayNoPrivilegesPage:function(){this.getNoPrivilegesPageView()},displayPageNotFoundPage:function(){this.getResourceNotFoundRoute()},onDashboardCreated:function(){this.onUserExperiencesSetup(!0)}});return C}),define("views/map/MapView",["underscore","backbone","localizer","views/map/MapViewUtils",window.location.href.indexOf("garmin.cn")!==-1?"views/map/DefaultMapView":"views/map/LeafletMapView"],function(e,t,n,r,i){var s={ON_MAP_READY:"ON_MAP_READY",ON_VISIBLE_TILES_LOADED:"ON_VISIBLE_TILES_LOADED",ON_MAP_PROVIDER_CHANGED:"ON_MAP_PROVIDER_CHANGED"},o={NOT_LOADED:"NOT_LOADED",PENDING:"PENDING",LOADED:"LOADED"},u={};u.google={key:"google",loadStatus:o.NOT_LOADED,moduleName:"garmingooglemaps",syncModel:new t.Model},u.bing={key:"bing",loadStatus:o.NOT_LOADED,moduleName:"garminbingmaps",syncModel:new t.Model},u.osm={key:"osm",loadStatus:o.NOT_LOADED,moduleName:"garminosmmaps",syncModel:new t.Model},u.BAIDU_V_1_4={key:"BAIDU_V_1_4",loadStatus:o.NOT_LOADED,moduleName:"garminbaidumaps",syncModel:new t.Model};var a=t.View.extend({initialize:function(t){if(!t.mapContainerId)throw"mapContainerId required for MapView";if(typeof t.width=="undefined")throw"Width is required for Map View";if(typeof t.height=="undefined")throw"Height is required for Map View";this.mapProvider=t.mapProvider,this.args=t,this.onReady=t.onReady,this.map=new i(e.defaults({el:this.el,mapProvider:this.mapProvider},t)),this.bindMapEvents()},bindMapEvents:function(){this.listenTo(this.map,s.ON_MAP_READY,this.onMapReady.bind(this)),this.listenTo(this.map,s.ON_MAP_PROVIDER_CHANGED,this.onMapProviderChanged.bind(this)),this.listenTo(this.map,s.ON_VISIBLE_TILES_LOADED,this.onVisibleTilesLoaded.bind(this))},onMapReady:function(){this.configureMap(),this.onReady&&this.onReady(),this.trigger(s.ON_MAP_READY)},configureMap:function(){this.args.cursorStyle&&this.map.changeCursorStyle(this.args.cursorStyle)},onMapProviderChanged:function(){this.trigger(s.ON_MAP_PROVIDER_CHANGED)},onVisibleTilesLoaded:function(){this.trigger(s.ON_VISIBLE_TILES_LOADED)},render:function(){this.map.render()},loadMap:function(){return this.map.loadMap()},isMapProviderValid:function(e){return!this.isBaiduEnabled()&&e==="BAIDU_V_1_4"?!1:!0},onAPIsLoaded:function(){return this.map.onAPIsLoaded()},zoomIn:function(){return this.map.zoomIn()},zoomOut:function(){return this.map.zoomOut()},addMarker:function(e,t,n,r,i,s){return this.map.addMarker(e,t,n,r,i,s)},bindPopupToMarker:function(e,t){return this.map.bindPopupToMarker(e,t)},addNumberedMarker:function(e,t,n,r,i,s,o){return this.map.addNumberedMarker(e,t,n,r,i,s,o)},addInfoBox:function(e,t){return this.map.addInfoBox(e,t)},removeInfoBox:function(e){return this.map.removeInfoBox(e)},removeMarker:function(e){return this.map.removeMarker(e)},removePolyline:function(e){return this.map.removePolyline(e)},setBounds:function(e,t){return this.map.setBounds(e,t)},closeInfoBoxes:function(){return this.map.closeInfoBoxes()},isInfoBoxOpen:function(e){return this.map.isInfoBoxOpen(e)},addPolyline:function(e,t){return this.map.addPolyline(e,t)},addEncodedPolyline:function(e,t){return this.map.addEncodedPolyline(e,t)},fitMapToPoints:function(e,t){return this.map.fitMapToPoints(e,t)},fitMapToPointsWithoutConvert:function(e){this.map.fitMapToPointsWithoutConvert(e)},convertPoint:function(e,t){this.map.convertPoint(e,t)},displayPrivacyZone:function(e,t,n,r){return this.map.displayPrivacyZone(e,t,n,r)},displayPrivacyZoneMap:function(e,t,n,r,i,s,o,u,a){return this.map.displayPrivacyZoneMap(e,t,n,r,i,s,o,u,a)},formatPointAsObject:function(e){return this.map.formatPointAsObject(e)},changeMapProvider:function(e){return this.map.changeMapProvider(e)},addClickHandler:function(e,t){return this.map.addClickHandler(e,t)},changeCursorStyle:function(e){return this.map.changeCursorStyle(e)},getMapProvider:function(){return this.map.getMapProvider()},getMapProviderType:function(){return this.map.getMapProviderType()},enableTerrain:function(e){return this.map.enableTerrain(e)},enableTrails:function(e){return this.map.enableTrails(e)},enableLabels:function(e){return this.map.enableLabels(e)},enableHeatMaps:function(e,t){return this.map.enableHeatMaps(e,t)},hasTerrainSupport:function(){return this.map.hasTerrainSupport()},hasTrailSupport:function(){return this.map.hasTrailSupport()},hasHeatmapSupport:function(){return this.map.hasHeatmapSupport()},hasLabelSupport:function(){return this.map.hasLabelSupport()},loadMapProvider:function(e){return this.map.loadMapProvider()},isBaiduEnabled:function(){return this.map.isBaiduEnabled()},searchForLocation:function(e,t){this.map.searchForLocation(e,t)},displayAreaSelectionTool:function(e){return this.map.displayAreaSelectionTool(e)},removeAreaSelectionTool:function(){return this.map.removeAreaSelectionTool()},addTilesOverlay:function(e,t){this.map.addTilesOverlay(e,t||{})},zoomInMapToUsersLocation:function(e,t,n){return this.map.zoomInMapToUsersLocation(e,t,n)},zoomInMapToSpecificLocation:function(e){return this.map.zoomInMapToSpecificLocation(e)},limitZoomOnMouseWheel:function(){return this.map.limitZoomOnMouseWheel()},disableDoubleClickZoom:function(){return this.map.disableDoubleClickZoom()},displayCustomCircle:function(e){return this.map.displayCustomCircle(e)},displayCustomMarker:function(e,t){return this.map.displayCustomMarker(e,t)},getEventPoint:function(e){return this.map.getEventPoint(e)},getDraggingEventPoint:function(e){return this.map.getDraggingEventPoint(e)},getLocationPoint:function(e){return this.map.getLocationPoint(e)},getMapPoint:function(e){return this.map.getMapPoint(e)},searchAddressByPosition:function(e,t){this.map.searchAddressByPosition(e,t)},changeMapStyle:function(e){return this.map.changeMapStyle(e)},remove:function(){if(this.map)return this.map.remove()},getMapCenterZoom:function(){return this.map.getMapCenterZoom()},getUrlVars:function(){return this.map.getUrlVars()},disableBaidu:function(){this.map.baiduMapsDisabled()},mapHasBeenInitialized:function(){return this.map?this.map.mapHasBeenInitialized:!1},getTrails:function(){this.map.hasTrailSupport()},toggleBicycleLayer:function(e){this.map.toggleBicycleLayer(e)},setView:function(e,t){this.map.setView(e,t)},locate:function(t){var n={setView:!0};this.map.locate(e.extend(n,t))},addLineListener:function(e,t,n){this.map.addLineListener(e,t,n)},addMapListener:function(e,t){this.map.addMapListener(e,t)},getTargetZoom:function(){return this.map.getTargetZoom()},resizeMap:function(){return this.map.resizeMap()},toProprietaryEventName:function(e){return this.map.toProprietaryEventName(e)},onWindowResized:function(){window.matchMedia("(max-width: 767px)").matches?(this.showScrollToggleButton(),this.mapProvider!=="google"&&this.$el.addClass("pointer-events-none")):(this.hideScrollToggleButton(),this.$el.removeClass("pointer-events-none"));var e=this.$el.hasClass("pointer-events-none")?n.localize("enable_scrolling"):n.localize("disable_scrolling");this.setTextForEnableDisableScrollButton(e)},setTextForEnableDisableScrollButton:function(e){this.$(".map-control-item.scrolling").text(e)},hideScrollToggleButton:function(){this.$(".map-control-item.scrolling").addClass("hide")},showScrollToggleButton:function(){this.$(".map-control-item.scrolling").removeClass("hide")}});return a.Events=s,a}),define("text!templates/utils/InlineEditView.html",[],function(){return'<<%= tag %> href="<%= url %>" class="inline-edit-target <%= customClasses %>" title="<%= value %>"><%= value %>\n<% if (label) {     %>\n    <%= label %>\n<% }                %>\n</<%= tag %>>\n\n<button class="inline-edit-trigger modal-trigger">\n    <i class="icon-pencil"></i>\n</button>\n\n<div class="inline-edit-editable">\n    <div class="inline-edit-editable-text" style="min-width: 15px;" contenteditable="true"><%= value %></div>\n    <span class="inline-edit-actions">\n        <button class="inline-edit-save icon-checkmark"></button>\n        <button class="inline-edit-cancel icon-close"></button>\n    </span>\n</div>\n    \n\n'}),define("views/utils/InlineEditView",["underscore","backbone","localizer","personalizer","utils/NavigationUtil","text!templates/utils/InlineEditView.html"],function(e,t,n,r,i,s){var o={CHANGE:"CHANGE",EDIT:"EDIT",PRE_CANCEL:"PRE_CANCEL",CANCEL:"CANCEL"},u={BACKSPACE:8,DELETE:46,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},a=t.View.extend({template:e.template(s),events:{"click .inline-edit-target":"onInlineEditTargetClicked","click .inline-edit-trigger":"onInlineEditTriggered","click .inline-edit-save":"onInlineEditSaveClicked","click .inline-edit-cancel":"onInlineEditCancelled","keydown .inline-edit-editable-text":"onInputKeyDown"},initialize:function(e){this.tag=e.tag||"a",this.customClasses=e.customClasses||"",this.label=e.label||"",this.value=e.value,this.formatClass=e.formatClass||"",this.url=e.url,this.disableEditOnClickText=e.disableEditOnClickText,this.maxLength=e.maxLength,this.minLength=e.minLength,this.disableEditOnClickText||(this.disableEditOnClickText=!1),typeof this.value=="undefined"&&(this.value=""),this.AcceptableList=[u.BACKSPACE,u.DELETE,u.ARROW_LEFT,u.ARROW_RIGHT,u.ARROW_UP,u.ARROW_DOWN]},defaultFormatFunc:function(e){return e},render:function(){this.$el.removeClass("edit"),this.$el.addClass(this.formatClass+" inline-edit inline-edit-text-field"),this.$el.html(this.template({Localizer:n,Personalizer:r,value:this.value,label:this.label,url:this.url||"#",tag:this.tag,customClasses:this.customClasses}))},onInlineEditTargetClicked:function(e){this.url?i.anchorTagHandler(e):this.disableEditOnClickText?e.preventDefault():this.onInlineEditTriggered(e)},onInlineEditTriggered:function(e){e.preventDefault(),this.$el.addClass("edit"),this.$(".inline-edit-target").hide(),this.$(".inline-edit-editable").show(),this.$(".inline-edit-editable-text").focus(),this.setSelected(),this.trigger(o.EDIT)},onInlineEditCancelled:function(e){this.trigger(o.PRE_CANCEL),e.preventDefault(),e.stopPropagation(),this.render(),this.trigger(o.CANCEL)},onInlineEditSaveClicked:function(e){e.preventDefault(),e.stopPropagation(),this.processInput()},processInput:function(){var t=this.$(".inline-edit-editable-text").text().trim();if(!e.isUndefined(this.minLength)&&t.length<this.minLength)return;this.value=t,this.maxLength&&this.value.length>this.maxLength&&(this.value=this.value.substring(0,this.maxLength)),this.trigger(o.CHANGE,this.value)},onInputKeyDown:function(e){e.keyCode===13&&(e.preventDefault(),this.processInput()),this.maxLength&&e.target.textContent.length>=this.maxLength&&this.AcceptableList.indexOf(e.keyCode)==-1&&e.preventDefault()},setSelected:function(){var e=this.$(".inline-edit-editable-text")[0],t,n;document.body.createTextRange?(t=document.body.createTextRange(),t.moveToElementText(e),t.select()):window.getSelection&&(n=window.getSelection(),t=document.createRange(),t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t))}});return a.Events=o,a}),define("text!templates/utils/InlineDropDownListView.html",[],function(){return'<div class="dropdown">\n    <button data-toggle="dropdown" data-value="<%= selectedItem.value %>">\n        <span class="<%= formatClass %>"><%= selectedItem.name || Localizer.localize(selectedItem.nameKey) %></span>\n        <i class="icon-pointer-down"></i>\n    </button>\n    <ul class="dropdown-menu pull-left" role="menu" aria-labelledby="dropdownMenu">\n\n        <% for (var i = 0; i < items.length; i++) {         %>\n        <% var item = items[i];                             %>\n            <li data-value="<%= item.value %>"><a tabindex="-1" href="#"><%= item.name || Localizer.localize(item.nameKey) %></a></li>\n            <% if (typeof item.children != \'undefined\') {              %>\n                <% for (var j = 0; j < item.children.length; j++) { %>\n                <%  var childItem = item.children[j];               %>\n                    <li data-value="<%= childItem.value %>"><a tabindex="-1" href="#" class="dropdown-tier"><%= childItem.name || Localizer.localize(childItem.nameKey) %></a></li>\n                <% }                                                %>\n            <% }                                                %>\n            <li class="divider"></li>\n        <% }                                                %>\n    </ul>\n</div>\n'}),define("views/utils/InlineDropDownListView",["underscore","backbone","localizer","personalizer","text!templates/utils/InlineDropDownListView.html"],function(e,t,n,r,i){var s={CHANGE:"CHANGE"},o=t.View.extend({template:e.template(i),events:{"click li":"onInlineSelectionChanged"},initialize:function(e){this.formatClass=e.formatClass||"",this.value=e.value,this.items=e.items,this.label=e.label,this.scrollable=!0,typeof e.scrollable!="undefined"&&(this.scrollable=e.scrollable);if(typeof this.items=="undefined")throw"Items are required for InlineDropDownListView";if(typeof this.value=="undefined")throw"Value is required for InlineDropDownListView";this.options=e.options||{}},render:function(){var e=this.findItem(this.value);return this.scrollable&&this.$el.addClass("inline-edit inline-edit-select"),this.$el.html(this.template({Localizer:n,Personalizer:r,formatClass:this.formatClass,className:this.className,items:this.items,selectedItem:e,label:this.label,useSelect:this.useSelect,options:this.options})),this.$("[data-value="+this.value+"]").addClass("active"),this},findItem:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];if(n.value==e)return n;if(typeof n.children!="undefined")for(var r=0;r<n.children.length;r++){var i=n.children[r];if(i.value==e)return i}}return null},onInlineSelectionChanged:function(e){e.preventDefault();var t=jQuery(e.currentTarget).data("value");t!=this.value&&(this.value=t,this.trigger(s.CHANGE,this.value)),this.render()}});return o.Events=s,o}),define("views/main/WidgetStateView",["underscore","backbone","views/sharing/SharingView","models/user/ViewerUserPreferences"],function(e,t,n,r){var i=t.View.extend({titleKeyName:"",menuKeyName:"",name:null,stateClassName:"",templateHtml:"",noDataTemplateHtml:"",enableConversation:!1,conversationResourceType:null,shareUrl:null,sharePrivacy:"private",showHelpIcon:!1,showHelpIconCss:"",initialize:function(e){this.widgetState=e.widgetState,this.widgetView=e.widgetView,this.userPreferences=e.userPreferences,this.userProfile=e.userProfile;if(!this.widgetState)throw"WidgetState required for WidgetStateView";if(!this.widgetView)throw"WidgetView required for WidgetStateView";if(!this.userPreferences)throw"WidgetView required for UserPreferences";this.initializeWidgetState&&this.initializeWidgetState(),this.initialized=!0},moveToPage:function(e,t){this.widgetView.moveToPage(e)},calculateNumPages:function(e,t){return e>0?Math.ceil(e/t):0},closeWidgetSheet:function(){this.widgetView.closeWidgetSheet()},displaySheet:function(e,t,n){this.widgetView.displaySheet(e,t,n)},displayTakeover:function(e,t){this.widgetView.displayTakeover(e,t)},closeWidgetTakeover:function(){this.widgetView.closeWidgetTakeover()},getDisplayName:function(){return r.get("displayName")},getCurrentPageIndex:function(){return this.widgetView.pageIndex},setCurrentPageIndex:function(e){this.widgetView.pageIndex=e},addCustomMenuItem:function(e,t,n){if(!this.initialized)throw"Custom menu item can't be added until WidgetStateView has been initialized.";this.widgetView.addCustomMenuItem(e,t,n)},render:function(){this.widgetView.render()},reload:function(){this.widgetView.reload()},raiseApplicationEvent:function(e){this.widgetView.raiseApplicationEvent.apply(this.widgetView,arguments)},createShareView:function(e,t){return new n({privacy:e,url:t,locale:this.userPreferences.get("preferredLocale"),customClasses:"widget-dropdown widget-footer-action",slideDirection:n.SlideDirection.Up})},fetchMore:function(){this.widgetView.fetchMoreComplete()},fetchMoreComplete:function(){this.widgetView.fetchMoreComplete()},updateTemplate:function(e,t){this.widgetView.updateTemplate(e,t)},isLoaded:function(){return this.widgetView.isLoaded()}});return i}),define("text!templates/main/Widget/SmallWidgetContent.html",[],function(){return'<%\n    var headerUrl = (typeof(view.headerUrl) === \'function\') ? view.headerUrl.call(this) : view.headerUrl\n%>\n\n<a href="<%= url(headerUrl) %>" class="small-widget-link">\n    <div class="feature-icon">\n        <% if (typeof classIconName !== \'undefined\') { %>\n        <i class="<%= classIconName %>"></i>\n        <% } %>\n    </div>\n    <div class="small-widget-title h4"><%= Localizer.localize(view.titleKeyName) %></div>\n</a>\n'}),define("text!templates/map/SmallMapControlsView.html",[],function(){return'<button class="zoomIn map-control-item" xmlns="http://www.w3.org/1999/html">\n    <i class="icon-add"></i>\n</button>\n<button class="zoomOut map-control-item">\n    <i class="icon-minus"></i>\n</button>\n\n\n<div class="dropdown map-control-item">\n    <button class="dropdown-trigger" data-toggle="dropdown">\n        <i class="icon-layers"></i>\n    </button>\n    <ul class="dropdown-menu">\n        <li class="map-provider-google"><a href="#"><%= Localizer.localize(\'map.control.google\') %></a></li>\n        <li class="map-provider-bing"><a href="#"><%= Localizer.localize(\'map.control.bing\') %></a></li>\n        <li class="map-provider-osm"><a href="#"><%= Localizer.localize(\'map.control.osm\') %></a></li>\n        <li class="map-provider-BAIDU_V_1_4" style="display: none;"><a href="#"><%= Localizer.localize(\'map.control.baidu\') %></a></li>\n        <li class="divider"></li>\n        <li class="map-type-road"><a href="#"><%= Localizer.localize(\'map.control.road\') %></a></li>\n        <li class="map-type-satellite"><a href="#"><%= Localizer.localize(\'map.control.satellite\') %></a></li>\n        <li class="divider"></li>\n        <li class="map-layer-terrain">\n            <label>\n                <input type="checkbox" style="display: none"><%= Localizer.localize(\'map.control.terrain\') %></input>\n            </label>\n        </li>\n        <li class="map-layer-trails">\n            <label>\n                <input type="checkbox" style="display: none"><%= Localizer.localize(\'map.control.trails\') %></input>\n            </label>\n        </li>\n        <li class="map-layer-labels">\n            <label>\n                <input type="checkbox" style="display: none"><%= Localizer.localize(\'map.control.labels\') %></input>\n            </label>\n        </li>\n        <% if (!hideHeatMaps) { %>\n        <li class="divider"></li>\n        <li class="map-layer-running-heatmap">\n            <label>\n                <input type="checkbox" style="display: none"><%= Localizer.localize(\'map.control.heatmap.running.heatmap\') %></input>\n            </label>\n        </li>\n        <li class="map-layer-cycling-heatmap">\n            <label>\n                <input type="checkbox" style="display: none"><%= Localizer.localize(\'map.control.heatmap.cycling.heatmap\') %></input>\n            </label>\n        </li>\n        <% } %>\n        <li class="map-coordinate-system" style="display: none">\n            <a href="#"><%= Localizer.localize(\'map.control.map_match\') %></a>\n        </li>\n    </ul>\n</div>\n'});if(Garmin==undefined)var Garmin={};Garmin.service==undefined&&(Garmin.service={});var defaultCallbacks={onFailure:function(e){alert(e.statusText)}};Garmin.service.Client=function(e){this.config=e},Garmin.service.Client.prototype={getResource:function(e,t,n){jQuery.ajax({url:e,type:"GET",data:t,success:n.onSuccess,error:n.onFailure})},getResourceJsonp:function(e,t,n){jQuery.ajax({url:e,type:"GET",dataType:"jsonp",data:t,success:n.onSuccess,error:n.onFailure})},postResource:function(e,t,n){jQuery.ajax({url:e,type:"POST",data:t,success:n.onSuccess,error:n.onFailure})}},define("client",function(){});if(Garmin==undefined)var Garmin={};Garmin.service==undefined&&(Garmin.service={});var userClientConstants={USER_SERVICE_JSON_URL:"/modern/proxy/user-service-1.0/json/",DISPLAYNAME_VALIDATION_DEFAULT_URL:"https://sso.garmin.com/sso",DISPLAYNAME_VALIDATION:"validateNewAccount",PREFERENCES:"preferences",USER_PREFERENCE:"user_preference",USER_PREFERENCES:"user_preferences",USER:"user",ACCOUNT:"account",DISPLAY:"display",MAP_PROVIDER_TYPE:"map_provider_type",GENDER:"gender",WEIGHT:"weight",VO2_MAX:"vO2Max",HEIGHT:"height",ACTIVITY_CLASS:"activity_class",LIFETIME_ATHLETE:"lifetime_athlete",PRIVACY:"privacy",HR_ZONES:"heart_rate_zones",POWER_ZONES:"power_zones",BIRTH:"birth_date",TIMEZONE:"timezone",MEASURE:"measurement_unit_system",DAY_OF_WEEK:"day",HRDISPLAY:"heart_rate_display",POWER_DISPLAY:"power_display",DATE_FORMAT:"date_format",NUMBER_FORMAT:"number_format",TIME_FORMAT:"time_format",USERNAME_AVAILABLE:"username_available",DISPLAYNAME:"display_name",HEALTH_DATA:"health_data",OPT_IN:"opt_in_notifications",OPT_OUT:"opt_out_notifications",PR_SPORT:"PersonalRecord.defaultSport",EMAIL_FRIEND_REQUEST:"email_friend_request",EMAIL_FRIEND_REQUEST_CONFIRMATION:"email_friend_confirmation_request",EMAIL_ACTIVITY_COMMENT:"email_activity_comment",EMAIL_EARLIER_ACTIVITY_COMMENT:"email_earlier_activity_comment",EMAIL_SEGMENT_COMMENT:"email_comment_segments_notifications",EMAIL_SEGMENT_UPDATES:"email_segment_update_notifications"};Garmin.service.settingsClient=function(e){this.config=e},Garmin.service.settingsClient.prototype=new Garmin.service.Client,Garmin.service.settingsClient.prototype.getMapProviderType=function(e){this.getResource(userClientConstants.USER_SERVICE_JSON_URL+userClientConstants.MAP_PROVIDER_TYPE,{random:(new Date).getTime()},e)},Garmin.service.settingsClient.prototype.updateMapProviderType=function(e,t){this.postResource(userClientConstants.USER_SERVICE_JSON_URL+userClientConstants.USER_PREFERENCE,{key:"map_provider_type",value:e},t)},Garmin.service.settingsClient.prototype.isDisplaynameAvailable=function(e,t){var n=userClientConstants.DISPLAYNAME_VALIDATION_DEFAULT_URL;typeof bundle_user_profile_api!="undefined"&&typeof bundle_user_profile_api.sso_host_url!="undefined"&&(n=bundle_user_profile_api.sso_host_url),this.getResourceJsonp(n+"/"+userClientConstants.DISPLAYNAME_VALIDATION,{clientId:"GarminConnect",newDisplayName:e},t)},Garmin.service.settingsClient.prototype.getPrivacy=function(e){this.getResource(userClientConstants.USER_SERVICE_JSON_URL+userClientConstants.PRIVACY,{random:Math.floor(Math.random()*1e3)},e)},Garmin.service.settingsClient.prototype.updatePrivacy=function(e,t){this.postResource(userClientConstants.USER_SERVICE_JSON_URL+userClientConstants.USER_PREFERENCE,{key:"default_activity_visibility_flag",value:e},t)},define("settingsclient",["client"],function(){}),define("views/map/SmallMapControlsView",["underscore","backbone","localizer","models/user/UserPreference","views/map/MapView","text!templates/map/SmallMapControlsView.html","settingsclient"],function(e,t,n,r,i,s){var o={ON_MAP_PROVIDER_CHANGED:"ON_MAP_PROVIDER_CHANGED"},u=t.View.extend({settingsClient:new Garmin.service.settingsClient,events:{'click [class^="map-provider-"]':"onMapProviderSelected",'click [class^="map-type-"]':"onMapTypeSelected","click .map-layer-terrain":"onMapStyleTerrainSelected","click .map-layer-trails":"onMapStyleTrailsSelected","click .map-layer-labels":"onMapStyleLabelsSelected","click .map-layer-running-heatmap":"onMapStyleRunningHeatmapSelected","click .map-layer-cycling-heatmap":"onMapStyleCyclingHeatmapSelected","click .map-coordinate-system":"onMapCoordinateSystemSelected","click .zoomIn":"onZoomInClicked","click .zoomOut":"onZoomOutClicked"},initialize:function(t){if(!t.mapView)throw"MapView object required by MapControls";this.mapType="road",this.layersEnabled=[],this.userMapSetting=t.userMapSetting,this.mapView=t.mapView,this.hideHeatMaps=t.hideHeatMaps,this.template=e.template(s),this.mapView.once(i.Events.ON_MAP_READY,this.onMapReady,this)},onMapReady:function(){if(this.userMapSetting){this.mapType=this.userMapSetting.getMapType(),this.mapView.changeMapStyle(this.mapType);var e=this.userMapSetting.getTerrain();e==1&&this.mapView.hasTerrainSupport()&&(this.mapType==Garmin.Map.Utils.MAP_STYLE_ROAD&&this.mapView.changeMapStyle(Garmin.Map.Utils.MAP_STYLE_TERRAIN),this.toggleLayerEnabled("terrain"));var t=this.userMapSetting.getTrails();t==1&&this.mapView.hasTrailSupport()&&(this.mapView.toggleBicycleLayer(!0),this.toggleLayerEnabled("trails"));var n=this.userMapSetting.getLabels();n==1&&(this.mapView.hasLabelSupport()&&this.mapType==Garmin.Map.Utils.MAP_STYLE_SATELLITE&&this.mapView.changeMapStyle(Garmin.Map.Utils.MAP_STYLE_HYBRID),this.toggleLayerEnabled("labels"));var r=this.userMapSetting.getHeatMapsRunning();r&&this.mapView.hasHeatmapSupport()&&(Garmin.Map.Utils.activityType="running",this.mapView.enableHeatMaps(!0,"running"),this.toggleLayerEnabled("running-heatmap"));var i=this.userMapSetting.getHeatMapsCycling();i&&this.mapView.hasHeatmapSupport()&&(Garmin.Map.Utils.activityType="cycling",this.mapView.enableHeatMaps(!0,"cycling"),this.toggleLayerEnabled("cycling-heatmap"))}this.render()},render:function(){this.$el.html(this.template({Localizer:n,hideHeatMaps:this.hideHeatMaps}));var t=this.mapProvider?this.mapProvider:this.mapView.getMapProviderType(),r=this.$(".map-provider-"+t);r.addClass("active"),t===Garmin.Map.Utils.PROVIDER_TYPE_OSM&&(this.mapType="road",this.$(".map-type-satellite").hide());var i=this.$(".map-type-"+this.mapType);i.addClass("active"),e.each(this.layersEnabled,function(e){var t=this.$(".map-layer-"+e);t.addClass("active multiple")},this),(this.mapType!=Garmin.Map.Utils.MAP_STYLE_ROAD||!this.mapView.hasTerrainSupport())&&this.$(".map-layer-terrain").addClass("disabled"),this.mapView.hasTrailSupport()||this.$(".map-layer-trails").addClass("disabled"),(this.mapType!=Garmin.Map.Utils.MAP_STYLE_SATELLITE||!this.mapView.hasLabelSupport())&&this.$(".map-layer-labels").addClass("disabled"),this.mapView.hasHeatmapSupport()||(this.$(".map-layer-running-heatmap").addClass("disabled"),this.$(".map-layer-cycling-heatmap").addClass("disabled"));if(this.mapView.disableBaidu())this.$(".map-provider-BAIDU_V_1_4").remove();else{var s=window.location.href;s.indexOf("garmin.cn")!=-1&&(this.$(".map-provider-google").remove(),this.$(".map-provider-bing").remove(),this.$(".map-provider-osm").remove())}this.mapView.getMapProviderType()==Garmin.Map.Utils.PROVIDER_TYPE_BAIDU&&this.$(".map-coordinate-system").show()},onZoomInClicked:function(e){e.preventDefault(),this.mapView.zoomIn()},onZoomOutClicked:function(e){e.preventDefault(),this.mapView.zoomOut()},onMapProviderSelected:function(e){e.preventDefault();if(this.$(e.currentTarget).hasClass("active"))return;var t=e.currentTarget.className.substring(13);if(this.userMapSetting){var n=new r({key:"map_provider_type",value:t});n.save()}t===Garmin.Map.Utils.PROVIDER_TYPE_OSM?this.$(".map-type-satellite").hide():this.$(".map-type-satellite").show(),this.mapProvider=t,this.trigger(o.ON_MAP_PROVIDER_CHANGED,t)},onMapTypeSelected:function(e){e.preventDefault();var t=e.currentTarget.className.substring(9);t.indexOf("active")==-1&&(this.userMapSetting&&(this.userMapSetting.setMapType(t),this.userMapSetting.save()),this.mapType=t,this.mapView.changeMapStyle(t),this.isLayerEnabled("labels")&&this.$(".map-layer-labels").hasClass("disabled")&&(this.userMapSetting.setLabels(!0),this.userMapSetting.save(),setTimeout(function(){this.mapView.enableLabels(!0)}.bind(this),0))),this.render()},onMapStyleTerrainSelected:function(e){e.preventDefault();var t=jQuery(e.currentTarget);if(t.hasClass("disabled"))return;var n=!this.isLayerEnabled("terrain");this.userMapSetting&&(this.userMapSetting.setTerrain(n),this.userMapSetting.save()),this.mapView.enableTerrain(n),this.toggleLayerEnabled("terrain"),this.render()},onMapStyleTrailsSelected:function(e){e.preventDefault();var t=jQuery(e.currentTarget);if(t.hasClass("disabled"))return;var n=!this.isLayerEnabled("trails");this.userMapSetting&&(this.userMapSetting.setTrails(n),this.userMapSetting.save()),this.mapView.enableTrails(n),this.toggleLayerEnabled("trails"),this.render()},onMapStyleLabelsSelected:function(e){e.preventDefault();var t=jQuery(e.currentTarget);if(t.hasClass("disabled"))return;var n=!this.isLayerEnabled("labels");this.userMapSetting&&(this.userMapSetting.setLabels(n),this.userMapSetting.save()),this.mapView.enableLabels(n),this.toggleLayerEnabled("labels"),this.render()},onMapStyleRunningHeatmapSelected:function(e){e.preventDefault();var t=jQuery(e.currentTarget);if(t.hasClass("disabled"))return;var n=!this.isLayerEnabled("running-heatmap");this.userMapSetting&&(this.userMapSetting.setHeatMapsRunning(n),n&&this.userMapSetting.setHeatMapsCycling(!n),this.userMapSetting.save()),this.mapView.enableHeatMaps(n,"running"),this.toggleLayerEnabled("running-heatmap"),n==1&&this.isLayerEnabled("cycling-heatmap")&&this.toggleLayerEnabled("cycling-heatmap"),this.render()},onMapStyleCyclingHeatmapSelected:function(e){e.preventDefault();var t=jQuery(e.currentTarget);if(t.hasClass("disabled"))return;var n=!this.isLayerEnabled("cycling-heatmap");this.userMapSetting&&(this.userMapSetting.setHeatMapsCycling(n),n&&this.userMapSetting.setHeatMapsRunning(!n),this.userMapSetting.save()),this.mapView.enableHeatMaps(n,"cycling"),this.toggleLayerEnabled("cycling-heatmap"),n==1&&this.isLayerEnabled("running-heatmap")&&this.toggleLayerEnabled("running-heatmap"),this.render()},onMapCoordinateSystemSelected:function(e){e.preventDefault();var t=this.mapView.getMapProvider();typeof t.toggleCoordinateSystem!="undefined"&&t.toggleCoordinateSystem()},toggleLayerEnabled:function(t){var n=e.find(this.layersEnabled,function(e){return e==t});n?this.layersEnabled=e.reject(this.layersEnabled,function(e){return e==t}):this.layersEnabled.push(t)},isLayerEnabled:function(t){var n=e.find(this.layersEnabled,function(e){return e==t});return n!=null},setTextForEnableDisableScrollButton:function(e){this.$(".map-control-item.scrolling").text(e)},hideScrollToggleButton:function(){this.$(".map-control-item.scrolling").addClass("hide")},showScrollToggleButton:function(){this.$(".map-control-item.scrolling").removeClass("hide")}});return u.Events=o,u}),define("constants/main/ApplicationEvents",[],function(){return{ACTIVITY_ADDED:"ACTIVITY_ADDED",ACTIVITY_CHANGED:"ACTIVITY_CHANGED",MYFITNESSPAL_SETUP_COMPLETE:"MYFITNESSPAL_SETUP_COMPLETE",ACTIVE_ACTIVITY_TRACKER_CHANGED:"ACTIVE_ACTIVITY_TRACKER_CHANGED",SLEEP_WINDOW_CHANGED:"SLEEP_WINDOW_CHANGED",SEGMENT_OPTED_IN_CHANGED:"SEGMENT_OPTED_IN_CHANGED",FTP_WEIGHT_CHANGED:"FTP_WEIGHT_CHANGED"}}),define("utils/validators/RegularExpressionValidator",["utils/validators/Validator"],function(e){var t={RegExFailed:"invalid_chars"},n={};n.Url=/^((([hH][tT][tT][pP][sS]?|[fF][tT][pP])\:\/\/)?([\w\.\-]+(\:[\w\.\&%\$\-]+)*@)?((([^\s\(\)\<\>\\\"\.\[\]\,@;:]+)(\.[^\s\(\)\<\>\\\"\.\[\]\,@;:]+)*(\.[a-zA-Z]{2,4}))|((([01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}([01]?\d{1,2}|2[0-4]\d|25[0-5])))(\b\:(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]\d{4}|[1-9]\d{0,3}|0)\b)?((\/[^\/][\w\.\,\?\'\\\/\+&%\$#\=~_\-@]*)*[^\.\,\?\"\'\(\)\[\]!;<>{}\s\x7F-\xFF])?)$/i,n.Twitter=/^@?[a-zA-Z0-9_]{1,15}$/i;var r=e.extend({initialize:function(e){this.initializeRegularExpressionValidator(e)},initializeRegularExpressionValidator:function(e){this.initializeValidator(e);if(!e.regularExpression)throw"Regular expression required for RegularExpressionValidator.";this.regularExpression=e.regularExpression},validateInput:function(e){return this.validateRegEx(e)},validateRegEx:function(e){if(!e||e.length==0)return;var n=new RegExp(this.regularExpression);if(n.test(e))return;return t.RegExFailed}});return r.Errors=t,r.RegularExpressions=n,r}),define("utils/validators/RequiredValidator",["utils/validators/RegularExpressionValidator"],function(e){var t={Required:"required"},n=e.extend({initialize:function(e){e.regularExpression=e.regularExpression||"\\S{1}.?",this.initializeRegularExpressionValidator(e)},validateInput:function(e){return this.validateExistence(e)},validateExistence:function(e){return!e||e.length<1?t.Required:this.validateRegEx(e)}});return n}),define("utils/parsers/DateParser",["personalizer"],function(e){var t=function(){},n={"MM/DD/YYYY":"mm/dd/yy","DD/MM/YYYY":"dd/mm/yy","YYYY/MM/DD":"yy/mm/dd"};return t.prototype.parse=function(t){try{var r=e.getDateFormatKey(),i=n[r],s=jQuery.datepicker.parseDate(i,t,null);return s}catch(o){return null}},t.JQUERY_DATE_FORMATS=n,t}),define("utils/validators/DateValidator",["utils/validators/RegularExpressionValidator","utils/parsers/DateParser"],function(e,t){var n={Incorrect:"error.date.incorrect",Maximum:"error.date.max",Minimum:"error.date.min"},r=e.extend({initialize:function(e){e.regularExpression="^\\d{2,4}[/]{1}\\d{2}[/]{1}\\d{2,4}$",this.initializeRegularExpressionValidator(e),this.required=e.required,this.parser=e.parser,this.maxDate=e.maxDate,this.minDate=e.minDate},validateInput:function(e){if(this.validateRegEx(e))return n.Incorrect;if(!this.required&&!e)return;var t=this.parser.parse(e);if(!t)return n.Incorrect;if(this.maxDate&&t&&t>this.maxDate)return n.Maximum;if(this.minDate&&t&&t<this.minDate)return n.Minimum}});return r}),define("text!templates/utils/DatePickerView.html",[],function(){return'<input id="<%= model.id %>" type="text" class="has-date-picker <%= customCssClasses %>" <%= readonly ? \'readonly=readonly\' : \'\' %>>\n<span id="<%= model.id %>-error" class="help-inline" style="display:none"><%= Localizer.localize(\'error.date.incorrect\') %></span>\n'}),jQuery.migrateMute===void 0&&(jQuery.migrateMute=!0),function(e,t,n){function r(n){var r=t.console;s[n]||(s[n]=!0,e.migrateWarnings.push(n),r&&r.warn&&!e.migrateMute&&(r.warn("JQMIGRATE: "+n),e.migrateTrace&&r.trace&&r.trace()))}function i(t,i,s,o){if(Object.defineProperty)try{return Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return r(o),s},set:function(e){r(o),s=e}}),n}catch(u){}e._definePropertyBroken=!0,t[i]=s}var s={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){s={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&r("jQuery is not compatible with Quirks Mode");var o=e("<input/>",{size:1}).attr("size")&&e.attrFn,u=e.attr,a=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},f=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},l=/^(?:input|button)$/i,c=/^[238]$/,h=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;i(e,"attrFn",o||{},"jQuery.attrFn is deprecated"),e.attr=function(t,i,s,a){var f=i.toLowerCase(),d=t&&t.nodeType;return a&&(4>u.length&&r("jQuery.fn.attr( props, pass ) is deprecated"),t&&!c.test(d)&&(o?i in o:e.isFunction(e.fn[i])))?e(t)[i](s):("type"===i&&s!==n&&l.test(t.nodeName)&&t.parentNode&&r("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[f]&&h.test(f)&&(e.attrHooks[f]={get:function(t,r){var i,s=e.prop(t,r);return s===!0||"boolean"!=typeof s&&(i=t.getAttributeNode(r))&&i.nodeValue!==!1?r.toLowerCase():n},set:function(t,n,r){var i;return n===!1?e.removeAttr(t,r):(i=e.propFix[r]||r,i in t&&(t[i]=!0),t.setAttribute(r,r.toLowerCase())),r}},p.test(f)&&r("jQuery.fn.attr('"+f+"') may use property instead of attribute")),u.call(e,t,i,s))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?a.apply(this,arguments):("input"!==n&&"option"!==n&&r("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?f.apply(this,arguments):("input"!==i&&"option"!==i&&r("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t,n)}};var d,v,m=e.fn.init,g=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,i){var s;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(s=y.exec(e.trim(t)))&&s[0]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),s[3]&&r("$(html) HTML text after last tag is ignored"),"#"===s[0].charAt(0)&&(r("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?m.call(this,e.parseHTML(s[2],n,!0),n,i):m.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?g.apply(this,arguments):(r("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(d=e.uaMatch(navigator.userAgent),v={},d.browser&&(v[d.browser]=!0,v.version=d.version),v.chrome?v.webkit=!0:v.webkit&&(v.safari=!0),e.browser=v),i(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(r,i){return i&&i instanceof e&&!(i instanceof t)&&(i=t(i)),e.fn.init.call(this,r,i,n)},t.fn.init.prototype=t.fn;var n=t(document);return r("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var i,s,o=this[0];return!o||"events"!==t||1!==arguments.length||(i=e.data(o,t),s=e._data(o,t),i!==n&&i!==s||s===n)?b.apply(this,arguments):(r("Use of jQuery.fn.data('events') is deprecated"),s)};var w=/\/(java|ecma)script/i,E=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return r("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),E.apply(this,arguments)},e.clean||(e.clean=function(t,i,s,o){i=i||document,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,r("jQuery.clean() is deprecated");var u,a,f,l,c=[];if(e.merge(c,e.buildFragment(t,i).childNodes),s)for(f=function(e){return!e.type||w.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):s.appendChild(e):n},u=0;null!=(a=c[u]);u++)e.nodeName(a,"script")&&f(a)||(s.appendChild(a),a.getElementsByTagName!==n&&(l=e.grep(e.merge([],a.getElementsByTagName("script")),f),c.splice.apply(c,[u+1,0].concat(l)),u+=l.length));return c});var S=e.event.add,x=e.event.remove,T=e.event.trigger,N=e.fn.toggle,C=e.fn.live,k=e.fn.die,L="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",A=RegExp("\\b(?:"+L+")\\b"),O=/(?:^|\s)hover(\.\S+|)\b/,M=function(t){return"string"!=typeof t||e.event.special.hover?t:(O.test(t)&&r("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(O,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&i(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,i,s){e!==document&&A.test(t)&&r("AJAX events should be attached to document: "+t),S.call(this,e,M(t||""),n,i,s)},e.event.remove=function(e,t,n,r,i){x.call(this,e,M(t)||"",n,r,i)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return r("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return N.apply(this,arguments);r("jQuery.fn.toggle(handler, handler...) is deprecated");var i=arguments,s=t.guid||e.guid++,o=0,u=function(n){var r=(e._data(this,"lastToggle"+t.guid)||0)%o;return e._data(this,"lastToggle"+t.guid,r+1),n.preventDefault(),i[r].apply(this,arguments)||!1};for(u.guid=s;i.length>o;)i[o++].guid=s;return this.click(u)},e.fn.live=function(t,n,i){return r("jQuery.fn.live() is deprecated"),C?C.apply(this,arguments):(e(this.context).on(t,this.selector,n,i),this)},e.fn.die=function(t,n){return r("jQuery.fn.die() is deprecated"),k?k.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,i){return n||A.test(e)||r("Global events are undocumented and deprecated"),T.call(this,e,t,n||document,i)},e.each(L.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window),define("jquerymigrate",["jquery"],function(){}),function(e){function t(t,i){var o=this,u=t.add(o),f=e(window),l,c,h,p=e.tools.expose&&(i.mask||i.expose),d=Math.random().toString().slice(10);p&&(typeof p=="string"&&(p={color:p}),p.closeOnClick=p.closeOnEsc=!1);var v=i.target||t.attr("rel");c=v?e(v):t;if(!c.length)throw"Could not find Overlay: "+v;t&&t.index(c)==-1&&t.click(function(e){return o.load(e),e.preventDefault()}),e.extend(o,{load:function(t){if(o.isOpened())return o;var l=r[i.effect];if(!l)throw'Overlay: cannot find effect : "'+i.effect+'"';i.oneInstance&&e.each(n,function(){this.close(t)}),t=t||e.Event(),t.type="onBeforeLoad",u.trigger(t);if(t.isDefaultPrevented())return o;h=!0,p&&e(c).expose(p);var v=i.top,y=i.left,w=c.outerWidth({margin:!0}),E=c.outerHeight({margin:!0});return typeof v=="string"&&(v=v=="center"?Math.max((f.height()-E)/2,0):parseInt(v,10)/100*f.height()),y=="center"&&(y=Math.max((f.width()-w)/2,0)),l[0].call(o,{top:v,left:y},function(){h&&(t.type="onLoad",u.trigger(t))}),p&&i.closeOnClick&&e.mask.getMask().one("click",o.close),i.closeOnClick&&e(document).bind("click."+d,function(t){e(t.target).parents(c).length||o.close(t)}),i.closeOnEsc&&e(document).bind("keydown."+d,function(e){e.keyCode==27&&o.close(e)}),o},close:function(t){if(!o.isOpened())return o;t=t||e.Event(),t.type="onBeforeClose",u.trigger(t);if(!t.isDefaultPrevented())return h=!1,r[i.effect][1].call(o,function(){t.type="onClose",u.trigger(t)}),e(document).unbind("click."+d).unbind("keydown."+d),p&&e.mask.close(),o},getOverlay:function(){return c},getTrigger:function(){return t},getClosers:function(){return l},isOpened:function(){return h},getConf:function(){return i}}),e.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(t,n){e.isFunction(i[n])&&e(o).bind(n,i[n]),o[n]=function(t){return t&&e(o).bind(n,t),o}}),l=c.find(i.close||".close"),!l.length&&!i.close&&(l=e('<a class="close"></a>'),c.prepend(l)),l.click(function(e){o.close(e)}),i.load&&o.load()}e.tools=e.tools||{version:"1.2.5"},e.tools.overlay={addEffect:function(e,t,n){r[e]=[t,n]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!e.browser.msie||e.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var n=[],r={};e.tools.overlay.addEffect("default",function(t,n){var r=this.getConf(),i=e(window);r.fixed||(t.top+=i.scrollTop(),t.left+=i.scrollLeft()),t.position=r.fixed?"fixed":"absolute",this.getOverlay().css(t).fadeIn(r.speed,n)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),e.fn.overlay=function(r){var i=this.data("overlay");return i?i:(e.isFunction(r)&&(r={onBeforeLoad:r}),r=e.extend(!0,{},e.tools.overlay.conf,r),this.each(function(){i=new t(e(this),r),n.push(i),e(this).data("overlay",i)}),r.api?i:this)}}(jQuery),define("jquerytools",["jquery","jquerymigrate"],function(){}),define("views/utils/DatePickerView",["require","underscore","moment","backbone","localizer","personalizer","utils/validators/Validator","utils/validators/DateValidator","utils/parsers/DateParser","utils/date/DateUtil","utils/reporters/ToolTipErrorReporter","text!templates/utils/DatePickerView.html","jqueryui","jquerytools"],function(e){var t=e("underscore"),n=e("moment"),r=e("backbone"),i=e("localizer"),s=e("personalizer"),o=e("utils/validators/Validator"),u=e("utils/validators/DateValidator"),a=e("utils/parsers/DateParser"),f=e("utils/date/DateUtil"),l=e("utils/reporters/ToolTipErrorReporter"),c=e("text!templates/utils/DatePickerView.html");e("jqueryui"),e("jquerytools");var h={CHANGE:"CHANGE",CLICK:"CLICK",ONCLOSE:"ONCLOSE"},p={en:!0},d=null,v=function(e){if(p[e])e=="en"&&(e="",jQuery.datepicker.setDefaults(jQuery.datepicker.regional[e]));else{var t=function(){console.log("Initialized date picker to locale: "+e),p[e]=!0,jQuery.datepicker.setDefaults(jQuery.datepicker.regional[e])},n="main/js/lib/datepicker/jquery.ui.datepicker-"+e+".min.js";jQuery.ajax({type:"GET",url:n,success:t,dataType:"script",cache:!0})}},m=r.View.extend({initialize:function(e){if(!jQuery)throw"JQuery is required.";if(!jQuery.datepicker)throw"JQuery UI Datepicker is required.";if(!e.userPreferences)throw"Date Picker should be initialized with UserPreferences.";if(!e.userPreferences.getLocale())throw"Date Picker should be initialized with UserPreferences AND a valid locale.";if(!e.id)throw"Date Picker should be initialized with a DOM ID.";this.userPreferences=e.userPreferences,this.date=e.date,this.id=e.id,this.dateParser=new a,this.enabled=!0,this.scrollableElement=e.scrollableElement,this.errorToolTipPosition=e.errorToolTipPosition,this.errorTooltipMessage=e.errorTooltipMessage,this.minDate=e.minDate,this.maxDate=e.maxDate,this.zIndex=e.zIndex,this.showOnFocus=e.showOnFocus,this.customCssClasses=e.customCssClasses,d=e.highlightDates,this.beforeShowDayCallback=e.beforeShowDayCallback,this.container=e.container,this.validationMessage=e.validationMessage,this.displayElementText=t.isUndefined(e.displayElementText)?"inline":e.displayElementText,this.dateFormat=s.getDateFormatKey(),this.notRequired=e.notRequired},getErrorTooltipReporter:function(){return this.errorTooltipMessage?new l({element:this.$("#"+this.id),message:this.errorTooltipMessage,position:this.errorToolTipPosition,scrollableElement:this.scrollableElement,container:this.container}):this.getDefaultErrorTooltipReporter()},getDefaultErrorTooltipReporter:function(){var e=this.validationMessage?this.validationMessage:i.localize("validation.date.format",s.getDateFormatKey());return new l({element:this.$("#"+this.id),message:e,position:this.errorToolTipPosition,scrollableElement:this.scrollableElement,container:this.container})},render:function(){var e={id:this.id},n=this;this.$el.css("display",this.displayElementText);var r=t.template(c);this.html=r({model:e,Localizer:i,readonly:this.readonly,customCssClasses:this.customCssClasses||""}),this.$el.html(this.html);var o=s.getDateFormatKey(),u=a.JQUERY_DATE_FORMATS[o];v(this.userPreferences.getLocale());var f=this.userPreferences.get("firstDayOfWeek").dayName,l=this.getFirstDayNumber(f);this.$("#"+this.id).datepicker({showOn:this.showOnFocus?"focus":"button",nextText:">",prevText:"<",constrainInput:!0,defaultDate:this.date,dateFormat:u,minDate:this.minDate,maxDate:this.maxDate,firstDay:l,hideIfNoPrevNext:!0,beforeShow:function(e,t){n.trigger(h.CLICK,this.id),n.zIndex&&setTimeout(function(){$(t.dpDiv[0]).css({zIndex:n.zIndex})},0)},onClose:function(){n.trigger(h.ONCLOSE)}}),d&&(this.beforeShowDayCallback&&typeof this.beforeShowDayCallback=="function"?this.$("#"+this.id).datepicker("option","beforeShowDay",this.beforeShowDayCallback):this.$("#"+this.id).datepicker("option","beforeShowDay",this.dateFunction)),this.$(".ui-datepicker-trigger").empty().addClass("icon-calendar"),this.readonly&&this.$("#"+this.id).datepicker("disable");var p=jQuery.datepicker.formatDate(u,this.date,null);return this.$("#"+this.id).val(p),this.initializeValidators(),this.el},getFirstDayNumber:function(e){switch(e){case"monday":return 1;case"saturday":return 6;case"sunday":default:return 0}},initializeValidators:function(){var e=this,t=this.validationMessage?this.validationMessage:i.localize("validation.date.format",s.getDateFormatKey());this.dateValidator=new u({element:this.$("#"+this.id),attribute:"data",required:!this.notRequired,parser:this.dateParser,reporter:this.getErrorTooltipReporter(),minDate:this.minDate,maxDate:this.maxDate}),this.dateValidator.bind(o.Events.ValidationFailure,this.onValidationFailure,this),this.dateValidator.bind(o.Events.ValidationSuccess,this.onValidationSuccess,this)},onValidationSuccess:function(e){if(this.notRequired||e.parsedValue)this.date=e.parsedValue,this.trigger(h.CHANGE,this.date,this.id)},onValidationFailure:function(e){this.trigger(h.CHANGE,null)},validate:function(){return this.enabled?this.dateValidator.validateInputNow():null},setMinDate:function(e){this.minDate=e,this.dateValidator.minDate=e},setMaxDate:function(e){this.maxDate=e,this.dateValidator.maxDate=e},setReadonly:function(e){this.readonly=e},disable:function(){this.enabled=!1,this.clearErrors()},enable:function(){this.enabled=!0},clearErrors:function(){var e=this.$("#"+this.id);e.parents("div.field-group").removeClass("error"),e.siblings("span.help-inline").hide(),e.siblings("span.help-inline").text("")},clearReport:function(){this.dateValidator.clearReport()},dateFunction:function(e){var t=e.getMonth()+1,n=e.getDate(),r=e.getFullYear();n<10&&(n="0"+n),t<10&&(t="0"+t);var i=r+"-"+t+"-"+n,s=d[i];return s||(s=d["default"]),s},hideCalendar:function(){var e=$("#"+this.id).datepicker();e.datepicker("hide"),$("#"+this.id).blur()},destroy:function(){return this.dateValidator&&(this.dateValidator.unbind(),this.dateValidator.destroy()),this.$el.empty().off(),this.stopListening(),this},getTargetValue:function(){return this.$("#"+this.id)[0].value},evalMinDate:function(){var e=n(this.getTargetValue(),this.dateFormat).format(this.dateFormat);e===this.getTargetValue()&&n(e,this.dateFormat).isValid()&&n(e,this.dateFormat).isBefore(this.minDate,this.dateFormat)&&(this.date=this.minDate,this.dateValidator.clearReport(),this.render())}});return m.Events=h,m}),define("utils/validators/TimeValidator",["utils/validators/Validator","localizer"],function(e,t){var n={Incorrect:"error.time.incorrect"},r=e.extend({initialize:function(e){this.initializeValidator(e),this.timeFormat24Hour=e.timeFormat24Hour,this.required=e.required},validateInput:function(e){if(this.required&&(!e||e.length<1))return n.Incorrect;if(this.timeFormat24Hour){var r=e?e.split(":"):null;return!r||r.length!=2?n.Incorrect:this.assertInt(r[0],0,23,n.Incorrect)||this.assertInt(r[1],0,59,n.Incorrect)}var r=e.split(" "),i="^"+t.localize("AM")+"|"+t.localize("PM")+"$",s=new RegExp(i,"i");return s.test(r[1])?(r=r[0].split(":"),!r||r.length!=2?n.Incorrect:this.assertInt(r[0],1,12,n.Incorrect)||this.assertInt(r[1],0,59,n.Incorrect)):n.Incorrect},assertInt:function(e,t,n,r){if(e===""||e===null||isNaN(e))return r;e.length==2&&e.charAt(0)=="0"&&(e=e.charAt(1));var i=parseInt(e,10);return i<t||i>n||isNaN(i)?r:""}});return r}),define("text!templates/utils/TimePickerView.html",[],function(){return'<input type="text" class="input-small has-time-picker" id="<%= model.id %>" value="<%= model.time %>" autocomplete="off" />\n<% if (displayIcon) { %>\n<i id="<%= model.id %>-icon" type="button" class="ui-timepicker-trigger icon-alarm-clock" rel="#<%= model.id %>"></i>\n<% } %>\n<span class="help-inline" style="display: none"><%= Localizer.localize(\'error.time.incorrect\') %></span>'}),define("views/utils/TimePickerView",["underscore","backbone","localizer","personalizer","utils/validators/Validator","utils/validators/TimeValidator","utils/date/DateUtil","utils/date/DateFormatter","utils/reporters/ToolTipErrorReporter","text!templates/utils/TimePickerView.html","jquerytimepicker"],function(e,t,n,r,i,s,o,u,a,f){var l={CHANGE:"CHANGE"},c=t.View.extend({initialize:function(t){if(!t.userPreferences)throw"Time Picker should be initialized with UserPreferences.";t.time||(t.time=u.formatTime(new Date(o.getCurrentTime()-6e4))),t.maxTime&&(t.maxTime=u.formatTime(t.maxTime)),t.minTime&&(this.setStartTime(t.minTime),t.minTime=u.formatTime(t.minTime));if(!t.id)throw"Time Picker should be initialized with a DOM ID.";this.userPreferences=t.userPreferences,this.time=t.time,this.maxTime=t.maxTime,this.minTime=t.minTime,this.id=t.id,this.required=t.required,this.scrollableElement=t.scrollableElement,this.errorToolTipPosition=t.errorToolTipPosition,this.languageOptions={am:n.localize("AM").toLowerCase(),pm:n.localize("PM").toLowerCase(),AM:n.localize("AM"),PM:n.localize("PM")};if(this.languageOptions.am.slice(-1)==="p"||this.languageOptions.am.slice(-1)==="a")this.languageOptions.am+="m";if(this.languageOptions.pm.slice(-1)==="p"||this.languageOptions.pm.slice(-1)==="a")this.languageOptions.pm+="m";this.timeFormat24Hour=this.userPreferences.get("timeFormat").formatKey=="time_twenty_four_hr",this.modalFix=t.modalFix,this.displayIcon=e.isNull(t.displayIcon)||e.isUndefined(t.displayIcon)?!0:t.displayIcon},render:function(){var t={id:this.id,time:this.time},r=e.template(f);this.html=r({model:t,Localizer:n,displayIcon:this.displayIcon}),this.$el.html(this.html);var i=this.getTimeField();this.timeFormat24Hour?i.timepicker({appendTo:this.$el,timeFormat:"G:i",step:15,maxTime:this.maxTime,minTime:this.minTime,startTime:this.startTime,lang:this.languageOptions}):i.timepicker({appendTo:this.$el,timeFormat:"g:i A",step:15,maxTime:this.maxTime,minTime:this.minTime,startTime:this.startTime,lang:this.languageOptions});var s=this;return this.modalFix&&i.on("showTimepicker",s.onTimepickerShown),this.$("#"+this.id+"-icon").bind("click",function(){s.getTimeField().focus()}),this.initializeValidators(),this.el},getTimeField:function(){return this.$("#"+this.id)},updateMaxTime:function(e){this.maxTime=u.formatTime(e);var t=this.getTimeField();t.timepicker("option","maxTime",this.maxTime)},updateMinTime:function(e){this.setStartTime(e),this.minTime=u.formatTime(e);var t=this.getTimeField();t.timepicker("option","minTime",this.minTime)},updateTime:function(e){this.time=e,this.timeValidator.clearReport()},initializeValidators:function(){this.timeValidator=new s({elementId:this.id,element:this.$("#"+this.id),attribute:"time",required:this.required,timeFormat24Hour:this.timeFormat24Hour,reporter:new a({element:this.$("#"+this.id),position:this.errorToolTipPosition,message:n.localize("validation.time.invalid"),scrollableElement:this.scrollableElement})}),this.timeValidator.bind(i.Events.ValidationFailure,this.onValidationFailure,this),this.timeValidator.bind(i.Events.ValidationSuccess,this.onValidationSuccess,this)},onValidationSuccess:function(e){this.time=e.enteredValue,this.offset=this.$("#"+this.id).timepicker("getSecondsFromMidnight"),this.trigger(l.CHANGE,this.time,this.offset)},onValidationFailure:function(e){this.trigger(l.CHANGE,null)},validate:function(){return this.timeValidator.validateInputNow()},onTimepickerShown:function(){var e=function(e){return e.stopPropagation(),!0};jQuery(".ui-timepicker-wrapper").on("click",e);var t=jQuery("#"+this.id);t.on("keyup",e),t.on("keydown",e),t.on("keypress",e)},enable:function(){this.$(".has-time-picker").removeAttr("disabled").removeClass("disabled")},disable:function(){this.$(".has-time-picker").attr("disabled","disabled").addClass("disabled")},setStartTime:function(e){var t=e.getMinutes(),n=Math.ceil(t/15);n===4&&e.setHours(e.getHours()+1);var r=n*15%60;e.setMinutes(r),this.startTime=u.formatTime(e)}});return c.Events=l,c}),define("models/reports/ReportMetric",["backbone"],function(e){var t=e.Model.extend({});return t}),define("collections/connections/LeaderBoardMetrics",["backbone","models/reports/ReportMetric","collections/utils/PagedCollection","utils/date/DateUtil"],function(e,t,n,r){var i={Steps:29,Distance:17},s={Wellness:"wellness",Fitness:"activity"},o=n.extend({model:t,baseUrl:function(){return"/proxy/userstats-service/leaderboard/"+this.userType+"/connection"},url:function(){var e=n.prototype.url.call(this);return e+="&metricId="+this.metricType+"&startDate="+this.startDate+"&endDate="+this.endDate,this.actTypeId!=null&&typeof this.actTypeId!="undefined"&&(e+="&actTypeId="+this.actTypeId),e},initialize:function(e,t){this.metricType=t.metricType,this.startDate=this.convertDate(t.startDate),this.endDate=this.convertDate(t.endDate),this.userType=t.userType,this.actTypeId=t.actTypeId,this.displayName=t.displayName,t.verb="GET",this.initializePagedCollection(t)},convertDate:function(e){return r.toISODateString(e)},parse:function(e){var t=e.allMetrics.metricsMap,n=[];for(var r in t)if(t.hasOwnProperty(r)){n=t[r];break}return n=_.filter(n,function(e){return e.value>0||e.value==0&&e.hasPrivate==1||e.userInfo.displayname==this.displayName},this),n},comparator:function(e,t){return e.get("value")<t.get("value")?1:e.get("value")>t.get("value")?-1:e.get("userInfo").displayname==this.displayName?-1:t.get("userInfo").displayname==this.displayName?1:0}});return o.MetricTypes=i,o.UserTypes=s,o}),define("models/reports/AvailableReport",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({urlRoot:"/proxy/userstats-service/statistics/chartconfig/",idAttribute:"metricId"});return n}),define("collections/reports/AvailableReports",["require","backbone","models/reports/AvailableReport"],function(e){var t=e("backbone"),n=e("models/reports/AvailableReport"),r=t.Collection.extend({model:n,url:function(){return"/proxy/userstats-service/statistics/availability/"+this.getDisplayName()},setDisplayName:function(e){this.displayName=e},getDisplayName:function(){return this.displayName},parse:function(e,t){var n=[];for(var r=0;r<e.allActivityMetricsAvailability.length;r++)e.allActivityMetricsAvailability[r].available===!0&&n.push(e.allActivityMetricsAvailability[r].metric);for(var i=0;i<e.wellnessMetricsAvailability.length;i++)e.wellnessMetricsAvailability[i].available===!0&&n.push(e.wellnessMetricsAvailability[i].metric);for(var s=0;s<e.commonMetricsAvailability.length;s++)e.commonMetricsAvailability[s].available===!0&&n.push(e.commonMetricsAvailability[s].metric);for(var o=0;o<e.cyclingMetricsAvailability.length;o++)e.cyclingMetricsAvailability[o].available===!0&&n.push(e.cyclingMetricsAvailability[o].metric);return n},comparator:function(e){return e.get("metricName")},hasReport:function(e){var t=this.where({metricName:e});return!!t}});return r}),define("models/wellness/FeedSummary",["require","backbone"],function(e){var t=e("backbone");return t.Model.extend({idAttribute:"uuid"})}),define("collections/wellness/ConnectionFeed",["require","backbone","models/wellness/FeedSummary","collections/utils/PagedCollection"],function(e){var t=e("backbone"),n=e("models/wellness/FeedSummary"),r=e("collections/utils/PagedCollection");return r.extend({model:n,baseUrl:"/proxy/usersummary-service/usersummary/connections/dailySummaryViews",initialize:function(e,t){t.verb="GET",this.initializePagedCollection(t)}})}),define("models/activity/Activity",["backbone"],function(e){var t=e.Model.extend({idAttribute:"activityId",initialize:function(e){this.displayName=e.displayName},url:function(){return"/proxy/activitylist-service/activities/commentsById/"+this.displayName+"?id="+this.id}});return t}),define("collections/activity/ConnectionFeed",["require","backbone","moment","models/activity/Activity","collections/utils/PagedCollection"],function(e){var t=e("backbone"),n=e("moment"),r=e("models/activity/Activity"),i=e("collections/utils/PagedCollection"),s=i.extend({baseUrl:"/proxy/activitylist-service/activities/comments/subscriptionFeed",model:r,initialize:function(e,t){t.verb="GET",this.initializePagedCollection(t)},parse:function(e){var t;return t=_.filter(e.activityList,function(e){return n(e.startTimeLocal)<=n()}),t}});return s}),define("collections/device/ActiveDevices",["underscore","backbone","models/device/Device","utils/device/ActiveIndicatorEnum"],function(e,t,n,r){var i=t.Collection.extend({model:n,url:function(){return"/proxy/device-service/deviceservice/device-info/active/"+this.getDisplayName()},initialize:function(e){},setDisplayName:function(e){this.displayName=e},getDisplayName:function(){return this.displayName},userOnlyHasWeightScale:function(){if(this.length>0){for(var e=0,t=this.length;e<t;e+=1)if(this.models[e].get("applicationKey")!=="indexSmartScale")return!1;return!0}return!1},getActivityTrackers:function(){return e.filter(this.models,function(e){return e.get("wellness")||e.get("hybrid")?!e.isInUseByAnotherUser():!1})}});return i}),function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){(function(e){var t=e.defaultOptions,n=e.doc,r=e.Chart,i=e.addEvent,s=e.removeEvent,o=e.fireEvent,u=e.createElement,a=e.discardElement,f=e.css,l=e.merge,c=e.pick,h=e.each,p=e.extend,d=e.splat,v=e.win,m=e.SVGRenderer,g=e.Renderer.prototype.symbols;p(t.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"}),t.navigation={buttonOptions:{theme:{},symbolSize:14,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,verticalAlign:"top",width:24}},t.exporting={type:"image/png",url:"https://export.highcharts.com/",printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChart()}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}]}}},e.post=function(e,t,r){var i;e=u("form",l({method:"post",action:e,enctype:"multipart/form-data"},r),{display:"none"},n.body);for(i in t)u("input",{type:"hidden",name:i,value:t[i]},null,e);e.submit(),a(e)},p(r.prototype,{sanitizeSVG:function(e){return e=e.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"Â ").replace(/&shy;/g,"Â­")},getChartHTML:function(){return this.inlineStyles(),this.container.innerHTML},getSVG:function(t){var r=this,i,s,o,f,c,v=l(r.options,t),m=v.exporting.allowHTML;return n.createElementNS||(n.createElementNS=function(e,t){return n.createElement(t)}),s=u("div",null,{position:"absolute",top:"-9999em",width:r.chartWidth+"px",height:r.chartHeight+"px"},n.body),o=r.renderTo.style.width,c=r.renderTo.style.height,o=v.exporting.sourceWidth||v.chart.width||/px$/.test(o)&&parseInt(o,10)||600,c=v.exporting.sourceHeight||v.chart.height||/px$/.test(c)&&parseInt(c,10)||400,p(v.chart,{animation:!1,renderTo:s,forExport:!0,renderer:"SVGRenderer",width:o,height:c}),v.exporting.enabled=!1,delete v.data,v.series=[],h(r.series,function(e){f=l(e.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:e.visible}),f.isInternal||v.series.push(f)}),t&&h(["xAxis","yAxis"],function(e){h(d(t[e]),function(t,n){v[e][n]=l(v[e][n],t)})}),i=new e.Chart(v,r.callback),h(["xAxis","yAxis"],function(e){h(r[e],function(t,n){var r=i[e][n],s=t.getExtremes(),o=s.userMin,s=s.userMax;!r||void 0===o&&void 0===s||r.setExtremes(o,s,!0,!1)})}),o=i.getChartHTML(),v=null,i.destroy(),a(s),m&&(s=o.match(/<\/svg>(.*?$)/))&&(s='<foreignObject x="0" y="0" width="200" height="200"><body xmlns="http://www.w3.org/1999/xhtml">'+s[1]+"</body></foreignObject>",o=o.replace("</svg>",s+"</svg>")),o=this.sanitizeSVG(o),o=o.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'")},getSVGForExport:function(e,t){var n=this.options.exporting;return this.getSVG(l({chart:{borderRadius:0}},n.chartOptions,t,{exporting:{sourceWidth:e&&e.sourceWidth||n.sourceWidth,sourceHeight:e&&e.sourceHeight||n.sourceHeight}}))},exportChart:function(t,n){var r=this.getSVGForExport(t,n);t=l(this.options.exporting,t),e.post(t.url,{filename:t.filename||"chart",type:t.type,width:t.width||0,scale:t.scale,svg:r},t.formAttributes)},print:function(){var e=this,t=e.container,r=[],i=t.parentNode,s=n.body,u=s.childNodes,a=e.options.exporting.printMaxWidth,f,l;if(!e.isPrinting){e.isPrinting=!0,e.pointer.reset(null,0),o(e,"beforePrint");if(l=a&&e.chartWidth>a)f=[e.options.chart.width,void 0,!1],e.setSize(a,void 0,!1);h(u,function(e,t){1===e.nodeType&&(r[t]=e.style.display,e.style.display="none")}),s.appendChild(t),v.focus(),v.print(),setTimeout(function(){i.appendChild(t),h(u,function(e,t){1===e.nodeType&&(e.style.display=r[t])}),e.isPrinting=!1,l&&e.setSize.apply(e,f),o(e,"afterPrint")},1e3)}},contextMenu:function(e,t,r,o,a,l,c){var p=this,d=p.chartWidth,v=p.chartHeight,m="cache-"+e,g=p[m],b=Math.max(a,l),E,S,T,N=function(t){p.pointer.inClass(t.target,e)||S()};g||(p[m]=g=u("div",{className:e},{position:"absolute",zIndex:1e3,padding:b+"px"},p.container),E=u("div",{className:"highcharts-menu"},null,g),S=function(){f(g,{display:"none"}),c&&c.setState(0),p.openMenu=!1},i(g,"mouseleave",function(){T=setTimeout(S,500)}),i(g,"mouseenter",function(){clearTimeout(T)}),i(n,"mouseup",N),i(p,"destroy",function(){s(n,"mouseup",N)}),h(t,function(e){if(e){var t;t=e.separator?u("hr",null,null,E):u("div",{className:"highcharts-menu-item",onclick:function(t){t&&t.stopPropagation(),S(),e.onclick&&e.onclick.apply(p,arguments)},innerHTML:e.text||p.options.lang[e.textKey]},null,E),p.exportDivElements.push(t)}}),p.exportDivElements.push(E,g),p.exportMenuWidth=g.offsetWidth,p.exportMenuHeight=g.offsetHeight),t={display:"block"},r+p.exportMenuWidth>d?t.right=d-r-a-b+"px":t.left=r-b+"px",o+l+p.exportMenuHeight>v&&"top"!==c.alignOptions.verticalAlign?t.bottom=v-o-b+"px":t.top=o+l-b+"px",f(g,t),p.openMenu=!0},addButton:function(e){var t=this,n=t.renderer,r=l(t.options.navigation.buttonOptions,e),i=r.onclick,s=r.menuItems,o,u,a=r.symbolSize||12;t.btnCount||(t.btnCount=0),t.exportDivElements||(t.exportDivElements=[],t.exportSVGElements=[]);if(!1!==r.enabled){var f=r.theme,h=f.states,d=h&&h.hover,h=h&&h.select,v;delete f.states,i?v=function(e){e.stopPropagation(),i.call(t,e)}:s&&(v=function(){t.contextMenu(u.menuClassName,s,u.translateX,u.translateY,u.width,u.height,u),u.setState(2)}),r.text&&r.symbol?f.paddingLeft=c(f.paddingLeft,25):r.text||p(f,{width:r.width,height:r.height,padding:0}),u=n.button(r.text,0,0,v,f,d,h).addClass(e.className).attr({title:t.options.lang[r._titleKey],zIndex:3}),u.menuClassName=e.menuClassName||"highcharts-menu-"+t.btnCount++,r.symbol&&(o=n.symbol(r.symbol,r.symbolX-a/2,r.symbolY-a/2,a,a).addClass("highcharts-button-symbol").attr({zIndex:1}).add(u)),u.add().align(p(r,{width:u.width,x:c(r.x,t.buttonOffset)}),!0,"spacingBox"),t.buttonOffset+=(u.width+r.buttonSpacing)*("right"===r.align?-1:1),t.exportSVGElements.push(u,o)}},destroyExport:function(e){var t=e?e.target:this;e=t.exportSVGElements;var n=t.exportDivElements;e&&(h(e,function(e,n){e&&(e.onclick=e.ontouchstart=null,t.exportSVGElements[n]=e.destroy())}),e.length=0),n&&(h(n,function(e,n){s(e,"mouseleave"),t.exportDivElements[n]=e.onmouseout=e.onmouseover=e.ontouchstart=e.onclick=null,a(e)}),n.length=0)}}),m.prototype.inlineToAttributes="fill stroke strokeLinecap strokeLinejoin strokeWidth textAnchor x y".split(" "),m.prototype.inlineBlacklist=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/perspective/,/TapHighlightColor/,/^transition/],m.prototype.unstyledElements=["clipPath","defs","desc"],r.prototype.inlineStyles=function(){function t(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()})}function r(i){var c,p,d,m="",g,y;if(1===i.nodeType&&-1===u.indexOf(i.nodeName)){p=v.getComputedStyle(i,null),d="svg"===i.nodeName?{}:v.getComputedStyle(i.parentNode,null),a[i.nodeName]||(f||(f=n.createElementNS(e.SVG_NS,"svg"),f.setAttribute("version","1.1"),n.body.appendChild(f)),g=n.createElementNS(i.namespaceURI,i.nodeName),f.appendChild(g),a[i.nodeName]=l(v.getComputedStyle(g,null)),f.removeChild(g));for(c in p){g=!1;for(y=o.length;y--&&!g;)g=o[y].test(c)||"function"==typeof p[c];g||d[c]!==p[c]&&a[i.nodeName][c]!==p[c]&&(-1!==s.indexOf(c)?i.setAttribute(t(c),p[c]):m+=t(c)+":"+p[c]+";")}m&&(c=i.getAttribute("style"),i.setAttribute("style",(c?c+";":"")+m)),"text"!==i.nodeName&&h(i.children||i.childNodes,r)}}var i=this.renderer,s=i.inlineToAttributes,o=i.inlineBlacklist,u=i.unstyledElements,a={},f;r(this.container.querySelector("svg")),f.parentNode.removeChild(f)},g.menu=function(e,t,n,r){return["M",e,t+2.5,"L",e+n,t+2.5,"M",e,t+r/2+.5,"L",e+n,t+r/2+.5,"M",e,t+r-1.5,"L",e+n,t+r-1.5]},r.prototype.renderExporting=function(){var e,t=this.options.exporting,n=t.buttons,r=this.isDirtyExporting||!this.exportSVGElements;this.buttonOffset=0,this.isDirtyExporting&&this.destroyExport();if(r&&!1!==t.enabled){for(e in n)this.addButton(n[e]);this.isDirtyExporting=!1}i(this,"destroy",this.destroyExport)},r.prototype.callbacks.push(function(e){e.renderExporting(),i(e,"redraw",e.renderExporting),h(["exporting","navigation"],function(t){e[t]={update:function(n,r){e.isDirtyExporting=!0,l(!0,e.options[t],n),c(r,!0)&&e.redraw()}}})})})(e)}),define("highchartsexport",["highcharts"],function(){}),define("text!templates/conversations/PageAddCommentView.html",[],function(){return'<%  var imageUrl = socialProfile.profileImageUrlSmall || \'//static.garmincdn.com/apps/connect/image/profile-pic-default_60.gif\' %>\n<!--avatar-->\n<div class="object-img pull-left">\n    <a class="profile" href="#">\n        <img class="media-object avatar avatar-tiny" data-src="holder.js/64x64" title="" alt="" src="<%= imageUrl %>">\n    </a>\n</div>\n\n<!--comment content-->\n<div class="media-body">\n\n    <textarea placeholder="<%= Localizer.localize(\'enter_your_comment\') %>" class="add-comment-textarea" maxlength="<%= maxLength %>"></textarea>\n    <div class="add-comment-button-wrapper text-right bottom-xs ">\n        <button class="btn btn-small add-comment-button" type="submit"><%= Localizer.localize(\'save\') %></button>\n    </div>\n\n</div>\n<!--end comment content-->\n\n'}),define("views/conversations/PageAddCommentView",["underscore","backbone","localizer","models/conversations/Comment","models/user/ViewerSocialProfile","utils/validators/MaxLengthValidator","text!templates/conversations/PageAddCommentView.html"],function(e,t,n,r,i,s,o){var u={COMMENT_ADDED:"COMMENT_ADDED"},a=t.View.extend({template:e.template(o),events:{"click .add-comment-button":"onAddCommentClicked","focus .add-comment-textarea":"onTextareaFocus","blur .add-comment-textarea":"onTextareaBlur","click a.profile":"onProfileClicked"},initialize:function(e){this.initializeAddCommentView(e)},initializeAddCommentView:function(e){this.resourceType=e.resourceType,this.resourceId=e.resourceId,this.conversation=e.conversation,this.maxLength=1e3},onAddCommentClicked:function(){this.conversation.isNew()?(this.conversation.once("sync",this.addComment,this),this.conversation.save()):this.addComment()},addComment:function(){var e=this.$(".add-comment-textarea"),t=jQuery.trim(e.val());if(t.length===0)return;var n=this.createComment(t);n.once("sync",this.onCommentSaved,this),n.save(),e.val(""),e.removeClass("active"),this.$(".add-comment-button-wrapper").hide()},createComment:function(e){var t=new r({conversationUuid:this.conversation.get("conversationUuid"),conversationCommentUuid:null,body:e,numberOfLikes:0}),n=this.conversation.get("numberOfComments");return this.conversation.set("numberOfComments",++n),t},onCommentSaved:function(e){this.trigger(u.COMMENT_ADDED,e)},render:function(){var e=(new Date).getMilliseconds();this.$el.html(this.template({Localizer:n,maxLength:this.maxLength,socialProfile:i.toJSON(),elementId:e})),new s({minLength:1,maxLength:this.maxLength,element:this.$(".add-comment-textarea")})},onTextareaFocus:function(e){jQuery(e.currentTarget).addClass("active"),this.$(".add-comment-button-wrapper").show()},onTextareaBlur:function(e){var t=jQuery(e.currentTarget);t.val().length||(t.removeClass("active"),this.$(".add-comment-button-wrapper").hide())},onProfileClicked:function(e){e.preventDefault(),e.stopPropagation();var n="/profile/"+i.get("displayName");t.history.navigate(n,{trigger:!0})}});return a.Events=u,a}),define("text!templates/conversations/PageCommentView.html",[],function(){return'<%\n    var commentPicUrl = comment.authorImageUrl || \'//static.garmincdn.com/apps/connect/image/profile-pic-default_60.gif\';\n    var likeTextKey = comment.likedByUser ? \'unlike\' : \'like\';\n%>\n\n<!--avatar-->\n<div class="object-img pull-left">\n    <a href="<%= url(\'/profile/\' + comment.authorDisplayName) %>">\n        <img class="media-object avatar avatar-tiny" data-src="holder.js/64x64" title="<%= comment.nameDisplayValue %>" alt="<%= comment.authorDisplayName %>" src="<%= commentPicUrl %>">\n    </a>\n</div>\n\n<!--comment content-->\n<div class="media-body">\n\n    <p class="">\n        <% if (comment.authorPro) { %>\n            <!-- per UX, PRO is not translated -->\n            <span class="label-pro"><i class="icon-checkmark"></i>PRO</span>\n        <% } %>\n        <a class="colored" href="<%= url(\'/profile/\' + comment.authorDisplayName) %>"><%= comment.nameDisplayValue %></a>\n    </p>\n    <p class="comment-body-text"><%= comment.body %></p>\n\n    <!-- Delete Comment -->\n    <% if (comment.userProfilePk == viewerProfilePk || conversationOwnerPk == viewerProfilePk) { %>\n    <button class="delete delete-js" title="<%= Localizer.localize(\'button_delete\') %>">\n        <i class="icon-close"></i>\n    </button>\n    <% } %>            \n    \n    <div class="feed-item-footer">\n        \n        <!--date stamp-->\n        <span class="date-stamp pull-left"><%= dayDisplay %></span>\n        \n        <!--Liking-->\n        <span class="entry-like pull-right"></span>\n        \n    </div>\n    \n</div>\n<!--end comment content-->\n'}),define("views/conversations/PageCommentView",["underscore","backbone","localizer","utils/ModelSynchronizer","utils/date/DateUtil","utils/NavigationUtil","views/conversations/LikeView","models/conversations/Comment","models/user/ViewerSocialProfile","models/user/ViewerUserPreferences","views/main/Modal/ModalConfirmationView","text!templates/conversations/PageCommentView.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={COMMENT_DELETED:"COMMENT_DELETED"},p=t.View.extend({events:{"click .delete":"onDeleteCommentClicked"},initialize:function(t){this.template=e.template(c),this.initializePageCommentView(t),this.showLikes=e.isUndefined(t.showLikes)?!0:t.showLikes},initializePageCommentView:function(e){this.conversation=e.conversation;if(!this.conversation)throw"Conversation required in PageCommentView";this.conversationOwnerProfilePk=this.conversation.get("ownerProfilePk")},render:function(){var e=this.model.toJSON();e.nameDisplayValue=e.authorFullName||e.authorDisplayName,e.authorDisplayName===a.get("displayName")&&(e.nameDisplayValue=a.get("fullName")||e.authorDisplayName),this.$el.addClass("media comment"),this.$el.html(this.template({comment:e,dayDisplay:i.howLongAgo(this.model.get("createDate")),Localizer:n,viewerProfilePk:a.get("profileId"),conversationOwnerPk:this.conversationOwnerProfilePk,url:s.url,showLikes:this.showLikes})),this.showLikes&&(this.likeView=new o({el:this.$(".entry-like"),conversationUuid:this.model.get("conversationCommentUuid"),liked:e.likedByUser,numberOfLikes:e.numberOfLikes,isComment:!0}),this.likeView.render())},onDeleteCommentClicked:function(e){e.preventDefault();var t=this,r=new l({modalTitle:n.localize("delete_comment"),message:n.localize("delete_comment_confirmation"),confirmationTextKey:"button_delete",cancelTextKey:"button_cancel",onSaveButtonClicked:function(){return t.model.destroy(),t.remove(),!0}});r.render()}});return p.Events=h,p}),!function(e){"use strict";var t=function(e,t){this.init("twipsy",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);!n.options.delay||!n.options.delay.show?n.show():(n.hoverState="in",setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show))},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);!n.options.delay||!n.options.delay.hide?n.hide():setTimeout(function(){n.hoverState="out",n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?thing.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).prependTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s.split(" ")[0]){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}switch(t?s.split(" ")[2]:s.split(" ")[1]){case"bottom":o.top=n.top-n.height/2;break;case"top":o.top=n.top-n.height/2-i/2;break;case"left":o.left=n.left+n.width/2-r+15;break;case"right":o.left=n.left+n.width/2-15}e.css(o).addClass(s.replace(" ","-")).addClass("in")}},setContent:function(){var e=this.tip();e.find(".twipsy-inner").html(this.getTitle()),e[0].className="twipsy"},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var t=this,n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e=e.toString().replace(/(^\s*|\s*$)/,""),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.twipsy=function(n){return this.each(function(){var r=e(this),i=r.data("twipsy"),s=typeof n=="object"&&n;i||r.data("twipsy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.twipsy.Constructor=t,e.fn.twipsy.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="twipsy"><div class="twipsy-arrow"></div><div class="twipsy-inner"></div></div>'}}(window.jQuery),define("twipsy",function(){}),function(e,t,n,r){function u(t,n){this.$element=e(t),this.options=e.extend({},s,n),this._defaults=s,this._name=i,this._menutype="",this.init()}function a(e){f(e,!0)}function f(e,t){var n=h(e),r=e.dialog({autoOpen:!1,closeText:"",modal:t,minWidth:n}),i=o.clone();i.find(".dialog-close-btn").click(function(e){return e.preventDefault(),r.dialog("close"),!1}),e.after(i),e.parent().attr("id",e.attr("id")+"-dialog"),c(e),e.hide()}function l(e){e.find(".ajax-component.deferred").length&&(e.find(".ajax-component.deferred").garminGetComponent({finishEvent:"componentDone",finishContext:e}),e.bind("componentDone",function(){c(e);var t=h(e);e.dialog("option",{width:t,position:"left"}).dialog("option","position","center")}))}function c(e){var t=e.find(".section-header").first();if(t){var n=e.siblings(".ui-widget-header");n.children(".ui-dialog-title").remove(),n.prepend(t.detach())}}function h(t){var n=t.width();return t.addClass("toggleHideToGetDimesions"),t.parent().addClass("toggleHideToGetDimesions"),t.children().each(function(t,r){var i=e(r).width();i>n&&(n=i)}),t.parent().removeClass("toggleHideToGetDimesions"),t.removeClass("toggleHideToGetDimesions"),n}var i="garminMenus",s={moveToBody:!0},o=e(n.createElement("div"));o.addClass("dialog-footer"),$closeBtn=e(n.createElement("button")),$closeBtn.append("Close"),$closeBtn.addClass("btn1 dialog-close-btn"),o.append($closeBtn),u.prototype.closeMenus=function(){},u.prototype.init=function(){var e=this;garminEvent.on("garminMenu:menu:close",this.closeThisMenu,{that:this}),garminEvent.on("garmin.menu.keyup",function(e){switch(e.keyCode){case"27":garminEvent.trigger("garminMenu:menu:close");break;case"39":garminEvent.trigger("garminMenu:menu:right");break;case"37":garminEvent.trigger("garminMenu:menu:left");break;default:garminLog("keyup called: ",e.keyCode)}}),this.menufy()},u.prototype.menufy=function(){var e=this.$element,t={submenu:"createSubMenu",tabmenu:"createTabMenu",selectmenu:"createSelectMenu",modalmenu:"createModalMenu",popmenu:"createPopMenu",popmodal:"createPopModal",popdialog:"createPopDialog",poptip:"createPopTip",popbox:"createPopBox",popinfo:"createPopInfo",nomenu:"noop"};for(menuType in t){var n=t[menuType];if(e.hasClass(menuType)&&typeof this[n]=="function"){this._menutype=menuType,this[n].call(this);break}}},u.prototype.noop=function(){return!0},u.prototype.createSubMenu=function(){this.createTabSubMenu(),this.moveSubmenuInfobox(),this.balanceSubmenuHeights()},u.prototype.createTabMenu=function(){this.createTabSubMenu()},u.prototype.createTabSubMenu=function(){var n=this.$element,r=this;n.children(".header-group").each(function(){var n=e(this),i=t.location.hash,s=!1;n.find(".content-header").each(function(){var t=e(this).find("a");t.attr("href")==i&&(r.showTab(n,t.parent()),s=!0)}),s||r.showTab(n,n.find(".content-header:first"))}).click(function(t){t.preventDefault();var n=e(this),i=e(t.target).parent();r.showTab(n,i)})},u.prototype.createPopInfo=function(){var e=this.$element,t=e.children(".element-body,.content-body"),n=jQuery('<a href="#" class="close"><i class="icon-close"></i>Close</a>'),r=this.findPopBodyClasses(t);this.enhancePopLinks(),e.addClass("enhanced").addClass(r).prepend(n).detach().appendTo("body"),n.on("click",{that:this},function(e){e.preventDefault(),e.stopPropagation(),garminEvent.trigger("garminMenu:menu:close")})},u.prototype.createPopTip=function(){var e=this.$element,t=e.children(".element-body,.content-body"),n=this.findPopBodyClasses(t);this.enhancePopLinks(),e.addClass("enhanced").addClass(n).detach().appendTo("body")},u.prototype.createPopBox=function(){var e=this.$element,t=e.children(".element-body",".content-body"),n=this.findPopBodyClasses(t);this.enhancePopLinks(),e.children(".element-header",".content-header").remove(),this.findPopOptions(e),e.addClass("enhanced").addClass(n),this.options.moveToBody==1&&e.detach().appendTo("body")},u.prototype.findPopOptions=function(t){if(typeof t.attr("data-options")!="undefined"){var n=t.attr("data-options").split(","),r={};jQuery.each(n,function(e,t){var n=t.split(":");r[n[0]]=n[1]}),this.options=e.extend({},s,r)}},u.prototype.findPopBodyClasses=function(e){e.removeClass("element-body"),e.removeClass("content-body");var t=e.attr("class");return t},u.prototype.enhancePopLinks=function(){var e=this.$element,t=e.attr("id"),n=jQuery('a[href="#'+t+'"]'),r=e.children(".element-header",".content-header");if(n.length==0){var i=jQuery('<a href="#'+t+'" class="'+r.attr("class")+'">'+r.children(":first").html()+"</a>");i.insertBefore(e),n=n.add(i)}n.addClass("pop-link").on("click",{that:this},this.openThisMenu)},u.prototype.moveSubmenuInfobox=function(){var t=this.$element;t.hasClass("with-infobox")&&t.children(".infobox").each(function(n,r){e(r).detach().appendTo(t.children(".header-group"))})},u.prototype.balanceSubmenuHeights=function(){var e=this.$element;if(e.parent().hasClass("boxed")){var t=e.children(".header-group").height();e.children(".body-group").css("min-height",t)}},u.prototype.createSelectMenu=function(){var t=this.$element,r=this;t.children(".header-group").children("ul").each(function(i,s){this.active=!1;var o=e(n.createElement("div")).addClass("header-group");t.prepend(o);var u=r.list2select(s,t,o)}).remove()},u.prototype.createPopModal=function(){this.createPopDialog(!0)},u.prototype.createPopDialog=function(t){var n=this.$element,r=e(this),i=n.hide().attr("id");f(n,t),i&&jQuery('a[href$="#'+i+'"]').each(function(e,t){jQuery(t).click(function(e){e.preventDefault(),l(n.children(".section-body")),n.dialog("open")})})},u.prototype.createModalMenu=function(){var t=this.$element,n=e(this);t.children(".body-group").children(".content-body").each(function(t,n){a(e(n))}),t.on("click",".header-group",function(t){t.preventDefault();var n=e(t.target),r=n.attr("href"),i=e(r);return l(i),i.dialog("open"),!1})},u.prototype.openThisMenu=function(e){e.preventDefault(),e.stopPropagation();var t=jQuery(e.currentTarget),n="bottomleft",r="topleft",i={};e.data.that.options.moveToBody==1?i=t.offset():i=t.position();var s=jQuery(t.attr("href")),o=s.children(".element-header,.content-header"),u=s.children(".element-body,.content-body"),a={left:i.left,top:i.top+t.outerHeight()},f={left:a.left,top:a.top};t.hasClass("top")==1?t.hasClass("right")==1?(n="topright",a={left:i.left+t.outerWidth(),top:i.top}):t.hasClass("left")==1?(n="topleft",a={left:i.left,top:i.top}):(n="top",a={left:i.left+Math.floor(t.outerWidth()*.5)+10,top:i.top}):t.hasClass("bottom")==1?t.hasClass("right")==1?(n="bottomright",a={left:i.left+t.outerWidth(),top:i.top+t.outerHeight()}):t.hasClass("left")==1?(n="bottomleft",a={left:i.left,top:i.top+t.outerHeight()}):(n="bottom",a={left:i.left+Math.floor(t.outerWidth()*.5)+10,top:i.top+t.outerHeight()}):t.hasClass("right")==1?(n="right",a={left:i.left+t.outerWidth(),top:i.top+Math.floor(t.outerHeight()*.5)}):t.hasClass("left")==1?(n="left",a={left:i.left,top:i.top+Math.floor(t.outerHeight()*.5)}):s.hasClass("top")==1?(n="bottom",a={left:i.left+Math.floor(t.outerWidth()*.5),top:i.top+t.outerHeight()}):s.hasClass("right")==1?(n="left",a={left:i.left,top:i.top+Math.floor(t.outerHeight()*.5)}):s.hasClass("bottom")==1?(n="top",a={left:i.left+Math.floor(t.outerWidth()*.5),top:i.top}):s.hasClass("left")==1&&(n="right",a={left:i.left+t.outerWidth(),top:i.top+Math.floor(t.outerHeight()*.5)}),s.hasClass("top")==1?s.hasClass("right")==1?(r="topright",f.left=a.left-s.outerWidth(),f.top=a.top):s.hasClass("left")==1?(r="topleft",f.left=a.left,f.top=a.top):(r="top",f.left=a.left-Math.floor(s.outerWidth()*.5),f.top=a.top):s.hasClass("bottom")==1?s.hasClass("right")==1?(r="bottomright",f.left=a.left-s.outerWidth(),f.top=a.top-s.outerHeight()):s.hasClass("left")==1?(r="bottomleft",f.left=a.left,f.top=a.top-s.outerHeight()):(r="bottom",f.left=a.left-Math.floor(s.outerWidth()*.5),f.top=a.top-s.outerHeight()):s.hasClass("right")==1?(r="right",f.left=a.left-s.outerWidth(),f.top=a.top-Math.floor(s.outerHeight()*.5)):s.hasClass("left")==1?(r="left",f.left=a.left,f.top=a.top-Math.floor(s.outerHeight()*.5)):n=="bottom"?(r="topcenter",f.left=a.left-Math.floor(s.outerWidth()*.5),f.top=a.top):n=="top"?(r="bottomcenter",f.left=a.left-Math.floor(s.outerWidth()*.5),f.top=a.top-Math.floor(s.outerHeight())):n=="left"?(r="rightcenter",f.left=a.left-s.outerWidth(),f.top=a.top-Math.floor(s.outerHeight()*.5)):n=="right"?(r="leftcenter",f.left=a.left,f.top=a.top-Math.floor(s.outerHeight()*.5)):(f.left=a.left,f.top=a.top),s.is(":visible")==1&&s.css("left").replace("px","")==f.left&&s.css("top").replace("px","")==f.top?garminEvent.trigger("garminMenu:menu:close"):(garminEvent.trigger("garminMenu:menu:close"),jQuery("body").off(".garminMenu"),jQuery("body").on("keyup.garminMenu click.garminMenu",e.data.that.handleDocumentEvent),s.on("click",function(e){e.stopPropagation()}),s.show().addClass("active"),s.css({left:f.left,top:f.top}),e.data.that.options.moveToBody!=1&&s.detach().insertAfter(t))},u.prototype.handleDocumentEvent=function(e){garminEvent.trigger("garminMenu:menu:close"),jQuery("body").off(".garminMenu")},u.prototype.closeThisMenu=function(e){/(popinfo|poptip|popmenu|popbox)/g.exec(this.that._menutype)!=null?this.that.$element.hide():this.that._menutype=="popmodal"&&this.that.$element.dialog("close")},u.prototype.list2select=function(t,r,i){var s=this,o=e(t),u=e(n.createElement("select")),a=e(n.createElement("option")),f="";return u.append(a.clone().text("Select One")),i.append(u),o.children("li").each(function(t,o){var l=a.clone(),c=e(o),h=c.children("a:first"),p=h.attr("href");l.val(p),l.html(h.text()),c.children("div.content-header-nested").children("ul").each(function(t,o){var u=e(n.createElement("div")).attr("id",p+"-nav").addClass("content-header");i.append(u),s.list2select(o,r,u)});if(c.hasClass("active")||s.active)l.attr("selected","selected"),s.active=!1,f=c.hasClass("active")?"leaf":"tree";u.append(l)}),u.change(function(t){return t.preventDefault(),s.showSelectTree(r,e(this),"leaf"),!1}),f&&(s.showSelectTree(r,u,f),s.active=!0),u},u.prototype.showSelectTree=function(t,r,i){var s=r.val(),o=s+"-nav";if(i=="leaf"){var u=e(s);t.children(".body-group").find(".active").removeClass("active"),u.addClass("active"),u.find(".ajax-component.deferred").garminGetComponent()}r.siblings(".content-header.active").removeClass("active");var a=n.getElementById(o);e(a).addClass("active")},u.prototype.showTab=function(t,n){var r=n.children("a").attr("href"),i=e(r);t.find(".content-header").removeClass("active"),i.parent().find(".content-body").removeClass("active"),n.addClass("active"),i.addClass("active"),i.find(".ajax-component.deferred").garminGetComponent()},e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new u(this,t))})}}(jQuery,window,document),define("jquerymenus",["jquery"],function(){}),define("utils/formatters/HtmlEncodingDecoding",[],function(){var e=function(){};return e.prototype.htmlEncode=function(e){return e?$("<div />").text(e).html():e},e.prototype.htmlDecode=function(e){return e?$("<div />").html(e).text():e},e}),define("models/gear_tracking/Gear",["localizer","backbone"],function(e,t){function n(e){var n=_.has(e,"customMakeModel")?e.customMakeModel:e instanceof t.Model?e.get("customMakeModel")||"":"";if(n)return n;var r=_.has(e,"gearMakeName")?e.gearMakeName:e instanceof t.Model?e.get("gearMakeName")||"":"",i=_.has(e,"gearModelName")?e.gearModelName:e instanceof t.Model?e.get("gearModelName")||"":"";return r+" "+i}function r(e){var t="",r=_.has(e,"displayName")?e.displayName:e.get("displayName")||"",i=n(e);return r&&i&&(t+=r+" ("+$.trim(i)+")"),r||(t=i),t}function i(t,n){return!t&&!n?e.localize("gear_change_default_confirmation_no_name"):t?n?t+" ("+n+")":t:n}var s=t.Model.extend({idAttribute:"uuid",urlRoot:"/proxy/gear-service/gear"});return s.getFullGearDisplayNameByModel=r,s.getFullGearDisplayName=i,s.getMakeModelDisplayName=n,s}),define("collections/gear_tracking/Gears",["underscore","backbone","models/gear_tracking/Gear","utils/parsers/UrlParser"],function(e,t,n,r){function i(t){if(e.isEmpty(t.criteria))throw"GearFilterCriteriaDTO must include a User Profile PK or Activity ID";if(e.has(t.criteria,"userProfilePk")===!1&&e.has(t.criteria,"activityId")===!1)throw"GearFilterCriteriaDTO must include a User Profile PK or Activity ID"}function s(e,t){i(t);if(t.criteria){var n=new r;e.queryString=n.convertObjectToQueryString(t.criteria)}}var o=t.Collection.extend({model:n,initialize:function(e,t){s(this,t)},url:function(){return"/proxy/gear-service/gear/filterGear"+this.queryString}});return o}),define("utils/ItemTypeIconClassMapper",["require","utils/ActivityTypeCssClassMapper"],function(e){var t=e("utils/ActivityTypeCssClassMapper"),n={getItemIconClass:function(e,t){if(e!=null)switch(e.get("itemType")){case"activity":return n.getActivityIconClass(e.get("activityTypeId"),t);case"workout":var r=e.get("sportTypeKey");switch(r){case"running":return"icon-activity-running";case"cycling":return"icon-activity-cycling";case"other":return"icon-activity-other";case"swimming":return"icon-activity-swimming";case"strength_training":return"icon-activity-fitness-equipment";case"cardio_training":return"icon-activity-cardio";default:return"icon-activity-other"}break;case"trainingPlan":return"icon-training-plans";case"goal":return"icon-goals";case"event":return"icon-race";default:return"icon-activity-"+e.get("itemType")}},getActivityIconClass:function(e,t){var n=t.findByTypeKey("all").get("typeId"),r=t.findByTypeId(e),i=typeof r=="undefined"?"multi_sport":r.get("typeKey"),s=typeof r=="undefined"?n:r.get("parentTypeId"),o=this.getIconClassname(i);return o==="no-icon"&&(i=t.findByTypeId(s).get("typeKey"),o=this.getIconClassname(i)),o==="no-icon"?"icon-activity-other":o},getActivityIconClassByTypeName:function(e,t){var n=t||e,r=this.getIconClassname(n);return r==="no-icon"&&e&&(n=e,r=this.getIconClassname(n)),r==="no-icon"?"icon-activity-other":r},getIconClassname:function(e){var n=t.map(e);return n==="uncategorized"?"no-icon":"icon-activity-"+t.map(e)}};return n}),define("models/groups/Group",["backbone"],function(e){var t={PRIVATE:"PRIVATE",PUBLIC:"PUBLIC",INVITE:"INVITE"},n={HIDDEN:"HIDDEN",VISIBLE:"VISIBLE"},r=e.Model.extend({urlRoot:"/proxy/group-service/group",defaults:{groupName:null,groupDescription:null,ownerId:null,profileImageUrlLarge:null,profileImageUrlMedium:null,profileImageUrlSmall:null,groupVisibility:n.VISIBLE,groupPrivacy:t.PUBLIC,location:null,websiteUrl:null,facebookUrl:null,twitterUrl:null,primaryActivities:[],activityFeedTypes:[],otherPrimaryActivity:null,leaderboardTypes:[],featureTypes:[]},initialize:function(e){this.isDirty=!1,this.bind("change",this.onChange,this),this.bind("sync",this.onSync,this)},backup:function(){this.backupAttributes=_.clone(this.attributes)},restore:function(){this.backupAttributes&&(this.set(this.backupAttributes),this.isDirty=!1)},onSync:function(){this.isDirty=!1,this.backup()},onChange:function(){this.isDirty=!0},hasActivitiesEnabled:function(){var e=this.get("primaryActivities");return _.contains(e,"RUNNING")||_.contains(e,"ROAD_CYCLING")||_.contains(e,"MOUNTAIN_BIKING")||_.contains(e,"SWIMMING")||_.contains(e,"TRIATHLON")||_.contains(e,"OTHER")||_.contains(e,"DIVING")},hasStepsEnabled:function(){return _.contains(this.get("primaryActivities"),"STEP_TRACKING_AND_WALKING")}});return r.PrivacySettings=t,r.VisibilitySettings=n,r}),function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){(function(e){var t=e.pInt,n=e.pick,r=e.each,i=e.isNumber,s;s={initDataClasses:function(t){var n=this,i=this.chart,s,o=0,u=this.options;this.dataClasses=s=[],r(t.dataClasses,function(r,f){var p;r=e.merge(r),s.push(r),r.color||("category"===u.dataClassColor?(p=i.options.colors,r.color=p[o++],o===p.length&&(o=0)):r.color=n.tweenColors(e.color(u.minColor),e.color(u.maxColor),f/(t.dataClasses.length-1)))})},initStops:function(t){this.stops=t.stops||[[0,this.options.minColor],[1,this.options.maxColor]],r(this.stops,function(t){t.color=e.color(t[1])})},toColor:function(e,t){var n,r=this.stops,i,s=this.dataClasses,o,u;if(s){for(u=s.length;u--;)if(o=s[u],i=o.from,r=o.to,(void 0===i||e>=i)&&(void 0===r||e<=r)){n=o.color,t&&(t.dataClass=u);break}}else{this.isLog&&(e=this.val2lin(e)),n=1-(this.max-e)/(this.max-this.min);for(u=r.length;u--&&!(n>r[u][0]););i=r[u]||r[u+1],r=r[u+1]||i,n=1-(r[0]-n)/(r[0]-i[0]||1),n=this.tweenColors(i.color,r.color,n)}return n},tweenColors:function(e,t,n){var r;return t.rgba.length&&e.rgba.length?(e=e.rgba,t=t.rgba,r=1!==t[3]||1!==e[3],e=(r?"rgba(":"rgb(")+Math.round(t[0]+(e[0]-t[0])*(1-n))+","+Math.round(t[1]+(e[1]-t[1])*(1-n))+","+Math.round(t[2]+(e[2]-t[2])*(1-n))+(r?","+(t[3]+(e[3]-t[3])*(1-n)):"")+")"):e=t.input||"none",e}},r(["fill","stroke"],function(t){e.Fx.prototype[t+"Setter"]=function(){this.elem.attr(t,s.tweenColors(e.color(this.start),e.color(this.end),this.pos))}}),e.seriesType("solidgauge","gauge",{colorByPoint:!0},{bindAxes:function(){var t;e.seriesTypes.gauge.prototype.bindAxes.call(this),t=this.yAxis,e.extend(t,s),t.options.dataClasses&&t.initDataClasses(t.options),t.initStops(t.options)},drawPoints:function(){var e=this,s=e.yAxis,o=s.center,a=e.options,l=e.chart.renderer,c=a.overshoot,h=i(c)?c/180*Math.PI:0;r(e.points,function(r){var i=r.graphic,c=s.startAngleRad+s.translate(r.y,null,null,null,!0),p=t(n(r.options.radius,a.radius,100))*o[2]/200,d=t(n(r.options.innerRadius,a.innerRadius,60))*o[2]/200,v=s.toColor(r.y,r),m=Math.min(s.startAngleRad,s.endAngleRad),y=Math.max(s.startAngleRad,s.endAngleRad);"none"===v&&(v=r.color||e.color||"none"),"none"!==v&&(r.color=v),c=Math.max(m-h,Math.min(y+h,c)),!1===a.wrap&&(c=Math.max(m,Math.min(y,c))),m=Math.min(c,s.startAngleRad),c=Math.max(c,s.startAngleRad),c-m>2*Math.PI&&(c=m+2*Math.PI),r.shapeArgs=d={x:o[0],y:o[1],r:p,innerR:d,start:m,end:c,fill:v},r.startR=p,i?(r=d.d,i.animate(d),r&&(d.d=r)):r.graphic=l.arc(d).addClass("highcharts-point").attr({fill:v,"sweep-flag":0}).add(e.group)})},animate:function(t){t||(this.startAngleRad=this.yAxis.startAngleRad,e.seriesTypes.pie.prototype.animate.call(this,t))}})})(e)}),define("lib/highcharts/solid-gauge",function(){}),define("models/weight/Weight",["backbone"],function(e){var t=e.Model.extend({initialize:function(e){},url:function(){var e="/proxy/weight-service/weight";return typeof this.get("isFirst")!="undefined"&&(e+="/first"),e},destroy:function(t){var n="/proxy/biometric-service/biometric/"+this.get("date"),r=_.extend({url:n},t||{});return e.Model.prototype.destroy.call(this,r)},save:function(t,n){var r=_.extend({url:"/proxy/weight-service/user-weight"},n||{});return e.Model.prototype.save.call(this,t,r)}});return t});